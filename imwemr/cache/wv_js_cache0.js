/*! jQuery UI - v1.11.4 - 2015-08-16
* http://jqueryui.com
* Includes: core.js, widget.js, mouse.js, position.js, draggable.js, droppable.js, resizable.js, selectable.js, sortable.js, accordion.js, autocomplete.js, button.js, datepicker.js, dialog.js, menu.js, progressbar.js, selectmenu.js, slider.js, spinner.js, tabs.js, tooltip.js, effect.js, effect-blind.js, effect-bounce.js, effect-clip.js, effect-drop.js, effect-explode.js, effect-fade.js, effect-fold.js, effect-highlight.js, effect-puff.js, effect-pulsate.js, effect-scale.js, effect-shake.js, effect-size.js, effect-slide.js, effect-transfer.js
* Copyright 2015 jQuery Foundation and other contributors; Licensed MIT */

(function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)})(function(e){function t(t,s){var n,a,o,r=t.nodeName.toLowerCase();return"area"===r?(n=t.parentNode,a=n.name,t.href&&a&&"map"===n.nodeName.toLowerCase()?(o=e("img[usemap='#"+a+"']")[0],!!o&&i(o)):!1):(/^(input|select|textarea|button|object)$/.test(r)?!t.disabled:"a"===r?t.href||s:s)&&i(t)}function i(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}function s(e){for(var t,i;e.length&&e[0]!==document;){if(t=e.css("position"),("absolute"===t||"relative"===t||"fixed"===t)&&(i=parseInt(e.css("zIndex"),10),!isNaN(i)&&0!==i))return i;e=e.parent()}return 0}function n(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},e.extend(this._defaults,this.regional[""]),this.regional.en=e.extend(!0,{},this.regional[""]),this.regional["en-US"]=e.extend(!0,{},this.regional.en),this.dpDiv=a(e("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function a(t){var i="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return t.delegate(i,"mouseout",function(){e(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&e(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&e(this).removeClass("ui-datepicker-next-hover")}).delegate(i,"mouseover",o)}function o(){e.datepicker._isDisabledDatepicker(v.inline?v.dpDiv.parent()[0]:v.input[0])||(e(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),e(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&e(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&e(this).addClass("ui-datepicker-next-hover"))}function r(t,i){e.extend(t,i);for(var s in i)null==i[s]&&(t[s]=i[s]);return t}function h(e){return function(){var t=this.element.val();e.apply(this,arguments),this._refresh(),t!==this.element.val()&&this._trigger("change")}}e.ui=e.ui||{},e.extend(e.ui,{version:"1.11.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({scrollParent:function(t){var i=this.css("position"),s="absolute"===i,n=t?/(auto|scroll|hidden)/:/(auto|scroll)/,a=this.parents().filter(function(){var t=e(this);return s&&"static"===t.css("position")?!1:n.test(t.css("overflow")+t.css("overflow-y")+t.css("overflow-x"))}).eq(0);return"fixed"!==i&&a.length?a:e(this[0].ownerDocument||document)},uniqueId:function(){var e=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(i){return!!e.data(i,t)}}):function(t,i,s){return!!e.data(t,s[3])},focusable:function(i){return t(i,!isNaN(e.attr(i,"tabindex")))},tabbable:function(i){var s=e.attr(i,"tabindex"),n=isNaN(s);return(n||s>=0)&&t(i,!n)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(t,i){function s(t,i,s,a){return e.each(n,function(){i-=parseFloat(e.css(t,"padding"+this))||0,s&&(i-=parseFloat(e.css(t,"border"+this+"Width"))||0),a&&(i-=parseFloat(e.css(t,"margin"+this))||0)}),i}var n="Width"===i?["Left","Right"]:["Top","Bottom"],a=i.toLowerCase(),o={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+i]=function(t){return void 0===t?o["inner"+i].call(this):this.each(function(){e(this).css(a,s(this,t)+"px")})},e.fn["outer"+i]=function(t,n){return"number"!=typeof t?o["outer"+i].call(this,t):this.each(function(){e(this).css(a,s(this,t,!0,n)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(i){return arguments.length?t.call(this,e.camelCase(i)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.fn.extend({focus:function(t){return function(i,s){return"number"==typeof i?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),s&&s.call(t)},i)}):t.apply(this,arguments)}}(e.fn.focus),disableSelection:function(){var e="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(e+".ui-disableSelection",function(e){e.preventDefault()})}}(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(t){if(void 0!==t)return this.css("zIndex",t);if(this.length)for(var i,s,n=e(this[0]);n.length&&n[0]!==document;){if(i=n.css("position"),("absolute"===i||"relative"===i||"fixed"===i)&&(s=parseInt(n.css("zIndex"),10),!isNaN(s)&&0!==s))return s;n=n.parent()}return 0}}),e.ui.plugin={add:function(t,i,s){var n,a=e.ui[t].prototype;for(n in s)a.plugins[n]=a.plugins[n]||[],a.plugins[n].push([i,s[n]])},call:function(e,t,i,s){var n,a=e.plugins[t];if(a&&(s||e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType))for(n=0;a.length>n;n++)e.options[a[n][0]]&&a[n][1].apply(e.element,i)}};var l=0,u=Array.prototype.slice;e.cleanData=function(t){return function(i){var s,n,a;for(a=0;null!=(n=i[a]);a++)try{s=e._data(n,"events"),s&&s.remove&&e(n).triggerHandler("remove")}catch(o){}t(i)}}(e.cleanData),e.widget=function(t,i,s){var n,a,o,r,h={},l=t.split(".")[0];return t=t.split(".")[1],n=l+"-"+t,s||(s=i,i=e.Widget),e.expr[":"][n.toLowerCase()]=function(t){return!!e.data(t,n)},e[l]=e[l]||{},a=e[l][t],o=e[l][t]=function(e,t){return this._createWidget?(arguments.length&&this._createWidget(e,t),void 0):new o(e,t)},e.extend(o,a,{version:s.version,_proto:e.extend({},s),_childConstructors:[]}),r=new i,r.options=e.widget.extend({},r.options),e.each(s,function(t,s){return e.isFunction(s)?(h[t]=function(){var e=function(){return i.prototype[t].apply(this,arguments)},n=function(e){return i.prototype[t].apply(this,e)};return function(){var t,i=this._super,a=this._superApply;return this._super=e,this._superApply=n,t=s.apply(this,arguments),this._super=i,this._superApply=a,t}}(),void 0):(h[t]=s,void 0)}),o.prototype=e.widget.extend(r,{widgetEventPrefix:a?r.widgetEventPrefix||t:t},h,{constructor:o,namespace:l,widgetName:t,widgetFullName:n}),a?(e.each(a._childConstructors,function(t,i){var s=i.prototype;e.widget(s.namespace+"."+s.widgetName,o,i._proto)}),delete a._childConstructors):i._childConstructors.push(o),e.widget.bridge(t,o),o},e.widget.extend=function(t){for(var i,s,n=u.call(arguments,1),a=0,o=n.length;o>a;a++)for(i in n[a])s=n[a][i],n[a].hasOwnProperty(i)&&void 0!==s&&(t[i]=e.isPlainObject(s)?e.isPlainObject(t[i])?e.widget.extend({},t[i],s):e.widget.extend({},s):s);return t},e.widget.bridge=function(t,i){var s=i.prototype.widgetFullName||t;e.fn[t]=function(n){var a="string"==typeof n,o=u.call(arguments,1),r=this;return a?this.each(function(){var i,a=e.data(this,s);return"instance"===n?(r=a,!1):a?e.isFunction(a[n])&&"_"!==n.charAt(0)?(i=a[n].apply(a,o),i!==a&&void 0!==i?(r=i&&i.jquery?r.pushStack(i.get()):i,!1):void 0):e.error("no such method '"+n+"' for "+t+" widget instance"):e.error("cannot call methods on "+t+" prior to initialization; "+"attempted to call method '"+n+"'")}):(o.length&&(n=e.widget.extend.apply(null,[n].concat(o))),this.each(function(){var t=e.data(this,s);t?(t.option(n||{}),t._init&&t._init()):e.data(this,s,new i(n,this))})),r}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,i){i=e(i||this.defaultElement||this)[0],this.element=e(i),this.uuid=l++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=e(),this.hoverable=e(),this.focusable=e(),i!==this&&(e.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===i&&this.destroy()}}),this.document=e(i.style?i.ownerDocument:i.document||i),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(t,i){var s,n,a,o=t;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof t)if(o={},s=t.split("."),t=s.shift(),s.length){for(n=o[t]=e.widget.extend({},this.options[t]),a=0;s.length-1>a;a++)n[s[a]]=n[s[a]]||{},n=n[s[a]];if(t=s.pop(),1===arguments.length)return void 0===n[t]?null:n[t];n[t]=i}else{if(1===arguments.length)return void 0===this.options[t]?null:this.options[t];o[t]=i}return this._setOptions(o),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!t),t&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(t,i,s){var n,a=this;"boolean"!=typeof t&&(s=i,i=t,t=!1),s?(i=n=e(i),this.bindings=this.bindings.add(i)):(s=i,i=this.element,n=this.widget()),e.each(s,function(s,o){function r(){return t||a.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled")?("string"==typeof o?a[o]:o).apply(a,arguments):void 0}"string"!=typeof o&&(r.guid=o.guid=o.guid||r.guid||e.guid++);var h=s.match(/^([\w:-]*)\s*(.*)$/),l=h[1]+a.eventNamespace,u=h[2];u?n.delegate(u,l,r):i.bind(l,r)})},_off:function(t,i){i=(i||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.unbind(i).undelegate(i),this.bindings=e(this.bindings.not(t).get()),this.focusable=e(this.focusable.not(t).get()),this.hoverable=e(this.hoverable.not(t).get())},_delay:function(e,t){function i(){return("string"==typeof e?s[e]:e).apply(s,arguments)}var s=this;return setTimeout(i,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,i,s){var n,a,o=this.options[t];if(s=s||{},i=e.Event(i),i.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),i.target=this.element[0],a=i.originalEvent)for(n in a)n in i||(i[n]=a[n]);return this.element.trigger(i,s),!(e.isFunction(o)&&o.apply(this.element[0],[i].concat(s))===!1||i.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,i){e.Widget.prototype["_"+t]=function(s,n,a){"string"==typeof n&&(n={effect:n});var o,r=n?n===!0||"number"==typeof n?i:n.effect||i:t;n=n||{},"number"==typeof n&&(n={duration:n}),o=!e.isEmptyObject(n),n.complete=a,n.delay&&s.delay(n.delay),o&&e.effects&&e.effects.effect[r]?s[t](n):r!==t&&s[r]?s[r](n.duration,n.easing,a):s.queue(function(i){e(this)[t](),a&&a.call(s[0]),i()})}}),e.widget;var d=!1;e(document).mouseup(function(){d=!1}),e.widget("ui.mouse",{version:"1.11.4",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(i){return!0===e.data(i.target,t.widgetName+".preventClickEvent")?(e.removeData(i.target,t.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(t){if(!d){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(t),this._mouseDownEvent=t;var i=this,s=1===t.which,n="string"==typeof this.options.cancel&&t.target.nodeName?e(t.target).closest(this.options.cancel).length:!1;return s&&!n&&this._mouseCapture(t)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){i.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(t)!==!1,!this._mouseStarted)?(t.preventDefault(),!0):(!0===e.data(t.target,this.widgetName+".preventClickEvent")&&e.removeData(t.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return i._mouseMove(e)},this._mouseUpDelegate=function(e){return i._mouseUp(e)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),t.preventDefault(),d=!0,!0)):!0}},_mouseMove:function(t){if(this._mouseMoved){if(e.ui.ie&&(!document.documentMode||9>document.documentMode)&&!t.button)return this._mouseUp(t);if(!t.which)return this._mouseUp(t)}return(t.which||t.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(t){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),d=!1,!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),function(){function t(e,t,i){return[parseFloat(e[0])*(p.test(e[0])?t/100:1),parseFloat(e[1])*(p.test(e[1])?i/100:1)]}function i(t,i){return parseInt(e.css(t,i),10)||0}function s(t){var i=t[0];return 9===i.nodeType?{width:t.width(),height:t.height(),offset:{top:0,left:0}}:e.isWindow(i)?{width:t.width(),height:t.height(),offset:{top:t.scrollTop(),left:t.scrollLeft()}}:i.preventDefault?{width:0,height:0,offset:{top:i.pageY,left:i.pageX}}:{width:t.outerWidth(),height:t.outerHeight(),offset:t.offset()}}e.ui=e.ui||{};var n,a,o=Math.max,r=Math.abs,h=Math.round,l=/left|center|right/,u=/top|center|bottom/,d=/[\+\-]\d+(\.[\d]+)?%?/,c=/^\w+/,p=/%$/,f=e.fn.position;e.position={scrollbarWidth:function(){if(void 0!==n)return n;var t,i,s=e("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),a=s.children()[0];return e("body").append(s),t=a.offsetWidth,s.css("overflow","scroll"),i=a.offsetWidth,t===i&&(i=s[0].clientWidth),s.remove(),n=t-i},getScrollInfo:function(t){var i=t.isWindow||t.isDocument?"":t.element.css("overflow-x"),s=t.isWindow||t.isDocument?"":t.element.css("overflow-y"),n="scroll"===i||"auto"===i&&t.width<t.element[0].scrollWidth,a="scroll"===s||"auto"===s&&t.height<t.element[0].scrollHeight;return{width:a?e.position.scrollbarWidth():0,height:n?e.position.scrollbarWidth():0}},getWithinInfo:function(t){var i=e(t||window),s=e.isWindow(i[0]),n=!!i[0]&&9===i[0].nodeType;return{element:i,isWindow:s,isDocument:n,offset:i.offset()||{left:0,top:0},scrollLeft:i.scrollLeft(),scrollTop:i.scrollTop(),width:s||n?i.width():i.outerWidth(),height:s||n?i.height():i.outerHeight()}}},e.fn.position=function(n){if(!n||!n.of)return f.apply(this,arguments);n=e.extend({},n);var p,m,g,v,y,b,_=e(n.of),x=e.position.getWithinInfo(n.within),w=e.position.getScrollInfo(x),k=(n.collision||"flip").split(" "),T={};return b=s(_),_[0].preventDefault&&(n.at="left top"),m=b.width,g=b.height,v=b.offset,y=e.extend({},v),e.each(["my","at"],function(){var e,t,i=(n[this]||"").split(" ");1===i.length&&(i=l.test(i[0])?i.concat(["center"]):u.test(i[0])?["center"].concat(i):["center","center"]),i[0]=l.test(i[0])?i[0]:"center",i[1]=u.test(i[1])?i[1]:"center",e=d.exec(i[0]),t=d.exec(i[1]),T[this]=[e?e[0]:0,t?t[0]:0],n[this]=[c.exec(i[0])[0],c.exec(i[1])[0]]}),1===k.length&&(k[1]=k[0]),"right"===n.at[0]?y.left+=m:"center"===n.at[0]&&(y.left+=m/2),"bottom"===n.at[1]?y.top+=g:"center"===n.at[1]&&(y.top+=g/2),p=t(T.at,m,g),y.left+=p[0],y.top+=p[1],this.each(function(){var s,l,u=e(this),d=u.outerWidth(),c=u.outerHeight(),f=i(this,"marginLeft"),b=i(this,"marginTop"),D=d+f+i(this,"marginRight")+w.width,S=c+b+i(this,"marginBottom")+w.height,M=e.extend({},y),C=t(T.my,u.outerWidth(),u.outerHeight());"right"===n.my[0]?M.left-=d:"center"===n.my[0]&&(M.left-=d/2),"bottom"===n.my[1]?M.top-=c:"center"===n.my[1]&&(M.top-=c/2),M.left+=C[0],M.top+=C[1],a||(M.left=h(M.left),M.top=h(M.top)),s={marginLeft:f,marginTop:b},e.each(["left","top"],function(t,i){e.ui.position[k[t]]&&e.ui.position[k[t]][i](M,{targetWidth:m,targetHeight:g,elemWidth:d,elemHeight:c,collisionPosition:s,collisionWidth:D,collisionHeight:S,offset:[p[0]+C[0],p[1]+C[1]],my:n.my,at:n.at,within:x,elem:u})}),n.using&&(l=function(e){var t=v.left-M.left,i=t+m-d,s=v.top-M.top,a=s+g-c,h={target:{element:_,left:v.left,top:v.top,width:m,height:g},element:{element:u,left:M.left,top:M.top,width:d,height:c},horizontal:0>i?"left":t>0?"right":"center",vertical:0>a?"top":s>0?"bottom":"middle"};d>m&&m>r(t+i)&&(h.horizontal="center"),c>g&&g>r(s+a)&&(h.vertical="middle"),h.important=o(r(t),r(i))>o(r(s),r(a))?"horizontal":"vertical",n.using.call(this,e,h)}),u.offset(e.extend(M,{using:l}))})},e.ui.position={fit:{left:function(e,t){var i,s=t.within,n=s.isWindow?s.scrollLeft:s.offset.left,a=s.width,r=e.left-t.collisionPosition.marginLeft,h=n-r,l=r+t.collisionWidth-a-n;t.collisionWidth>a?h>0&&0>=l?(i=e.left+h+t.collisionWidth-a-n,e.left+=h-i):e.left=l>0&&0>=h?n:h>l?n+a-t.collisionWidth:n:h>0?e.left+=h:l>0?e.left-=l:e.left=o(e.left-r,e.left)},top:function(e,t){var i,s=t.within,n=s.isWindow?s.scrollTop:s.offset.top,a=t.within.height,r=e.top-t.collisionPosition.marginTop,h=n-r,l=r+t.collisionHeight-a-n;t.collisionHeight>a?h>0&&0>=l?(i=e.top+h+t.collisionHeight-a-n,e.top+=h-i):e.top=l>0&&0>=h?n:h>l?n+a-t.collisionHeight:n:h>0?e.top+=h:l>0?e.top-=l:e.top=o(e.top-r,e.top)}},flip:{left:function(e,t){var i,s,n=t.within,a=n.offset.left+n.scrollLeft,o=n.width,h=n.isWindow?n.scrollLeft:n.offset.left,l=e.left-t.collisionPosition.marginLeft,u=l-h,d=l+t.collisionWidth-o-h,c="left"===t.my[0]?-t.elemWidth:"right"===t.my[0]?t.elemWidth:0,p="left"===t.at[0]?t.targetWidth:"right"===t.at[0]?-t.targetWidth:0,f=-2*t.offset[0];0>u?(i=e.left+c+p+f+t.collisionWidth-o-a,(0>i||r(u)>i)&&(e.left+=c+p+f)):d>0&&(s=e.left-t.collisionPosition.marginLeft+c+p+f-h,(s>0||d>r(s))&&(e.left+=c+p+f))},top:function(e,t){var i,s,n=t.within,a=n.offset.top+n.scrollTop,o=n.height,h=n.isWindow?n.scrollTop:n.offset.top,l=e.top-t.collisionPosition.marginTop,u=l-h,d=l+t.collisionHeight-o-h,c="top"===t.my[1],p=c?-t.elemHeight:"bottom"===t.my[1]?t.elemHeight:0,f="top"===t.at[1]?t.targetHeight:"bottom"===t.at[1]?-t.targetHeight:0,m=-2*t.offset[1];0>u?(s=e.top+p+f+m+t.collisionHeight-o-a,(0>s||r(u)>s)&&(e.top+=p+f+m)):d>0&&(i=e.top-t.collisionPosition.marginTop+p+f+m-h,(i>0||d>r(i))&&(e.top+=p+f+m))}},flipfit:{left:function(){e.ui.position.flip.left.apply(this,arguments),e.ui.position.fit.left.apply(this,arguments)},top:function(){e.ui.position.flip.top.apply(this,arguments),e.ui.position.fit.top.apply(this,arguments)}}},function(){var t,i,s,n,o,r=document.getElementsByTagName("body")[0],h=document.createElement("div");t=document.createElement(r?"div":"body"),s={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},r&&e.extend(s,{position:"absolute",left:"-1000px",top:"-1000px"});for(o in s)t.style[o]=s[o];t.appendChild(h),i=r||document.documentElement,i.insertBefore(t,i.firstChild),h.style.cssText="position: absolute; left: 10.7432222px;",n=e(h).offset().left,a=n>10&&11>n,t.innerHTML="",i.removeChild(t)}()}(),e.ui.position,e.widget("ui.draggable",e.ui.mouse,{version:"1.11.4",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._setHandleClassName(),this._mouseInit()},_setOption:function(e,t){this._super(e,t),"handle"===e&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){return(this.helper||this.element).is(".ui-draggable-dragging")?(this.destroyOnClear=!0,void 0):(this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._removeHandleClassName(),this._mouseDestroy(),void 0)},_mouseCapture:function(t){var i=this.options;return this._blurActiveElement(t),this.helper||i.disabled||e(t.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(t),this.handle?(this._blockFrames(i.iframeFix===!0?"iframe":i.iframeFix),!0):!1)},_blockFrames:function(t){this.iframeBlocks=this.document.find(t).map(function(){var t=e(this);return e("<div>").css("position","absolute").appendTo(t.parent()).outerWidth(t.outerWidth()).outerHeight(t.outerHeight()).offset(t.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(t){var i=this.document[0];if(this.handleElement.is(t.target))try{i.activeElement&&"body"!==i.activeElement.nodeName.toLowerCase()&&e(i.activeElement).blur()}catch(s){}},_mouseStart:function(t){var i=this.options;return this.helper=this._createHelper(t),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=this.helper.parents().filter(function(){return"fixed"===e(this).css("position")}).length>0,this.positionAbs=this.element.offset(),this._refreshOffsets(t),this.originalPosition=this.position=this._generatePosition(t,!1),this.originalPageX=t.pageX,this.originalPageY=t.pageY,i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt),this._setContainment(),this._trigger("start",t)===!1?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!i.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._normalizeRightBottom(),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)},_refreshOffsets:function(e){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:e.pageX-this.offset.left,top:e.pageY-this.offset.top}},_mouseDrag:function(t,i){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(t,!0),this.positionAbs=this._convertPositionTo("absolute"),!i){var s=this._uiHash();if(this._trigger("drag",t,s)===!1)return this._mouseUp({}),!1;this.position=s.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var i=this,s=!1;return e.ui.ddmanager&&!this.options.dropBehaviour&&(s=e.ui.ddmanager.drop(this,t)),this.dropped&&(s=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!s||"valid"===this.options.revert&&s||this.options.revert===!0||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,s)?e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){i._trigger("stop",t)!==!1&&i._clear()}):this._trigger("stop",t)!==!1&&this._clear(),!1},_mouseUp:function(t){return this._unblockFrames(),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),this.handleElement.is(t.target)&&this.element.focus(),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){return this.options.handle?!!e(t.target).closest(this.element.find(this.options.handle)).length:!0},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this.handleElement.addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.handleElement.removeClass("ui-draggable-handle")},_createHelper:function(t){var i=this.options,s=e.isFunction(i.helper),n=s?e(i.helper.apply(this.element[0],[t])):"clone"===i.helper?this.element.clone().removeAttr("id"):this.element;return n.parents("body").length||n.appendTo("parent"===i.appendTo?this.element[0].parentNode:i.appendTo),s&&n[0]===this.element[0]&&this._setPositionRelative(),n[0]===this.element[0]||/(fixed|absolute)/.test(n.css("position"))||n.css("position","absolute"),n},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_isRootNode:function(e){return/(html|body)/i.test(e.tagName)||e===this.document[0]},_getParentOffset:function(){var t=this.offsetParent.offset(),i=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==i&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var e=this.element.position(),t=this._isRootNode(this.scrollParent[0]);return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+(t?0:this.scrollParent.scrollTop()),left:e.left-(parseInt(this.helper.css("left"),10)||0)+(t?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,i,s,n=this.options,a=this.document[0];return this.relativeContainer=null,n.containment?"window"===n.containment?(this.containment=[e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,e(window).scrollLeft()+e(window).width()-this.helperProportions.width-this.margins.left,e(window).scrollTop()+(e(window).height()||a.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],void 0):"document"===n.containment?(this.containment=[0,0,e(a).width()-this.helperProportions.width-this.margins.left,(e(a).height()||a.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],void 0):n.containment.constructor===Array?(this.containment=n.containment,void 0):("parent"===n.containment&&(n.containment=this.helper[0].parentNode),i=e(n.containment),s=i[0],s&&(t=/(scroll|auto)/.test(i.css("overflow")),this.containment=[(parseInt(i.css("borderLeftWidth"),10)||0)+(parseInt(i.css("paddingLeft"),10)||0),(parseInt(i.css("borderTopWidth"),10)||0)+(parseInt(i.css("paddingTop"),10)||0),(t?Math.max(s.scrollWidth,s.offsetWidth):s.offsetWidth)-(parseInt(i.css("borderRightWidth"),10)||0)-(parseInt(i.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(s.scrollHeight,s.offsetHeight):s.offsetHeight)-(parseInt(i.css("borderBottomWidth"),10)||0)-(parseInt(i.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=i),void 0):(this.containment=null,void 0)},_convertPositionTo:function(e,t){t||(t=this.position);var i="absolute"===e?1:-1,s=this._isRootNode(this.scrollParent[0]);return{top:t.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.offset.scroll.top:s?0:this.offset.scroll.top)*i,left:t.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.offset.scroll.left:s?0:this.offset.scroll.left)*i}},_generatePosition:function(e,t){var i,s,n,a,o=this.options,r=this._isRootNode(this.scrollParent[0]),h=e.pageX,l=e.pageY;return r&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),t&&(this.containment&&(this.relativeContainer?(s=this.relativeContainer.offset(),i=[this.containment[0]+s.left,this.containment[1]+s.top,this.containment[2]+s.left,this.containment[3]+s.top]):i=this.containment,e.pageX-this.offset.click.left<i[0]&&(h=i[0]+this.offset.click.left),e.pageY-this.offset.click.top<i[1]&&(l=i[1]+this.offset.click.top),e.pageX-this.offset.click.left>i[2]&&(h=i[2]+this.offset.click.left),e.pageY-this.offset.click.top>i[3]&&(l=i[3]+this.offset.click.top)),o.grid&&(n=o.grid[1]?this.originalPageY+Math.round((l-this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY,l=i?n-this.offset.click.top>=i[1]||n-this.offset.click.top>i[3]?n:n-this.offset.click.top>=i[1]?n-o.grid[1]:n+o.grid[1]:n,a=o.grid[0]?this.originalPageX+Math.round((h-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX,h=i?a-this.offset.click.left>=i[0]||a-this.offset.click.left>i[2]?a:a-this.offset.click.left>=i[0]?a-o.grid[0]:a+o.grid[0]:a),"y"===o.axis&&(h=this.originalPageX),"x"===o.axis&&(l=this.originalPageY)),{top:l-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:r?0:this.offset.scroll.top),left:h-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:r?0:this.offset.scroll.left)}
},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_normalizeRightBottom:function(){"y"!==this.options.axis&&"auto"!==this.helper.css("right")&&(this.helper.width(this.helper.width()),this.helper.css("right","auto")),"x"!==this.options.axis&&"auto"!==this.helper.css("bottom")&&(this.helper.height(this.helper.height()),this.helper.css("bottom","auto"))},_trigger:function(t,i,s){return s=s||this._uiHash(),e.ui.plugin.call(this,t,[i,s,this],!0),/^(drag|start|stop)/.test(t)&&(this.positionAbs=this._convertPositionTo("absolute"),s.offset=this.positionAbs),e.Widget.prototype._trigger.call(this,t,i,s)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,i,s){var n=e.extend({},i,{item:s.element});s.sortables=[],e(s.options.connectToSortable).each(function(){var i=e(this).sortable("instance");i&&!i.options.disabled&&(s.sortables.push(i),i.refreshPositions(),i._trigger("activate",t,n))})},stop:function(t,i,s){var n=e.extend({},i,{item:s.element});s.cancelHelperRemoval=!1,e.each(s.sortables,function(){var e=this;e.isOver?(e.isOver=0,s.cancelHelperRemoval=!0,e.cancelHelperRemoval=!1,e._storedCSS={position:e.placeholder.css("position"),top:e.placeholder.css("top"),left:e.placeholder.css("left")},e._mouseStop(t),e.options.helper=e.options._helper):(e.cancelHelperRemoval=!0,e._trigger("deactivate",t,n))})},drag:function(t,i,s){e.each(s.sortables,function(){var n=!1,a=this;a.positionAbs=s.positionAbs,a.helperProportions=s.helperProportions,a.offset.click=s.offset.click,a._intersectsWith(a.containerCache)&&(n=!0,e.each(s.sortables,function(){return this.positionAbs=s.positionAbs,this.helperProportions=s.helperProportions,this.offset.click=s.offset.click,this!==a&&this._intersectsWith(this.containerCache)&&e.contains(a.element[0],this.element[0])&&(n=!1),n})),n?(a.isOver||(a.isOver=1,s._parent=i.helper.parent(),a.currentItem=i.helper.appendTo(a.element).data("ui-sortable-item",!0),a.options._helper=a.options.helper,a.options.helper=function(){return i.helper[0]},t.target=a.currentItem[0],a._mouseCapture(t,!0),a._mouseStart(t,!0,!0),a.offset.click.top=s.offset.click.top,a.offset.click.left=s.offset.click.left,a.offset.parent.left-=s.offset.parent.left-a.offset.parent.left,a.offset.parent.top-=s.offset.parent.top-a.offset.parent.top,s._trigger("toSortable",t),s.dropped=a.element,e.each(s.sortables,function(){this.refreshPositions()}),s.currentItem=s.element,a.fromOutside=s),a.currentItem&&(a._mouseDrag(t),i.position=a.position)):a.isOver&&(a.isOver=0,a.cancelHelperRemoval=!0,a.options._revert=a.options.revert,a.options.revert=!1,a._trigger("out",t,a._uiHash(a)),a._mouseStop(t,!0),a.options.revert=a.options._revert,a.options.helper=a.options._helper,a.placeholder&&a.placeholder.remove(),i.helper.appendTo(s._parent),s._refreshOffsets(t),i.position=s._generatePosition(t,!0),s._trigger("fromSortable",t),s.dropped=!1,e.each(s.sortables,function(){this.refreshPositions()}))})}}),e.ui.plugin.add("draggable","cursor",{start:function(t,i,s){var n=e("body"),a=s.options;n.css("cursor")&&(a._cursor=n.css("cursor")),n.css("cursor",a.cursor)},stop:function(t,i,s){var n=s.options;n._cursor&&e("body").css("cursor",n._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,i,s){var n=e(i.helper),a=s.options;n.css("opacity")&&(a._opacity=n.css("opacity")),n.css("opacity",a.opacity)},stop:function(t,i,s){var n=s.options;n._opacity&&e(i.helper).css("opacity",n._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(e,t,i){i.scrollParentNotHidden||(i.scrollParentNotHidden=i.helper.scrollParent(!1)),i.scrollParentNotHidden[0]!==i.document[0]&&"HTML"!==i.scrollParentNotHidden[0].tagName&&(i.overflowOffset=i.scrollParentNotHidden.offset())},drag:function(t,i,s){var n=s.options,a=!1,o=s.scrollParentNotHidden[0],r=s.document[0];o!==r&&"HTML"!==o.tagName?(n.axis&&"x"===n.axis||(s.overflowOffset.top+o.offsetHeight-t.pageY<n.scrollSensitivity?o.scrollTop=a=o.scrollTop+n.scrollSpeed:t.pageY-s.overflowOffset.top<n.scrollSensitivity&&(o.scrollTop=a=o.scrollTop-n.scrollSpeed)),n.axis&&"y"===n.axis||(s.overflowOffset.left+o.offsetWidth-t.pageX<n.scrollSensitivity?o.scrollLeft=a=o.scrollLeft+n.scrollSpeed:t.pageX-s.overflowOffset.left<n.scrollSensitivity&&(o.scrollLeft=a=o.scrollLeft-n.scrollSpeed))):(n.axis&&"x"===n.axis||(t.pageY-e(r).scrollTop()<n.scrollSensitivity?a=e(r).scrollTop(e(r).scrollTop()-n.scrollSpeed):e(window).height()-(t.pageY-e(r).scrollTop())<n.scrollSensitivity&&(a=e(r).scrollTop(e(r).scrollTop()+n.scrollSpeed))),n.axis&&"y"===n.axis||(t.pageX-e(r).scrollLeft()<n.scrollSensitivity?a=e(r).scrollLeft(e(r).scrollLeft()-n.scrollSpeed):e(window).width()-(t.pageX-e(r).scrollLeft())<n.scrollSensitivity&&(a=e(r).scrollLeft(e(r).scrollLeft()+n.scrollSpeed)))),a!==!1&&e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(s,t)}}),e.ui.plugin.add("draggable","snap",{start:function(t,i,s){var n=s.options;s.snapElements=[],e(n.snap.constructor!==String?n.snap.items||":data(ui-draggable)":n.snap).each(function(){var t=e(this),i=t.offset();this!==s.element[0]&&s.snapElements.push({item:this,width:t.outerWidth(),height:t.outerHeight(),top:i.top,left:i.left})})},drag:function(t,i,s){var n,a,o,r,h,l,u,d,c,p,f=s.options,m=f.snapTolerance,g=i.offset.left,v=g+s.helperProportions.width,y=i.offset.top,b=y+s.helperProportions.height;for(c=s.snapElements.length-1;c>=0;c--)h=s.snapElements[c].left-s.margins.left,l=h+s.snapElements[c].width,u=s.snapElements[c].top-s.margins.top,d=u+s.snapElements[c].height,h-m>v||g>l+m||u-m>b||y>d+m||!e.contains(s.snapElements[c].item.ownerDocument,s.snapElements[c].item)?(s.snapElements[c].snapping&&s.options.snap.release&&s.options.snap.release.call(s.element,t,e.extend(s._uiHash(),{snapItem:s.snapElements[c].item})),s.snapElements[c].snapping=!1):("inner"!==f.snapMode&&(n=m>=Math.abs(u-b),a=m>=Math.abs(d-y),o=m>=Math.abs(h-v),r=m>=Math.abs(l-g),n&&(i.position.top=s._convertPositionTo("relative",{top:u-s.helperProportions.height,left:0}).top),a&&(i.position.top=s._convertPositionTo("relative",{top:d,left:0}).top),o&&(i.position.left=s._convertPositionTo("relative",{top:0,left:h-s.helperProportions.width}).left),r&&(i.position.left=s._convertPositionTo("relative",{top:0,left:l}).left)),p=n||a||o||r,"outer"!==f.snapMode&&(n=m>=Math.abs(u-y),a=m>=Math.abs(d-b),o=m>=Math.abs(h-g),r=m>=Math.abs(l-v),n&&(i.position.top=s._convertPositionTo("relative",{top:u,left:0}).top),a&&(i.position.top=s._convertPositionTo("relative",{top:d-s.helperProportions.height,left:0}).top),o&&(i.position.left=s._convertPositionTo("relative",{top:0,left:h}).left),r&&(i.position.left=s._convertPositionTo("relative",{top:0,left:l-s.helperProportions.width}).left)),!s.snapElements[c].snapping&&(n||a||o||r||p)&&s.options.snap.snap&&s.options.snap.snap.call(s.element,t,e.extend(s._uiHash(),{snapItem:s.snapElements[c].item})),s.snapElements[c].snapping=n||a||o||r||p)}}),e.ui.plugin.add("draggable","stack",{start:function(t,i,s){var n,a=s.options,o=e.makeArray(e(a.stack)).sort(function(t,i){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(i).css("zIndex"),10)||0)});o.length&&(n=parseInt(e(o[0]).css("zIndex"),10)||0,e(o).each(function(t){e(this).css("zIndex",n+t)}),this.css("zIndex",n+o.length))}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,i,s){var n=e(i.helper),a=s.options;n.css("zIndex")&&(a._zIndex=n.css("zIndex")),n.css("zIndex",a.zIndex)},stop:function(t,i,s){var n=s.options;n._zIndex&&e(i.helper).css("zIndex",n._zIndex)}}),e.ui.draggable,e.widget("ui.droppable",{version:"1.11.4",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var t,i=this.options,s=i.accept;this.isover=!1,this.isout=!0,this.accept=e.isFunction(s)?s:function(e){return e.is(s)},this.proportions=function(){return arguments.length?(t=arguments[0],void 0):t?t:t={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}},this._addToManager(i.scope),i.addClasses&&this.element.addClass("ui-droppable")},_addToManager:function(t){e.ui.ddmanager.droppables[t]=e.ui.ddmanager.droppables[t]||[],e.ui.ddmanager.droppables[t].push(this)},_splice:function(e){for(var t=0;e.length>t;t++)e[t]===this&&e.splice(t,1)},_destroy:function(){var t=e.ui.ddmanager.droppables[this.options.scope];this._splice(t),this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(t,i){if("accept"===t)this.accept=e.isFunction(i)?i:function(e){return e.is(i)};else if("scope"===t){var s=e.ui.ddmanager.droppables[this.options.scope];this._splice(s),this._addToManager(i)}this._super(t,i)},_activate:function(t){var i=e.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),i&&this._trigger("activate",t,this.ui(i))},_deactivate:function(t){var i=e.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),i&&this._trigger("deactivate",t,this.ui(i))},_over:function(t){var i=e.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",t,this.ui(i)))},_out:function(t){var i=e.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",t,this.ui(i)))},_drop:function(t,i){var s=i||e.ui.ddmanager.current,n=!1;return s&&(s.currentItem||s.element)[0]!==this.element[0]?(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var i=e(this).droppable("instance");return i.options.greedy&&!i.options.disabled&&i.options.scope===s.options.scope&&i.accept.call(i.element[0],s.currentItem||s.element)&&e.ui.intersect(s,e.extend(i,{offset:i.element.offset()}),i.options.tolerance,t)?(n=!0,!1):void 0}),n?!1:this.accept.call(this.element[0],s.currentItem||s.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",t,this.ui(s)),this.element):!1):!1},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}}}),e.ui.intersect=function(){function e(e,t,i){return e>=t&&t+i>e}return function(t,i,s,n){if(!i.offset)return!1;var a=(t.positionAbs||t.position.absolute).left+t.margins.left,o=(t.positionAbs||t.position.absolute).top+t.margins.top,r=a+t.helperProportions.width,h=o+t.helperProportions.height,l=i.offset.left,u=i.offset.top,d=l+i.proportions().width,c=u+i.proportions().height;switch(s){case"fit":return a>=l&&d>=r&&o>=u&&c>=h;case"intersect":return a+t.helperProportions.width/2>l&&d>r-t.helperProportions.width/2&&o+t.helperProportions.height/2>u&&c>h-t.helperProportions.height/2;case"pointer":return e(n.pageY,u,i.proportions().height)&&e(n.pageX,l,i.proportions().width);case"touch":return(o>=u&&c>=o||h>=u&&c>=h||u>o&&h>c)&&(a>=l&&d>=a||r>=l&&d>=r||l>a&&r>d);default:return!1}}}(),e.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(t,i){var s,n,a=e.ui.ddmanager.droppables[t.options.scope]||[],o=i?i.type:null,r=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();e:for(s=0;a.length>s;s++)if(!(a[s].options.disabled||t&&!a[s].accept.call(a[s].element[0],t.currentItem||t.element))){for(n=0;r.length>n;n++)if(r[n]===a[s].element[0]){a[s].proportions().height=0;continue e}a[s].visible="none"!==a[s].element.css("display"),a[s].visible&&("mousedown"===o&&a[s]._activate.call(a[s],i),a[s].offset=a[s].element.offset(),a[s].proportions({width:a[s].element[0].offsetWidth,height:a[s].element[0].offsetHeight}))}},drop:function(t,i){var s=!1;return e.each((e.ui.ddmanager.droppables[t.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&e.ui.intersect(t,this,this.options.tolerance,i)&&(s=this._drop.call(this,i)||s),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,i)))}),s},dragStart:function(t,i){t.element.parentsUntil("body").bind("scroll.droppable",function(){t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,i)})},drag:function(t,i){t.options.refreshPositions&&e.ui.ddmanager.prepareOffsets(t,i),e.each(e.ui.ddmanager.droppables[t.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var s,n,a,o=e.ui.intersect(t,this,this.options.tolerance,i),r=!o&&this.isover?"isout":o&&!this.isover?"isover":null;r&&(this.options.greedy&&(n=this.options.scope,a=this.element.parents(":data(ui-droppable)").filter(function(){return e(this).droppable("instance").options.scope===n}),a.length&&(s=e(a[0]).droppable("instance"),s.greedyChild="isover"===r)),s&&"isover"===r&&(s.isover=!1,s.isout=!0,s._out.call(s,i)),this[r]=!0,this["isout"===r?"isover":"isout"]=!1,this["isover"===r?"_over":"_out"].call(this,i),s&&"isout"===r&&(s.isout=!1,s.isover=!0,s._over.call(s,i)))}})},dragStop:function(t,i){t.element.parentsUntil("body").unbind("scroll.droppable"),t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,i)}},e.ui.droppable,e.widget("ui.resizable",e.ui.mouse,{version:"1.11.4",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(e){return parseInt(e,10)||0},_isNumber:function(e){return!isNaN(parseInt(e,10))},_hasScroll:function(t,i){if("hidden"===e(t).css("overflow"))return!1;var s=i&&"left"===i?"scrollLeft":"scrollTop",n=!1;return t[s]>0?!0:(t[s]=1,n=t[s]>0,t[s]=0,n)},_create:function(){var t,i,s,n,a,o=this,r=this.options;if(this.element.addClass("ui-resizable"),e.extend(this,{_aspectRatio:!!r.aspectRatio,aspectRatio:r.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:r.helper||r.ghost||r.animate?r.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/^(canvas|textarea|input|select|button|img)$/i)&&(this.element.wrap(e("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=r.handles||(e(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this._handles=e(),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),t=this.handles.split(","),this.handles={},i=0;t.length>i;i++)s=e.trim(t[i]),a="ui-resizable-"+s,n=e("<div class='ui-resizable-handle "+a+"'></div>"),n.css({zIndex:r.zIndex}),"se"===s&&n.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[s]=".ui-resizable-"+s,this.element.append(n);this._renderAxis=function(t){var i,s,n,a;t=t||this.element;for(i in this.handles)this.handles[i].constructor===String?this.handles[i]=this.element.children(this.handles[i]).first().show():(this.handles[i].jquery||this.handles[i].nodeType)&&(this.handles[i]=e(this.handles[i]),this._on(this.handles[i],{mousedown:o._mouseDown})),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/^(textarea|input|select|button)$/i)&&(s=e(this.handles[i],this.element),a=/sw|ne|nw|se|n|s/.test(i)?s.outerHeight():s.outerWidth(),n=["padding",/ne|nw|n/.test(i)?"Top":/se|sw|s/.test(i)?"Bottom":/^e$/.test(i)?"Right":"Left"].join(""),t.css(n,a),this._proportionallyResize()),this._handles=this._handles.add(this.handles[i])},this._renderAxis(this.element),this._handles=this._handles.add(this.element.find(".ui-resizable-handle")),this._handles.disableSelection(),this._handles.mouseover(function(){o.resizing||(this.className&&(n=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),o.axis=n&&n[1]?n[1]:"se")}),r.autoHide&&(this._handles.hide(),e(this.element).addClass("ui-resizable-autohide").mouseenter(function(){r.disabled||(e(this).removeClass("ui-resizable-autohide"),o._handles.show())}).mouseleave(function(){r.disabled||o.resizing||(e(this).addClass("ui-resizable-autohide"),o._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var t,i=function(t){e(t).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(i(this.element),t=this.element,this.originalElement.css({position:t.css("position"),width:t.outerWidth(),height:t.outerHeight(),top:t.css("top"),left:t.css("left")}).insertAfter(t),t.remove()),this.originalElement.css("resize",this.originalResizeStyle),i(this.originalElement),this},_mouseCapture:function(t){var i,s,n=!1;for(i in this.handles)s=e(this.handles[i])[0],(s===t.target||e.contains(s,t.target))&&(n=!0);return!this.options.disabled&&n},_mouseStart:function(t){var i,s,n,a=this.options,o=this.element;return this.resizing=!0,this._renderProxy(),i=this._num(this.helper.css("left")),s=this._num(this.helper.css("top")),a.containment&&(i+=e(a.containment).scrollLeft()||0,s+=e(a.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:i,top:s},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:o.width(),height:o.height()},this.originalSize=this._helper?{width:o.outerWidth(),height:o.outerHeight()}:{width:o.width(),height:o.height()},this.sizeDiff={width:o.outerWidth()-o.width(),height:o.outerHeight()-o.height()},this.originalPosition={left:i,top:s},this.originalMousePosition={left:t.pageX,top:t.pageY},this.aspectRatio="number"==typeof a.aspectRatio?a.aspectRatio:this.originalSize.width/this.originalSize.height||1,n=e(".ui-resizable-"+this.axis).css("cursor"),e("body").css("cursor","auto"===n?this.axis+"-resize":n),o.addClass("ui-resizable-resizing"),this._propagate("start",t),!0},_mouseDrag:function(t){var i,s,n=this.originalMousePosition,a=this.axis,o=t.pageX-n.left||0,r=t.pageY-n.top||0,h=this._change[a];return this._updatePrevProperties(),h?(i=h.apply(this,[t,o,r]),this._updateVirtualBoundaries(t.shiftKey),(this._aspectRatio||t.shiftKey)&&(i=this._updateRatio(i,t)),i=this._respectSize(i,t),this._updateCache(i),this._propagate("resize",t),s=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),e.isEmptyObject(s)||(this._updatePrevProperties(),this._trigger("resize",t,this.ui()),this._applyChanges()),!1):!1},_mouseStop:function(t){this.resizing=!1;var i,s,n,a,o,r,h,l=this.options,u=this;return this._helper&&(i=this._proportionallyResizeElements,s=i.length&&/textarea/i.test(i[0].nodeName),n=s&&this._hasScroll(i[0],"left")?0:u.sizeDiff.height,a=s?0:u.sizeDiff.width,o={width:u.helper.width()-a,height:u.helper.height()-n},r=parseInt(u.element.css("left"),10)+(u.position.left-u.originalPosition.left)||null,h=parseInt(u.element.css("top"),10)+(u.position.top-u.originalPosition.top)||null,l.animate||this.element.css(e.extend(o,{top:h,left:r})),u.helper.height(u.size.height),u.helper.width(u.size.width),this._helper&&!l.animate&&this._proportionallyResize()),e("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",t),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var e={};return this.position.top!==this.prevPosition.top&&(e.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(e.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(e.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(e.height=this.size.height+"px"),this.helper.css(e),e},_updateVirtualBoundaries:function(e){var t,i,s,n,a,o=this.options;a={minWidth:this._isNumber(o.minWidth)?o.minWidth:0,maxWidth:this._isNumber(o.maxWidth)?o.maxWidth:1/0,minHeight:this._isNumber(o.minHeight)?o.minHeight:0,maxHeight:this._isNumber(o.maxHeight)?o.maxHeight:1/0},(this._aspectRatio||e)&&(t=a.minHeight*this.aspectRatio,s=a.minWidth/this.aspectRatio,i=a.maxHeight*this.aspectRatio,n=a.maxWidth/this.aspectRatio,t>a.minWidth&&(a.minWidth=t),s>a.minHeight&&(a.minHeight=s),a.maxWidth>i&&(a.maxWidth=i),a.maxHeight>n&&(a.maxHeight=n)),this._vBoundaries=a},_updateCache:function(e){this.offset=this.helper.offset(),this._isNumber(e.left)&&(this.position.left=e.left),this._isNumber(e.top)&&(this.position.top=e.top),this._isNumber(e.height)&&(this.size.height=e.height),this._isNumber(e.width)&&(this.size.width=e.width)},_updateRatio:function(e){var t=this.position,i=this.size,s=this.axis;return this._isNumber(e.height)?e.width=e.height*this.aspectRatio:this._isNumber(e.width)&&(e.height=e.width/this.aspectRatio),"sw"===s&&(e.left=t.left+(i.width-e.width),e.top=null),"nw"===s&&(e.top=t.top+(i.height-e.height),e.left=t.left+(i.width-e.width)),e},_respectSize:function(e){var t=this._vBoundaries,i=this.axis,s=this._isNumber(e.width)&&t.maxWidth&&t.maxWidth<e.width,n=this._isNumber(e.height)&&t.maxHeight&&t.maxHeight<e.height,a=this._isNumber(e.width)&&t.minWidth&&t.minWidth>e.width,o=this._isNumber(e.height)&&t.minHeight&&t.minHeight>e.height,r=this.originalPosition.left+this.originalSize.width,h=this.position.top+this.size.height,l=/sw|nw|w/.test(i),u=/nw|ne|n/.test(i);return a&&(e.width=t.minWidth),o&&(e.height=t.minHeight),s&&(e.width=t.maxWidth),n&&(e.height=t.maxHeight),a&&l&&(e.left=r-t.minWidth),s&&l&&(e.left=r-t.maxWidth),o&&u&&(e.top=h-t.minHeight),n&&u&&(e.top=h-t.maxHeight),e.width||e.height||e.left||!e.top?e.width||e.height||e.top||!e.left||(e.left=null):e.top=null,e},_getPaddingPlusBorderDimensions:function(e){for(var t=0,i=[],s=[e.css("borderTopWidth"),e.css("borderRightWidth"),e.css("borderBottomWidth"),e.css("borderLeftWidth")],n=[e.css("paddingTop"),e.css("paddingRight"),e.css("paddingBottom"),e.css("paddingLeft")];4>t;t++)i[t]=parseInt(s[t],10)||0,i[t]+=parseInt(n[t],10)||0;return{height:i[0]+i[2],width:i[1]+i[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var e,t=0,i=this.helper||this.element;this._proportionallyResizeElements.length>t;t++)e=this._proportionallyResizeElements[t],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(e)),e.css({height:i.height()-this.outerDimensions.height||0,width:i.width()-this.outerDimensions.width||0})},_renderProxy:function(){var t=this.element,i=this.options;this.elementOffset=t.offset(),this._helper?(this.helper=this.helper||e("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++i.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(e,t){return{width:this.originalSize.width+t}},w:function(e,t){var i=this.originalSize,s=this.originalPosition;return{left:s.left+t,width:i.width-t}},n:function(e,t,i){var s=this.originalSize,n=this.originalPosition;return{top:n.top+i,height:s.height-i}},s:function(e,t,i){return{height:this.originalSize.height+i}},se:function(t,i,s){return e.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[t,i,s]))},sw:function(t,i,s){return e.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[t,i,s]))},ne:function(t,i,s){return e.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[t,i,s]))},nw:function(t,i,s){return e.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[t,i,s]))}},_propagate:function(t,i){e.ui.plugin.call(this,t,[i,this.ui()]),"resize"!==t&&this._trigger(t,i,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),e.ui.plugin.add("resizable","animate",{stop:function(t){var i=e(this).resizable("instance"),s=i.options,n=i._proportionallyResizeElements,a=n.length&&/textarea/i.test(n[0].nodeName),o=a&&i._hasScroll(n[0],"left")?0:i.sizeDiff.height,r=a?0:i.sizeDiff.width,h={width:i.size.width-r,height:i.size.height-o},l=parseInt(i.element.css("left"),10)+(i.position.left-i.originalPosition.left)||null,u=parseInt(i.element.css("top"),10)+(i.position.top-i.originalPosition.top)||null;i.element.animate(e.extend(h,u&&l?{top:u,left:l}:{}),{duration:s.animateDuration,easing:s.animateEasing,step:function(){var s={width:parseInt(i.element.css("width"),10),height:parseInt(i.element.css("height"),10),top:parseInt(i.element.css("top"),10),left:parseInt(i.element.css("left"),10)};n&&n.length&&e(n[0]).css({width:s.width,height:s.height}),i._updateCache(s),i._propagate("resize",t)}})}}),e.ui.plugin.add("resizable","containment",{start:function(){var t,i,s,n,a,o,r,h=e(this).resizable("instance"),l=h.options,u=h.element,d=l.containment,c=d instanceof e?d.get(0):/parent/.test(d)?u.parent().get(0):d;c&&(h.containerElement=e(c),/document/.test(d)||d===document?(h.containerOffset={left:0,top:0},h.containerPosition={left:0,top:0},h.parentData={element:e(document),left:0,top:0,width:e(document).width(),height:e(document).height()||document.body.parentNode.scrollHeight}):(t=e(c),i=[],e(["Top","Right","Left","Bottom"]).each(function(e,s){i[e]=h._num(t.css("padding"+s))}),h.containerOffset=t.offset(),h.containerPosition=t.position(),h.containerSize={height:t.innerHeight()-i[3],width:t.innerWidth()-i[1]},s=h.containerOffset,n=h.containerSize.height,a=h.containerSize.width,o=h._hasScroll(c,"left")?c.scrollWidth:a,r=h._hasScroll(c)?c.scrollHeight:n,h.parentData={element:c,left:s.left,top:s.top,width:o,height:r}))},resize:function(t){var i,s,n,a,o=e(this).resizable("instance"),r=o.options,h=o.containerOffset,l=o.position,u=o._aspectRatio||t.shiftKey,d={top:0,left:0},c=o.containerElement,p=!0;c[0]!==document&&/static/.test(c.css("position"))&&(d=h),l.left<(o._helper?h.left:0)&&(o.size.width=o.size.width+(o._helper?o.position.left-h.left:o.position.left-d.left),u&&(o.size.height=o.size.width/o.aspectRatio,p=!1),o.position.left=r.helper?h.left:0),l.top<(o._helper?h.top:0)&&(o.size.height=o.size.height+(o._helper?o.position.top-h.top:o.position.top),u&&(o.size.width=o.size.height*o.aspectRatio,p=!1),o.position.top=o._helper?h.top:0),n=o.containerElement.get(0)===o.element.parent().get(0),a=/relative|absolute/.test(o.containerElement.css("position")),n&&a?(o.offset.left=o.parentData.left+o.position.left,o.offset.top=o.parentData.top+o.position.top):(o.offset.left=o.element.offset().left,o.offset.top=o.element.offset().top),i=Math.abs(o.sizeDiff.width+(o._helper?o.offset.left-d.left:o.offset.left-h.left)),s=Math.abs(o.sizeDiff.height+(o._helper?o.offset.top-d.top:o.offset.top-h.top)),i+o.size.width>=o.parentData.width&&(o.size.width=o.parentData.width-i,u&&(o.size.height=o.size.width/o.aspectRatio,p=!1)),s+o.size.height>=o.parentData.height&&(o.size.height=o.parentData.height-s,u&&(o.size.width=o.size.height*o.aspectRatio,p=!1)),p||(o.position.left=o.prevPosition.left,o.position.top=o.prevPosition.top,o.size.width=o.prevSize.width,o.size.height=o.prevSize.height)},stop:function(){var t=e(this).resizable("instance"),i=t.options,s=t.containerOffset,n=t.containerPosition,a=t.containerElement,o=e(t.helper),r=o.offset(),h=o.outerWidth()-t.sizeDiff.width,l=o.outerHeight()-t.sizeDiff.height;t._helper&&!i.animate&&/relative/.test(a.css("position"))&&e(this).css({left:r.left-n.left-s.left,width:h,height:l}),t._helper&&!i.animate&&/static/.test(a.css("position"))&&e(this).css({left:r.left-n.left-s.left,width:h,height:l})}}),e.ui.plugin.add("resizable","alsoResize",{start:function(){var t=e(this).resizable("instance"),i=t.options;e(i.alsoResize).each(function(){var t=e(this);t.data("ui-resizable-alsoresize",{width:parseInt(t.width(),10),height:parseInt(t.height(),10),left:parseInt(t.css("left"),10),top:parseInt(t.css("top"),10)})})},resize:function(t,i){var s=e(this).resizable("instance"),n=s.options,a=s.originalSize,o=s.originalPosition,r={height:s.size.height-a.height||0,width:s.size.width-a.width||0,top:s.position.top-o.top||0,left:s.position.left-o.left||0};e(n.alsoResize).each(function(){var t=e(this),s=e(this).data("ui-resizable-alsoresize"),n={},a=t.parents(i.originalElement[0]).length?["width","height"]:["width","height","top","left"];e.each(a,function(e,t){var i=(s[t]||0)+(r[t]||0);i&&i>=0&&(n[t]=i||null)}),t.css(n)})},stop:function(){e(this).removeData("resizable-alsoresize")}}),e.ui.plugin.add("resizable","ghost",{start:function(){var t=e(this).resizable("instance"),i=t.options,s=t.size;t.ghost=t.originalElement.clone(),t.ghost.css({opacity:.25,display:"block",position:"relative",height:s.height,width:s.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof i.ghost?i.ghost:""),t.ghost.appendTo(t.helper)},resize:function(){var t=e(this).resizable("instance");t.ghost&&t.ghost.css({position:"relative",height:t.size.height,width:t.size.width})},stop:function(){var t=e(this).resizable("instance");t.ghost&&t.helper&&t.helper.get(0).removeChild(t.ghost.get(0))}}),e.ui.plugin.add("resizable","grid",{resize:function(){var t,i=e(this).resizable("instance"),s=i.options,n=i.size,a=i.originalSize,o=i.originalPosition,r=i.axis,h="number"==typeof s.grid?[s.grid,s.grid]:s.grid,l=h[0]||1,u=h[1]||1,d=Math.round((n.width-a.width)/l)*l,c=Math.round((n.height-a.height)/u)*u,p=a.width+d,f=a.height+c,m=s.maxWidth&&p>s.maxWidth,g=s.maxHeight&&f>s.maxHeight,v=s.minWidth&&s.minWidth>p,y=s.minHeight&&s.minHeight>f;s.grid=h,v&&(p+=l),y&&(f+=u),m&&(p-=l),g&&(f-=u),/^(se|s|e)$/.test(r)?(i.size.width=p,i.size.height=f):/^(ne)$/.test(r)?(i.size.width=p,i.size.height=f,i.position.top=o.top-c):/^(sw)$/.test(r)?(i.size.width=p,i.size.height=f,i.position.left=o.left-d):((0>=f-u||0>=p-l)&&(t=i._getPaddingPlusBorderDimensions(this)),f-u>0?(i.size.height=f,i.position.top=o.top-c):(f=u-t.height,i.size.height=f,i.position.top=o.top+a.height-f),p-l>0?(i.size.width=p,i.position.left=o.left-d):(p=l-t.width,i.size.width=p,i.position.left=o.left+a.width-p))}}),e.ui.resizable,e.widget("ui.selectable",e.ui.mouse,{version:"1.11.4",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var t,i=this;
this.element.addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){t=e(i.options.filter,i.element[0]),t.addClass("ui-selectee"),t.each(function(){var t=e(this),i=t.offset();e.data(this,"selectable-item",{element:this,$element:t,left:i.left,top:i.top,right:i.left+t.outerWidth(),bottom:i.top+t.outerHeight(),startselected:!1,selected:t.hasClass("ui-selected"),selecting:t.hasClass("ui-selecting"),unselecting:t.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=t.addClass("ui-selectee"),this._mouseInit(),this.helper=e("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(t){var i=this,s=this.options;this.opos=[t.pageX,t.pageY],this.options.disabled||(this.selectees=e(s.filter,this.element[0]),this._trigger("start",t),e(s.appendTo).append(this.helper),this.helper.css({left:t.pageX,top:t.pageY,width:0,height:0}),s.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var s=e.data(this,"selectable-item");s.startselected=!0,t.metaKey||t.ctrlKey||(s.$element.removeClass("ui-selected"),s.selected=!1,s.$element.addClass("ui-unselecting"),s.unselecting=!0,i._trigger("unselecting",t,{unselecting:s.element}))}),e(t.target).parents().addBack().each(function(){var s,n=e.data(this,"selectable-item");return n?(s=!t.metaKey&&!t.ctrlKey||!n.$element.hasClass("ui-selected"),n.$element.removeClass(s?"ui-unselecting":"ui-selected").addClass(s?"ui-selecting":"ui-unselecting"),n.unselecting=!s,n.selecting=s,n.selected=s,s?i._trigger("selecting",t,{selecting:n.element}):i._trigger("unselecting",t,{unselecting:n.element}),!1):void 0}))},_mouseDrag:function(t){if(this.dragged=!0,!this.options.disabled){var i,s=this,n=this.options,a=this.opos[0],o=this.opos[1],r=t.pageX,h=t.pageY;return a>r&&(i=r,r=a,a=i),o>h&&(i=h,h=o,o=i),this.helper.css({left:a,top:o,width:r-a,height:h-o}),this.selectees.each(function(){var i=e.data(this,"selectable-item"),l=!1;i&&i.element!==s.element[0]&&("touch"===n.tolerance?l=!(i.left>r||a>i.right||i.top>h||o>i.bottom):"fit"===n.tolerance&&(l=i.left>a&&r>i.right&&i.top>o&&h>i.bottom),l?(i.selected&&(i.$element.removeClass("ui-selected"),i.selected=!1),i.unselecting&&(i.$element.removeClass("ui-unselecting"),i.unselecting=!1),i.selecting||(i.$element.addClass("ui-selecting"),i.selecting=!0,s._trigger("selecting",t,{selecting:i.element}))):(i.selecting&&((t.metaKey||t.ctrlKey)&&i.startselected?(i.$element.removeClass("ui-selecting"),i.selecting=!1,i.$element.addClass("ui-selected"),i.selected=!0):(i.$element.removeClass("ui-selecting"),i.selecting=!1,i.startselected&&(i.$element.addClass("ui-unselecting"),i.unselecting=!0),s._trigger("unselecting",t,{unselecting:i.element}))),i.selected&&(t.metaKey||t.ctrlKey||i.startselected||(i.$element.removeClass("ui-selected"),i.selected=!1,i.$element.addClass("ui-unselecting"),i.unselecting=!0,s._trigger("unselecting",t,{unselecting:i.element})))))}),!1}},_mouseStop:function(t){var i=this;return this.dragged=!1,e(".ui-unselecting",this.element[0]).each(function(){var s=e.data(this,"selectable-item");s.$element.removeClass("ui-unselecting"),s.unselecting=!1,s.startselected=!1,i._trigger("unselected",t,{unselected:s.element})}),e(".ui-selecting",this.element[0]).each(function(){var s=e.data(this,"selectable-item");s.$element.removeClass("ui-selecting").addClass("ui-selected"),s.selecting=!1,s.selected=!0,s.startselected=!0,i._trigger("selected",t,{selected:s.element})}),this._trigger("stop",t),this.helper.remove(),!1}}),e.widget("ui.sortable",e.ui.mouse,{version:"1.11.4",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(e,t,i){return e>=t&&t+i>e},_isFloating:function(e){return/left|right/.test(e.css("float"))||/inline|table-cell/.test(e.css("display"))},_create:function(){this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(e,t){this._super(e,t),"handle"===e&&this._setHandleClassName()},_setHandleClassName:function(){this.element.find(".ui-sortable-handle").removeClass("ui-sortable-handle"),e.each(this.items,function(){(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item).addClass("ui-sortable-handle")})},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").find(".ui-sortable-handle").removeClass("ui-sortable-handle"),this._mouseDestroy();for(var e=this.items.length-1;e>=0;e--)this.items[e].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(t,i){var s=null,n=!1,a=this;return this.reverting?!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(t),e(t.target).parents().each(function(){return e.data(this,a.widgetName+"-item")===a?(s=e(this),!1):void 0}),e.data(t.target,a.widgetName+"-item")===a&&(s=e(t.target)),s?!this.options.handle||i||(e(this.options.handle,s).find("*").addBack().each(function(){this===t.target&&(n=!0)}),n)?(this.currentItem=s,this._removeCurrentsFromItems(),!0):!1:!1)},_mouseStart:function(t,i,s){var n,a,o=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),o.containment&&this._setContainment(),o.cursor&&"auto"!==o.cursor&&(a=this.document.find("body"),this.storedCursor=a.css("cursor"),a.css("cursor",o.cursor),this.storedStylesheet=e("<style>*{ cursor: "+o.cursor+" !important; }</style>").appendTo(a)),o.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",o.opacity)),o.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",o.zIndex)),this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!s)for(n=this.containers.length-1;n>=0;n--)this.containers[n]._trigger("activate",t,this._uiHash(this));return e.ui.ddmanager&&(e.ui.ddmanager.current=this),e.ui.ddmanager&&!o.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(t),!0},_mouseDrag:function(t){var i,s,n,a,o=this.options,r=!1;for(this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-t.pageY<o.scrollSensitivity?this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop+o.scrollSpeed:t.pageY-this.overflowOffset.top<o.scrollSensitivity&&(this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop-o.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<o.scrollSensitivity?this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft+o.scrollSpeed:t.pageX-this.overflowOffset.left<o.scrollSensitivity&&(this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft-o.scrollSpeed)):(t.pageY-this.document.scrollTop()<o.scrollSensitivity?r=this.document.scrollTop(this.document.scrollTop()-o.scrollSpeed):this.window.height()-(t.pageY-this.document.scrollTop())<o.scrollSensitivity&&(r=this.document.scrollTop(this.document.scrollTop()+o.scrollSpeed)),t.pageX-this.document.scrollLeft()<o.scrollSensitivity?r=this.document.scrollLeft(this.document.scrollLeft()-o.scrollSpeed):this.window.width()-(t.pageX-this.document.scrollLeft())<o.scrollSensitivity&&(r=this.document.scrollLeft(this.document.scrollLeft()+o.scrollSpeed))),r!==!1&&e.ui.ddmanager&&!o.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),i=this.items.length-1;i>=0;i--)if(s=this.items[i],n=s.item[0],a=this._intersectsWithPointer(s),a&&s.instance===this.currentContainer&&n!==this.currentItem[0]&&this.placeholder[1===a?"next":"prev"]()[0]!==n&&!e.contains(this.placeholder[0],n)&&("semi-dynamic"===this.options.type?!e.contains(this.element[0],n):!0)){if(this.direction=1===a?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(s))break;this._rearrange(t,s),this._trigger("change",t,this._uiHash());break}return this._contactContainers(t),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),this._trigger("sort",t,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(t,i){if(t){if(e.ui.ddmanager&&!this.options.dropBehaviour&&e.ui.ddmanager.drop(this,t),this.options.revert){var s=this,n=this.placeholder.offset(),a=this.options.axis,o={};a&&"x"!==a||(o.left=n.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollLeft)),a&&"y"!==a||(o.top=n.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,e(this.helper).animate(o,parseInt(this.options.revert,10)||500,function(){s._clear(t)})}else this._clear(t,i);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var t=this.containers.length-1;t>=0;t--)this.containers[t]._trigger("deactivate",null,this._uiHash(this)),this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",null,this._uiHash(this)),this.containers[t].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),e.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?e(this.domPosition.prev).after(this.currentItem):e(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(t){var i=this._getItemsAsjQuery(t&&t.connected),s=[];return t=t||{},e(i).each(function(){var i=(e(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[\-=_](.+)/);i&&s.push((t.key||i[1]+"[]")+"="+(t.key&&t.expression?i[1]:i[2]))}),!s.length&&t.key&&s.push(t.key+"="),s.join("&")},toArray:function(t){var i=this._getItemsAsjQuery(t&&t.connected),s=[];return t=t||{},i.each(function(){s.push(e(t.item||this).attr(t.attribute||"id")||"")}),s},_intersectsWith:function(e){var t=this.positionAbs.left,i=t+this.helperProportions.width,s=this.positionAbs.top,n=s+this.helperProportions.height,a=e.left,o=a+e.width,r=e.top,h=r+e.height,l=this.offset.click.top,u=this.offset.click.left,d="x"===this.options.axis||s+l>r&&h>s+l,c="y"===this.options.axis||t+u>a&&o>t+u,p=d&&c;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"]?p:t+this.helperProportions.width/2>a&&o>i-this.helperProportions.width/2&&s+this.helperProportions.height/2>r&&h>n-this.helperProportions.height/2},_intersectsWithPointer:function(e){var t="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top,e.height),i="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left,e.width),s=t&&i,n=this._getDragVerticalDirection(),a=this._getDragHorizontalDirection();return s?this.floating?a&&"right"===a||"down"===n?2:1:n&&("down"===n?2:1):!1},_intersectsWithSides:function(e){var t=this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top+e.height/2,e.height),i=this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left+e.width/2,e.width),s=this._getDragVerticalDirection(),n=this._getDragHorizontalDirection();return this.floating&&n?"right"===n&&i||"left"===n&&!i:s&&("down"===s&&t||"up"===s&&!t)},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return 0!==e&&(e>0?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return 0!==e&&(e>0?"right":"left")},refresh:function(e){return this._refreshItems(e),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var e=this.options;return e.connectWith.constructor===String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(t){function i(){r.push(this)}var s,n,a,o,r=[],h=[],l=this._connectWith();if(l&&t)for(s=l.length-1;s>=0;s--)for(a=e(l[s],this.document[0]),n=a.length-1;n>=0;n--)o=e.data(a[n],this.widgetFullName),o&&o!==this&&!o.options.disabled&&h.push([e.isFunction(o.options.items)?o.options.items.call(o.element):e(o.options.items,o.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),o]);for(h.push([e.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):e(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),s=h.length-1;s>=0;s--)h[s][0].each(i);return e(r)},_removeCurrentsFromItems:function(){var t=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=e.grep(this.items,function(e){for(var i=0;t.length>i;i++)if(t[i]===e.item[0])return!1;return!0})},_refreshItems:function(t){this.items=[],this.containers=[this];var i,s,n,a,o,r,h,l,u=this.items,d=[[e.isFunction(this.options.items)?this.options.items.call(this.element[0],t,{item:this.currentItem}):e(this.options.items,this.element),this]],c=this._connectWith();if(c&&this.ready)for(i=c.length-1;i>=0;i--)for(n=e(c[i],this.document[0]),s=n.length-1;s>=0;s--)a=e.data(n[s],this.widgetFullName),a&&a!==this&&!a.options.disabled&&(d.push([e.isFunction(a.options.items)?a.options.items.call(a.element[0],t,{item:this.currentItem}):e(a.options.items,a.element),a]),this.containers.push(a));for(i=d.length-1;i>=0;i--)for(o=d[i][1],r=d[i][0],s=0,l=r.length;l>s;s++)h=e(r[s]),h.data(this.widgetName+"-item",o),u.push({item:h,instance:o,width:0,height:0,left:0,top:0})},refreshPositions:function(t){this.floating=this.items.length?"x"===this.options.axis||this._isFloating(this.items[0].item):!1,this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var i,s,n,a;for(i=this.items.length-1;i>=0;i--)s=this.items[i],s.instance!==this.currentContainer&&this.currentContainer&&s.item[0]!==this.currentItem[0]||(n=this.options.toleranceElement?e(this.options.toleranceElement,s.item):s.item,t||(s.width=n.outerWidth(),s.height=n.outerHeight()),a=n.offset(),s.left=a.left,s.top=a.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(i=this.containers.length-1;i>=0;i--)a=this.containers[i].element.offset(),this.containers[i].containerCache.left=a.left,this.containers[i].containerCache.top=a.top,this.containers[i].containerCache.width=this.containers[i].element.outerWidth(),this.containers[i].containerCache.height=this.containers[i].element.outerHeight();return this},_createPlaceholder:function(t){t=t||this;var i,s=t.options;s.placeholder&&s.placeholder.constructor!==String||(i=s.placeholder,s.placeholder={element:function(){var s=t.currentItem[0].nodeName.toLowerCase(),n=e("<"+s+">",t.document[0]).addClass(i||t.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tbody"===s?t._createTrPlaceholder(t.currentItem.find("tr").eq(0),e("<tr>",t.document[0]).appendTo(n)):"tr"===s?t._createTrPlaceholder(t.currentItem,n):"img"===s&&n.attr("src",t.currentItem.attr("src")),i||n.css("visibility","hidden"),n},update:function(e,n){(!i||s.forcePlaceholderSize)&&(n.height()||n.height(t.currentItem.innerHeight()-parseInt(t.currentItem.css("paddingTop")||0,10)-parseInt(t.currentItem.css("paddingBottom")||0,10)),n.width()||n.width(t.currentItem.innerWidth()-parseInt(t.currentItem.css("paddingLeft")||0,10)-parseInt(t.currentItem.css("paddingRight")||0,10)))}}),t.placeholder=e(s.placeholder.element.call(t.element,t.currentItem)),t.currentItem.after(t.placeholder),s.placeholder.update(t,t.placeholder)},_createTrPlaceholder:function(t,i){var s=this;t.children().each(function(){e("<td>&#160;</td>",s.document[0]).attr("colspan",e(this).attr("colspan")||1).appendTo(i)})},_contactContainers:function(t){var i,s,n,a,o,r,h,l,u,d,c=null,p=null;for(i=this.containers.length-1;i>=0;i--)if(!e.contains(this.currentItem[0],this.containers[i].element[0]))if(this._intersectsWith(this.containers[i].containerCache)){if(c&&e.contains(this.containers[i].element[0],c.element[0]))continue;c=this.containers[i],p=i}else this.containers[i].containerCache.over&&(this.containers[i]._trigger("out",t,this._uiHash(this)),this.containers[i].containerCache.over=0);if(c)if(1===this.containers.length)this.containers[p].containerCache.over||(this.containers[p]._trigger("over",t,this._uiHash(this)),this.containers[p].containerCache.over=1);else{for(n=1e4,a=null,u=c.floating||this._isFloating(this.currentItem),o=u?"left":"top",r=u?"width":"height",d=u?"clientX":"clientY",s=this.items.length-1;s>=0;s--)e.contains(this.containers[p].element[0],this.items[s].item[0])&&this.items[s].item[0]!==this.currentItem[0]&&(h=this.items[s].item.offset()[o],l=!1,t[d]-h>this.items[s][r]/2&&(l=!0),n>Math.abs(t[d]-h)&&(n=Math.abs(t[d]-h),a=this.items[s],this.direction=l?"up":"down"));if(!a&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[p])return this.currentContainer.containerCache.over||(this.containers[p]._trigger("over",t,this._uiHash()),this.currentContainer.containerCache.over=1),void 0;a?this._rearrange(t,a,null,!0):this._rearrange(t,null,this.containers[p].element,!0),this._trigger("change",t,this._uiHash()),this.containers[p]._trigger("change",t,this._uiHash(this)),this.currentContainer=this.containers[p],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[p]._trigger("over",t,this._uiHash(this)),this.containers[p].containerCache.over=1}},_createHelper:function(t){var i=this.options,s=e.isFunction(i.helper)?e(i.helper.apply(this.element[0],[t,this.currentItem])):"clone"===i.helper?this.currentItem.clone():this.currentItem;return s.parents("body").length||e("parent"!==i.appendTo?i.appendTo:this.currentItem[0].parentNode)[0].appendChild(s[0]),s[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!s[0].style.width||i.forceHelperSize)&&s.width(this.currentItem.width()),(!s[0].style.height||i.forceHelperSize)&&s.height(this.currentItem.height()),s},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==this.document[0]&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===this.document[0].body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&e.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,i,s,n=this.options;"parent"===n.containment&&(n.containment=this.helper[0].parentNode),("document"===n.containment||"window"===n.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,"document"===n.containment?this.document.width():this.window.width()-this.helperProportions.width-this.margins.left,("document"===n.containment?this.document.width():this.window.height()||this.document[0].body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(n.containment)||(t=e(n.containment)[0],i=e(n.containment).offset(),s="hidden"!==e(t).css("overflow"),this.containment=[i.left+(parseInt(e(t).css("borderLeftWidth"),10)||0)+(parseInt(e(t).css("paddingLeft"),10)||0)-this.margins.left,i.top+(parseInt(e(t).css("borderTopWidth"),10)||0)+(parseInt(e(t).css("paddingTop"),10)||0)-this.margins.top,i.left+(s?Math.max(t.scrollWidth,t.offsetWidth):t.offsetWidth)-(parseInt(e(t).css("borderLeftWidth"),10)||0)-(parseInt(e(t).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,i.top+(s?Math.max(t.scrollHeight,t.offsetHeight):t.offsetHeight)-(parseInt(e(t).css("borderTopWidth"),10)||0)-(parseInt(e(t).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(t,i){i||(i=this.position);var s="absolute"===t?1:-1,n="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,a=/(html|body)/i.test(n[0].tagName);return{top:i.top+this.offset.relative.top*s+this.offset.parent.top*s-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():a?0:n.scrollTop())*s,left:i.left+this.offset.relative.left*s+this.offset.parent.left*s-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():a?0:n.scrollLeft())*s}},_generatePosition:function(t){var i,s,n=this.options,a=t.pageX,o=t.pageY,r="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,h=/(html|body)/i.test(r[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(a=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(o=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(a=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3]&&(o=this.containment[3]+this.offset.click.top)),n.grid&&(i=this.originalPageY+Math.round((o-this.originalPageY)/n.grid[1])*n.grid[1],o=this.containment?i-this.offset.click.top>=this.containment[1]&&i-this.offset.click.top<=this.containment[3]?i:i-this.offset.click.top>=this.containment[1]?i-n.grid[1]:i+n.grid[1]:i,s=this.originalPageX+Math.round((a-this.originalPageX)/n.grid[0])*n.grid[0],a=this.containment?s-this.offset.click.left>=this.containment[0]&&s-this.offset.click.left<=this.containment[2]?s:s-this.offset.click.left>=this.containment[0]?s-n.grid[0]:s+n.grid[0]:s)),{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():h?0:r.scrollTop()),left:a-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():h?0:r.scrollLeft())}},_rearrange:function(e,t,i,s){i?i[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?t.item[0]:t.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var n=this.counter;this._delay(function(){n===this.counter&&this.refreshPositions(!s)})},_clear:function(e,t){function i(e,t,i){return function(s){i._trigger(e,s,t._uiHash(t))}}this.reverting=!1;var s,n=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(s in this._storedCSS)("auto"===this._storedCSS[s]||"static"===this._storedCSS[s])&&(this._storedCSS[s]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!t&&n.push(function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||t||n.push(function(e){this._trigger("update",e,this._uiHash())}),this!==this.currentContainer&&(t||(n.push(function(e){this._trigger("remove",e,this._uiHash())}),n.push(function(e){return function(t){e._trigger("receive",t,this._uiHash(this))}}.call(this,this.currentContainer)),n.push(function(e){return function(t){e._trigger("update",t,this._uiHash(this))}}.call(this,this.currentContainer)))),s=this.containers.length-1;s>=0;s--)t||n.push(i("deactivate",this,this.containers[s])),this.containers[s].containerCache.over&&(n.push(i("out",this,this.containers[s])),this.containers[s].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,t||this._trigger("beforeStop",e,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!t){for(s=0;n.length>s;s++)n[s].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){e.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(t){var i=t||this;return{helper:i.helper,placeholder:i.placeholder||e([]),position:i.position,originalPosition:i.originalPosition,offset:i.positionAbs,item:i.currentItem,sender:t?t.element:null}}}),e.widget("ui.accordion",{version:"1.11.4",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},hideProps:{borderTopWidth:"hide",borderBottomWidth:"hide",paddingTop:"hide",paddingBottom:"hide",height:"hide"},showProps:{borderTopWidth:"show",borderBottomWidth:"show",paddingTop:"show",paddingBottom:"show",height:"show"},_create:function(){var t=this.options;this.prevShow=this.prevHide=e(),this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role","tablist"),t.collapsible||t.active!==!1&&null!=t.active||(t.active=0),this._processPanels(),0>t.active&&(t.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():e()}},_createIcons:function(){var t=this.options.icons;t&&(e("<span>").addClass("ui-accordion-header-icon ui-icon "+t.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(t.header).addClass(t.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var e;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").removeUniqueId(),this._destroyIcons(),e=this.headers.next().removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").css("display","").removeAttr("role").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeUniqueId(),"content"!==this.options.heightStyle&&e.css("height","")},_setOption:function(e,t){return"active"===e?(this._activate(t),void 0):("event"===e&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(t)),this._super(e,t),"collapsible"!==e||t||this.options.active!==!1||this._activate(0),"icons"===e&&(this._destroyIcons(),t&&this._createIcons()),"disabled"===e&&(this.element.toggleClass("ui-state-disabled",!!t).attr("aria-disabled",t),this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!t)),void 0)},_keydown:function(t){if(!t.altKey&&!t.ctrlKey){var i=e.ui.keyCode,s=this.headers.length,n=this.headers.index(t.target),a=!1;switch(t.keyCode){case i.RIGHT:case i.DOWN:a=this.headers[(n+1)%s];break;case i.LEFT:case i.UP:a=this.headers[(n-1+s)%s];break;case i.SPACE:case i.ENTER:this._eventHandler(t);break;case i.HOME:a=this.headers[0];break;case i.END:a=this.headers[s-1]}a&&(e(t.target).attr("tabIndex",-1),e(a).attr("tabIndex",0),a.focus(),t.preventDefault())}},_panelKeyDown:function(t){t.keyCode===e.ui.keyCode.UP&&t.ctrlKey&&e(t.currentTarget).prev().focus()},refresh:function(){var t=this.options;this._processPanels(),t.active===!1&&t.collapsible===!0||!this.headers.length?(t.active=!1,this.active=e()):t.active===!1?this._activate(0):this.active.length&&!e.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(t.active=!1,this.active=e()):this._activate(Math.max(0,t.active-1)):t.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){var e=this.headers,t=this.panels;this.headers=this.element.find(this.options.header).addClass("ui-accordion-header ui-state-default ui-corner-all"),this.panels=this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide(),t&&(this._off(e.not(this.headers)),this._off(t.not(this.panels)))
},_refresh:function(){var t,i=this.options,s=i.heightStyle,n=this.element.parent();this.active=this._findActive(i.active).addClass("ui-accordion-header-active ui-state-active ui-corner-top").removeClass("ui-corner-all"),this.active.next().addClass("ui-accordion-content-active").show(),this.headers.attr("role","tab").each(function(){var t=e(this),i=t.uniqueId().attr("id"),s=t.next(),n=s.uniqueId().attr("id");t.attr("aria-controls",n),s.attr("aria-labelledby",i)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(i.event),"fill"===s?(t=n.height(),this.element.siblings(":visible").each(function(){var i=e(this),s=i.css("position");"absolute"!==s&&"fixed"!==s&&(t-=i.outerHeight(!0))}),this.headers.each(function(){t-=e(this).outerHeight(!0)}),this.headers.next().each(function(){e(this).height(Math.max(0,t-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")):"auto"===s&&(t=0,this.headers.next().each(function(){t=Math.max(t,e(this).css("height","").height())}).height(t))},_activate:function(t){var i=this._findActive(t)[0];i!==this.active[0]&&(i=i||this.active[0],this._eventHandler({target:i,currentTarget:i,preventDefault:e.noop}))},_findActive:function(t){return"number"==typeof t?this.headers.eq(t):e()},_setupEvents:function(t){var i={keydown:"_keydown"};t&&e.each(t.split(" "),function(e,t){i[t]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,i),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(t){var i=this.options,s=this.active,n=e(t.currentTarget),a=n[0]===s[0],o=a&&i.collapsible,r=o?e():n.next(),h=s.next(),l={oldHeader:s,oldPanel:h,newHeader:o?e():n,newPanel:r};t.preventDefault(),a&&!i.collapsible||this._trigger("beforeActivate",t,l)===!1||(i.active=o?!1:this.headers.index(n),this.active=a?e():n,this._toggle(l),s.removeClass("ui-accordion-header-active ui-state-active"),i.icons&&s.children(".ui-accordion-header-icon").removeClass(i.icons.activeHeader).addClass(i.icons.header),a||(n.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),i.icons&&n.children(".ui-accordion-header-icon").removeClass(i.icons.header).addClass(i.icons.activeHeader),n.next().addClass("ui-accordion-content-active")))},_toggle:function(t){var i=t.newPanel,s=this.prevShow.length?this.prevShow:t.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=i,this.prevHide=s,this.options.animate?this._animate(i,s,t):(s.hide(),i.show(),this._toggleComplete(t)),s.attr({"aria-hidden":"true"}),s.prev().attr({"aria-selected":"false","aria-expanded":"false"}),i.length&&s.length?s.prev().attr({tabIndex:-1,"aria-expanded":"false"}):i.length&&this.headers.filter(function(){return 0===parseInt(e(this).attr("tabIndex"),10)}).attr("tabIndex",-1),i.attr("aria-hidden","false").prev().attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_animate:function(e,t,i){var s,n,a,o=this,r=0,h=e.css("box-sizing"),l=e.length&&(!t.length||e.index()<t.index()),u=this.options.animate||{},d=l&&u.down||u,c=function(){o._toggleComplete(i)};return"number"==typeof d&&(a=d),"string"==typeof d&&(n=d),n=n||d.easing||u.easing,a=a||d.duration||u.duration,t.length?e.length?(s=e.show().outerHeight(),t.animate(this.hideProps,{duration:a,easing:n,step:function(e,t){t.now=Math.round(e)}}),e.hide().animate(this.showProps,{duration:a,easing:n,complete:c,step:function(e,i){i.now=Math.round(e),"height"!==i.prop?"content-box"===h&&(r+=i.now):"content"!==o.options.heightStyle&&(i.now=Math.round(s-t.outerHeight()-r),r=0)}}),void 0):t.animate(this.hideProps,a,n,c):e.animate(this.showProps,a,n,c)},_toggleComplete:function(e){var t=e.oldPanel;t.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"),t.length&&(t.parent()[0].className=t.parent()[0].className),this._trigger("activate",null,e)}}),e.widget("ui.menu",{version:"1.11.4",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},items:"> *",menus:"ul",position:{my:"left-1 top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item":function(e){e.preventDefault()},"click .ui-menu-item":function(t){var i=e(t.target);!this.mouseHandled&&i.not(".ui-state-disabled").length&&(this.select(t),t.isPropagationStopped()||(this.mouseHandled=!0),i.has(".ui-menu").length?this.expand(t):!this.element.is(":focus")&&e(this.document[0].activeElement).closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(t){if(!this.previousFilter){var i=e(t.currentTarget);i.siblings(".ui-state-active").removeClass("ui-state-active"),this.focus(t,i)}},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(e,t){var i=this.active||this.element.find(this.options.items).eq(0);t||this.focus(e,i)},blur:function(t){this._delay(function(){e.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(t)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(e){this._closeOnDocumentClick(e)&&this.collapseAll(e),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-menu-icons ui-front").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").removeUniqueId().removeClass("ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var t=e(this);t.data("ui-menu-submenu-carat")&&t.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(t){var i,s,n,a,o=!0;switch(t.keyCode){case e.ui.keyCode.PAGE_UP:this.previousPage(t);break;case e.ui.keyCode.PAGE_DOWN:this.nextPage(t);break;case e.ui.keyCode.HOME:this._move("first","first",t);break;case e.ui.keyCode.END:this._move("last","last",t);break;case e.ui.keyCode.UP:this.previous(t);break;case e.ui.keyCode.DOWN:this.next(t);break;case e.ui.keyCode.LEFT:this.collapse(t);break;case e.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(t);break;case e.ui.keyCode.ENTER:case e.ui.keyCode.SPACE:this._activate(t);break;case e.ui.keyCode.ESCAPE:this.collapse(t);break;default:o=!1,s=this.previousFilter||"",n=String.fromCharCode(t.keyCode),a=!1,clearTimeout(this.filterTimer),n===s?a=!0:n=s+n,i=this._filterMenuItems(n),i=a&&-1!==i.index(this.active.next())?this.active.nextAll(".ui-menu-item"):i,i.length||(n=String.fromCharCode(t.keyCode),i=this._filterMenuItems(n)),i.length?(this.focus(t,i),this.previousFilter=n,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter}o&&t.preventDefault()},_activate:function(e){this.active.is(".ui-state-disabled")||(this.active.is("[aria-haspopup='true']")?this.expand(e):this.select(e))},refresh:function(){var t,i,s=this,n=this.options.icons.submenu,a=this.element.find(this.options.menus);this.element.toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length),a.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-front").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var t=e(this),i=t.parent(),s=e("<span>").addClass("ui-menu-icon ui-icon "+n).data("ui-menu-submenu-carat",!0);i.attr("aria-haspopup","true").prepend(s),t.attr("aria-labelledby",i.attr("id"))}),t=a.add(this.element),i=t.find(this.options.items),i.not(".ui-menu-item").each(function(){var t=e(this);s._isDivider(t)&&t.addClass("ui-widget-content ui-menu-divider")}),i.not(".ui-menu-item, .ui-menu-divider").addClass("ui-menu-item").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),i.filter(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!e.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(e,t){"icons"===e&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(t.submenu),"disabled"===e&&this.element.toggleClass("ui-state-disabled",!!t).attr("aria-disabled",t),this._super(e,t)},focus:function(e,t){var i,s;this.blur(e,e&&"focus"===e.type),this._scrollIntoView(t),this.active=t.first(),s=this.active.addClass("ui-state-focus").removeClass("ui-state-active"),this.options.role&&this.element.attr("aria-activedescendant",s.attr("id")),this.active.parent().closest(".ui-menu-item").addClass("ui-state-active"),e&&"keydown"===e.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),i=t.children(".ui-menu"),i.length&&e&&/^mouse/.test(e.type)&&this._startOpening(i),this.activeMenu=t.parent(),this._trigger("focus",e,{item:t})},_scrollIntoView:function(t){var i,s,n,a,o,r;this._hasScroll()&&(i=parseFloat(e.css(this.activeMenu[0],"borderTopWidth"))||0,s=parseFloat(e.css(this.activeMenu[0],"paddingTop"))||0,n=t.offset().top-this.activeMenu.offset().top-i-s,a=this.activeMenu.scrollTop(),o=this.activeMenu.height(),r=t.outerHeight(),0>n?this.activeMenu.scrollTop(a+n):n+r>o&&this.activeMenu.scrollTop(a+n-o+r))},blur:function(e,t){t||clearTimeout(this.timer),this.active&&(this.active.removeClass("ui-state-focus"),this.active=null,this._trigger("blur",e,{item:this.active}))},_startOpening:function(e){clearTimeout(this.timer),"true"===e.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(e)},this.delay))},_open:function(t){var i=e.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(t.parents(".ui-menu")).hide().attr("aria-hidden","true"),t.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(i)},collapseAll:function(t,i){clearTimeout(this.timer),this.timer=this._delay(function(){var s=i?this.element:e(t&&t.target).closest(this.element.find(".ui-menu"));s.length||(s=this.element),this._close(s),this.blur(t),this.activeMenu=s},this.delay)},_close:function(e){e||(e=this.active?this.active.parent():this.element),e.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find(".ui-state-active").not(".ui-state-focus").removeClass("ui-state-active")},_closeOnDocumentClick:function(t){return!e(t.target).closest(".ui-menu").length},_isDivider:function(e){return!/[^\-\u2014\u2013\s]/.test(e.text())},collapse:function(e){var t=this.active&&this.active.parent().closest(".ui-menu-item",this.element);t&&t.length&&(this._close(),this.focus(e,t))},expand:function(e){var t=this.active&&this.active.children(".ui-menu ").find(this.options.items).first();t&&t.length&&(this._open(t.parent()),this._delay(function(){this.focus(e,t)}))},next:function(e){this._move("next","first",e)},previous:function(e){this._move("prev","last",e)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(e,t,i){var s;this.active&&(s="first"===e||"last"===e?this.active["first"===e?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[e+"All"](".ui-menu-item").eq(0)),s&&s.length&&this.active||(s=this.activeMenu.find(this.options.items)[t]()),this.focus(i,s)},nextPage:function(t){var i,s,n;return this.active?(this.isLastItem()||(this._hasScroll()?(s=this.active.offset().top,n=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return i=e(this),0>i.offset().top-s-n}),this.focus(t,i)):this.focus(t,this.activeMenu.find(this.options.items)[this.active?"last":"first"]())),void 0):(this.next(t),void 0)},previousPage:function(t){var i,s,n;return this.active?(this.isFirstItem()||(this._hasScroll()?(s=this.active.offset().top,n=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return i=e(this),i.offset().top-s+n>0}),this.focus(t,i)):this.focus(t,this.activeMenu.find(this.options.items).first())),void 0):(this.next(t),void 0)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(t){this.active=this.active||e(t.target).closest(".ui-menu-item");var i={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(t,!0),this._trigger("select",t,i)},_filterMenuItems:function(t){var i=t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),s=RegExp("^"+i,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter(function(){return s.test(e.trim(e(this).text()))})}}),e.widget("ui.autocomplete",{version:"1.11.4",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var t,i,s,n=this.element[0].nodeName.toLowerCase(),a="textarea"===n,o="input"===n;this.isMultiLine=a?!0:o?!1:this.element.prop("isContentEditable"),this.valueMethod=this.element[a||o?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(n){if(this.element.prop("readOnly"))return t=!0,s=!0,i=!0,void 0;t=!1,s=!1,i=!1;var a=e.ui.keyCode;switch(n.keyCode){case a.PAGE_UP:t=!0,this._move("previousPage",n);break;case a.PAGE_DOWN:t=!0,this._move("nextPage",n);break;case a.UP:t=!0,this._keyEvent("previous",n);break;case a.DOWN:t=!0,this._keyEvent("next",n);break;case a.ENTER:this.menu.active&&(t=!0,n.preventDefault(),this.menu.select(n));break;case a.TAB:this.menu.active&&this.menu.select(n);break;case a.ESCAPE:this.menu.element.is(":visible")&&(this.isMultiLine||this._value(this.term),this.close(n),n.preventDefault());break;default:i=!0,this._searchTimeout(n)}},keypress:function(s){if(t)return t=!1,(!this.isMultiLine||this.menu.element.is(":visible"))&&s.preventDefault(),void 0;if(!i){var n=e.ui.keyCode;switch(s.keyCode){case n.PAGE_UP:this._move("previousPage",s);break;case n.PAGE_DOWN:this._move("nextPage",s);break;case n.UP:this._keyEvent("previous",s);break;case n.DOWN:this._keyEvent("next",s)}}},input:function(e){return s?(s=!1,e.preventDefault(),void 0):(this._searchTimeout(e),void 0)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(e){return this.cancelBlur?(delete this.cancelBlur,void 0):(clearTimeout(this.searching),this.close(e),this._change(e),void 0)}}),this._initSource(),this.menu=e("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().menu("instance"),this._on(this.menu.element,{mousedown:function(t){t.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var i=this.menu.element[0];e(t.target).closest(".ui-menu-item").length||this._delay(function(){var t=this;this.document.one("mousedown",function(s){s.target===t.element[0]||s.target===i||e.contains(i,s.target)||t.close()})})},menufocus:function(t,i){var s,n;return this.isNewMenu&&(this.isNewMenu=!1,t.originalEvent&&/^mouse/.test(t.originalEvent.type))?(this.menu.blur(),this.document.one("mousemove",function(){e(t.target).trigger(t.originalEvent)}),void 0):(n=i.item.data("ui-autocomplete-item"),!1!==this._trigger("focus",t,{item:n})&&t.originalEvent&&/^key/.test(t.originalEvent.type)&&this._value(n.value),s=i.item.attr("aria-label")||n.value,s&&e.trim(s).length&&(this.liveRegion.children().hide(),e("<div>").text(s).appendTo(this.liveRegion)),void 0)},menuselect:function(e,t){var i=t.item.data("ui-autocomplete-item"),s=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=s,this._delay(function(){this.previous=s,this.selectedItem=i})),!1!==this._trigger("select",e,{item:i})&&this._value(i.value),this.term=this._value(),this.close(e),this.selectedItem=i}}),this.liveRegion=e("<span>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(e,t){this._super(e,t),"source"===e&&this._initSource(),"appendTo"===e&&this.menu.element.appendTo(this._appendTo()),"disabled"===e&&t&&this.xhr&&this.xhr.abort()},_appendTo:function(){var t=this.options.appendTo;return t&&(t=t.jquery||t.nodeType?e(t):this.document.find(t).eq(0)),t&&t[0]||(t=this.element.closest(".ui-front")),t.length||(t=this.document[0].body),t},_initSource:function(){var t,i,s=this;e.isArray(this.options.source)?(t=this.options.source,this.source=function(i,s){s(e.ui.autocomplete.filter(t,i.term))}):"string"==typeof this.options.source?(i=this.options.source,this.source=function(t,n){s.xhr&&s.xhr.abort(),s.xhr=e.ajax({url:i,data:t,dataType:"json",success:function(e){n(e)},error:function(){n([])}})}):this.source=this.options.source},_searchTimeout:function(e){clearTimeout(this.searching),this.searching=this._delay(function(){var t=this.term===this._value(),i=this.menu.element.is(":visible"),s=e.altKey||e.ctrlKey||e.metaKey||e.shiftKey;(!t||t&&!i&&!s)&&(this.selectedItem=null,this.search(null,e))},this.options.delay)},search:function(e,t){return e=null!=e?e:this._value(),this.term=this._value(),e.length<this.options.minLength?this.close(t):this._trigger("search",t)!==!1?this._search(e):void 0},_search:function(e){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:e},this._response())},_response:function(){var t=++this.requestIndex;return e.proxy(function(e){t===this.requestIndex&&this.__response(e),this.pending--,this.pending||this.element.removeClass("ui-autocomplete-loading")},this)},__response:function(e){e&&(e=this._normalize(e)),this._trigger("response",null,{content:e}),!this.options.disabled&&e&&e.length&&!this.cancelSearch?(this._suggest(e),this._trigger("open")):this._close()},close:function(e){this.cancelSearch=!0,this._close(e)},_close:function(e){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",e))},_change:function(e){this.previous!==this._value()&&this._trigger("change",e,{item:this.selectedItem})},_normalize:function(t){return t.length&&t[0].label&&t[0].value?t:e.map(t,function(t){return"string"==typeof t?{label:t,value:t}:e.extend({},t,{label:t.label||t.value,value:t.value||t.label})})},_suggest:function(t){var i=this.menu.element.empty();this._renderMenu(i,t),this.isNewMenu=!0,this.menu.refresh(),i.show(),this._resizeMenu(),i.position(e.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var e=this.menu.element;e.outerWidth(Math.max(e.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(t,i){var s=this;e.each(i,function(e,i){s._renderItemData(t,i)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-autocomplete-item",t)},_renderItem:function(t,i){return e("<li>").text(i.label).appendTo(t)},_move:function(e,t){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(e)||this.menu.isLastItem()&&/^next/.test(e)?(this.isMultiLine||this._value(this.term),this.menu.blur(),void 0):(this.menu[e](t),void 0):(this.search(null,t),void 0)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(e,t){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(e,t),t.preventDefault())}}),e.extend(e.ui.autocomplete,{escapeRegex:function(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(t,i){var s=RegExp(e.ui.autocomplete.escapeRegex(i),"i");return e.grep(t,function(e){return s.test(e.label||e.value||e)})}}),e.widget("ui.autocomplete",e.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(e){return e+(e>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(t){var i;this._superApply(arguments),this.options.disabled||this.cancelSearch||(i=t&&t.length?this.options.messages.results(t.length):this.options.messages.noResults,this.liveRegion.children().hide(),e("<div>").text(i).appendTo(this.liveRegion))}}),e.ui.autocomplete;var c,p="ui-button ui-widget ui-state-default ui-corner-all",f="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",m=function(){var t=e(this);setTimeout(function(){t.find(":ui-button").button("refresh")},1)},g=function(t){var i=t.name,s=t.form,n=e([]);return i&&(i=i.replace(/'/g,"\\'"),n=s?e(s).find("[name='"+i+"'][type=radio]"):e("[name='"+i+"'][type=radio]",t.ownerDocument).filter(function(){return!this.form})),n};e.widget("ui.button",{version:"1.11.4",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,m),"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var t=this,i=this.options,s="checkbox"===this.type||"radio"===this.type,n=s?"":"ui-state-active";null===i.label&&(i.label="input"===this.type?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(p).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){i.disabled||this===c&&e(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){i.disabled||e(this).removeClass(n)}).bind("click"+this.eventNamespace,function(e){i.disabled&&(e.preventDefault(),e.stopImmediatePropagation())}),this._on({focus:function(){this.buttonElement.addClass("ui-state-focus")},blur:function(){this.buttonElement.removeClass("ui-state-focus")}}),s&&this.element.bind("change"+this.eventNamespace,function(){t.refresh()}),"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){return i.disabled?!1:void 0}):"radio"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(i.disabled)return!1;e(this).addClass("ui-state-active"),t.buttonElement.attr("aria-pressed","true");var s=t.element[0];g(s).not(s).map(function(){return e(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){return i.disabled?!1:(e(this).addClass("ui-state-active"),c=this,t.document.one("mouseup",function(){c=null}),void 0)}).bind("mouseup"+this.eventNamespace,function(){return i.disabled?!1:(e(this).removeClass("ui-state-active"),void 0)}).bind("keydown"+this.eventNamespace,function(t){return i.disabled?!1:((t.keyCode===e.ui.keyCode.SPACE||t.keyCode===e.ui.keyCode.ENTER)&&e(this).addClass("ui-state-active"),void 0)}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){e(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(t){t.keyCode===e.ui.keyCode.SPACE&&e(this).click()})),this._setOption("disabled",i.disabled),this._resetButton()},_determineButtonType:function(){var e,t,i;this.type=this.element.is("[type=checkbox]")?"checkbox":this.element.is("[type=radio]")?"radio":this.element.is("input")?"input":"button","checkbox"===this.type||"radio"===this.type?(e=this.element.parents().last(),t="label[for='"+this.element.attr("id")+"']",this.buttonElement=e.find(t),this.buttonElement.length||(e=e.length?e.siblings():this.element.siblings(),this.buttonElement=e.filter(t),this.buttonElement.length||(this.buttonElement=e.find(t))),this.element.addClass("ui-helper-hidden-accessible"),i=this.element.is(":checked"),i&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",i)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(p+" ui-state-active "+f).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(e,t){return this._super(e,t),"disabled"===e?(this.widget().toggleClass("ui-state-disabled",!!t),this.element.prop("disabled",!!t),t&&("checkbox"===this.type||"radio"===this.type?this.buttonElement.removeClass("ui-state-focus"):this.buttonElement.removeClass("ui-state-focus ui-state-active")),void 0):(this._resetButton(),void 0)},refresh:function(){var t=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");t!==this.options.disabled&&this._setOption("disabled",t),"radio"===this.type?g(this.element[0]).each(function(){e(this).is(":checked")?e(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):e(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"===this.type)return this.options.label&&this.element.val(this.options.label),void 0;var t=this.buttonElement.removeClass(f),i=e("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(t.empty()).text(),s=this.options.icons,n=s.primary&&s.secondary,a=[];s.primary||s.secondary?(this.options.text&&a.push("ui-button-text-icon"+(n?"s":s.primary?"-primary":"-secondary")),s.primary&&t.prepend("<span class='ui-button-icon-primary ui-icon "+s.primary+"'></span>"),s.secondary&&t.append("<span class='ui-button-icon-secondary ui-icon "+s.secondary+"'></span>"),this.options.text||(a.push(n?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||t.attr("title",e.trim(i)))):a.push("ui-button-text-only"),t.addClass(a.join(" "))}}),e.widget("ui.buttonset",{version:"1.11.4",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(e,t){"disabled"===e&&this.buttons.button("option",e,t),this._super(e,t)},refresh:function(){var t="rtl"===this.element.css("direction"),i=this.element.find(this.options.items),s=i.filter(":ui-button");i.not(":ui-button").button(),s.button("refresh"),this.buttons=i.map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(t?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(t?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}}),e.ui.button,e.extend(e.ui,{datepicker:{version:"1.11.4"}});var v;e.extend(n.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){return r(this._defaults,e||{}),this},_attachDatepicker:function(t,i){var s,n,a;s=t.nodeName.toLowerCase(),n="div"===s||"span"===s,t.id||(this.uuid+=1,t.id="dp"+this.uuid),a=this._newInst(e(t),n),a.settings=e.extend({},i||{}),"input"===s?this._connectDatepicker(t,a):n&&this._inlineDatepicker(t,a)},_newInst:function(t,i){var s=t[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:s,input:t,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:i,dpDiv:i?a(e("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(t,i){var s=e(t);i.append=e([]),i.trigger=e([]),s.hasClass(this.markerClassName)||(this._attachments(s,i),s.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(i),e.data(t,"datepicker",i),i.settings.disabled&&this._disableDatepicker(t))},_attachments:function(t,i){var s,n,a,o=this._get(i,"appendText"),r=this._get(i,"isRTL");i.append&&i.append.remove(),o&&(i.append=e("<span class='"+this._appendClass+"'>"+o+"</span>"),t[r?"before":"after"](i.append)),t.unbind("focus",this._showDatepicker),i.trigger&&i.trigger.remove(),s=this._get(i,"showOn"),("focus"===s||"both"===s)&&t.focus(this._showDatepicker),("button"===s||"both"===s)&&(n=this._get(i,"buttonText"),a=this._get(i,"buttonImage"),i.trigger=e(this._get(i,"buttonImageOnly")?e("<img/>").addClass(this._triggerClass).attr({src:a,alt:n,title:n}):e("<button type='button'></button>").addClass(this._triggerClass).html(a?e("<img/>").attr({src:a,alt:n,title:n}):n)),t[r?"before":"after"](i.trigger),i.trigger.click(function(){return e.datepicker._datepickerShowing&&e.datepicker._lastInput===t[0]?e.datepicker._hideDatepicker():e.datepicker._datepickerShowing&&e.datepicker._lastInput!==t[0]?(e.datepicker._hideDatepicker(),e.datepicker._showDatepicker(t[0])):e.datepicker._showDatepicker(t[0]),!1}))},_autoSize:function(e){if(this._get(e,"autoSize")&&!e.inline){var t,i,s,n,a=new Date(2009,11,20),o=this._get(e,"dateFormat");o.match(/[DM]/)&&(t=function(e){for(i=0,s=0,n=0;e.length>n;n++)e[n].length>i&&(i=e[n].length,s=n);return s},a.setMonth(t(this._get(e,o.match(/MM/)?"monthNames":"monthNamesShort"))),a.setDate(t(this._get(e,o.match(/DD/)?"dayNames":"dayNamesShort"))+20-a.getDay())),e.input.attr("size",this._formatDate(e,a).length)}},_inlineDatepicker:function(t,i){var s=e(t);s.hasClass(this.markerClassName)||(s.addClass(this.markerClassName).append(i.dpDiv),e.data(t,"datepicker",i),this._setDate(i,this._getDefaultDate(i),!0),this._updateDatepicker(i),this._updateAlternate(i),i.settings.disabled&&this._disableDatepicker(t),i.dpDiv.css("display","block"))},_dialogDatepicker:function(t,i,s,n,a){var o,h,l,u,d,c=this._dialogInst;return c||(this.uuid+=1,o="dp"+this.uuid,this._dialogInput=e("<input type='text' id='"+o+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),e("body").append(this._dialogInput),c=this._dialogInst=this._newInst(this._dialogInput,!1),c.settings={},e.data(this._dialogInput[0],"datepicker",c)),r(c.settings,n||{}),i=i&&i.constructor===Date?this._formatDate(c,i):i,this._dialogInput.val(i),this._pos=a?a.length?a:[a.pageX,a.pageY]:null,this._pos||(h=document.documentElement.clientWidth,l=document.documentElement.clientHeight,u=document.documentElement.scrollLeft||document.body.scrollLeft,d=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[h/2-100+u,l/2-150+d]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),c.settings.onSelect=s,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),e.blockUI&&e.blockUI(this.dpDiv),e.data(this._dialogInput[0],"datepicker",c),this
},_destroyDatepicker:function(t){var i,s=e(t),n=e.data(t,"datepicker");s.hasClass(this.markerClassName)&&(i=t.nodeName.toLowerCase(),e.removeData(t,"datepicker"),"input"===i?(n.append.remove(),n.trigger.remove(),s.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):("div"===i||"span"===i)&&s.removeClass(this.markerClassName).empty(),v===n&&(v=null))},_enableDatepicker:function(t){var i,s,n=e(t),a=e.data(t,"datepicker");n.hasClass(this.markerClassName)&&(i=t.nodeName.toLowerCase(),"input"===i?(t.disabled=!1,a.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):("div"===i||"span"===i)&&(s=n.children("."+this._inlineClass),s.children().removeClass("ui-state-disabled"),s.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}))},_disableDatepicker:function(t){var i,s,n=e(t),a=e.data(t,"datepicker");n.hasClass(this.markerClassName)&&(i=t.nodeName.toLowerCase(),"input"===i?(t.disabled=!0,a.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):("div"===i||"span"===i)&&(s=n.children("."+this._inlineClass),s.children().addClass("ui-state-disabled"),s.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}),this._disabledInputs[this._disabledInputs.length]=t)},_isDisabledDatepicker:function(e){if(!e)return!1;for(var t=0;this._disabledInputs.length>t;t++)if(this._disabledInputs[t]===e)return!0;return!1},_getInst:function(t){try{return e.data(t,"datepicker")}catch(i){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(t,i,s){var n,a,o,h,l=this._getInst(t);return 2===arguments.length&&"string"==typeof i?"defaults"===i?e.extend({},e.datepicker._defaults):l?"all"===i?e.extend({},l.settings):this._get(l,i):null:(n=i||{},"string"==typeof i&&(n={},n[i]=s),l&&(this._curInst===l&&this._hideDatepicker(),a=this._getDateDatepicker(t,!0),o=this._getMinMaxDate(l,"min"),h=this._getMinMaxDate(l,"max"),r(l.settings,n),null!==o&&void 0!==n.dateFormat&&void 0===n.minDate&&(l.settings.minDate=this._formatDate(l,o)),null!==h&&void 0!==n.dateFormat&&void 0===n.maxDate&&(l.settings.maxDate=this._formatDate(l,h)),"disabled"in n&&(n.disabled?this._disableDatepicker(t):this._enableDatepicker(t)),this._attachments(e(t),l),this._autoSize(l),this._setDate(l,a),this._updateAlternate(l),this._updateDatepicker(l)),void 0)},_changeDatepicker:function(e,t,i){this._optionDatepicker(e,t,i)},_refreshDatepicker:function(e){var t=this._getInst(e);t&&this._updateDatepicker(t)},_setDateDatepicker:function(e,t){var i=this._getInst(e);i&&(this._setDate(i,t),this._updateDatepicker(i),this._updateAlternate(i))},_getDateDatepicker:function(e,t){var i=this._getInst(e);return i&&!i.inline&&this._setDateFromField(i,t),i?this._getDate(i):null},_doKeyDown:function(t){var i,s,n,a=e.datepicker._getInst(t.target),o=!0,r=a.dpDiv.is(".ui-datepicker-rtl");if(a._keyEvent=!0,e.datepicker._datepickerShowing)switch(t.keyCode){case 9:e.datepicker._hideDatepicker(),o=!1;break;case 13:return n=e("td."+e.datepicker._dayOverClass+":not(."+e.datepicker._currentClass+")",a.dpDiv),n[0]&&e.datepicker._selectDay(t.target,a.selectedMonth,a.selectedYear,n[0]),i=e.datepicker._get(a,"onSelect"),i?(s=e.datepicker._formatDate(a),i.apply(a.input?a.input[0]:null,[s,a])):e.datepicker._hideDatepicker(),!1;case 27:e.datepicker._hideDatepicker();break;case 33:e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(a,"stepBigMonths"):-e.datepicker._get(a,"stepMonths"),"M");break;case 34:e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(a,"stepBigMonths"):+e.datepicker._get(a,"stepMonths"),"M");break;case 35:(t.ctrlKey||t.metaKey)&&e.datepicker._clearDate(t.target),o=t.ctrlKey||t.metaKey;break;case 36:(t.ctrlKey||t.metaKey)&&e.datepicker._gotoToday(t.target),o=t.ctrlKey||t.metaKey;break;case 37:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,r?1:-1,"D"),o=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(a,"stepBigMonths"):-e.datepicker._get(a,"stepMonths"),"M");break;case 38:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,-7,"D"),o=t.ctrlKey||t.metaKey;break;case 39:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,r?-1:1,"D"),o=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(a,"stepBigMonths"):+e.datepicker._get(a,"stepMonths"),"M");break;case 40:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,7,"D"),o=t.ctrlKey||t.metaKey;break;default:o=!1}else 36===t.keyCode&&t.ctrlKey?e.datepicker._showDatepicker(this):o=!1;o&&(t.preventDefault(),t.stopPropagation())},_doKeyPress:function(t){var i,s,n=e.datepicker._getInst(t.target);return e.datepicker._get(n,"constrainInput")?(i=e.datepicker._possibleChars(e.datepicker._get(n,"dateFormat")),s=String.fromCharCode(null==t.charCode?t.keyCode:t.charCode),t.ctrlKey||t.metaKey||" ">s||!i||i.indexOf(s)>-1):void 0},_doKeyUp:function(t){var i,s=e.datepicker._getInst(t.target);if(s.input.val()!==s.lastVal)try{i=e.datepicker.parseDate(e.datepicker._get(s,"dateFormat"),s.input?s.input.val():null,e.datepicker._getFormatConfig(s)),i&&(e.datepicker._setDateFromField(s),e.datepicker._updateAlternate(s),e.datepicker._updateDatepicker(s))}catch(n){}return!0},_showDatepicker:function(t){if(t=t.target||t,"input"!==t.nodeName.toLowerCase()&&(t=e("input",t.parentNode)[0]),!e.datepicker._isDisabledDatepicker(t)&&e.datepicker._lastInput!==t){var i,n,a,o,h,l,u;i=e.datepicker._getInst(t),e.datepicker._curInst&&e.datepicker._curInst!==i&&(e.datepicker._curInst.dpDiv.stop(!0,!0),i&&e.datepicker._datepickerShowing&&e.datepicker._hideDatepicker(e.datepicker._curInst.input[0])),n=e.datepicker._get(i,"beforeShow"),a=n?n.apply(t,[t,i]):{},a!==!1&&(r(i.settings,a),i.lastVal=null,e.datepicker._lastInput=t,e.datepicker._setDateFromField(i),e.datepicker._inDialog&&(t.value=""),e.datepicker._pos||(e.datepicker._pos=e.datepicker._findPos(t),e.datepicker._pos[1]+=t.offsetHeight),o=!1,e(t).parents().each(function(){return o|="fixed"===e(this).css("position"),!o}),h={left:e.datepicker._pos[0],top:e.datepicker._pos[1]},e.datepicker._pos=null,i.dpDiv.empty(),i.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),e.datepicker._updateDatepicker(i),h=e.datepicker._checkOffset(i,h,o),i.dpDiv.css({position:e.datepicker._inDialog&&e.blockUI?"static":o?"fixed":"absolute",display:"none",left:h.left+"px",top:h.top+"px"}),i.inline||(l=e.datepicker._get(i,"showAnim"),u=e.datepicker._get(i,"duration"),i.dpDiv.css("z-index",s(e(t))+1),e.datepicker._datepickerShowing=!0,e.effects&&e.effects.effect[l]?i.dpDiv.show(l,e.datepicker._get(i,"showOptions"),u):i.dpDiv[l||"show"](l?u:null),e.datepicker._shouldFocusInput(i)&&i.input.focus(),e.datepicker._curInst=i))}},_updateDatepicker:function(t){this.maxRows=4,v=t,t.dpDiv.empty().append(this._generateHTML(t)),this._attachHandlers(t);var i,s=this._getNumberOfMonths(t),n=s[1],a=17,r=t.dpDiv.find("."+this._dayOverClass+" a");r.length>0&&o.apply(r.get(0)),t.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),n>1&&t.dpDiv.addClass("ui-datepicker-multi-"+n).css("width",a*n+"em"),t.dpDiv[(1!==s[0]||1!==s[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),t.dpDiv[(this._get(t,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),t===e.datepicker._curInst&&e.datepicker._datepickerShowing&&e.datepicker._shouldFocusInput(t)&&t.input.focus(),t.yearshtml&&(i=t.yearshtml,setTimeout(function(){i===t.yearshtml&&t.yearshtml&&t.dpDiv.find("select.ui-datepicker-year:first").replaceWith(t.yearshtml),i=t.yearshtml=null},0))},_shouldFocusInput:function(e){return e.input&&e.input.is(":visible")&&!e.input.is(":disabled")&&!e.input.is(":focus")},_checkOffset:function(t,i,s){var n=t.dpDiv.outerWidth(),a=t.dpDiv.outerHeight(),o=t.input?t.input.outerWidth():0,r=t.input?t.input.outerHeight():0,h=document.documentElement.clientWidth+(s?0:e(document).scrollLeft()),l=document.documentElement.clientHeight+(s?0:e(document).scrollTop());return i.left-=this._get(t,"isRTL")?n-o:0,i.left-=s&&i.left===t.input.offset().left?e(document).scrollLeft():0,i.top-=s&&i.top===t.input.offset().top+r?e(document).scrollTop():0,i.left-=Math.min(i.left,i.left+n>h&&h>n?Math.abs(i.left+n-h):0),i.top-=Math.min(i.top,i.top+a>l&&l>a?Math.abs(a+r):0),i},_findPos:function(t){for(var i,s=this._getInst(t),n=this._get(s,"isRTL");t&&("hidden"===t.type||1!==t.nodeType||e.expr.filters.hidden(t));)t=t[n?"previousSibling":"nextSibling"];return i=e(t).offset(),[i.left,i.top]},_hideDatepicker:function(t){var i,s,n,a,o=this._curInst;!o||t&&o!==e.data(t,"datepicker")||this._datepickerShowing&&(i=this._get(o,"showAnim"),s=this._get(o,"duration"),n=function(){e.datepicker._tidyDialog(o)},e.effects&&(e.effects.effect[i]||e.effects[i])?o.dpDiv.hide(i,e.datepicker._get(o,"showOptions"),s,n):o.dpDiv["slideDown"===i?"slideUp":"fadeIn"===i?"fadeOut":"hide"](i?s:null,n),i||n(),this._datepickerShowing=!1,a=this._get(o,"onClose"),a&&a.apply(o.input?o.input[0]:null,[o.input?o.input.val():"",o]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),e.blockUI&&(e.unblockUI(),e("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(t){if(e.datepicker._curInst){var i=e(t.target),s=e.datepicker._getInst(i[0]);(i[0].id!==e.datepicker._mainDivId&&0===i.parents("#"+e.datepicker._mainDivId).length&&!i.hasClass(e.datepicker.markerClassName)&&!i.closest("."+e.datepicker._triggerClass).length&&e.datepicker._datepickerShowing&&(!e.datepicker._inDialog||!e.blockUI)||i.hasClass(e.datepicker.markerClassName)&&e.datepicker._curInst!==s)&&e.datepicker._hideDatepicker()}},_adjustDate:function(t,i,s){var n=e(t),a=this._getInst(n[0]);this._isDisabledDatepicker(n[0])||(this._adjustInstDate(a,i+("M"===s?this._get(a,"showCurrentAtPos"):0),s),this._updateDatepicker(a))},_gotoToday:function(t){var i,s=e(t),n=this._getInst(s[0]);this._get(n,"gotoCurrent")&&n.currentDay?(n.selectedDay=n.currentDay,n.drawMonth=n.selectedMonth=n.currentMonth,n.drawYear=n.selectedYear=n.currentYear):(i=new Date,n.selectedDay=i.getDate(),n.drawMonth=n.selectedMonth=i.getMonth(),n.drawYear=n.selectedYear=i.getFullYear()),this._notifyChange(n),this._adjustDate(s)},_selectMonthYear:function(t,i,s){var n=e(t),a=this._getInst(n[0]);a["selected"+("M"===s?"Month":"Year")]=a["draw"+("M"===s?"Month":"Year")]=parseInt(i.options[i.selectedIndex].value,10),this._notifyChange(a),this._adjustDate(n)},_selectDay:function(t,i,s,n){var a,o=e(t);e(n).hasClass(this._unselectableClass)||this._isDisabledDatepicker(o[0])||(a=this._getInst(o[0]),a.selectedDay=a.currentDay=e("a",n).html(),a.selectedMonth=a.currentMonth=i,a.selectedYear=a.currentYear=s,this._selectDate(t,this._formatDate(a,a.currentDay,a.currentMonth,a.currentYear)))},_clearDate:function(t){var i=e(t);this._selectDate(i,"")},_selectDate:function(t,i){var s,n=e(t),a=this._getInst(n[0]);i=null!=i?i:this._formatDate(a),a.input&&a.input.val(i),this._updateAlternate(a),s=this._get(a,"onSelect"),s?s.apply(a.input?a.input[0]:null,[i,a]):a.input&&a.input.trigger("change"),a.inline?this._updateDatepicker(a):(this._hideDatepicker(),this._lastInput=a.input[0],"object"!=typeof a.input[0]&&a.input.focus(),this._lastInput=null)},_updateAlternate:function(t){var i,s,n,a=this._get(t,"altField");a&&(i=this._get(t,"altFormat")||this._get(t,"dateFormat"),s=this._getDate(t),n=this.formatDate(i,s,this._getFormatConfig(t)),e(a).each(function(){e(this).val(n)}))},noWeekends:function(e){var t=e.getDay();return[t>0&&6>t,""]},iso8601Week:function(e){var t,i=new Date(e.getTime());return i.setDate(i.getDate()+4-(i.getDay()||7)),t=i.getTime(),i.setMonth(0),i.setDate(1),Math.floor(Math.round((t-i)/864e5)/7)+1},parseDate:function(t,i,s){if(null==t||null==i)throw"Invalid arguments";if(i="object"==typeof i?""+i:i+"",""===i)return null;var n,a,o,r,h=0,l=(s?s.shortYearCutoff:null)||this._defaults.shortYearCutoff,u="string"!=typeof l?l:(new Date).getFullYear()%100+parseInt(l,10),d=(s?s.dayNamesShort:null)||this._defaults.dayNamesShort,c=(s?s.dayNames:null)||this._defaults.dayNames,p=(s?s.monthNamesShort:null)||this._defaults.monthNamesShort,f=(s?s.monthNames:null)||this._defaults.monthNames,m=-1,g=-1,v=-1,y=-1,b=!1,_=function(e){var i=t.length>n+1&&t.charAt(n+1)===e;return i&&n++,i},x=function(e){var t=_(e),s="@"===e?14:"!"===e?20:"y"===e&&t?4:"o"===e?3:2,n="y"===e?s:1,a=RegExp("^\\d{"+n+","+s+"}"),o=i.substring(h).match(a);if(!o)throw"Missing number at position "+h;return h+=o[0].length,parseInt(o[0],10)},w=function(t,s,n){var a=-1,o=e.map(_(t)?n:s,function(e,t){return[[t,e]]}).sort(function(e,t){return-(e[1].length-t[1].length)});if(e.each(o,function(e,t){var s=t[1];return i.substr(h,s.length).toLowerCase()===s.toLowerCase()?(a=t[0],h+=s.length,!1):void 0}),-1!==a)return a+1;throw"Unknown name at position "+h},k=function(){if(i.charAt(h)!==t.charAt(n))throw"Unexpected literal at position "+h;h++};for(n=0;t.length>n;n++)if(b)"'"!==t.charAt(n)||_("'")?k():b=!1;else switch(t.charAt(n)){case"d":v=x("d");break;case"D":w("D",d,c);break;case"o":y=x("o");break;case"m":g=x("m");break;case"M":g=w("M",p,f);break;case"y":m=x("y");break;case"@":r=new Date(x("@")),m=r.getFullYear(),g=r.getMonth()+1,v=r.getDate();break;case"!":r=new Date((x("!")-this._ticksTo1970)/1e4),m=r.getFullYear(),g=r.getMonth()+1,v=r.getDate();break;case"'":_("'")?k():b=!0;break;default:k()}if(i.length>h&&(o=i.substr(h),!/^\s+/.test(o)))throw"Extra/unparsed characters found in date: "+o;if(-1===m?m=(new Date).getFullYear():100>m&&(m+=(new Date).getFullYear()-(new Date).getFullYear()%100+(u>=m?0:-100)),y>-1)for(g=1,v=y;;){if(a=this._getDaysInMonth(m,g-1),a>=v)break;g++,v-=a}if(r=this._daylightSavingAdjust(new Date(m,g-1,v)),r.getFullYear()!==m||r.getMonth()+1!==g||r.getDate()!==v)throw"Invalid date";return r},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:1e7*60*60*24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925)),formatDate:function(e,t,i){if(!t)return"";var s,n=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,a=(i?i.dayNames:null)||this._defaults.dayNames,o=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,r=(i?i.monthNames:null)||this._defaults.monthNames,h=function(t){var i=e.length>s+1&&e.charAt(s+1)===t;return i&&s++,i},l=function(e,t,i){var s=""+t;if(h(e))for(;i>s.length;)s="0"+s;return s},u=function(e,t,i,s){return h(e)?s[t]:i[t]},d="",c=!1;if(t)for(s=0;e.length>s;s++)if(c)"'"!==e.charAt(s)||h("'")?d+=e.charAt(s):c=!1;else switch(e.charAt(s)){case"d":d+=l("d",t.getDate(),2);break;case"D":d+=u("D",t.getDay(),n,a);break;case"o":d+=l("o",Math.round((new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime()-new Date(t.getFullYear(),0,0).getTime())/864e5),3);break;case"m":d+=l("m",t.getMonth()+1,2);break;case"M":d+=u("M",t.getMonth(),o,r);break;case"y":d+=h("y")?t.getFullYear():(10>t.getYear()%100?"0":"")+t.getYear()%100;break;case"@":d+=t.getTime();break;case"!":d+=1e4*t.getTime()+this._ticksTo1970;break;case"'":h("'")?d+="'":c=!0;break;default:d+=e.charAt(s)}return d},_possibleChars:function(e){var t,i="",s=!1,n=function(i){var s=e.length>t+1&&e.charAt(t+1)===i;return s&&t++,s};for(t=0;e.length>t;t++)if(s)"'"!==e.charAt(t)||n("'")?i+=e.charAt(t):s=!1;else switch(e.charAt(t)){case"d":case"m":case"y":case"@":i+="0123456789";break;case"D":case"M":return null;case"'":n("'")?i+="'":s=!0;break;default:i+=e.charAt(t)}return i},_get:function(e,t){return void 0!==e.settings[t]?e.settings[t]:this._defaults[t]},_setDateFromField:function(e,t){if(e.input.val()!==e.lastVal){var i=this._get(e,"dateFormat"),s=e.lastVal=e.input?e.input.val():null,n=this._getDefaultDate(e),a=n,o=this._getFormatConfig(e);try{a=this.parseDate(i,s,o)||n}catch(r){s=t?"":s}e.selectedDay=a.getDate(),e.drawMonth=e.selectedMonth=a.getMonth(),e.drawYear=e.selectedYear=a.getFullYear(),e.currentDay=s?a.getDate():0,e.currentMonth=s?a.getMonth():0,e.currentYear=s?a.getFullYear():0,this._adjustInstDate(e)}},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(t,i,s){var n=function(e){var t=new Date;return t.setDate(t.getDate()+e),t},a=function(i){try{return e.datepicker.parseDate(e.datepicker._get(t,"dateFormat"),i,e.datepicker._getFormatConfig(t))}catch(s){}for(var n=(i.toLowerCase().match(/^c/)?e.datepicker._getDate(t):null)||new Date,a=n.getFullYear(),o=n.getMonth(),r=n.getDate(),h=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,l=h.exec(i);l;){switch(l[2]||"d"){case"d":case"D":r+=parseInt(l[1],10);break;case"w":case"W":r+=7*parseInt(l[1],10);break;case"m":case"M":o+=parseInt(l[1],10),r=Math.min(r,e.datepicker._getDaysInMonth(a,o));break;case"y":case"Y":a+=parseInt(l[1],10),r=Math.min(r,e.datepicker._getDaysInMonth(a,o))}l=h.exec(i)}return new Date(a,o,r)},o=null==i||""===i?s:"string"==typeof i?a(i):"number"==typeof i?isNaN(i)?s:n(i):new Date(i.getTime());return o=o&&"Invalid Date"==""+o?s:o,o&&(o.setHours(0),o.setMinutes(0),o.setSeconds(0),o.setMilliseconds(0)),this._daylightSavingAdjust(o)},_daylightSavingAdjust:function(e){return e?(e.setHours(e.getHours()>12?e.getHours()+2:0),e):null},_setDate:function(e,t,i){var s=!t,n=e.selectedMonth,a=e.selectedYear,o=this._restrictMinMax(e,this._determineDate(e,t,new Date));e.selectedDay=e.currentDay=o.getDate(),e.drawMonth=e.selectedMonth=e.currentMonth=o.getMonth(),e.drawYear=e.selectedYear=e.currentYear=o.getFullYear(),n===e.selectedMonth&&a===e.selectedYear||i||this._notifyChange(e),this._adjustInstDate(e),e.input&&e.input.val(s?"":this._formatDate(e))},_getDate:function(e){var t=!e.currentYear||e.input&&""===e.input.val()?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return t},_attachHandlers:function(t){var i=this._get(t,"stepMonths"),s="#"+t.id.replace(/\\\\/g,"\\");t.dpDiv.find("[data-handler]").map(function(){var t={prev:function(){e.datepicker._adjustDate(s,-i,"M")},next:function(){e.datepicker._adjustDate(s,+i,"M")},hide:function(){e.datepicker._hideDatepicker()},today:function(){e.datepicker._gotoToday(s)},selectDay:function(){return e.datepicker._selectDay(s,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return e.datepicker._selectMonthYear(s,this,"M"),!1},selectYear:function(){return e.datepicker._selectMonthYear(s,this,"Y"),!1}};e(this).bind(this.getAttribute("data-event"),t[this.getAttribute("data-handler")])})},_generateHTML:function(e){var t,i,s,n,a,o,r,h,l,u,d,c,p,f,m,g,v,y,b,_,x,w,k,T,D,S,M,C,N,A,P,I,H,z,F,E,O,j,W,L=new Date,R=this._daylightSavingAdjust(new Date(L.getFullYear(),L.getMonth(),L.getDate())),Y=this._get(e,"isRTL"),B=this._get(e,"showButtonPanel"),J=this._get(e,"hideIfNoPrevNext"),q=this._get(e,"navigationAsDateFormat"),K=this._getNumberOfMonths(e),V=this._get(e,"showCurrentAtPos"),U=this._get(e,"stepMonths"),Q=1!==K[0]||1!==K[1],G=this._daylightSavingAdjust(e.currentDay?new Date(e.currentYear,e.currentMonth,e.currentDay):new Date(9999,9,9)),X=this._getMinMaxDate(e,"min"),$=this._getMinMaxDate(e,"max"),Z=e.drawMonth-V,et=e.drawYear;if(0>Z&&(Z+=12,et--),$)for(t=this._daylightSavingAdjust(new Date($.getFullYear(),$.getMonth()-K[0]*K[1]+1,$.getDate())),t=X&&X>t?X:t;this._daylightSavingAdjust(new Date(et,Z,1))>t;)Z--,0>Z&&(Z=11,et--);for(e.drawMonth=Z,e.drawYear=et,i=this._get(e,"prevText"),i=q?this.formatDate(i,this._daylightSavingAdjust(new Date(et,Z-U,1)),this._getFormatConfig(e)):i,s=this._canAdjustMonth(e,-1,et,Z)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"e":"w")+"'>"+i+"</span></a>":J?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"e":"w")+"'>"+i+"</span></a>",n=this._get(e,"nextText"),n=q?this.formatDate(n,this._daylightSavingAdjust(new Date(et,Z+U,1)),this._getFormatConfig(e)):n,a=this._canAdjustMonth(e,1,et,Z)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"w":"e")+"'>"+n+"</span></a>":J?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(Y?"w":"e")+"'>"+n+"</span></a>",o=this._get(e,"currentText"),r=this._get(e,"gotoCurrent")&&e.currentDay?G:R,o=q?this.formatDate(o,r,this._getFormatConfig(e)):o,h=e.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(e,"closeText")+"</button>",l=B?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(Y?h:"")+(this._isInRange(e,r)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+o+"</button>":"")+(Y?"":h)+"</div>":"",u=parseInt(this._get(e,"firstDay"),10),u=isNaN(u)?0:u,d=this._get(e,"showWeek"),c=this._get(e,"dayNames"),p=this._get(e,"dayNamesMin"),f=this._get(e,"monthNames"),m=this._get(e,"monthNamesShort"),g=this._get(e,"beforeShowDay"),v=this._get(e,"showOtherMonths"),y=this._get(e,"selectOtherMonths"),b=this._getDefaultDate(e),_="",w=0;K[0]>w;w++){for(k="",this.maxRows=4,T=0;K[1]>T;T++){if(D=this._daylightSavingAdjust(new Date(et,Z,e.selectedDay)),S=" ui-corner-all",M="",Q){if(M+="<div class='ui-datepicker-group",K[1]>1)switch(T){case 0:M+=" ui-datepicker-group-first",S=" ui-corner-"+(Y?"right":"left");break;case K[1]-1:M+=" ui-datepicker-group-last",S=" ui-corner-"+(Y?"left":"right");break;default:M+=" ui-datepicker-group-middle",S=""}M+="'>"}for(M+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+S+"'>"+(/all|left/.test(S)&&0===w?Y?a:s:"")+(/all|right/.test(S)&&0===w?Y?s:a:"")+this._generateMonthYearHeader(e,Z,et,X,$,w>0||T>0,f,m)+"</div><table class='ui-datepicker-calendar'><thead>"+"<tr>",C=d?"<th class='ui-datepicker-week-col'>"+this._get(e,"weekHeader")+"</th>":"",x=0;7>x;x++)N=(x+u)%7,C+="<th scope='col'"+((x+u+6)%7>=5?" class='ui-datepicker-week-end'":"")+">"+"<span title='"+c[N]+"'>"+p[N]+"</span></th>";for(M+=C+"</tr></thead><tbody>",A=this._getDaysInMonth(et,Z),et===e.selectedYear&&Z===e.selectedMonth&&(e.selectedDay=Math.min(e.selectedDay,A)),P=(this._getFirstDayOfMonth(et,Z)-u+7)%7,I=Math.ceil((P+A)/7),H=Q?this.maxRows>I?this.maxRows:I:I,this.maxRows=H,z=this._daylightSavingAdjust(new Date(et,Z,1-P)),F=0;H>F;F++){for(M+="<tr>",E=d?"<td class='ui-datepicker-week-col'>"+this._get(e,"calculateWeek")(z)+"</td>":"",x=0;7>x;x++)O=g?g.apply(e.input?e.input[0]:null,[z]):[!0,""],j=z.getMonth()!==Z,W=j&&!y||!O[0]||X&&X>z||$&&z>$,E+="<td class='"+((x+u+6)%7>=5?" ui-datepicker-week-end":"")+(j?" ui-datepicker-other-month":"")+(z.getTime()===D.getTime()&&Z===e.selectedMonth&&e._keyEvent||b.getTime()===z.getTime()&&b.getTime()===D.getTime()?" "+this._dayOverClass:"")+(W?" "+this._unselectableClass+" ui-state-disabled":"")+(j&&!v?"":" "+O[1]+(z.getTime()===G.getTime()?" "+this._currentClass:"")+(z.getTime()===R.getTime()?" ui-datepicker-today":""))+"'"+(j&&!v||!O[2]?"":" title='"+O[2].replace(/'/g,"&#39;")+"'")+(W?"":" data-handler='selectDay' data-event='click' data-month='"+z.getMonth()+"' data-year='"+z.getFullYear()+"'")+">"+(j&&!v?"&#xa0;":W?"<span class='ui-state-default'>"+z.getDate()+"</span>":"<a class='ui-state-default"+(z.getTime()===R.getTime()?" ui-state-highlight":"")+(z.getTime()===G.getTime()?" ui-state-active":"")+(j?" ui-priority-secondary":"")+"' href='#'>"+z.getDate()+"</a>")+"</td>",z.setDate(z.getDate()+1),z=this._daylightSavingAdjust(z);M+=E+"</tr>"}Z++,Z>11&&(Z=0,et++),M+="</tbody></table>"+(Q?"</div>"+(K[0]>0&&T===K[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),k+=M}_+=k}return _+=l,e._keyEvent=!1,_},_generateMonthYearHeader:function(e,t,i,s,n,a,o,r){var h,l,u,d,c,p,f,m,g=this._get(e,"changeMonth"),v=this._get(e,"changeYear"),y=this._get(e,"showMonthAfterYear"),b="<div class='ui-datepicker-title'>",_="";if(a||!g)_+="<span class='ui-datepicker-month'>"+o[t]+"</span>";else{for(h=s&&s.getFullYear()===i,l=n&&n.getFullYear()===i,_+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",u=0;12>u;u++)(!h||u>=s.getMonth())&&(!l||n.getMonth()>=u)&&(_+="<option value='"+u+"'"+(u===t?" selected='selected'":"")+">"+r[u]+"</option>");_+="</select>"}if(y||(b+=_+(!a&&g&&v?"":"&#xa0;")),!e.yearshtml)if(e.yearshtml="",a||!v)b+="<span class='ui-datepicker-year'>"+i+"</span>";else{for(d=this._get(e,"yearRange").split(":"),c=(new Date).getFullYear(),p=function(e){var t=e.match(/c[+\-].*/)?i+parseInt(e.substring(1),10):e.match(/[+\-].*/)?c+parseInt(e,10):parseInt(e,10);return isNaN(t)?c:t},f=p(d[0]),m=Math.max(f,p(d[1]||"")),f=s?Math.max(f,s.getFullYear()):f,m=n?Math.min(m,n.getFullYear()):m,e.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";m>=f;f++)e.yearshtml+="<option value='"+f+"'"+(f===i?" selected='selected'":"")+">"+f+"</option>";e.yearshtml+="</select>",b+=e.yearshtml,e.yearshtml=null}return b+=this._get(e,"yearSuffix"),y&&(b+=(!a&&g&&v?"":"&#xa0;")+_),b+="</div>"},_adjustInstDate:function(e,t,i){var s=e.drawYear+("Y"===i?t:0),n=e.drawMonth+("M"===i?t:0),a=Math.min(e.selectedDay,this._getDaysInMonth(s,n))+("D"===i?t:0),o=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(s,n,a)));e.selectedDay=o.getDate(),e.drawMonth=e.selectedMonth=o.getMonth(),e.drawYear=e.selectedYear=o.getFullYear(),("M"===i||"Y"===i)&&this._notifyChange(e)},_restrictMinMax:function(e,t){var i=this._getMinMaxDate(e,"min"),s=this._getMinMaxDate(e,"max"),n=i&&i>t?i:t;return s&&n>s?s:n},_notifyChange:function(e){var t=this._get(e,"onChangeMonthYear");t&&t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])},_getNumberOfMonths:function(e){var t=this._get(e,"numberOfMonths");return null==t?[1,1]:"number"==typeof t?[1,t]:t},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+"Date"),null)},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return new Date(e,t,1).getDay()},_canAdjustMonth:function(e,t,i,s){var n=this._getNumberOfMonths(e),a=this._daylightSavingAdjust(new Date(i,s+(0>t?t:n[0]*n[1]),1));return 0>t&&a.setDate(this._getDaysInMonth(a.getFullYear(),a.getMonth())),this._isInRange(e,a)},_isInRange:function(e,t){var i,s,n=this._getMinMaxDate(e,"min"),a=this._getMinMaxDate(e,"max"),o=null,r=null,h=this._get(e,"yearRange");return h&&(i=h.split(":"),s=(new Date).getFullYear(),o=parseInt(i[0],10),r=parseInt(i[1],10),i[0].match(/[+\-].*/)&&(o+=s),i[1].match(/[+\-].*/)&&(r+=s)),(!n||t.getTime()>=n.getTime())&&(!a||t.getTime()<=a.getTime())&&(!o||t.getFullYear()>=o)&&(!r||r>=t.getFullYear())},_getFormatConfig:function(e){var t=this._get(e,"shortYearCutoff");return t="string"!=typeof t?t:(new Date).getFullYear()%100+parseInt(t,10),{shortYearCutoff:t,dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames")}},_formatDate:function(e,t,i,s){t||(e.currentDay=e.selectedDay,e.currentMonth=e.selectedMonth,e.currentYear=e.selectedYear);var n=t?"object"==typeof t?t:this._daylightSavingAdjust(new Date(s,i,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return this.formatDate(this._get(e,"dateFormat"),n,this._getFormatConfig(e))}}),e.fn.datepicker=function(t){if(!this.length)return this;e.datepicker.initialized||(e(document).mousedown(e.datepicker._checkExternalClick),e.datepicker.initialized=!0),0===e("#"+e.datepicker._mainDivId).length&&e("body").append(e.datepicker.dpDiv);var i=Array.prototype.slice.call(arguments,1);return"string"!=typeof t||"isDisabled"!==t&&"getDate"!==t&&"widget"!==t?"option"===t&&2===arguments.length&&"string"==typeof arguments[1]?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(i)):this.each(function(){"string"==typeof t?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this].concat(i)):e.datepicker._attachDatepicker(this,t)}):e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(i))},e.datepicker=new n,e.datepicker.initialized=!1,e.datepicker.uuid=(new Date).getTime(),e.datepicker.version="1.11.4",e.datepicker,e.widget("ui.dialog",{version:"1.11.4",options:{appendTo:"body",autoOpen:!0,buttons:[],closeOnEscape:!0,closeText:"Close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(t){var i=e(this).css(t).offset().top;0>i&&e(this).css("top",t.top-i)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},sizeRelatedOptions:{buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},resizableRelatedOptions:{maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),this.options.title=this.options.title||this.originalTitle,this._createWrapper(),this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&e.fn.draggable&&this._makeDraggable(),this.options.resizable&&e.fn.resizable&&this._makeResizable(),this._isOpen=!1,this._trackFocus()},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var t=this.options.appendTo;return t&&(t.jquery||t.nodeType)?e(t):this.document.find(t||"body").eq(0)},_destroy:function(){var e,t=this.originalPosition;this._untrackInstance(),this._destroyOverlay(),this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach(),this.uiDialog.stop(!0,!0).remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),e=t.parent.children().eq(t.index),e.length&&e[0]!==this.element[0]?e.before(this.element):t.parent.append(this.element)},widget:function(){return this.uiDialog},disable:e.noop,enable:e.noop,close:function(t){var i,s=this;if(this._isOpen&&this._trigger("beforeClose",t)!==!1){if(this._isOpen=!1,this._focusedElement=null,this._destroyOverlay(),this._untrackInstance(),!this.opener.filter(":focusable").focus().length)try{i=this.document[0].activeElement,i&&"body"!==i.nodeName.toLowerCase()&&e(i).blur()}catch(n){}this._hide(this.uiDialog,this.options.hide,function(){s._trigger("close",t)})}},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(t,i){var s=!1,n=this.uiDialog.siblings(".ui-front:visible").map(function(){return+e(this).css("z-index")}).get(),a=Math.max.apply(null,n);return a>=+this.uiDialog.css("z-index")&&(this.uiDialog.css("z-index",a+1),s=!0),s&&!i&&this._trigger("focus",t),s},open:function(){var t=this;
return this._isOpen?(this._moveToTop()&&this._focusTabbable(),void 0):(this._isOpen=!0,this.opener=e(this.document[0].activeElement),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this.overlay&&this.overlay.css("z-index",this.uiDialog.css("z-index")-1),this._show(this.uiDialog,this.options.show,function(){t._focusTabbable(),t._trigger("focus")}),this._makeFocusTarget(),this._trigger("open"),void 0)},_focusTabbable:function(){var e=this._focusedElement;e||(e=this.element.find("[autofocus]")),e.length||(e=this.element.find(":tabbable")),e.length||(e=this.uiDialogButtonPane.find(":tabbable")),e.length||(e=this.uiDialogTitlebarClose.filter(":tabbable")),e.length||(e=this.uiDialog),e.eq(0).focus()},_keepFocus:function(t){function i(){var t=this.document[0].activeElement,i=this.uiDialog[0]===t||e.contains(this.uiDialog[0],t);i||this._focusTabbable()}t.preventDefault(),i.call(this),this._delay(i)},_createWrapper:function(){this.uiDialog=e("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._on(this.uiDialog,{keydown:function(t){if(this.options.closeOnEscape&&!t.isDefaultPrevented()&&t.keyCode&&t.keyCode===e.ui.keyCode.ESCAPE)return t.preventDefault(),this.close(t),void 0;if(t.keyCode===e.ui.keyCode.TAB&&!t.isDefaultPrevented()){var i=this.uiDialog.find(":tabbable"),s=i.filter(":first"),n=i.filter(":last");t.target!==n[0]&&t.target!==this.uiDialog[0]||t.shiftKey?t.target!==s[0]&&t.target!==this.uiDialog[0]||!t.shiftKey||(this._delay(function(){n.focus()}),t.preventDefault()):(this._delay(function(){s.focus()}),t.preventDefault())}},mousedown:function(e){this._moveToTop(e)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var t;this.uiDialogTitlebar=e("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog),this._on(this.uiDialogTitlebar,{mousedown:function(t){e(t.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.focus()}}),this.uiDialogTitlebarClose=e("<button type='button'></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:!1}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar),this._on(this.uiDialogTitlebarClose,{click:function(e){e.preventDefault(),this.close(e)}}),t=e("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar),this._title(t),this.uiDialog.attr({"aria-labelledby":t.attr("id")})},_title:function(e){this.options.title||e.html("&#160;"),e.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=e("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),this.uiButtonSet=e("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane),this._createButtons()},_createButtons:function(){var t=this,i=this.options.buttons;return this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),e.isEmptyObject(i)||e.isArray(i)&&!i.length?(this.uiDialog.removeClass("ui-dialog-buttons"),void 0):(e.each(i,function(i,s){var n,a;s=e.isFunction(s)?{click:s,text:i}:s,s=e.extend({type:"button"},s),n=s.click,s.click=function(){n.apply(t.element[0],arguments)},a={icons:s.icons,text:s.showText},delete s.icons,delete s.showText,e("<button></button>",s).button(a).appendTo(t.uiButtonSet)}),this.uiDialog.addClass("ui-dialog-buttons"),this.uiDialogButtonPane.appendTo(this.uiDialog),void 0)},_makeDraggable:function(){function t(e){return{position:e.position,offset:e.offset}}var i=this,s=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(s,n){e(this).addClass("ui-dialog-dragging"),i._blockFrames(),i._trigger("dragStart",s,t(n))},drag:function(e,s){i._trigger("drag",e,t(s))},stop:function(n,a){var o=a.offset.left-i.document.scrollLeft(),r=a.offset.top-i.document.scrollTop();s.position={my:"left top",at:"left"+(o>=0?"+":"")+o+" "+"top"+(r>=0?"+":"")+r,of:i.window},e(this).removeClass("ui-dialog-dragging"),i._unblockFrames(),i._trigger("dragStop",n,t(a))}})},_makeResizable:function(){function t(e){return{originalPosition:e.originalPosition,originalSize:e.originalSize,position:e.position,size:e.size}}var i=this,s=this.options,n=s.resizable,a=this.uiDialog.css("position"),o="string"==typeof n?n:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:s.maxWidth,maxHeight:s.maxHeight,minWidth:s.minWidth,minHeight:this._minHeight(),handles:o,start:function(s,n){e(this).addClass("ui-dialog-resizing"),i._blockFrames(),i._trigger("resizeStart",s,t(n))},resize:function(e,s){i._trigger("resize",e,t(s))},stop:function(n,a){var o=i.uiDialog.offset(),r=o.left-i.document.scrollLeft(),h=o.top-i.document.scrollTop();s.height=i.uiDialog.height(),s.width=i.uiDialog.width(),s.position={my:"left top",at:"left"+(r>=0?"+":"")+r+" "+"top"+(h>=0?"+":"")+h,of:i.window},e(this).removeClass("ui-dialog-resizing"),i._unblockFrames(),i._trigger("resizeStop",n,t(a))}}).css("position",a)},_trackFocus:function(){this._on(this.widget(),{focusin:function(t){this._makeFocusTarget(),this._focusedElement=e(t.target)}})},_makeFocusTarget:function(){this._untrackInstance(),this._trackingInstances().unshift(this)},_untrackInstance:function(){var t=this._trackingInstances(),i=e.inArray(this,t);-1!==i&&t.splice(i,1)},_trackingInstances:function(){var e=this.document.data("ui-dialog-instances");return e||(e=[],this.document.data("ui-dialog-instances",e)),e},_minHeight:function(){var e=this.options;return"auto"===e.height?e.minHeight:Math.min(e.minHeight,e.height)},_position:function(){var e=this.uiDialog.is(":visible");e||this.uiDialog.show(),this.uiDialog.position(this.options.position),e||this.uiDialog.hide()},_setOptions:function(t){var i=this,s=!1,n={};e.each(t,function(e,t){i._setOption(e,t),e in i.sizeRelatedOptions&&(s=!0),e in i.resizableRelatedOptions&&(n[e]=t)}),s&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",n)},_setOption:function(e,t){var i,s,n=this.uiDialog;"dialogClass"===e&&n.removeClass(this.options.dialogClass).addClass(t),"disabled"!==e&&(this._super(e,t),"appendTo"===e&&this.uiDialog.appendTo(this._appendTo()),"buttons"===e&&this._createButtons(),"closeText"===e&&this.uiDialogTitlebarClose.button({label:""+t}),"draggable"===e&&(i=n.is(":data(ui-draggable)"),i&&!t&&n.draggable("destroy"),!i&&t&&this._makeDraggable()),"position"===e&&this._position(),"resizable"===e&&(s=n.is(":data(ui-resizable)"),s&&!t&&n.resizable("destroy"),s&&"string"==typeof t&&n.resizable("option","handles",t),s||t===!1||this._makeResizable()),"title"===e&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var e,t,i,s=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),s.minWidth>s.width&&(s.width=s.minWidth),e=this.uiDialog.css({height:"auto",width:s.width}).outerHeight(),t=Math.max(0,s.minHeight-e),i="number"==typeof s.maxHeight?Math.max(0,s.maxHeight-e):"none","auto"===s.height?this.element.css({minHeight:t,maxHeight:i,height:"auto"}):this.element.height(Math.max(0,s.height-e)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var t=e(this);return e("<div>").css({position:"absolute",width:t.outerWidth(),height:t.outerHeight()}).appendTo(t.parent()).offset(t.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(t){return e(t.target).closest(".ui-dialog").length?!0:!!e(t.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var t=!0;this._delay(function(){t=!1}),this.document.data("ui-dialog-overlays")||this._on(this.document,{focusin:function(e){t||this._allowInteraction(e)||(e.preventDefault(),this._trackingInstances()[0]._focusTabbable())}}),this.overlay=e("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo()),this._on(this.overlay,{mousedown:"_keepFocus"}),this.document.data("ui-dialog-overlays",(this.document.data("ui-dialog-overlays")||0)+1)}},_destroyOverlay:function(){if(this.options.modal&&this.overlay){var e=this.document.data("ui-dialog-overlays")-1;e?this.document.data("ui-dialog-overlays",e):this.document.unbind("focusin").removeData("ui-dialog-overlays"),this.overlay.remove(),this.overlay=null}}}),e.widget("ui.progressbar",{version:"1.11.4",options:{max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min}),this.valueDiv=e("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.valueDiv.remove()},value:function(e){return void 0===e?this.options.value:(this.options.value=this._constrainedValue(e),this._refreshValue(),void 0)},_constrainedValue:function(e){return void 0===e&&(e=this.options.value),this.indeterminate=e===!1,"number"!=typeof e&&(e=0),this.indeterminate?!1:Math.min(this.options.max,Math.max(this.min,e))},_setOptions:function(e){var t=e.value;delete e.value,this._super(e),this.options.value=this._constrainedValue(t),this._refreshValue()},_setOption:function(e,t){"max"===e&&(t=Math.max(this.min,t)),"disabled"===e&&this.element.toggleClass("ui-state-disabled",!!t).attr("aria-disabled",t),this._super(e,t)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var t=this.options.value,i=this._percentage();this.valueDiv.toggle(this.indeterminate||t>this.min).toggleClass("ui-corner-right",t===this.options.max).width(i.toFixed(0)+"%"),this.element.toggleClass("ui-progressbar-indeterminate",this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=e("<div class='ui-progressbar-overlay'></div>").appendTo(this.valueDiv))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":t}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==t&&(this.oldValue=t,this._trigger("change")),t===this.options.max&&this._trigger("complete")}}),e.widget("ui.selectmenu",{version:"1.11.4",defaultElement:"<select>",options:{appendTo:null,disabled:null,icons:{button:"ui-icon-triangle-1-s"},position:{my:"left top",at:"left bottom",collision:"none"},width:null,change:null,close:null,focus:null,open:null,select:null},_create:function(){var e=this.element.uniqueId().attr("id");this.ids={element:e,button:e+"-button",menu:e+"-menu"},this._drawButton(),this._drawMenu(),this.options.disabled&&this.disable()},_drawButton:function(){var t=this;this.label=e("label[for='"+this.ids.element+"']").attr("for",this.ids.button),this._on(this.label,{click:function(e){this.button.focus(),e.preventDefault()}}),this.element.hide(),this.button=e("<span>",{"class":"ui-selectmenu-button ui-widget ui-state-default ui-corner-all",tabindex:this.options.disabled?-1:0,id:this.ids.button,role:"combobox","aria-expanded":"false","aria-autocomplete":"list","aria-owns":this.ids.menu,"aria-haspopup":"true"}).insertAfter(this.element),e("<span>",{"class":"ui-icon "+this.options.icons.button}).prependTo(this.button),this.buttonText=e("<span>",{"class":"ui-selectmenu-text"}).appendTo(this.button),this._setText(this.buttonText,this.element.find("option:selected").text()),this._resizeButton(),this._on(this.button,this._buttonEvents),this.button.one("focusin",function(){t.menuItems||t._refreshMenu()}),this._hoverable(this.button),this._focusable(this.button)},_drawMenu:function(){var t=this;this.menu=e("<ul>",{"aria-hidden":"true","aria-labelledby":this.ids.button,id:this.ids.menu}),this.menuWrap=e("<div>",{"class":"ui-selectmenu-menu ui-front"}).append(this.menu).appendTo(this._appendTo()),this.menuInstance=this.menu.menu({role:"listbox",select:function(e,i){e.preventDefault(),t._setSelection(),t._select(i.item.data("ui-selectmenu-item"),e)},focus:function(e,i){var s=i.item.data("ui-selectmenu-item");null!=t.focusIndex&&s.index!==t.focusIndex&&(t._trigger("focus",e,{item:s}),t.isOpen||t._select(s,e)),t.focusIndex=s.index,t.button.attr("aria-activedescendant",t.menuItems.eq(s.index).attr("id"))}}).menu("instance"),this.menu.addClass("ui-corner-bottom").removeClass("ui-corner-all"),this.menuInstance._off(this.menu,"mouseleave"),this.menuInstance._closeOnDocumentClick=function(){return!1},this.menuInstance._isDivider=function(){return!1}},refresh:function(){this._refreshMenu(),this._setText(this.buttonText,this._getSelectedItem().text()),this.options.width||this._resizeButton()},_refreshMenu:function(){this.menu.empty();var e,t=this.element.find("option");t.length&&(this._parseOptions(t),this._renderMenu(this.menu,this.items),this.menuInstance.refresh(),this.menuItems=this.menu.find("li").not(".ui-selectmenu-optgroup"),e=this._getSelectedItem(),this.menuInstance.focus(null,e),this._setAria(e.data("ui-selectmenu-item")),this._setOption("disabled",this.element.prop("disabled")))},open:function(e){this.options.disabled||(this.menuItems?(this.menu.find(".ui-state-focus").removeClass("ui-state-focus"),this.menuInstance.focus(null,this._getSelectedItem())):this._refreshMenu(),this.isOpen=!0,this._toggleAttr(),this._resizeMenu(),this._position(),this._on(this.document,this._documentClick),this._trigger("open",e))},_position:function(){this.menuWrap.position(e.extend({of:this.button},this.options.position))},close:function(e){this.isOpen&&(this.isOpen=!1,this._toggleAttr(),this.range=null,this._off(this.document),this._trigger("close",e))},widget:function(){return this.button},menuWidget:function(){return this.menu},_renderMenu:function(t,i){var s=this,n="";e.each(i,function(i,a){a.optgroup!==n&&(e("<li>",{"class":"ui-selectmenu-optgroup ui-menu-divider"+(a.element.parent("optgroup").prop("disabled")?" ui-state-disabled":""),text:a.optgroup}).appendTo(t),n=a.optgroup),s._renderItemData(t,a)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-selectmenu-item",t)},_renderItem:function(t,i){var s=e("<li>");return i.disabled&&s.addClass("ui-state-disabled"),this._setText(s,i.label),s.appendTo(t)},_setText:function(e,t){t?e.text(t):e.html("&#160;")},_move:function(e,t){var i,s,n=".ui-menu-item";this.isOpen?i=this.menuItems.eq(this.focusIndex):(i=this.menuItems.eq(this.element[0].selectedIndex),n+=":not(.ui-state-disabled)"),s="first"===e||"last"===e?i["first"===e?"prevAll":"nextAll"](n).eq(-1):i[e+"All"](n).eq(0),s.length&&this.menuInstance.focus(t,s)},_getSelectedItem:function(){return this.menuItems.eq(this.element[0].selectedIndex)},_toggle:function(e){this[this.isOpen?"close":"open"](e)},_setSelection:function(){var e;this.range&&(window.getSelection?(e=window.getSelection(),e.removeAllRanges(),e.addRange(this.range)):this.range.select(),this.button.focus())},_documentClick:{mousedown:function(t){this.isOpen&&(e(t.target).closest(".ui-selectmenu-menu, #"+this.ids.button).length||this.close(t))}},_buttonEvents:{mousedown:function(){var e;window.getSelection?(e=window.getSelection(),e.rangeCount&&(this.range=e.getRangeAt(0))):this.range=document.selection.createRange()},click:function(e){this._setSelection(),this._toggle(e)},keydown:function(t){var i=!0;switch(t.keyCode){case e.ui.keyCode.TAB:case e.ui.keyCode.ESCAPE:this.close(t),i=!1;break;case e.ui.keyCode.ENTER:this.isOpen&&this._selectFocusedItem(t);break;case e.ui.keyCode.UP:t.altKey?this._toggle(t):this._move("prev",t);break;case e.ui.keyCode.DOWN:t.altKey?this._toggle(t):this._move("next",t);break;case e.ui.keyCode.SPACE:this.isOpen?this._selectFocusedItem(t):this._toggle(t);break;case e.ui.keyCode.LEFT:this._move("prev",t);break;case e.ui.keyCode.RIGHT:this._move("next",t);break;case e.ui.keyCode.HOME:case e.ui.keyCode.PAGE_UP:this._move("first",t);break;case e.ui.keyCode.END:case e.ui.keyCode.PAGE_DOWN:this._move("last",t);break;default:this.menu.trigger(t),i=!1}i&&t.preventDefault()}},_selectFocusedItem:function(e){var t=this.menuItems.eq(this.focusIndex);t.hasClass("ui-state-disabled")||this._select(t.data("ui-selectmenu-item"),e)},_select:function(e,t){var i=this.element[0].selectedIndex;this.element[0].selectedIndex=e.index,this._setText(this.buttonText,e.label),this._setAria(e),this._trigger("select",t,{item:e}),e.index!==i&&this._trigger("change",t,{item:e}),this.close(t)},_setAria:function(e){var t=this.menuItems.eq(e.index).attr("id");this.button.attr({"aria-labelledby":t,"aria-activedescendant":t}),this.menu.attr("aria-activedescendant",t)},_setOption:function(e,t){"icons"===e&&this.button.find("span.ui-icon").removeClass(this.options.icons.button).addClass(t.button),this._super(e,t),"appendTo"===e&&this.menuWrap.appendTo(this._appendTo()),"disabled"===e&&(this.menuInstance.option("disabled",t),this.button.toggleClass("ui-state-disabled",t).attr("aria-disabled",t),this.element.prop("disabled",t),t?(this.button.attr("tabindex",-1),this.close()):this.button.attr("tabindex",0)),"width"===e&&this._resizeButton()},_appendTo:function(){var t=this.options.appendTo;return t&&(t=t.jquery||t.nodeType?e(t):this.document.find(t).eq(0)),t&&t[0]||(t=this.element.closest(".ui-front")),t.length||(t=this.document[0].body),t},_toggleAttr:function(){this.button.toggleClass("ui-corner-top",this.isOpen).toggleClass("ui-corner-all",!this.isOpen).attr("aria-expanded",this.isOpen),this.menuWrap.toggleClass("ui-selectmenu-open",this.isOpen),this.menu.attr("aria-hidden",!this.isOpen)},_resizeButton:function(){var e=this.options.width;e||(e=this.element.show().outerWidth(),this.element.hide()),this.button.outerWidth(e)},_resizeMenu:function(){this.menu.outerWidth(Math.max(this.button.outerWidth(),this.menu.width("").outerWidth()+1))},_getCreateOptions:function(){return{disabled:this.element.prop("disabled")}},_parseOptions:function(t){var i=[];t.each(function(t,s){var n=e(s),a=n.parent("optgroup");i.push({element:n,index:t,value:n.val(),label:n.text(),optgroup:a.attr("label")||"",disabled:a.prop("disabled")||n.prop("disabled")})}),this.items=i},_destroy:function(){this.menuWrap.remove(),this.button.remove(),this.element.show(),this.element.removeUniqueId(),this.label.attr("for",this.ids.element)}}),e.widget("ui.slider",e.ui.mouse,{version:"1.11.4",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this._calculateNewMax(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget"+" ui-widget-content"+" ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var t,i,s=this.options,n=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),a="<span class='ui-slider-handle ui-state-default ui-corner-all' tabindex='0'></span>",o=[];for(i=s.values&&s.values.length||1,n.length>i&&(n.slice(i).remove(),n=n.slice(0,i)),t=n.length;i>t;t++)o.push(a);this.handles=n.add(e(o.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(t){e(this).data("ui-slider-handle-index",t)})},_createRange:function(){var t=this.options,i="";t.range?(t.range===!0&&(t.values?t.values.length&&2!==t.values.length?t.values=[t.values[0],t.values[0]]:e.isArray(t.values)&&(t.values=t.values.slice(0)):t.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=e("<div></div>").appendTo(this.element),i="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(i+("min"===t.range||"max"===t.range?" ui-slider-range-"+t.range:""))):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){this._off(this.handles),this._on(this.handles,this._handleEvents),this._hoverable(this.handles),this._focusable(this.handles)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(t){var i,s,n,a,o,r,h,l,u=this,d=this.options;return d.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),i={x:t.pageX,y:t.pageY},s=this._normValueFromMouse(i),n=this._valueMax()-this._valueMin()+1,this.handles.each(function(t){var i=Math.abs(s-u.values(t));(n>i||n===i&&(t===u._lastChangedValue||u.values(t)===d.min))&&(n=i,a=e(this),o=t)}),r=this._start(t,o),r===!1?!1:(this._mouseSliding=!0,this._handleIndex=o,a.addClass("ui-state-active").focus(),h=a.offset(),l=!e(t.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=l?{left:0,top:0}:{left:t.pageX-h.left-a.width()/2,top:t.pageY-h.top-a.height()/2-(parseInt(a.css("borderTopWidth"),10)||0)-(parseInt(a.css("borderBottomWidth"),10)||0)+(parseInt(a.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(t,o,s),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(e){var t={x:e.pageX,y:e.pageY},i=this._normValueFromMouse(t);return this._slide(e,this._handleIndex,i),!1},_mouseStop:function(e){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(e,this._handleIndex),this._change(e,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(e){var t,i,s,n,a;return"horizontal"===this.orientation?(t=this.elementSize.width,i=e.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(t=this.elementSize.height,i=e.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),s=i/t,s>1&&(s=1),0>s&&(s=0),"vertical"===this.orientation&&(s=1-s),n=this._valueMax()-this._valueMin(),a=this._valueMin()+s*n,this._trimAlignValue(a)},_start:function(e,t){var i={handle:this.handles[t],value:this.value()};return this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._trigger("start",e,i)},_slide:function(e,t,i){var s,n,a;this.options.values&&this.options.values.length?(s=this.values(t?0:1),2===this.options.values.length&&this.options.range===!0&&(0===t&&i>s||1===t&&s>i)&&(i=s),i!==this.values(t)&&(n=this.values(),n[t]=i,a=this._trigger("slide",e,{handle:this.handles[t],value:i,values:n}),s=this.values(t?0:1),a!==!1&&this.values(t,i))):i!==this.value()&&(a=this._trigger("slide",e,{handle:this.handles[t],value:i}),a!==!1&&this.value(i))},_stop:function(e,t){var i={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._trigger("stop",e,i)},_change:function(e,t){if(!this._keySliding&&!this._mouseSliding){var i={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._lastChangedValue=t,this._trigger("change",e,i)}},value:function(e){return arguments.length?(this.options.value=this._trimAlignValue(e),this._refreshValue(),this._change(null,0),void 0):this._value()},values:function(t,i){var s,n,a;if(arguments.length>1)return this.options.values[t]=this._trimAlignValue(i),this._refreshValue(),this._change(null,t),void 0;if(!arguments.length)return this._values();if(!e.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(t):this.value();for(s=this.options.values,n=arguments[0],a=0;s.length>a;a+=1)s[a]=this._trimAlignValue(n[a]),this._change(null,a);this._refreshValue()},_setOption:function(t,i){var s,n=0;switch("range"===t&&this.options.range===!0&&("min"===i?(this.options.value=this._values(0),this.options.values=null):"max"===i&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),e.isArray(this.options.values)&&(n=this.options.values.length),"disabled"===t&&this.element.toggleClass("ui-state-disabled",!!i),this._super(t,i),t){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue(),this.handles.css("horizontal"===i?"bottom":"left","");break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),s=0;n>s;s+=1)this._change(null,s);this._animateOff=!1;break;case"step":case"min":case"max":this._animateOff=!0,this._calculateNewMax(),this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var e=this.options.value;return e=this._trimAlignValue(e)},_values:function(e){var t,i,s;if(arguments.length)return t=this.options.values[e],t=this._trimAlignValue(t);if(this.options.values&&this.options.values.length){for(i=this.options.values.slice(),s=0;i.length>s;s+=1)i[s]=this._trimAlignValue(i[s]);return i}return[]},_trimAlignValue:function(e){if(this._valueMin()>=e)return this._valueMin();if(e>=this._valueMax())return this._valueMax();var t=this.options.step>0?this.options.step:1,i=(e-this._valueMin())%t,s=e-i;return 2*Math.abs(i)>=t&&(s+=i>0?t:-t),parseFloat(s.toFixed(5))},_calculateNewMax:function(){var e=this.options.max,t=this._valueMin(),i=this.options.step,s=Math.floor(+(e-t).toFixed(this._precision())/i)*i;e=s+t,this.max=parseFloat(e.toFixed(this._precision()))},_precision:function(){var e=this._precisionOf(this.options.step);return null!==this.options.min&&(e=Math.max(e,this._precisionOf(this.options.min))),e},_precisionOf:function(e){var t=""+e,i=t.indexOf(".");return-1===i?0:t.length-i-1},_valueMin:function(){return this.options.min},_valueMax:function(){return this.max},_refreshValue:function(){var t,i,s,n,a,o=this.options.range,r=this.options,h=this,l=this._animateOff?!1:r.animate,u={};this.options.values&&this.options.values.length?this.handles.each(function(s){i=100*((h.values(s)-h._valueMin())/(h._valueMax()-h._valueMin())),u["horizontal"===h.orientation?"left":"bottom"]=i+"%",e(this).stop(1,1)[l?"animate":"css"](u,r.animate),h.options.range===!0&&("horizontal"===h.orientation?(0===s&&h.range.stop(1,1)[l?"animate":"css"]({left:i+"%"},r.animate),1===s&&h.range[l?"animate":"css"]({width:i-t+"%"},{queue:!1,duration:r.animate})):(0===s&&h.range.stop(1,1)[l?"animate":"css"]({bottom:i+"%"},r.animate),1===s&&h.range[l?"animate":"css"]({height:i-t+"%"},{queue:!1,duration:r.animate}))),t=i}):(s=this.value(),n=this._valueMin(),a=this._valueMax(),i=a!==n?100*((s-n)/(a-n)):0,u["horizontal"===this.orientation?"left":"bottom"]=i+"%",this.handle.stop(1,1)[l?"animate":"css"](u,r.animate),"min"===o&&"horizontal"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({width:i+"%"},r.animate),"max"===o&&"horizontal"===this.orientation&&this.range[l?"animate":"css"]({width:100-i+"%"},{queue:!1,duration:r.animate}),"min"===o&&"vertical"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({height:i+"%"},r.animate),"max"===o&&"vertical"===this.orientation&&this.range[l?"animate":"css"]({height:100-i+"%"},{queue:!1,duration:r.animate}))},_handleEvents:{keydown:function(t){var i,s,n,a,o=e(t.target).data("ui-slider-handle-index");switch(t.keyCode){case e.ui.keyCode.HOME:case e.ui.keyCode.END:case e.ui.keyCode.PAGE_UP:case e.ui.keyCode.PAGE_DOWN:case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(t.preventDefault(),!this._keySliding&&(this._keySliding=!0,e(t.target).addClass("ui-state-active"),i=this._start(t,o),i===!1))return}switch(a=this.options.step,s=n=this.options.values&&this.options.values.length?this.values(o):this.value(),t.keyCode){case e.ui.keyCode.HOME:n=this._valueMin();break;case e.ui.keyCode.END:n=this._valueMax();break;case e.ui.keyCode.PAGE_UP:n=this._trimAlignValue(s+(this._valueMax()-this._valueMin())/this.numPages);break;case e.ui.keyCode.PAGE_DOWN:n=this._trimAlignValue(s-(this._valueMax()-this._valueMin())/this.numPages);break;case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:if(s===this._valueMax())return;n=this._trimAlignValue(s+a);break;case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(s===this._valueMin())return;n=this._trimAlignValue(s-a)}this._slide(t,o,n)},keyup:function(t){var i=e(t.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(t,i),this._change(t,i),e(t.target).removeClass("ui-state-active"))}}}),e.widget("ui.spinner",{version:"1.11.4",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),""!==this.value()&&this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var t={},i=this.element;return e.each(["min","max","step"],function(e,s){var n=i.attr(s);void 0!==n&&n.length&&(t[s]=n)}),t},_events:{keydown:function(e){this._start(e)&&this._keydown(e)&&e.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(e){return this.cancelBlur?(delete this.cancelBlur,void 0):(this._stop(),this._refresh(),this.previous!==this.element.val()&&this._trigger("change",e),void 0)},mousewheel:function(e,t){if(t){if(!this.spinning&&!this._start(e))return!1;this._spin((t>0?1:-1)*this.options.step,e),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(e)},100),e.preventDefault()}},"mousedown .ui-spinner-button":function(t){function i(){var e=this.element[0]===this.document[0].activeElement;e||(this.element.focus(),this.previous=s,this._delay(function(){this.previous=s}))}var s;s=this.element[0]===this.document[0].activeElement?this.previous:this.element.val(),t.preventDefault(),i.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,i.call(this)}),this._start(t)!==!1&&this._repeat(null,e(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(t){return e(t.currentTarget).hasClass("ui-state-active")?this._start(t)===!1?!1:(this._repeat(null,e(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t),void 0):void 0},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var e=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton"),this.buttons=e.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all"),this.buttons.height()>Math.ceil(.5*e.height())&&e.height()>0&&e.height(e.height()),this.options.disabled&&this.disable()
},_keydown:function(t){var i=this.options,s=e.ui.keyCode;switch(t.keyCode){case s.UP:return this._repeat(null,1,t),!0;case s.DOWN:return this._repeat(null,-1,t),!0;case s.PAGE_UP:return this._repeat(null,i.page,t),!0;case s.PAGE_DOWN:return this._repeat(null,-i.page,t),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+this.options.icons.up+"'>&#9650;</span>"+"</a>"+"<a class='ui-spinner-button ui-spinner-down ui-corner-br'>"+"<span class='ui-icon "+this.options.icons.down+"'>&#9660;</span>"+"</a>"},_start:function(e){return this.spinning||this._trigger("start",e)!==!1?(this.counter||(this.counter=1),this.spinning=!0,!0):!1},_repeat:function(e,t,i){e=e||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,t,i)},e),this._spin(t*this.options.step,i)},_spin:function(e,t){var i=this.value()||0;this.counter||(this.counter=1),i=this._adjustValue(i+e*this._increment(this.counter)),this.spinning&&this._trigger("spin",t,{value:i})===!1||(this._value(i),this.counter++)},_increment:function(t){var i=this.options.incremental;return i?e.isFunction(i)?i(t):Math.floor(t*t*t/5e4-t*t/500+17*t/200+1):1},_precision:function(){var e=this._precisionOf(this.options.step);return null!==this.options.min&&(e=Math.max(e,this._precisionOf(this.options.min))),e},_precisionOf:function(e){var t=""+e,i=t.indexOf(".");return-1===i?0:t.length-i-1},_adjustValue:function(e){var t,i,s=this.options;return t=null!==s.min?s.min:0,i=e-t,i=Math.round(i/s.step)*s.step,e=t+i,e=parseFloat(e.toFixed(this._precision())),null!==s.max&&e>s.max?s.max:null!==s.min&&s.min>e?s.min:e},_stop:function(e){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",e))},_setOption:function(e,t){if("culture"===e||"numberFormat"===e){var i=this._parse(this.element.val());return this.options[e]=t,this.element.val(this._format(i)),void 0}("max"===e||"min"===e||"step"===e)&&"string"==typeof t&&(t=this._parse(t)),"icons"===e&&(this.buttons.first().find(".ui-icon").removeClass(this.options.icons.up).addClass(t.up),this.buttons.last().find(".ui-icon").removeClass(this.options.icons.down).addClass(t.down)),this._super(e,t),"disabled"===e&&(this.widget().toggleClass("ui-state-disabled",!!t),this.element.prop("disabled",!!t),this.buttons.button(t?"disable":"enable"))},_setOptions:h(function(e){this._super(e)}),_parse:function(e){return"string"==typeof e&&""!==e&&(e=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(e,10,this.options.culture):+e),""===e||isNaN(e)?null:e},_format:function(e){return""===e?"":window.Globalize&&this.options.numberFormat?Globalize.format(e,this.options.numberFormat,this.options.culture):e},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},isValid:function(){var e=this.value();return null===e?!1:e===this._adjustValue(e)},_value:function(e,t){var i;""!==e&&(i=this._parse(e),null!==i&&(t||(i=this._adjustValue(i)),e=this._format(i))),this.element.val(e),this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:h(function(e){this._stepUp(e)}),_stepUp:function(e){this._start()&&(this._spin((e||1)*this.options.step),this._stop())},stepDown:h(function(e){this._stepDown(e)}),_stepDown:function(e){this._start()&&(this._spin((e||1)*-this.options.step),this._stop())},pageUp:h(function(e){this._stepUp((e||1)*this.options.page)}),pageDown:h(function(e){this._stepDown((e||1)*this.options.page)}),value:function(e){return arguments.length?(h(this._value).call(this,e),void 0):this._parse(this.element.val())},widget:function(){return this.uiSpinner}}),e.widget("ui.tabs",{version:"1.11.4",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_isLocal:function(){var e=/#.*$/;return function(t){var i,s;t=t.cloneNode(!1),i=t.href.replace(e,""),s=location.href.replace(e,"");try{i=decodeURIComponent(i)}catch(n){}try{s=decodeURIComponent(s)}catch(n){}return t.hash.length>1&&i===s}}(),_create:function(){var t=this,i=this.options;this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",i.collapsible),this._processTabs(),i.active=this._initialActive(),e.isArray(i.disabled)&&(i.disabled=e.unique(i.disabled.concat(e.map(this.tabs.filter(".ui-state-disabled"),function(e){return t.tabs.index(e)}))).sort()),this.active=this.options.active!==!1&&this.anchors.length?this._findActive(i.active):e(),this._refresh(),this.active.length&&this.load(i.active)},_initialActive:function(){var t=this.options.active,i=this.options.collapsible,s=location.hash.substring(1);return null===t&&(s&&this.tabs.each(function(i,n){return e(n).attr("aria-controls")===s?(t=i,!1):void 0}),null===t&&(t=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),(null===t||-1===t)&&(t=this.tabs.length?0:!1)),t!==!1&&(t=this.tabs.index(this.tabs.eq(t)),-1===t&&(t=i?!1:0)),!i&&t===!1&&this.anchors.length&&(t=0),t},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):e()}},_tabKeydown:function(t){var i=e(this.document[0].activeElement).closest("li"),s=this.tabs.index(i),n=!0;if(!this._handlePageNav(t)){switch(t.keyCode){case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:s++;break;case e.ui.keyCode.UP:case e.ui.keyCode.LEFT:n=!1,s--;break;case e.ui.keyCode.END:s=this.anchors.length-1;break;case e.ui.keyCode.HOME:s=0;break;case e.ui.keyCode.SPACE:return t.preventDefault(),clearTimeout(this.activating),this._activate(s),void 0;case e.ui.keyCode.ENTER:return t.preventDefault(),clearTimeout(this.activating),this._activate(s===this.options.active?!1:s),void 0;default:return}t.preventDefault(),clearTimeout(this.activating),s=this._focusNextTab(s,n),t.ctrlKey||t.metaKey||(i.attr("aria-selected","false"),this.tabs.eq(s).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",s)},this.delay))}},_panelKeydown:function(t){this._handlePageNav(t)||t.ctrlKey&&t.keyCode===e.ui.keyCode.UP&&(t.preventDefault(),this.active.focus())},_handlePageNav:function(t){return t.altKey&&t.keyCode===e.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):t.altKey&&t.keyCode===e.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(t,i){function s(){return t>n&&(t=0),0>t&&(t=n),t}for(var n=this.tabs.length-1;-1!==e.inArray(s(),this.options.disabled);)t=i?t+1:t-1;return t},_focusNextTab:function(e,t){return e=this._findNextTab(e,t),this.tabs.eq(e).focus(),e},_setOption:function(e,t){return"active"===e?(this._activate(t),void 0):"disabled"===e?(this._setupDisabled(t),void 0):(this._super(e,t),"collapsible"===e&&(this.element.toggleClass("ui-tabs-collapsible",t),t||this.options.active!==!1||this._activate(0)),"event"===e&&this._setupEvents(t),"heightStyle"===e&&this._setupHeightStyle(t),void 0)},_sanitizeSelector:function(e){return e?e.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var t=this.options,i=this.tablist.children(":has(a[href])");t.disabled=e.map(i.filter(".ui-state-disabled"),function(e){return i.index(e)}),this._processTabs(),t.active!==!1&&this.anchors.length?this.active.length&&!e.contains(this.tablist[0],this.active[0])?this.tabs.length===t.disabled.length?(t.active=!1,this.active=e()):this._activate(this._findNextTab(Math.max(0,t.active-1),!1)):t.active=this.tabs.index(this.active):(t.active=!1,this.active=e()),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var t=this,i=this.tabs,s=this.anchors,n=this.panels;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist").delegate("> li","mousedown"+this.eventNamespace,function(t){e(this).is(".ui-state-disabled")&&t.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){e(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map(function(){return e("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=e(),this.anchors.each(function(i,s){var n,a,o,r=e(s).uniqueId().attr("id"),h=e(s).closest("li"),l=h.attr("aria-controls");t._isLocal(s)?(n=s.hash,o=n.substring(1),a=t.element.find(t._sanitizeSelector(n))):(o=h.attr("aria-controls")||e({}).uniqueId()[0].id,n="#"+o,a=t.element.find(n),a.length||(a=t._createPanel(o),a.insertAfter(t.panels[i-1]||t.tablist)),a.attr("aria-live","polite")),a.length&&(t.panels=t.panels.add(a)),l&&h.data("ui-tabs-aria-controls",l),h.attr({"aria-controls":o,"aria-labelledby":r}),a.attr("aria-labelledby",r)}),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel"),i&&(this._off(i.not(this.tabs)),this._off(s.not(this.anchors)),this._off(n.not(this.panels)))},_getList:function(){return this.tablist||this.element.find("ol,ul").eq(0)},_createPanel:function(t){return e("<div>").attr("id",t).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(t){e.isArray(t)&&(t.length?t.length===this.anchors.length&&(t=!0):t=!1);for(var i,s=0;i=this.tabs[s];s++)t===!0||-1!==e.inArray(s,t)?e(i).addClass("ui-state-disabled").attr("aria-disabled","true"):e(i).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=t},_setupEvents:function(t){var i={};t&&e.each(t.split(" "),function(e,t){i[t]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(!0,this.anchors,{click:function(e){e.preventDefault()}}),this._on(this.anchors,i),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(t){var i,s=this.element.parent();"fill"===t?(i=s.height(),i-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var t=e(this),s=t.css("position");"absolute"!==s&&"fixed"!==s&&(i-=t.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){i-=e(this).outerHeight(!0)}),this.panels.each(function(){e(this).height(Math.max(0,i-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")):"auto"===t&&(i=0,this.panels.each(function(){i=Math.max(i,e(this).height("").height())}).height(i))},_eventHandler:function(t){var i=this.options,s=this.active,n=e(t.currentTarget),a=n.closest("li"),o=a[0]===s[0],r=o&&i.collapsible,h=r?e():this._getPanelForTab(a),l=s.length?this._getPanelForTab(s):e(),u={oldTab:s,oldPanel:l,newTab:r?e():a,newPanel:h};t.preventDefault(),a.hasClass("ui-state-disabled")||a.hasClass("ui-tabs-loading")||this.running||o&&!i.collapsible||this._trigger("beforeActivate",t,u)===!1||(i.active=r?!1:this.tabs.index(a),this.active=o?e():a,this.xhr&&this.xhr.abort(),l.length||h.length||e.error("jQuery UI Tabs: Mismatching fragment identifier."),h.length&&this.load(this.tabs.index(a),t),this._toggle(t,u))},_toggle:function(t,i){function s(){a.running=!1,a._trigger("activate",t,i)}function n(){i.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),o.length&&a.options.show?a._show(o,a.options.show,s):(o.show(),s())}var a=this,o=i.newPanel,r=i.oldPanel;this.running=!0,r.length&&this.options.hide?this._hide(r,this.options.hide,function(){i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),n()}):(i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),r.hide(),n()),r.attr("aria-hidden","true"),i.oldTab.attr({"aria-selected":"false","aria-expanded":"false"}),o.length&&r.length?i.oldTab.attr("tabIndex",-1):o.length&&this.tabs.filter(function(){return 0===e(this).attr("tabIndex")}).attr("tabIndex",-1),o.attr("aria-hidden","false"),i.newTab.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_activate:function(t){var i,s=this._findActive(t);s[0]!==this.active[0]&&(s.length||(s=this.active),i=s.find(".ui-tabs-anchor")[0],this._eventHandler({target:i,currentTarget:i,preventDefault:e.noop}))},_findActive:function(t){return t===!1?e():this.tabs.eq(t)},_getIndex:function(e){return"string"==typeof e&&(e=this.anchors.index(this.anchors.filter("[href$='"+e+"']"))),e},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(),this.tablist.unbind(this.eventNamespace),this.tabs.add(this.panels).each(function(){e.data(this,"ui-tabs-destroy")?e(this).remove():e(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}),this.tabs.each(function(){var t=e(this),i=t.data("ui-tabs-aria-controls");i?t.attr("aria-controls",i).removeData("ui-tabs-aria-controls"):t.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(t){var i=this.options.disabled;i!==!1&&(void 0===t?i=!1:(t=this._getIndex(t),i=e.isArray(i)?e.map(i,function(e){return e!==t?e:null}):e.map(this.tabs,function(e,i){return i!==t?i:null})),this._setupDisabled(i))},disable:function(t){var i=this.options.disabled;if(i!==!0){if(void 0===t)i=!0;else{if(t=this._getIndex(t),-1!==e.inArray(t,i))return;i=e.isArray(i)?e.merge([t],i).sort():[t]}this._setupDisabled(i)}},load:function(t,i){t=this._getIndex(t);var s=this,n=this.tabs.eq(t),a=n.find(".ui-tabs-anchor"),o=this._getPanelForTab(n),r={tab:n,panel:o},h=function(e,t){"abort"===t&&s.panels.stop(!1,!0),n.removeClass("ui-tabs-loading"),o.removeAttr("aria-busy"),e===s.xhr&&delete s.xhr};this._isLocal(a[0])||(this.xhr=e.ajax(this._ajaxSettings(a,i,r)),this.xhr&&"canceled"!==this.xhr.statusText&&(n.addClass("ui-tabs-loading"),o.attr("aria-busy","true"),this.xhr.done(function(e,t,n){setTimeout(function(){o.html(e),s._trigger("load",i,r),h(n,t)},1)}).fail(function(e,t){setTimeout(function(){h(e,t)},1)})))},_ajaxSettings:function(t,i,s){var n=this;return{url:t.attr("href"),beforeSend:function(t,a){return n._trigger("beforeLoad",i,e.extend({jqXHR:t,ajaxSettings:a},s))}}},_getPanelForTab:function(t){var i=e(t).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+i))}}),e.widget("ui.tooltip",{version:"1.11.4",options:{content:function(){var t=e(this).attr("title")||"";return e("<a>").text(t).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_addDescribedBy:function(t,i){var s=(t.attr("aria-describedby")||"").split(/\s+/);s.push(i),t.data("ui-tooltip-id",i).attr("aria-describedby",e.trim(s.join(" ")))},_removeDescribedBy:function(t){var i=t.data("ui-tooltip-id"),s=(t.attr("aria-describedby")||"").split(/\s+/),n=e.inArray(i,s);-1!==n&&s.splice(n,1),t.removeData("ui-tooltip-id"),s=e.trim(s.join(" ")),s?t.attr("aria-describedby",s):t.removeAttr("aria-describedby")},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.options.disabled&&this._disable(),this.liveRegion=e("<div>").attr({role:"log","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body)},_setOption:function(t,i){var s=this;return"disabled"===t?(this[i?"_disable":"_enable"](),this.options[t]=i,void 0):(this._super(t,i),"content"===t&&e.each(this.tooltips,function(e,t){s._updateContent(t.element)}),void 0)},_disable:function(){var t=this;e.each(this.tooltips,function(i,s){var n=e.Event("blur");n.target=n.currentTarget=s.element[0],t.close(n,!0)}),this.element.find(this.options.items).addBack().each(function(){var t=e(this);t.is("[title]")&&t.data("ui-tooltip-title",t.attr("title")).removeAttr("title")})},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var t=e(this);t.data("ui-tooltip-title")&&t.attr("title",t.data("ui-tooltip-title"))})},open:function(t){var i=this,s=e(t?t.target:this.element).closest(this.options.items);s.length&&!s.data("ui-tooltip-id")&&(s.attr("title")&&s.data("ui-tooltip-title",s.attr("title")),s.data("ui-tooltip-open",!0),t&&"mouseover"===t.type&&s.parents().each(function(){var t,s=e(this);s.data("ui-tooltip-open")&&(t=e.Event("blur"),t.target=t.currentTarget=this,i.close(t,!0)),s.attr("title")&&(s.uniqueId(),i.parents[this.id]={element:this,title:s.attr("title")},s.attr("title",""))}),this._registerCloseHandlers(t,s),this._updateContent(s,t))},_updateContent:function(e,t){var i,s=this.options.content,n=this,a=t?t.type:null;return"string"==typeof s?this._open(t,e,s):(i=s.call(e[0],function(i){n._delay(function(){e.data("ui-tooltip-open")&&(t&&(t.type=a),this._open(t,e,i))})}),i&&this._open(t,e,i),void 0)},_open:function(t,i,s){function n(e){l.of=e,o.is(":hidden")||o.position(l)}var a,o,r,h,l=e.extend({},this.options.position);if(s){if(a=this._find(i))return a.tooltip.find(".ui-tooltip-content").html(s),void 0;i.is("[title]")&&(t&&"mouseover"===t.type?i.attr("title",""):i.removeAttr("title")),a=this._tooltip(i),o=a.tooltip,this._addDescribedBy(i,o.attr("id")),o.find(".ui-tooltip-content").html(s),this.liveRegion.children().hide(),s.clone?(h=s.clone(),h.removeAttr("id").find("[id]").removeAttr("id")):h=s,e("<div>").html(h).appendTo(this.liveRegion),this.options.track&&t&&/^mouse/.test(t.type)?(this._on(this.document,{mousemove:n}),n(t)):o.position(e.extend({of:i},this.options.position)),o.hide(),this._show(o,this.options.show),this.options.show&&this.options.show.delay&&(r=this.delayedShow=setInterval(function(){o.is(":visible")&&(n(l.of),clearInterval(r))},e.fx.interval)),this._trigger("open",t,{tooltip:o})}},_registerCloseHandlers:function(t,i){var s={keyup:function(t){if(t.keyCode===e.ui.keyCode.ESCAPE){var s=e.Event(t);s.currentTarget=i[0],this.close(s,!0)}}};i[0]!==this.element[0]&&(s.remove=function(){this._removeTooltip(this._find(i).tooltip)}),t&&"mouseover"!==t.type||(s.mouseleave="close"),t&&"focusin"!==t.type||(s.focusout="close"),this._on(!0,i,s)},close:function(t){var i,s=this,n=e(t?t.currentTarget:this.element),a=this._find(n);return a?(i=a.tooltip,a.closing||(clearInterval(this.delayedShow),n.data("ui-tooltip-title")&&!n.attr("title")&&n.attr("title",n.data("ui-tooltip-title")),this._removeDescribedBy(n),a.hiding=!0,i.stop(!0),this._hide(i,this.options.hide,function(){s._removeTooltip(e(this))}),n.removeData("ui-tooltip-open"),this._off(n,"mouseleave focusout keyup"),n[0]!==this.element[0]&&this._off(n,"remove"),this._off(this.document,"mousemove"),t&&"mouseleave"===t.type&&e.each(this.parents,function(t,i){e(i.element).attr("title",i.title),delete s.parents[t]}),a.closing=!0,this._trigger("close",t,{tooltip:i}),a.hiding||(a.closing=!1)),void 0):(n.removeData("ui-tooltip-open"),void 0)},_tooltip:function(t){var i=e("<div>").attr("role","tooltip").addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||"")),s=i.uniqueId().attr("id");return e("<div>").addClass("ui-tooltip-content").appendTo(i),i.appendTo(this.document[0].body),this.tooltips[s]={element:t,tooltip:i}},_find:function(e){var t=e.data("ui-tooltip-id");return t?this.tooltips[t]:null},_removeTooltip:function(e){e.remove(),delete this.tooltips[e.attr("id")]},_destroy:function(){var t=this;e.each(this.tooltips,function(i,s){var n=e.Event("blur"),a=s.element;n.target=n.currentTarget=a[0],t.close(n,!0),e("#"+i).remove(),a.data("ui-tooltip-title")&&(a.attr("title")||a.attr("title",a.data("ui-tooltip-title")),a.removeData("ui-tooltip-title"))}),this.liveRegion.remove()}});var y="ui-effects-",b=e;e.effects={effect:{}},function(e,t){function i(e,t,i){var s=d[t.type]||{};return null==e?i||!t.def?null:t.def:(e=s.floor?~~e:parseFloat(e),isNaN(e)?t.def:s.mod?(e+s.mod)%s.mod:0>e?0:e>s.max?s.max:e)}function s(i){var s=l(),n=s._rgba=[];return i=i.toLowerCase(),f(h,function(e,a){var o,r=a.re.exec(i),h=r&&a.parse(r),l=a.space||"rgba";return h?(o=s[l](h),s[u[l].cache]=o[u[l].cache],n=s._rgba=o._rgba,!1):t}),n.length?("0,0,0,0"===n.join()&&e.extend(n,a.transparent),s):a[i]}function n(e,t,i){return i=(i+1)%1,1>6*i?e+6*(t-e)*i:1>2*i?t:2>3*i?e+6*(t-e)*(2/3-i):e}var a,o="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",r=/^([\-+])=\s*(\d+\.?\d*)/,h=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[2.55*e[1],2.55*e[2],2.55*e[3],e[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(e){return[e[1],e[2]/100,e[3]/100,e[4]]}}],l=e.Color=function(t,i,s,n){return new e.Color.fn.parse(t,i,s,n)},u={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},d={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},c=l.support={},p=e("<p>")[0],f=e.each;p.style.cssText="background-color:rgba(1,1,1,.5)",c.rgba=p.style.backgroundColor.indexOf("rgba")>-1,f(u,function(e,t){t.cache="_"+e,t.props.alpha={idx:3,type:"percent",def:1}}),l.fn=e.extend(l.prototype,{parse:function(n,o,r,h){if(n===t)return this._rgba=[null,null,null,null],this;(n.jquery||n.nodeType)&&(n=e(n).css(o),o=t);var d=this,c=e.type(n),p=this._rgba=[];return o!==t&&(n=[n,o,r,h],c="array"),"string"===c?this.parse(s(n)||a._default):"array"===c?(f(u.rgba.props,function(e,t){p[t.idx]=i(n[t.idx],t)}),this):"object"===c?(n instanceof l?f(u,function(e,t){n[t.cache]&&(d[t.cache]=n[t.cache].slice())}):f(u,function(t,s){var a=s.cache;f(s.props,function(e,t){if(!d[a]&&s.to){if("alpha"===e||null==n[e])return;d[a]=s.to(d._rgba)}d[a][t.idx]=i(n[e],t,!0)}),d[a]&&0>e.inArray(null,d[a].slice(0,3))&&(d[a][3]=1,s.from&&(d._rgba=s.from(d[a])))}),this):t},is:function(e){var i=l(e),s=!0,n=this;return f(u,function(e,a){var o,r=i[a.cache];return r&&(o=n[a.cache]||a.to&&a.to(n._rgba)||[],f(a.props,function(e,i){return null!=r[i.idx]?s=r[i.idx]===o[i.idx]:t})),s}),s},_space:function(){var e=[],t=this;return f(u,function(i,s){t[s.cache]&&e.push(i)}),e.pop()},transition:function(e,t){var s=l(e),n=s._space(),a=u[n],o=0===this.alpha()?l("transparent"):this,r=o[a.cache]||a.to(o._rgba),h=r.slice();return s=s[a.cache],f(a.props,function(e,n){var a=n.idx,o=r[a],l=s[a],u=d[n.type]||{};null!==l&&(null===o?h[a]=l:(u.mod&&(l-o>u.mod/2?o+=u.mod:o-l>u.mod/2&&(o-=u.mod)),h[a]=i((l-o)*t+o,n)))}),this[n](h)},blend:function(t){if(1===this._rgba[3])return this;var i=this._rgba.slice(),s=i.pop(),n=l(t)._rgba;return l(e.map(i,function(e,t){return(1-s)*n[t]+s*e}))},toRgbaString:function(){var t="rgba(",i=e.map(this._rgba,function(e,t){return null==e?t>2?1:0:e});return 1===i[3]&&(i.pop(),t="rgb("),t+i.join()+")"},toHslaString:function(){var t="hsla(",i=e.map(this.hsla(),function(e,t){return null==e&&(e=t>2?1:0),t&&3>t&&(e=Math.round(100*e)+"%"),e});return 1===i[3]&&(i.pop(),t="hsl("),t+i.join()+")"},toHexString:function(t){var i=this._rgba.slice(),s=i.pop();return t&&i.push(~~(255*s)),"#"+e.map(i,function(e){return e=(e||0).toString(16),1===e.length?"0"+e:e}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),l.fn.parse.prototype=l.fn,u.hsla.to=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t,i,s=e[0]/255,n=e[1]/255,a=e[2]/255,o=e[3],r=Math.max(s,n,a),h=Math.min(s,n,a),l=r-h,u=r+h,d=.5*u;return t=h===r?0:s===r?60*(n-a)/l+360:n===r?60*(a-s)/l+120:60*(s-n)/l+240,i=0===l?0:.5>=d?l/u:l/(2-u),[Math.round(t)%360,i,d,null==o?1:o]},u.hsla.from=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t=e[0]/360,i=e[1],s=e[2],a=e[3],o=.5>=s?s*(1+i):s+i-s*i,r=2*s-o;return[Math.round(255*n(r,o,t+1/3)),Math.round(255*n(r,o,t)),Math.round(255*n(r,o,t-1/3)),a]},f(u,function(s,n){var a=n.props,o=n.cache,h=n.to,u=n.from;l.fn[s]=function(s){if(h&&!this[o]&&(this[o]=h(this._rgba)),s===t)return this[o].slice();var n,r=e.type(s),d="array"===r||"object"===r?s:arguments,c=this[o].slice();return f(a,function(e,t){var s=d["object"===r?e:t.idx];null==s&&(s=c[t.idx]),c[t.idx]=i(s,t)}),u?(n=l(u(c)),n[o]=c,n):l(c)},f(a,function(t,i){l.fn[t]||(l.fn[t]=function(n){var a,o=e.type(n),h="alpha"===t?this._hsla?"hsla":"rgba":s,l=this[h](),u=l[i.idx];return"undefined"===o?u:("function"===o&&(n=n.call(this,u),o=e.type(n)),null==n&&i.empty?this:("string"===o&&(a=r.exec(n),a&&(n=u+parseFloat(a[2])*("+"===a[1]?1:-1))),l[i.idx]=n,this[h](l)))})})}),l.hook=function(t){var i=t.split(" ");f(i,function(t,i){e.cssHooks[i]={set:function(t,n){var a,o,r="";if("transparent"!==n&&("string"!==e.type(n)||(a=s(n)))){if(n=l(a||n),!c.rgba&&1!==n._rgba[3]){for(o="backgroundColor"===i?t.parentNode:t;(""===r||"transparent"===r)&&o&&o.style;)try{r=e.css(o,"backgroundColor"),o=o.parentNode}catch(h){}n=n.blend(r&&"transparent"!==r?r:"_default")}n=n.toRgbaString()}try{t.style[i]=n}catch(h){}}},e.fx.step[i]=function(t){t.colorInit||(t.start=l(t.elem,i),t.end=l(t.end),t.colorInit=!0),e.cssHooks[i].set(t.elem,t.start.transition(t.end,t.pos))}})},l.hook(o),e.cssHooks.borderColor={expand:function(e){var t={};return f(["Top","Right","Bottom","Left"],function(i,s){t["border"+s+"Color"]=e}),t}},a=e.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(b),function(){function t(t){var i,s,n=t.ownerDocument.defaultView?t.ownerDocument.defaultView.getComputedStyle(t,null):t.currentStyle,a={};if(n&&n.length&&n[0]&&n[n[0]])for(s=n.length;s--;)i=n[s],"string"==typeof n[i]&&(a[e.camelCase(i)]=n[i]);else for(i in n)"string"==typeof n[i]&&(a[i]=n[i]);return a}function i(t,i){var s,a,o={};for(s in i)a=i[s],t[s]!==a&&(n[s]||(e.fx.step[s]||!isNaN(parseFloat(a)))&&(o[s]=a));return o}var s=["add","remove","toggle"],n={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};e.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(t,i){e.fx.step[i]=function(e){("none"!==e.end&&!e.setAttr||1===e.pos&&!e.setAttr)&&(b.style(e.elem,i,e.end),e.setAttr=!0)}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e.effects.animateClass=function(n,a,o,r){var h=e.speed(a,o,r);return this.queue(function(){var a,o=e(this),r=o.attr("class")||"",l=h.children?o.find("*").addBack():o;l=l.map(function(){var i=e(this);return{el:i,start:t(this)}}),a=function(){e.each(s,function(e,t){n[t]&&o[t+"Class"](n[t])})},a(),l=l.map(function(){return this.end=t(this.el[0]),this.diff=i(this.start,this.end),this}),o.attr("class",r),l=l.map(function(){var t=this,i=e.Deferred(),s=e.extend({},h,{queue:!1,complete:function(){i.resolve(t)}});return this.el.animate(this.diff,s),i.promise()}),e.when.apply(e,l.get()).done(function(){a(),e.each(arguments,function(){var t=this.el;e.each(this.diff,function(e){t.css(e,"")})}),h.complete.call(o[0])})})},e.fn.extend({addClass:function(t){return function(i,s,n,a){return s?e.effects.animateClass.call(this,{add:i},s,n,a):t.apply(this,arguments)}}(e.fn.addClass),removeClass:function(t){return function(i,s,n,a){return arguments.length>1?e.effects.animateClass.call(this,{remove:i},s,n,a):t.apply(this,arguments)}}(e.fn.removeClass),toggleClass:function(t){return function(i,s,n,a,o){return"boolean"==typeof s||void 0===s?n?e.effects.animateClass.call(this,s?{add:i}:{remove:i},n,a,o):t.apply(this,arguments):e.effects.animateClass.call(this,{toggle:i},s,n,a)}}(e.fn.toggleClass),switchClass:function(t,i,s,n,a){return e.effects.animateClass.call(this,{add:i,remove:t},s,n,a)}})}(),function(){function t(t,i,s,n){return e.isPlainObject(t)&&(i=t,t=t.effect),t={effect:t},null==i&&(i={}),e.isFunction(i)&&(n=i,s=null,i={}),("number"==typeof i||e.fx.speeds[i])&&(n=s,s=i,i={}),e.isFunction(s)&&(n=s,s=null),i&&e.extend(t,i),s=s||i.duration,t.duration=e.fx.off?0:"number"==typeof s?s:s in e.fx.speeds?e.fx.speeds[s]:e.fx.speeds._default,t.complete=n||i.complete,t}function i(t){return!t||"number"==typeof t||e.fx.speeds[t]?!0:"string"!=typeof t||e.effects.effect[t]?e.isFunction(t)?!0:"object"!=typeof t||t.effect?!1:!0:!0}e.extend(e.effects,{version:"1.11.4",save:function(e,t){for(var i=0;t.length>i;i++)null!==t[i]&&e.data(y+t[i],e[0].style[t[i]])},restore:function(e,t){var i,s;for(s=0;t.length>s;s++)null!==t[s]&&(i=e.data(y+t[s]),void 0===i&&(i=""),e.css(t[s],i))},setMode:function(e,t){return"toggle"===t&&(t=e.is(":hidden")?"show":"hide"),t},getBaseline:function(e,t){var i,s;switch(e[0]){case"top":i=0;break;case"middle":i=.5;break;case"bottom":i=1;break;default:i=e[0]/t.height}switch(e[1]){case"left":s=0;break;case"center":s=.5;break;case"right":s=1;break;default:s=e[1]/t.width}return{x:s,y:i}},createWrapper:function(t){if(t.parent().is(".ui-effects-wrapper"))return t.parent();var i={width:t.outerWidth(!0),height:t.outerHeight(!0),"float":t.css("float")},s=e("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),n={width:t.width(),height:t.height()},a=document.activeElement;try{a.id}catch(o){a=document.body}return t.wrap(s),(t[0]===a||e.contains(t[0],a))&&e(a).focus(),s=t.parent(),"static"===t.css("position")?(s.css({position:"relative"}),t.css({position:"relative"})):(e.extend(i,{position:t.css("position"),zIndex:t.css("z-index")}),e.each(["top","left","bottom","right"],function(e,s){i[s]=t.css(s),isNaN(parseInt(i[s],10))&&(i[s]="auto")}),t.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),t.css(n),s.css(i).show()},removeWrapper:function(t){var i=document.activeElement;
return t.parent().is(".ui-effects-wrapper")&&(t.parent().replaceWith(t),(t[0]===i||e.contains(t[0],i))&&e(i).focus()),t},setTransition:function(t,i,s,n){return n=n||{},e.each(i,function(e,i){var a=t.cssUnit(i);a[0]>0&&(n[i]=a[0]*s+a[1])}),n}}),e.fn.extend({effect:function(){function i(t){function i(){e.isFunction(a)&&a.call(n[0]),e.isFunction(t)&&t()}var n=e(this),a=s.complete,r=s.mode;(n.is(":hidden")?"hide"===r:"show"===r)?(n[r](),i()):o.call(n[0],s,i)}var s=t.apply(this,arguments),n=s.mode,a=s.queue,o=e.effects.effect[s.effect];return e.fx.off||!o?n?this[n](s.duration,s.complete):this.each(function(){s.complete&&s.complete.call(this)}):a===!1?this.each(i):this.queue(a||"fx",i)},show:function(e){return function(s){if(i(s))return e.apply(this,arguments);var n=t.apply(this,arguments);return n.mode="show",this.effect.call(this,n)}}(e.fn.show),hide:function(e){return function(s){if(i(s))return e.apply(this,arguments);var n=t.apply(this,arguments);return n.mode="hide",this.effect.call(this,n)}}(e.fn.hide),toggle:function(e){return function(s){if(i(s)||"boolean"==typeof s)return e.apply(this,arguments);var n=t.apply(this,arguments);return n.mode="toggle",this.effect.call(this,n)}}(e.fn.toggle),cssUnit:function(t){var i=this.css(t),s=[];return e.each(["em","px","%","pt"],function(e,t){i.indexOf(t)>0&&(s=[parseFloat(i),t])}),s}})}(),function(){var t={};e.each(["Quad","Cubic","Quart","Quint","Expo"],function(e,i){t[i]=function(t){return Math.pow(t,e+2)}}),e.extend(t,{Sine:function(e){return 1-Math.cos(e*Math.PI/2)},Circ:function(e){return 1-Math.sqrt(1-e*e)},Elastic:function(e){return 0===e||1===e?e:-Math.pow(2,8*(e-1))*Math.sin((80*(e-1)-7.5)*Math.PI/15)},Back:function(e){return e*e*(3*e-2)},Bounce:function(e){for(var t,i=4;((t=Math.pow(2,--i))-1)/11>e;);return 1/Math.pow(4,3-i)-7.5625*Math.pow((3*t-2)/22-e,2)}}),e.each(t,function(t,i){e.easing["easeIn"+t]=i,e.easing["easeOut"+t]=function(e){return 1-i(1-e)},e.easing["easeInOut"+t]=function(e){return.5>e?i(2*e)/2:1-i(-2*e+2)/2}})}(),e.effects,e.effects.effect.blind=function(t,i){var s,n,a,o=e(this),r=/up|down|vertical/,h=/up|left|vertical|horizontal/,l=["position","top","bottom","left","right","height","width"],u=e.effects.setMode(o,t.mode||"hide"),d=t.direction||"up",c=r.test(d),p=c?"height":"width",f=c?"top":"left",m=h.test(d),g={},v="show"===u;o.parent().is(".ui-effects-wrapper")?e.effects.save(o.parent(),l):e.effects.save(o,l),o.show(),s=e.effects.createWrapper(o).css({overflow:"hidden"}),n=s[p](),a=parseFloat(s.css(f))||0,g[p]=v?n:0,m||(o.css(c?"bottom":"right",0).css(c?"top":"left","auto").css({position:"absolute"}),g[f]=v?a:n+a),v&&(s.css(p,0),m||s.css(f,a+n)),s.animate(g,{duration:t.duration,easing:t.easing,queue:!1,complete:function(){"hide"===u&&o.hide(),e.effects.restore(o,l),e.effects.removeWrapper(o),i()}})},e.effects.effect.bounce=function(t,i){var s,n,a,o=e(this),r=["position","top","bottom","left","right","height","width"],h=e.effects.setMode(o,t.mode||"effect"),l="hide"===h,u="show"===h,d=t.direction||"up",c=t.distance,p=t.times||5,f=2*p+(u||l?1:0),m=t.duration/f,g=t.easing,v="up"===d||"down"===d?"top":"left",y="up"===d||"left"===d,b=o.queue(),_=b.length;for((u||l)&&r.push("opacity"),e.effects.save(o,r),o.show(),e.effects.createWrapper(o),c||(c=o["top"===v?"outerHeight":"outerWidth"]()/3),u&&(a={opacity:1},a[v]=0,o.css("opacity",0).css(v,y?2*-c:2*c).animate(a,m,g)),l&&(c/=Math.pow(2,p-1)),a={},a[v]=0,s=0;p>s;s++)n={},n[v]=(y?"-=":"+=")+c,o.animate(n,m,g).animate(a,m,g),c=l?2*c:c/2;l&&(n={opacity:0},n[v]=(y?"-=":"+=")+c,o.animate(n,m,g)),o.queue(function(){l&&o.hide(),e.effects.restore(o,r),e.effects.removeWrapper(o),i()}),_>1&&b.splice.apply(b,[1,0].concat(b.splice(_,f+1))),o.dequeue()},e.effects.effect.clip=function(t,i){var s,n,a,o=e(this),r=["position","top","bottom","left","right","height","width"],h=e.effects.setMode(o,t.mode||"hide"),l="show"===h,u=t.direction||"vertical",d="vertical"===u,c=d?"height":"width",p=d?"top":"left",f={};e.effects.save(o,r),o.show(),s=e.effects.createWrapper(o).css({overflow:"hidden"}),n="IMG"===o[0].tagName?s:o,a=n[c](),l&&(n.css(c,0),n.css(p,a/2)),f[c]=l?a:0,f[p]=l?0:a/2,n.animate(f,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){l||o.hide(),e.effects.restore(o,r),e.effects.removeWrapper(o),i()}})},e.effects.effect.drop=function(t,i){var s,n=e(this),a=["position","top","bottom","left","right","opacity","height","width"],o=e.effects.setMode(n,t.mode||"hide"),r="show"===o,h=t.direction||"left",l="up"===h||"down"===h?"top":"left",u="up"===h||"left"===h?"pos":"neg",d={opacity:r?1:0};e.effects.save(n,a),n.show(),e.effects.createWrapper(n),s=t.distance||n["top"===l?"outerHeight":"outerWidth"](!0)/2,r&&n.css("opacity",0).css(l,"pos"===u?-s:s),d[l]=(r?"pos"===u?"+=":"-=":"pos"===u?"-=":"+=")+s,n.animate(d,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===o&&n.hide(),e.effects.restore(n,a),e.effects.removeWrapper(n),i()}})},e.effects.effect.explode=function(t,i){function s(){b.push(this),b.length===d*c&&n()}function n(){p.css({visibility:"visible"}),e(b).remove(),m||p.hide(),i()}var a,o,r,h,l,u,d=t.pieces?Math.round(Math.sqrt(t.pieces)):3,c=d,p=e(this),f=e.effects.setMode(p,t.mode||"hide"),m="show"===f,g=p.show().css("visibility","hidden").offset(),v=Math.ceil(p.outerWidth()/c),y=Math.ceil(p.outerHeight()/d),b=[];for(a=0;d>a;a++)for(h=g.top+a*y,u=a-(d-1)/2,o=0;c>o;o++)r=g.left+o*v,l=o-(c-1)/2,p.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-o*v,top:-a*y}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:v,height:y,left:r+(m?l*v:0),top:h+(m?u*y:0),opacity:m?0:1}).animate({left:r+(m?0:l*v),top:h+(m?0:u*y),opacity:m?1:0},t.duration||500,t.easing,s)},e.effects.effect.fade=function(t,i){var s=e(this),n=e.effects.setMode(s,t.mode||"toggle");s.animate({opacity:n},{queue:!1,duration:t.duration,easing:t.easing,complete:i})},e.effects.effect.fold=function(t,i){var s,n,a=e(this),o=["position","top","bottom","left","right","height","width"],r=e.effects.setMode(a,t.mode||"hide"),h="show"===r,l="hide"===r,u=t.size||15,d=/([0-9]+)%/.exec(u),c=!!t.horizFirst,p=h!==c,f=p?["width","height"]:["height","width"],m=t.duration/2,g={},v={};e.effects.save(a,o),a.show(),s=e.effects.createWrapper(a).css({overflow:"hidden"}),n=p?[s.width(),s.height()]:[s.height(),s.width()],d&&(u=parseInt(d[1],10)/100*n[l?0:1]),h&&s.css(c?{height:0,width:u}:{height:u,width:0}),g[f[0]]=h?n[0]:u,v[f[1]]=h?n[1]:0,s.animate(g,m,t.easing).animate(v,m,t.easing,function(){l&&a.hide(),e.effects.restore(a,o),e.effects.removeWrapper(a),i()})},e.effects.effect.highlight=function(t,i){var s=e(this),n=["backgroundImage","backgroundColor","opacity"],a=e.effects.setMode(s,t.mode||"show"),o={backgroundColor:s.css("backgroundColor")};"hide"===a&&(o.opacity=0),e.effects.save(s,n),s.show().css({backgroundImage:"none",backgroundColor:t.color||"#ffff99"}).animate(o,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===a&&s.hide(),e.effects.restore(s,n),i()}})},e.effects.effect.size=function(t,i){var s,n,a,o=e(this),r=["position","top","bottom","left","right","width","height","overflow","opacity"],h=["position","top","bottom","left","right","overflow","opacity"],l=["width","height","overflow"],u=["fontSize"],d=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],c=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],p=e.effects.setMode(o,t.mode||"effect"),f=t.restore||"effect"!==p,m=t.scale||"both",g=t.origin||["middle","center"],v=o.css("position"),y=f?r:h,b={height:0,width:0,outerHeight:0,outerWidth:0};"show"===p&&o.show(),s={height:o.height(),width:o.width(),outerHeight:o.outerHeight(),outerWidth:o.outerWidth()},"toggle"===t.mode&&"show"===p?(o.from=t.to||b,o.to=t.from||s):(o.from=t.from||("show"===p?b:s),o.to=t.to||("hide"===p?b:s)),a={from:{y:o.from.height/s.height,x:o.from.width/s.width},to:{y:o.to.height/s.height,x:o.to.width/s.width}},("box"===m||"both"===m)&&(a.from.y!==a.to.y&&(y=y.concat(d),o.from=e.effects.setTransition(o,d,a.from.y,o.from),o.to=e.effects.setTransition(o,d,a.to.y,o.to)),a.from.x!==a.to.x&&(y=y.concat(c),o.from=e.effects.setTransition(o,c,a.from.x,o.from),o.to=e.effects.setTransition(o,c,a.to.x,o.to))),("content"===m||"both"===m)&&a.from.y!==a.to.y&&(y=y.concat(u).concat(l),o.from=e.effects.setTransition(o,u,a.from.y,o.from),o.to=e.effects.setTransition(o,u,a.to.y,o.to)),e.effects.save(o,y),o.show(),e.effects.createWrapper(o),o.css("overflow","hidden").css(o.from),g&&(n=e.effects.getBaseline(g,s),o.from.top=(s.outerHeight-o.outerHeight())*n.y,o.from.left=(s.outerWidth-o.outerWidth())*n.x,o.to.top=(s.outerHeight-o.to.outerHeight)*n.y,o.to.left=(s.outerWidth-o.to.outerWidth)*n.x),o.css(o.from),("content"===m||"both"===m)&&(d=d.concat(["marginTop","marginBottom"]).concat(u),c=c.concat(["marginLeft","marginRight"]),l=r.concat(d).concat(c),o.find("*[width]").each(function(){var i=e(this),s={height:i.height(),width:i.width(),outerHeight:i.outerHeight(),outerWidth:i.outerWidth()};f&&e.effects.save(i,l),i.from={height:s.height*a.from.y,width:s.width*a.from.x,outerHeight:s.outerHeight*a.from.y,outerWidth:s.outerWidth*a.from.x},i.to={height:s.height*a.to.y,width:s.width*a.to.x,outerHeight:s.height*a.to.y,outerWidth:s.width*a.to.x},a.from.y!==a.to.y&&(i.from=e.effects.setTransition(i,d,a.from.y,i.from),i.to=e.effects.setTransition(i,d,a.to.y,i.to)),a.from.x!==a.to.x&&(i.from=e.effects.setTransition(i,c,a.from.x,i.from),i.to=e.effects.setTransition(i,c,a.to.x,i.to)),i.css(i.from),i.animate(i.to,t.duration,t.easing,function(){f&&e.effects.restore(i,l)})})),o.animate(o.to,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){0===o.to.opacity&&o.css("opacity",o.from.opacity),"hide"===p&&o.hide(),e.effects.restore(o,y),f||("static"===v?o.css({position:"relative",top:o.to.top,left:o.to.left}):e.each(["top","left"],function(e,t){o.css(t,function(t,i){var s=parseInt(i,10),n=e?o.to.left:o.to.top;return"auto"===i?n+"px":s+n+"px"})})),e.effects.removeWrapper(o),i()}})},e.effects.effect.scale=function(t,i){var s=e(this),n=e.extend(!0,{},t),a=e.effects.setMode(s,t.mode||"effect"),o=parseInt(t.percent,10)||(0===parseInt(t.percent,10)?0:"hide"===a?0:100),r=t.direction||"both",h=t.origin,l={height:s.height(),width:s.width(),outerHeight:s.outerHeight(),outerWidth:s.outerWidth()},u={y:"horizontal"!==r?o/100:1,x:"vertical"!==r?o/100:1};n.effect="size",n.queue=!1,n.complete=i,"effect"!==a&&(n.origin=h||["middle","center"],n.restore=!0),n.from=t.from||("show"===a?{height:0,width:0,outerHeight:0,outerWidth:0}:l),n.to={height:l.height*u.y,width:l.width*u.x,outerHeight:l.outerHeight*u.y,outerWidth:l.outerWidth*u.x},n.fade&&("show"===a&&(n.from.opacity=0,n.to.opacity=1),"hide"===a&&(n.from.opacity=1,n.to.opacity=0)),s.effect(n)},e.effects.effect.puff=function(t,i){var s=e(this),n=e.effects.setMode(s,t.mode||"hide"),a="hide"===n,o=parseInt(t.percent,10)||150,r=o/100,h={height:s.height(),width:s.width(),outerHeight:s.outerHeight(),outerWidth:s.outerWidth()};e.extend(t,{effect:"scale",queue:!1,fade:!0,mode:n,complete:i,percent:a?o:100,from:a?h:{height:h.height*r,width:h.width*r,outerHeight:h.outerHeight*r,outerWidth:h.outerWidth*r}}),s.effect(t)},e.effects.effect.pulsate=function(t,i){var s,n=e(this),a=e.effects.setMode(n,t.mode||"show"),o="show"===a,r="hide"===a,h=o||"hide"===a,l=2*(t.times||5)+(h?1:0),u=t.duration/l,d=0,c=n.queue(),p=c.length;for((o||!n.is(":visible"))&&(n.css("opacity",0).show(),d=1),s=1;l>s;s++)n.animate({opacity:d},u,t.easing),d=1-d;n.animate({opacity:d},u,t.easing),n.queue(function(){r&&n.hide(),i()}),p>1&&c.splice.apply(c,[1,0].concat(c.splice(p,l+1))),n.dequeue()},e.effects.effect.shake=function(t,i){var s,n=e(this),a=["position","top","bottom","left","right","height","width"],o=e.effects.setMode(n,t.mode||"effect"),r=t.direction||"left",h=t.distance||20,l=t.times||3,u=2*l+1,d=Math.round(t.duration/u),c="up"===r||"down"===r?"top":"left",p="up"===r||"left"===r,f={},m={},g={},v=n.queue(),y=v.length;for(e.effects.save(n,a),n.show(),e.effects.createWrapper(n),f[c]=(p?"-=":"+=")+h,m[c]=(p?"+=":"-=")+2*h,g[c]=(p?"-=":"+=")+2*h,n.animate(f,d,t.easing),s=1;l>s;s++)n.animate(m,d,t.easing).animate(g,d,t.easing);n.animate(m,d,t.easing).animate(f,d/2,t.easing).queue(function(){"hide"===o&&n.hide(),e.effects.restore(n,a),e.effects.removeWrapper(n),i()}),y>1&&v.splice.apply(v,[1,0].concat(v.splice(y,u+1))),n.dequeue()},e.effects.effect.slide=function(t,i){var s,n=e(this),a=["position","top","bottom","left","right","width","height"],o=e.effects.setMode(n,t.mode||"show"),r="show"===o,h=t.direction||"left",l="up"===h||"down"===h?"top":"left",u="up"===h||"left"===h,d={};e.effects.save(n,a),n.show(),s=t.distance||n["top"===l?"outerHeight":"outerWidth"](!0),e.effects.createWrapper(n).css({overflow:"hidden"}),r&&n.css(l,u?isNaN(s)?"-"+s:-s:s),d[l]=(r?u?"+=":"-=":u?"-=":"+=")+s,n.animate(d,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){"hide"===o&&n.hide(),e.effects.restore(n,a),e.effects.removeWrapper(n),i()}})},e.effects.effect.transfer=function(t,i){var s=e(this),n=e(t.to),a="fixed"===n.css("position"),o=e("body"),r=a?o.scrollTop():0,h=a?o.scrollLeft():0,l=n.offset(),u={top:l.top-r,left:l.left-h,height:n.innerHeight(),width:n.innerWidth()},d=s.offset(),c=e("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(t.className).css({top:d.top-r,left:d.left-h,height:s.innerHeight(),width:s.innerWidth(),position:a?"fixed":"absolute"}).animate(u,t.duration,t.easing,function(){c.remove(),i()})}});/*!
 * Bootstrap v3.3.7 (http://getbootstrap.com)
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under the MIT license
 */
if("undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");+function(a){"use strict";var b=a.fn.jquery.split(" ")[0].split(".");if(b[0]<2&&b[1]<9||1==b[0]&&9==b[1]&&b[2]<1||b[0]>3)throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher, but lower than version 4")}(jQuery),+function(a){"use strict";function b(){var a=document.createElement("bootstrap"),b={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var c in b)if(void 0!==a.style[c])return{end:b[c]};return!1}a.fn.emulateTransitionEnd=function(b){var c=!1,d=this;a(this).one("bsTransitionEnd",function(){c=!0});var e=function(){c||a(d).trigger(a.support.transition.end)};return setTimeout(e,b),this},a(function(){a.support.transition=b(),a.support.transition&&(a.event.special.bsTransitionEnd={bindType:a.support.transition.end,delegateType:a.support.transition.end,handle:function(b){if(a(b.target).is(this))return b.handleObj.handler.apply(this,arguments)}})})}(jQuery),+function(a){"use strict";function b(b){return this.each(function(){var c=a(this),e=c.data("bs.alert");e||c.data("bs.alert",e=new d(this)),"string"==typeof b&&e[b].call(c)})}var c='[data-dismiss="alert"]',d=function(b){a(b).on("click",c,this.close)};d.VERSION="3.3.7",d.TRANSITION_DURATION=150,d.prototype.close=function(b){function c(){g.detach().trigger("closed.bs.alert").remove()}var e=a(this),f=e.attr("data-target");f||(f=e.attr("href"),f=f&&f.replace(/.*(?=#[^\s]*$)/,""));var g=a("#"===f?[]:f);b&&b.preventDefault(),g.length||(g=e.closest(".alert")),g.trigger(b=a.Event("close.bs.alert")),b.isDefaultPrevented()||(g.removeClass("in"),a.support.transition&&g.hasClass("fade")?g.one("bsTransitionEnd",c).emulateTransitionEnd(d.TRANSITION_DURATION):c())};var e=a.fn.alert;a.fn.alert=b,a.fn.alert.Constructor=d,a.fn.alert.noConflict=function(){return a.fn.alert=e,this},a(document).on("click.bs.alert.data-api",c,d.prototype.close)}(jQuery),+function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.button"),f="object"==typeof b&&b;e||d.data("bs.button",e=new c(this,f)),"toggle"==b?e.toggle():b&&e.setState(b)})}var c=function(b,d){this.$element=a(b),this.options=a.extend({},c.DEFAULTS,d),this.isLoading=!1};c.VERSION="3.3.7",c.DEFAULTS={loadingText:"loading..."},c.prototype.setState=function(b){var c="disabled",d=this.$element,e=d.is("input")?"val":"html",f=d.data();b+="Text",null==f.resetText&&d.data("resetText",d[e]()),setTimeout(a.proxy(function(){d[e](null==f[b]?this.options[b]:f[b]),"loadingText"==b?(this.isLoading=!0,d.addClass(c).attr(c,c).prop(c,!0)):this.isLoading&&(this.isLoading=!1,d.removeClass(c).removeAttr(c).prop(c,!1))},this),0)},c.prototype.toggle=function(){var a=!0,b=this.$element.closest('[data-toggle="buttons"]');if(b.length){var c=this.$element.find("input");"radio"==c.prop("type")?(c.prop("checked")&&(a=!1),b.find(".active").removeClass("active"),this.$element.addClass("active")):"checkbox"==c.prop("type")&&(c.prop("checked")!==this.$element.hasClass("active")&&(a=!1),this.$element.toggleClass("active")),c.prop("checked",this.$element.hasClass("active")),a&&c.trigger("change")}else this.$element.attr("aria-pressed",!this.$element.hasClass("active")),this.$element.toggleClass("active")};var d=a.fn.button;a.fn.button=b,a.fn.button.Constructor=c,a.fn.button.noConflict=function(){return a.fn.button=d,this},a(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(c){var d=a(c.target).closest(".btn");b.call(d,"toggle"),a(c.target).is('input[type="radio"], input[type="checkbox"]')||(c.preventDefault(),d.is("input,button")?d.trigger("focus"):d.find("input:visible,button:visible").first().trigger("focus"))}).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',function(b){a(b.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(b.type))})}(jQuery),+function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.carousel"),f=a.extend({},c.DEFAULTS,d.data(),"object"==typeof b&&b),g="string"==typeof b?b:f.slide;e||d.data("bs.carousel",e=new c(this,f)),"number"==typeof b?e.to(b):g?e[g]():f.interval&&e.pause().cycle()})}var c=function(b,c){this.$element=a(b),this.$indicators=this.$element.find(".carousel-indicators"),this.options=c,this.paused=null,this.sliding=null,this.interval=null,this.$active=null,this.$items=null,this.options.keyboard&&this.$element.on("keydown.bs.carousel",a.proxy(this.keydown,this)),"hover"==this.options.pause&&!("ontouchstart"in document.documentElement)&&this.$element.on("mouseenter.bs.carousel",a.proxy(this.pause,this)).on("mouseleave.bs.carousel",a.proxy(this.cycle,this))};c.VERSION="3.3.7",c.TRANSITION_DURATION=600,c.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0},c.prototype.keydown=function(a){if(!/input|textarea/i.test(a.target.tagName)){switch(a.which){case 37:this.prev();break;case 39:this.next();break;default:return}a.preventDefault()}},c.prototype.cycle=function(b){return b||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(a.proxy(this.next,this),this.options.interval)),this},c.prototype.getItemIndex=function(a){return this.$items=a.parent().children(".item"),this.$items.index(a||this.$active)},c.prototype.getItemForDirection=function(a,b){var c=this.getItemIndex(b),d="prev"==a&&0===c||"next"==a&&c==this.$items.length-1;if(d&&!this.options.wrap)return b;var e="prev"==a?-1:1,f=(c+e)%this.$items.length;return this.$items.eq(f)},c.prototype.to=function(a){var b=this,c=this.getItemIndex(this.$active=this.$element.find(".item.active"));if(!(a>this.$items.length-1||a<0))return this.sliding?this.$element.one("slid.bs.carousel",function(){b.to(a)}):c==a?this.pause().cycle():this.slide(a>c?"next":"prev",this.$items.eq(a))},c.prototype.pause=function(b){return b||(this.paused=!0),this.$element.find(".next, .prev").length&&a.support.transition&&(this.$element.trigger(a.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},c.prototype.next=function(){if(!this.sliding)return this.slide("next")},c.prototype.prev=function(){if(!this.sliding)return this.slide("prev")},c.prototype.slide=function(b,d){var e=this.$element.find(".item.active"),f=d||this.getItemForDirection(b,e),g=this.interval,h="next"==b?"left":"right",i=this;if(f.hasClass("active"))return this.sliding=!1;var j=f[0],k=a.Event("slide.bs.carousel",{relatedTarget:j,direction:h});if(this.$element.trigger(k),!k.isDefaultPrevented()){if(this.sliding=!0,g&&this.pause(),this.$indicators.length){this.$indicators.find(".active").removeClass("active");var l=a(this.$indicators.children()[this.getItemIndex(f)]);l&&l.addClass("active")}var m=a.Event("slid.bs.carousel",{relatedTarget:j,direction:h});return a.support.transition&&this.$element.hasClass("slide")?(f.addClass(b),f[0].offsetWidth,e.addClass(h),f.addClass(h),e.one("bsTransitionEnd",function(){f.removeClass([b,h].join(" ")).addClass("active"),e.removeClass(["active",h].join(" ")),i.sliding=!1,setTimeout(function(){i.$element.trigger(m)},0)}).emulateTransitionEnd(c.TRANSITION_DURATION)):(e.removeClass("active"),f.addClass("active"),this.sliding=!1,this.$element.trigger(m)),g&&this.cycle(),this}};var d=a.fn.carousel;a.fn.carousel=b,a.fn.carousel.Constructor=c,a.fn.carousel.noConflict=function(){return a.fn.carousel=d,this};var e=function(c){var d,e=a(this),f=a(e.attr("data-target")||(d=e.attr("href"))&&d.replace(/.*(?=#[^\s]+$)/,""));if(f.hasClass("carousel")){var g=a.extend({},f.data(),e.data()),h=e.attr("data-slide-to");h&&(g.interval=!1),b.call(f,g),h&&f.data("bs.carousel").to(h),c.preventDefault()}};a(document).on("click.bs.carousel.data-api","[data-slide]",e).on("click.bs.carousel.data-api","[data-slide-to]",e),a(window).on("load",function(){a('[data-ride="carousel"]').each(function(){var c=a(this);b.call(c,c.data())})})}(jQuery),+function(a){"use strict";function b(b){var c,d=b.attr("data-target")||(c=b.attr("href"))&&c.replace(/.*(?=#[^\s]+$)/,"");return a(d)}function c(b){return this.each(function(){var c=a(this),e=c.data("bs.collapse"),f=a.extend({},d.DEFAULTS,c.data(),"object"==typeof b&&b);!e&&f.toggle&&/show|hide/.test(b)&&(f.toggle=!1),e||c.data("bs.collapse",e=new d(this,f)),"string"==typeof b&&e[b]()})}var d=function(b,c){this.$element=a(b),this.options=a.extend({},d.DEFAULTS,c),this.$trigger=a('[data-toggle="collapse"][href="#'+b.id+'"],[data-toggle="collapse"][data-target="#'+b.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};d.VERSION="3.3.7",d.TRANSITION_DURATION=350,d.DEFAULTS={toggle:!0},d.prototype.dimension=function(){var a=this.$element.hasClass("width");return a?"width":"height"},d.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var b,e=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(e&&e.length&&(b=e.data("bs.collapse"),b&&b.transitioning))){var f=a.Event("show.bs.collapse");if(this.$element.trigger(f),!f.isDefaultPrevented()){e&&e.length&&(c.call(e,"hide"),b||e.data("bs.collapse",null));var g=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[g](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var h=function(){this.$element.removeClass("collapsing").addClass("collapse in")[g](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!a.support.transition)return h.call(this);var i=a.camelCase(["scroll",g].join("-"));this.$element.one("bsTransitionEnd",a.proxy(h,this)).emulateTransitionEnd(d.TRANSITION_DURATION)[g](this.$element[0][i])}}}},d.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var b=a.Event("hide.bs.collapse");if(this.$element.trigger(b),!b.isDefaultPrevented()){var c=this.dimension();this.$element[c](this.$element[c]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var e=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};return a.support.transition?void this.$element[c](0).one("bsTransitionEnd",a.proxy(e,this)).emulateTransitionEnd(d.TRANSITION_DURATION):e.call(this)}}},d.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},d.prototype.getParent=function(){return a(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(a.proxy(function(c,d){var e=a(d);this.addAriaAndCollapsedClass(b(e),e)},this)).end()},d.prototype.addAriaAndCollapsedClass=function(a,b){var c=a.hasClass("in");a.attr("aria-expanded",c),b.toggleClass("collapsed",!c).attr("aria-expanded",c)};var e=a.fn.collapse;a.fn.collapse=c,a.fn.collapse.Constructor=d,a.fn.collapse.noConflict=function(){return a.fn.collapse=e,this},a(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(d){var e=a(this);e.attr("data-target")||d.preventDefault();var f=b(e),g=f.data("bs.collapse"),h=g?"toggle":e.data();c.call(f,h)})}(jQuery),+function(a){"use strict";function b(b){var c=b.attr("data-target");c||(c=b.attr("href"),c=c&&/#[A-Za-z]/.test(c)&&c.replace(/.*(?=#[^\s]*$)/,""));var d=c&&a(c);return d&&d.length?d:b.parent()}function c(c){c&&3===c.which||(a(e).remove(),a(f).each(function(){var d=a(this),e=b(d),f={relatedTarget:this};e.hasClass("open")&&(c&&"click"==c.type&&/input|textarea/i.test(c.target.tagName)&&a.contains(e[0],c.target)||(e.trigger(c=a.Event("hide.bs.dropdown",f)),c.isDefaultPrevented()||(d.attr("aria-expanded","false"),e.removeClass("open").trigger(a.Event("hidden.bs.dropdown",f)))))}))}function d(b){return this.each(function(){var c=a(this),d=c.data("bs.dropdown");d||c.data("bs.dropdown",d=new g(this)),"string"==typeof b&&d[b].call(c)})}var e=".dropdown-backdrop",f='[data-toggle="dropdown"]',g=function(b){a(b).on("click.bs.dropdown",this.toggle)};g.VERSION="3.3.7",g.prototype.toggle=function(d){var e=a(this);if(!e.is(".disabled, :disabled")){var f=b(e),g=f.hasClass("open");if(c(),!g){"ontouchstart"in document.documentElement&&!f.closest(".navbar-nav").length&&a(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(a(this)).on("click",c);var h={relatedTarget:this};if(f.trigger(d=a.Event("show.bs.dropdown",h)),d.isDefaultPrevented())return;e.trigger("focus").attr("aria-expanded","true"),f.toggleClass("open").trigger(a.Event("shown.bs.dropdown",h))}return!1}},g.prototype.keydown=function(c){if(/(38|40|27|32)/.test(c.which)&&!/input|textarea/i.test(c.target.tagName)){var d=a(this);if(c.preventDefault(),c.stopPropagation(),!d.is(".disabled, :disabled")){var e=b(d),g=e.hasClass("open");if(!g&&27!=c.which||g&&27==c.which)return 27==c.which&&e.find(f).trigger("focus"),d.trigger("click");var h=" li:not(.disabled):visible a",i=e.find(".dropdown-menu"+h);if(i.length){var j=i.index(c.target);38==c.which&&j>0&&j--,40==c.which&&j<i.length-1&&j++,~j||(j=0),i.eq(j).trigger("focus")}}}};var h=a.fn.dropdown;a.fn.dropdown=d,a.fn.dropdown.Constructor=g,a.fn.dropdown.noConflict=function(){return a.fn.dropdown=h,this},a(document).on("click.bs.dropdown.data-api",c).on("click.bs.dropdown.data-api",".dropdown form",function(a){a.stopPropagation()}).on("click.bs.dropdown.data-api",f,g.prototype.toggle).on("keydown.bs.dropdown.data-api",f,g.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",g.prototype.keydown)}(jQuery),+function(a){"use strict";function b(b,d){return this.each(function(){var e=a(this),f=e.data("bs.modal"),g=a.extend({},c.DEFAULTS,e.data(),"object"==typeof b&&b);f||e.data("bs.modal",f=new c(this,g)),"string"==typeof b?f[b](d):g.show&&f.show(d)})}var c=function(b,c){this.options=c,this.$body=a(document.body),this.$element=a(b),this.$dialog=this.$element.find(".modal-dialog"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,a.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};c.VERSION="3.3.7",c.TRANSITION_DURATION=300,c.BACKDROP_TRANSITION_DURATION=150,c.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},c.prototype.toggle=function(a){return this.isShown?this.hide():this.show(a)},c.prototype.show=function(b){var d=this,e=a.Event("show.bs.modal",{relatedTarget:b});this.$element.trigger(e),this.isShown||e.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',a.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.bs.modal",function(){d.$element.one("mouseup.dismiss.bs.modal",function(b){a(b.target).is(d.$element)&&(d.ignoreBackdropClick=!0)})}),this.backdrop(function(){var e=a.support.transition&&d.$element.hasClass("fade");d.$element.parent().length||d.$element.appendTo(d.$body),d.$element.show().scrollTop(0),d.adjustDialog(),e&&d.$element[0].offsetWidth,d.$element.addClass("in"),d.enforceFocus();var f=a.Event("shown.bs.modal",{relatedTarget:b});e?d.$dialog.one("bsTransitionEnd",function(){d.$element.trigger("focus").trigger(f)}).emulateTransitionEnd(c.TRANSITION_DURATION):d.$element.trigger("focus").trigger(f)}))},c.prototype.hide=function(b){b&&b.preventDefault(),b=a.Event("hide.bs.modal"),this.$element.trigger(b),this.isShown&&!b.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),a(document).off("focusin.bs.modal"),this.$element.removeClass("in").off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),a.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",a.proxy(this.hideModal,this)).emulateTransitionEnd(c.TRANSITION_DURATION):this.hideModal())},c.prototype.enforceFocus=function(){a(document).off("focusin.bs.modal").on("focusin.bs.modal",a.proxy(function(a){document===a.target||this.$element[0]===a.target||this.$element.has(a.target).length||this.$element.trigger("focus")},this))},c.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",a.proxy(function(a){27==a.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},c.prototype.resize=function(){this.isShown?a(window).on("resize.bs.modal",a.proxy(this.handleUpdate,this)):a(window).off("resize.bs.modal")},c.prototype.hideModal=function(){var a=this;this.$element.hide(),this.backdrop(function(){a.$body.removeClass("modal-open"),a.resetAdjustments(),a.resetScrollbar(),a.$element.trigger("hidden.bs.modal")})},c.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},c.prototype.backdrop=function(b){var d=this,e=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var f=a.support.transition&&e;if(this.$backdrop=a(document.createElement("div")).addClass("modal-backdrop "+e).appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",a.proxy(function(a){return this.ignoreBackdropClick?void(this.ignoreBackdropClick=!1):void(a.target===a.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide()))},this)),f&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!b)return;f?this.$backdrop.one("bsTransitionEnd",b).emulateTransitionEnd(c.BACKDROP_TRANSITION_DURATION):b()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var g=function(){d.removeBackdrop(),b&&b()};a.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",g).emulateTransitionEnd(c.BACKDROP_TRANSITION_DURATION):g()}else b&&b()},c.prototype.handleUpdate=function(){this.adjustDialog()},c.prototype.adjustDialog=function(){var a=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&a?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!a?this.scrollbarWidth:""})},c.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},c.prototype.checkScrollbar=function(){var a=window.innerWidth;if(!a){var b=document.documentElement.getBoundingClientRect();a=b.right-Math.abs(b.left)}this.bodyIsOverflowing=document.body.clientWidth<a,this.scrollbarWidth=this.measureScrollbar()},c.prototype.setScrollbar=function(){var a=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"",this.bodyIsOverflowing&&this.$body.css("padding-right",a+this.scrollbarWidth)},c.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad)},c.prototype.measureScrollbar=function(){var a=document.createElement("div");a.className="modal-scrollbar-measure",this.$body.append(a);var b=a.offsetWidth-a.clientWidth;return this.$body[0].removeChild(a),b};var d=a.fn.modal;a.fn.modal=b,a.fn.modal.Constructor=c,a.fn.modal.noConflict=function(){return a.fn.modal=d,this},a(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(c){var d=a(this),e=d.attr("href"),f=a(d.attr("data-target")||e&&e.replace(/.*(?=#[^\s]+$)/,"")),g=f.data("bs.modal")?"toggle":a.extend({remote:!/#/.test(e)&&e},f.data(),d.data());d.is("a")&&c.preventDefault(),f.one("show.bs.modal",function(a){a.isDefaultPrevented()||f.one("hidden.bs.modal",function(){d.is(":visible")&&d.trigger("focus")})}),b.call(f,g,this)})}(jQuery),+function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.tooltip"),f="object"==typeof b&&b;!e&&/destroy|hide/.test(b)||(e||d.data("bs.tooltip",e=new c(this,f)),"string"==typeof b&&e[b]())})}var c=function(a,b){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.inState=null,this.init("tooltip",a,b)};c.VERSION="3.3.7",c.TRANSITION_DURATION=150,c.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},c.prototype.init=function(b,c,d){if(this.enabled=!0,this.type=b,this.$element=a(c),this.options=this.getOptions(d),this.$viewport=this.options.viewport&&a(a.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var e=this.options.trigger.split(" "),f=e.length;f--;){var g=e[f];if("click"==g)this.$element.on("click."+this.type,this.options.selector,a.proxy(this.toggle,this));else if("manual"!=g){var h="hover"==g?"mouseenter":"focusin",i="hover"==g?"mouseleave":"focusout";this.$element.on(h+"."+this.type,this.options.selector,a.proxy(this.enter,this)),this.$element.on(i+"."+this.type,this.options.selector,a.proxy(this.leave,this))}}this.options.selector?this._options=a.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},c.prototype.getDefaults=function(){return c.DEFAULTS},c.prototype.getOptions=function(b){return b=a.extend({},this.getDefaults(),this.$element.data(),b),b.delay&&"number"==typeof b.delay&&(b.delay={show:b.delay,hide:b.delay}),b},c.prototype.getDelegateOptions=function(){var b={},c=this.getDefaults();return this._options&&a.each(this._options,function(a,d){c[a]!=d&&(b[a]=d)}),b},c.prototype.enter=function(b){var c=b instanceof this.constructor?b:a(b.currentTarget).data("bs."+this.type);return c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data("bs."+this.type,c)),b instanceof a.Event&&(c.inState["focusin"==b.type?"focus":"hover"]=!0),c.tip().hasClass("in")||"in"==c.hoverState?void(c.hoverState="in"):(clearTimeout(c.timeout),c.hoverState="in",c.options.delay&&c.options.delay.show?void(c.timeout=setTimeout(function(){"in"==c.hoverState&&c.show()},c.options.delay.show)):c.show())},c.prototype.isInStateTrue=function(){for(var a in this.inState)if(this.inState[a])return!0;return!1},c.prototype.leave=function(b){var c=b instanceof this.constructor?b:a(b.currentTarget).data("bs."+this.type);if(c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data("bs."+this.type,c)),b instanceof a.Event&&(c.inState["focusout"==b.type?"focus":"hover"]=!1),!c.isInStateTrue())return clearTimeout(c.timeout),c.hoverState="out",c.options.delay&&c.options.delay.hide?void(c.timeout=setTimeout(function(){"out"==c.hoverState&&c.hide()},c.options.delay.hide)):c.hide()},c.prototype.show=function(){var b=a.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(b);var d=a.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(b.isDefaultPrevented()||!d)return;var e=this,f=this.tip(),g=this.getUID(this.type);this.setContent(),f.attr("id",g),this.$element.attr("aria-describedby",g),this.options.animation&&f.addClass("fade");var h="function"==typeof this.options.placement?this.options.placement.call(this,f[0],this.$element[0]):this.options.placement,i=/\s?auto?\s?/i,j=i.test(h);j&&(h=h.replace(i,"")||"top"),f.detach().css({top:0,left:0,display:"block"}).addClass(h).data("bs."+this.type,this),this.options.container?f.appendTo(this.options.container):f.insertAfter(this.$element),this.$element.trigger("inserted.bs."+this.type);var k=this.getPosition(),l=f[0].offsetWidth,m=f[0].offsetHeight;if(j){var n=h,o=this.getPosition(this.$viewport);h="bottom"==h&&k.bottom+m>o.bottom?"top":"top"==h&&k.top-m<o.top?"bottom":"right"==h&&k.right+l>o.width?"left":"left"==h&&k.left-l<o.left?"right":h,f.removeClass(n).addClass(h)}var p=this.getCalculatedOffset(h,k,l,m);this.applyPlacement(p,h);var q=function(){var a=e.hoverState;e.$element.trigger("shown.bs."+e.type),e.hoverState=null,"out"==a&&e.leave(e)};a.support.transition&&this.$tip.hasClass("fade")?f.one("bsTransitionEnd",q).emulateTransitionEnd(c.TRANSITION_DURATION):q()}},c.prototype.applyPlacement=function(b,c){var d=this.tip(),e=d[0].offsetWidth,f=d[0].offsetHeight,g=parseInt(d.css("margin-top"),10),h=parseInt(d.css("margin-left"),10);isNaN(g)&&(g=0),isNaN(h)&&(h=0),b.top+=g,b.left+=h,a.offset.setOffset(d[0],a.extend({using:function(a){d.css({top:Math.round(a.top),left:Math.round(a.left)})}},b),0),d.addClass("in");var i=d[0].offsetWidth,j=d[0].offsetHeight;"top"==c&&j!=f&&(b.top=b.top+f-j);var k=this.getViewportAdjustedDelta(c,b,i,j);k.left?b.left+=k.left:b.top+=k.top;var l=/top|bottom/.test(c),m=l?2*k.left-e+i:2*k.top-f+j,n=l?"offsetWidth":"offsetHeight";d.offset(b),this.replaceArrow(m,d[0][n],l)},c.prototype.replaceArrow=function(a,b,c){this.arrow().css(c?"left":"top",50*(1-a/b)+"%").css(c?"top":"left","")},c.prototype.setContent=function(){var a=this.tip(),b=this.getTitle();a.find(".tooltip-inner")[this.options.html?"html":"text"](b),a.removeClass("fade in top bottom left right")},c.prototype.hide=function(b){function d(){"in"!=e.hoverState&&f.detach(),e.$element&&e.$element.removeAttr("aria-describedby").trigger("hidden.bs."+e.type),b&&b()}var e=this,f=a(this.$tip),g=a.Event("hide.bs."+this.type);if(this.$element.trigger(g),!g.isDefaultPrevented())return f.removeClass("in"),a.support.transition&&f.hasClass("fade")?f.one("bsTransitionEnd",d).emulateTransitionEnd(c.TRANSITION_DURATION):d(),this.hoverState=null,this},c.prototype.fixTitle=function(){var a=this.$element;(a.attr("title")||"string"!=typeof a.attr("data-original-title"))&&a.attr("data-original-title",a.attr("title")||"").attr("title","")},c.prototype.hasContent=function(){return this.getTitle()},c.prototype.getPosition=function(b){b=b||this.$element;var c=b[0],d="BODY"==c.tagName,e=c.getBoundingClientRect();null==e.width&&(e=a.extend({},e,{width:e.right-e.left,height:e.bottom-e.top}));var f=window.SVGElement&&c instanceof window.SVGElement,g=d?{top:0,left:0}:f?null:b.offset(),h={scroll:d?document.documentElement.scrollTop||document.body.scrollTop:b.scrollTop()},i=d?{width:a(window).width(),height:a(window).height()}:null;return a.extend({},e,h,i,g)},c.prototype.getCalculatedOffset=function(a,b,c,d){return"bottom"==a?{top:b.top+b.height,left:b.left+b.width/2-c/2}:"top"==a?{top:b.top-d,left:b.left+b.width/2-c/2}:"left"==a?{top:b.top+b.height/2-d/2,left:b.left-c}:{top:b.top+b.height/2-d/2,left:b.left+b.width}},c.prototype.getViewportAdjustedDelta=function(a,b,c,d){var e={top:0,left:0};if(!this.$viewport)return e;var f=this.options.viewport&&this.options.viewport.padding||0,g=this.getPosition(this.$viewport);if(/right|left/.test(a)){var h=b.top-f-g.scroll,i=b.top+f-g.scroll+d;h<g.top?e.top=g.top-h:i>g.top+g.height&&(e.top=g.top+g.height-i)}else{var j=b.left-f,k=b.left+f+c;j<g.left?e.left=g.left-j:k>g.right&&(e.left=g.left+g.width-k)}return e},c.prototype.getTitle=function(){var a,b=this.$element,c=this.options;return a=b.attr("data-original-title")||("function"==typeof c.title?c.title.call(b[0]):c.title)},c.prototype.getUID=function(a){do a+=~~(1e6*Math.random());while(document.getElementById(a));return a},c.prototype.tip=function(){if(!this.$tip&&(this.$tip=a(this.options.template),1!=this.$tip.length))throw new Error(this.type+" `template` option must consist of exactly 1 top-level element!");return this.$tip},c.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},c.prototype.enable=function(){this.enabled=!0},c.prototype.disable=function(){this.enabled=!1},c.prototype.toggleEnabled=function(){this.enabled=!this.enabled},c.prototype.toggle=function(b){var c=this;b&&(c=a(b.currentTarget).data("bs."+this.type),c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data("bs."+this.type,c))),b?(c.inState.click=!c.inState.click,c.isInStateTrue()?c.enter(c):c.leave(c)):c.tip().hasClass("in")?c.leave(c):c.enter(c)},c.prototype.destroy=function(){var a=this;clearTimeout(this.timeout),this.hide(function(){a.$element.off("."+a.type).removeData("bs."+a.type),a.$tip&&a.$tip.detach(),a.$tip=null,a.$arrow=null,a.$viewport=null,a.$element=null})};var d=a.fn.tooltip;a.fn.tooltip=b,a.fn.tooltip.Constructor=c,a.fn.tooltip.noConflict=function(){return a.fn.tooltip=d,this}}(jQuery),+function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.popover"),f="object"==typeof b&&b;!e&&/destroy|hide/.test(b)||(e||d.data("bs.popover",e=new c(this,f)),"string"==typeof b&&e[b]())})}var c=function(a,b){this.init("popover",a,b)};if(!a.fn.tooltip)throw new Error("Popover requires tooltip.js");c.VERSION="3.3.7",c.DEFAULTS=a.extend({},a.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),c.prototype=a.extend({},a.fn.tooltip.Constructor.prototype),c.prototype.constructor=c,c.prototype.getDefaults=function(){return c.DEFAULTS},c.prototype.setContent=function(){var a=this.tip(),b=this.getTitle(),c=this.getContent();a.find(".popover-title")[this.options.html?"html":"text"](b),a.find(".popover-content").children().detach().end()[this.options.html?"string"==typeof c?"html":"append":"text"](c),a.removeClass("fade top bottom left right in"),a.find(".popover-title").html()||a.find(".popover-title").hide()},c.prototype.hasContent=function(){return this.getTitle()||this.getContent()},c.prototype.getContent=function(){var a=this.$element,b=this.options;return a.attr("data-content")||("function"==typeof b.content?b.content.call(a[0]):b.content)},c.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")};var d=a.fn.popover;a.fn.popover=b,a.fn.popover.Constructor=c,a.fn.popover.noConflict=function(){return a.fn.popover=d,this}}(jQuery),+function(a){"use strict";function b(c,d){this.$body=a(document.body),this.$scrollElement=a(a(c).is(document.body)?window:c),this.options=a.extend({},b.DEFAULTS,d),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",a.proxy(this.process,this)),this.refresh(),this.process()}function c(c){return this.each(function(){var d=a(this),e=d.data("bs.scrollspy"),f="object"==typeof c&&c;e||d.data("bs.scrollspy",e=new b(this,f)),"string"==typeof c&&e[c]()})}b.VERSION="3.3.7",b.DEFAULTS={offset:10},b.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},b.prototype.refresh=function(){var b=this,c="offset",d=0;this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight(),a.isWindow(this.$scrollElement[0])||(c="position",d=this.$scrollElement.scrollTop()),this.$body.find(this.selector).map(function(){var b=a(this),e=b.data("target")||b.attr("href"),f=/^#./.test(e)&&a(e);return f&&f.length&&f.is(":visible")&&[[f[c]().top+d,e]]||null}).sort(function(a,b){return a[0]-b[0]}).each(function(){b.offsets.push(this[0]),b.targets.push(this[1])})},b.prototype.process=function(){var a,b=this.$scrollElement.scrollTop()+this.options.offset,c=this.getScrollHeight(),d=this.options.offset+c-this.$scrollElement.height(),e=this.offsets,f=this.targets,g=this.activeTarget;if(this.scrollHeight!=c&&this.refresh(),b>=d)return g!=(a=f[f.length-1])&&this.activate(a);if(g&&b<e[0])return this.activeTarget=null,this.clear();for(a=e.length;a--;)g!=f[a]&&b>=e[a]&&(void 0===e[a+1]||b<e[a+1])&&this.activate(f[a])},b.prototype.activate=function(b){
this.activeTarget=b,this.clear();var c=this.selector+'[data-target="'+b+'"],'+this.selector+'[href="'+b+'"]',d=a(c).parents("li").addClass("active");d.parent(".dropdown-menu").length&&(d=d.closest("li.dropdown").addClass("active")),d.trigger("activate.bs.scrollspy")},b.prototype.clear=function(){a(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var d=a.fn.scrollspy;a.fn.scrollspy=c,a.fn.scrollspy.Constructor=b,a.fn.scrollspy.noConflict=function(){return a.fn.scrollspy=d,this},a(window).on("load.bs.scrollspy.data-api",function(){a('[data-spy="scroll"]').each(function(){var b=a(this);c.call(b,b.data())})})}(jQuery),+function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.tab");e||d.data("bs.tab",e=new c(this)),"string"==typeof b&&e[b]()})}var c=function(b){this.element=a(b)};c.VERSION="3.3.7",c.TRANSITION_DURATION=150,c.prototype.show=function(){var b=this.element,c=b.closest("ul:not(.dropdown-menu)"),d=b.data("target");if(d||(d=b.attr("href"),d=d&&d.replace(/.*(?=#[^\s]*$)/,"")),!b.parent("li").hasClass("active")){var e=c.find(".active:last a"),f=a.Event("hide.bs.tab",{relatedTarget:b[0]}),g=a.Event("show.bs.tab",{relatedTarget:e[0]});if(e.trigger(f),b.trigger(g),!g.isDefaultPrevented()&&!f.isDefaultPrevented()){var h=a(d);this.activate(b.closest("li"),c),this.activate(h,h.parent(),function(){e.trigger({type:"hidden.bs.tab",relatedTarget:b[0]}),b.trigger({type:"shown.bs.tab",relatedTarget:e[0]})})}}},c.prototype.activate=function(b,d,e){function f(){g.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),b.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),h?(b[0].offsetWidth,b.addClass("in")):b.removeClass("fade"),b.parent(".dropdown-menu").length&&b.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),e&&e()}var g=d.find("> .active"),h=e&&a.support.transition&&(g.length&&g.hasClass("fade")||!!d.find("> .fade").length);g.length&&h?g.one("bsTransitionEnd",f).emulateTransitionEnd(c.TRANSITION_DURATION):f(),g.removeClass("in")};var d=a.fn.tab;a.fn.tab=b,a.fn.tab.Constructor=c,a.fn.tab.noConflict=function(){return a.fn.tab=d,this};var e=function(c){c.preventDefault(),b.call(a(this),"show")};a(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',e).on("click.bs.tab.data-api",'[data-toggle="pill"]',e)}(jQuery),+function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.affix"),f="object"==typeof b&&b;e||d.data("bs.affix",e=new c(this,f)),"string"==typeof b&&e[b]()})}var c=function(b,d){this.options=a.extend({},c.DEFAULTS,d),this.$target=a(this.options.target).on("scroll.bs.affix.data-api",a.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",a.proxy(this.checkPositionWithEventLoop,this)),this.$element=a(b),this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()};c.VERSION="3.3.7",c.RESET="affix affix-top affix-bottom",c.DEFAULTS={offset:0,target:window},c.prototype.getState=function(a,b,c,d){var e=this.$target.scrollTop(),f=this.$element.offset(),g=this.$target.height();if(null!=c&&"top"==this.affixed)return e<c&&"top";if("bottom"==this.affixed)return null!=c?!(e+this.unpin<=f.top)&&"bottom":!(e+g<=a-d)&&"bottom";var h=null==this.affixed,i=h?e:f.top,j=h?g:b;return null!=c&&e<=c?"top":null!=d&&i+j>=a-d&&"bottom"},c.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(c.RESET).addClass("affix");var a=this.$target.scrollTop(),b=this.$element.offset();return this.pinnedOffset=b.top-a},c.prototype.checkPositionWithEventLoop=function(){setTimeout(a.proxy(this.checkPosition,this),1)},c.prototype.checkPosition=function(){if(this.$element.is(":visible")){var b=this.$element.height(),d=this.options.offset,e=d.top,f=d.bottom,g=Math.max(a(document).height(),a(document.body).height());"object"!=typeof d&&(f=e=d),"function"==typeof e&&(e=d.top(this.$element)),"function"==typeof f&&(f=d.bottom(this.$element));var h=this.getState(g,b,e,f);if(this.affixed!=h){null!=this.unpin&&this.$element.css("top","");var i="affix"+(h?"-"+h:""),j=a.Event(i+".bs.affix");if(this.$element.trigger(j),j.isDefaultPrevented())return;this.affixed=h,this.unpin="bottom"==h?this.getPinnedOffset():null,this.$element.removeClass(c.RESET).addClass(i).trigger(i.replace("affix","affixed")+".bs.affix")}"bottom"==h&&this.$element.offset({top:g-b-f})}};var d=a.fn.affix;a.fn.affix=b,a.fn.affix.Constructor=c,a.fn.affix.noConflict=function(){return a.fn.affix=d,this},a(window).on("load",function(){a('[data-spy="affix"]').each(function(){var c=a(this),d=c.data();d.offset=d.offset||{},null!=d.offsetBottom&&(d.offset.bottom=d.offsetBottom),null!=d.offsetTop&&(d.offset.top=d.offsetTop),b.call(c,d)})})}(jQuery);window.onkeydown=function(event){if(event.keyCode==78){if(event.ctrlKey){event.returnValue=false;event.keyCode=0;window.status='New window is disabled';return false;}}};var zbtn = $.fn.button.noConflict();$.fn.btn = zbtn;/*!
 * Bootstrap-select v1.12.4 (http://silviomoreto.github.io/bootstrap-select)
 *
 * Copyright 2013-2017 bootstrap-select
 * Licensed under MIT (https://github.com/silviomoreto/bootstrap-select/blob/master/LICENSE)
 */
!function(a,b){"function"==typeof define&&define.amd?define(["jquery"],function(a){return b(a)}):"object"==typeof module&&module.exports?module.exports=b(require("jquery")):b(a.jQuery)}(this,function(a){!function(a){"use strict";function b(b){var c=[{re:/[\xC0-\xC6]/g,ch:"A"},{re:/[\xE0-\xE6]/g,ch:"a"},{re:/[\xC8-\xCB]/g,ch:"E"},{re:/[\xE8-\xEB]/g,ch:"e"},{re:/[\xCC-\xCF]/g,ch:"I"},{re:/[\xEC-\xEF]/g,ch:"i"},{re:/[\xD2-\xD6]/g,ch:"O"},{re:/[\xF2-\xF6]/g,ch:"o"},{re:/[\xD9-\xDC]/g,ch:"U"},{re:/[\xF9-\xFC]/g,ch:"u"},{re:/[\xC7-\xE7]/g,ch:"c"},{re:/[\xD1]/g,ch:"N"},{re:/[\xF1]/g,ch:"n"}];return a.each(c,function(){b=b?b.replace(this.re,this.ch):""}),b}function c(b){var c=arguments,d=b;[].shift.apply(c);var e,f=this.each(function(){var b=a(this);if(b.is("select")){var f=b.data("selectpicker"),g="object"==typeof d&&d;if(f){if(g)for(var h in g)g.hasOwnProperty(h)&&(f.options[h]=g[h])}else{var i=a.extend({},l.DEFAULTS,a.fn.selectpicker.defaults||{},b.data(),g);i.template=a.extend({},l.DEFAULTS.template,a.fn.selectpicker.defaults?a.fn.selectpicker.defaults.template:{},b.data().template,g.template),b.data("selectpicker",f=new l(this,i))}"string"==typeof d&&(e=f[d]instanceof Function?f[d].apply(f,c):f.options[d])}});return"undefined"!=typeof e?e:f}String.prototype.includes||!function(){var a={}.toString,b=function(){try{var a={},b=Object.defineProperty,c=b(a,a,a)&&b}catch(a){}return c}(),c="".indexOf,d=function(b){if(null==this)throw new TypeError;var d=String(this);if(b&&"[object RegExp]"==a.call(b))throw new TypeError;var e=d.length,f=String(b),g=f.length,h=arguments.length>1?arguments[1]:void 0,i=h?Number(h):0;i!=i&&(i=0);var j=Math.min(Math.max(i,0),e);return!(g+j>e)&&c.call(d,f,i)!=-1};b?b(String.prototype,"includes",{value:d,configurable:!0,writable:!0}):String.prototype.includes=d}(),String.prototype.startsWith||!function(){var a=function(){try{var a={},b=Object.defineProperty,c=b(a,a,a)&&b}catch(a){}return c}(),b={}.toString,c=function(a){if(null==this)throw new TypeError;var c=String(this);if(a&&"[object RegExp]"==b.call(a))throw new TypeError;var d=c.length,e=String(a),f=e.length,g=arguments.length>1?arguments[1]:void 0,h=g?Number(g):0;h!=h&&(h=0);var i=Math.min(Math.max(h,0),d);if(f+i>d)return!1;for(var j=-1;++j<f;)if(c.charCodeAt(i+j)!=e.charCodeAt(j))return!1;return!0};a?a(String.prototype,"startsWith",{value:c,configurable:!0,writable:!0}):String.prototype.startsWith=c}(),Object.keys||(Object.keys=function(a,b,c){c=[];for(b in a)c.hasOwnProperty.call(a,b)&&c.push(b);return c});var d={useDefault:!1,_set:a.valHooks.select.set};a.valHooks.select.set=function(b,c){return c&&!d.useDefault&&a(b).data("selected",!0),d._set.apply(this,arguments)};var e=null,f=function(){try{return new Event("change"),!0}catch(a){return!1}}();a.fn.triggerNative=function(a){var b,c=this[0];c.dispatchEvent?(f?b=new Event(a,{bubbles:!0}):(b=document.createEvent("Event"),b.initEvent(a,!0,!1)),c.dispatchEvent(b)):c.fireEvent?(b=document.createEventObject(),b.eventType=a,c.fireEvent("on"+a,b)):this.trigger(a)},a.expr.pseudos.icontains=function(b,c,d){var e=a(b).find("a"),f=(e.data("tokens")||e.text()).toString().toUpperCase();return f.includes(d[3].toUpperCase())},a.expr.pseudos.ibegins=function(b,c,d){var e=a(b).find("a"),f=(e.data("tokens")||e.text()).toString().toUpperCase();return f.startsWith(d[3].toUpperCase())},a.expr.pseudos.aicontains=function(b,c,d){var e=a(b).find("a"),f=(e.data("tokens")||e.data("normalizedText")||e.text()).toString().toUpperCase();return f.includes(d[3].toUpperCase())},a.expr.pseudos.aibegins=function(b,c,d){var e=a(b).find("a"),f=(e.data("tokens")||e.data("normalizedText")||e.text()).toString().toUpperCase();return f.startsWith(d[3].toUpperCase())};var g={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},h={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#x27;":"'","&#x60;":"`"},i=function(a){var b=function(b){return a[b]},c="(?:"+Object.keys(a).join("|")+")",d=RegExp(c),e=RegExp(c,"g");return function(a){return a=null==a?"":""+a,d.test(a)?a.replace(e,b):a}},j=i(g),k=i(h),l=function(b,c){d.useDefault||(a.valHooks.select.set=d._set,d.useDefault=!0),this.$element=a(b),this.$newElement=null,this.$button=null,this.$menu=null,this.$lis=null,this.options=c,null===this.options.title&&(this.options.title=this.$element.attr("title"));var e=this.options.windowPadding;"number"==typeof e&&(this.options.windowPadding=[e,e,e,e]),this.val=l.prototype.val,this.render=l.prototype.render,this.refresh=l.prototype.refresh,this.setStyle=l.prototype.setStyle,this.selectAll=l.prototype.selectAll,this.deselectAll=l.prototype.deselectAll,this.destroy=l.prototype.destroy,this.remove=l.prototype.remove,this.show=l.prototype.show,this.hide=l.prototype.hide,this.init()};l.VERSION="1.12.4",l.DEFAULTS={noneSelectedText:"Nothing selected",noneResultsText:"No results matched {0}",countSelectedText:function(a,b){return 1==a?"{0} item selected":"{0} items selected"},maxOptionsText:function(a,b){return[1==a?"Limit reached ({n} item max)":"Limit reached ({n} items max)",1==b?"Group limit reached ({n} item max)":"Group limit reached ({n} items max)"]},selectAllText:"Select All",deselectAllText:"Deselect All",doneButton:!1,doneButtonText:"Close",multipleSeparator:", ",styleBase:"btn",style:"btn-default",size:"auto",title:null,selectedTextFormat:"values",width:!1,container:!1,hideDisabled:!1,showSubtext:!1,showIcon:!0,showContent:!0,dropupAuto:!0,header:!1,liveSearch:!1,liveSearchPlaceholder:null,liveSearchNormalize:!1,liveSearchStyle:"contains",actionsBox:!1,iconBase:"glyphicon",tickIcon:"glyphicon-ok",showTick:!1,template:{caret:'<span class="caret"></span>'},maxOptions:!1,mobile:!1,selectOnTab:!1,dropdownAlignRight:!1,windowPadding:0},l.prototype={constructor:l,init:function(){var b=this,c=this.$element.attr("id");this.$element.addClass("bs-select-hidden"),this.liObj={},this.multiple=this.$element.prop("multiple"),this.autofocus=this.$element.prop("autofocus"),this.$newElement=this.createView(),this.$element.after(this.$newElement).appendTo(this.$newElement),this.$button=this.$newElement.children("button"),this.$menu=this.$newElement.children(".dropdown-menu"),this.$menuInner=this.$menu.children(".inner"),this.$searchbox=this.$menu.find("input"),this.$element.removeClass("bs-select-hidden"),this.options.dropdownAlignRight===!0&&this.$menu.addClass("dropdown-menu-right"),"undefined"!=typeof c&&(this.$button.attr("data-id",c),a('label[for="'+c+'"]').click(function(a){a.preventDefault(),b.$button.focus()})),this.checkDisabled(),this.clickListener(),this.options.liveSearch&&this.liveSearchListener(),this.render(),this.setStyle(),this.setWidth(),this.options.container&&this.selectPosition(),this.$menu.data("this",this),this.$newElement.data("this",this),this.options.mobile&&this.mobile(),this.$newElement.on({"hide.bs.dropdown":function(a){b.$menuInner.attr("aria-expanded",!1),b.$element.trigger("hide.bs.select",a)},"hidden.bs.dropdown":function(a){b.$element.trigger("hidden.bs.select",a)},"show.bs.dropdown":function(a){b.$menuInner.attr("aria-expanded",!0),b.$element.trigger("show.bs.select",a)},"shown.bs.dropdown":function(a){b.$element.trigger("shown.bs.select",a)}}),b.$element[0].hasAttribute("required")&&this.$element.on("invalid",function(){b.$button.addClass("bs-invalid"),b.$element.on({"focus.bs.select":function(){b.$button.focus(),b.$element.off("focus.bs.select")},"shown.bs.select":function(){b.$element.val(b.$element.val()).off("shown.bs.select")},"rendered.bs.select":function(){this.validity.valid&&b.$button.removeClass("bs-invalid"),b.$element.off("rendered.bs.select")}}),b.$button.on("blur.bs.select",function(){b.$element.focus().blur(),b.$button.off("blur.bs.select")})}),setTimeout(function(){b.$element.trigger("loaded.bs.select")})},createDropdown:function(){var b=this.multiple||this.options.showTick?" show-tick":"",c=this.$element.parent().hasClass("input-group")?" input-group-btn":"",d=this.autofocus?" autofocus":"",e=this.options.header?'<div class="popover-title"><button type="button" class="close" aria-hidden="true">&times;</button>'+this.options.header+"</div>":"",f=this.options.liveSearch?'<div class="bs-searchbox"><input type="text" class="form-control" autocomplete="off"'+(null===this.options.liveSearchPlaceholder?"":' placeholder="'+j(this.options.liveSearchPlaceholder)+'"')+' role="textbox" aria-label="Search"></div>':"",g=this.multiple&&this.options.actionsBox?'<div class="bs-actionsbox"><div class="btn-group btn-group-sm btn-block"><button type="button" class="actions-btn bs-select-all btn btn-default">'+this.options.selectAllText+'</button><button type="button" class="actions-btn bs-deselect-all btn btn-default">'+this.options.deselectAllText+"</button></div></div>":"",h=this.multiple&&this.options.doneButton?'<div class="bs-donebutton"><div class="btn-group btn-block"><button type="button" class="btn btn-sm btn-default">'+this.options.doneButtonText+"</button></div></div>":"",i='<div class="btn-group bootstrap-select'+b+c+'"><button type="button" class="'+this.options.styleBase+' dropdown-toggle" data-toggle="dropdown"'+d+' role="button"><span class="filter-option pull-left"></span>&nbsp;<span class="bs-caret">'+this.options.template.caret+'</span></button><div class="dropdown-menu open" role="combobox">'+e+f+g+'<ul class="dropdown-menu inner" role="listbox" aria-expanded="false"></ul>'+h+"</div></div>";return a(i)},createView:function(){var a=this.createDropdown(),b=this.createLi();return a.find("ul")[0].innerHTML=b,a},reloadLi:function(){var a=this.createLi();this.$menuInner[0].innerHTML=a},createLi:function(){var c=this,d=[],e=0,f=document.createElement("option"),g=-1,h=function(a,b,c,d){return"<li"+("undefined"!=typeof c&&""!==c?' class="'+c+'"':"")+("undefined"!=typeof b&&null!==b?' data-original-index="'+b+'"':"")+("undefined"!=typeof d&&null!==d?'data-optgroup="'+d+'"':"")+">"+a+"</li>"},i=function(d,e,f,g){return'<a tabindex="0"'+("undefined"!=typeof e?' class="'+e+'"':"")+(f?' style="'+f+'"':"")+(c.options.liveSearchNormalize?' data-normalized-text="'+b(j(a(d).html()))+'"':"")+("undefined"!=typeof g||null!==g?' data-tokens="'+g+'"':"")+' role="option">'+d+'<span class="'+c.options.iconBase+" "+c.options.tickIcon+' check-mark"></span></a>'};if(this.options.title&&!this.multiple&&(g--,!this.$element.find(".bs-title-option").length)){var k=this.$element[0];f.className="bs-title-option",f.innerHTML=this.options.title,f.value="",k.insertBefore(f,k.firstChild);var l=a(k.options[k.selectedIndex]);void 0===l.attr("selected")&&void 0===this.$element.data("selected")&&(f.selected=!0)}var m=this.$element.find("option");return m.each(function(b){var f=a(this);if(g++,!f.hasClass("bs-title-option")){var k,l=this.className||"",n=j(this.style.cssText),o=f.data("content")?f.data("content"):f.html(),p=f.data("tokens")?f.data("tokens"):null,q="undefined"!=typeof f.data("subtext")?'<small class="text-muted">'+f.data("subtext")+"</small>":"",r="undefined"!=typeof f.data("icon")?'<span class="'+c.options.iconBase+" "+f.data("icon")+'"></span> ':"",s=f.parent(),t="OPTGROUP"===s[0].tagName,u=t&&s[0].disabled,v=this.disabled||u;if(""!==r&&v&&(r="<span>"+r+"</span>"),c.options.hideDisabled&&(v&&!t||u))return k=f.data("prevHiddenIndex"),f.next().data("prevHiddenIndex",void 0!==k?k:b),void g--;if(f.data("content")||(o=r+'<span class="text">'+o+q+"</span>"),t&&f.data("divider")!==!0){if(c.options.hideDisabled&&v){if(void 0===s.data("allOptionsDisabled")){var w=s.children();s.data("allOptionsDisabled",w.filter(":disabled").length===w.length)}if(s.data("allOptionsDisabled"))return void g--}var x=" "+s[0].className||"";if(0===f.index()){e+=1;var y=s[0].label,z="undefined"!=typeof s.data("subtext")?'<small class="text-muted">'+s.data("subtext")+"</small>":"",A=s.data("icon")?'<span class="'+c.options.iconBase+" "+s.data("icon")+'"></span> ':"";y=A+'<span class="text">'+j(y)+z+"</span>",0!==b&&d.length>0&&(g++,d.push(h("",null,"divider",e+"div"))),g++,d.push(h(y,null,"dropdown-header"+x,e))}if(c.options.hideDisabled&&v)return void g--;d.push(h(i(o,"opt "+l+x,n,p),b,"",e))}else if(f.data("divider")===!0)d.push(h("",b,"divider"));else if(f.data("hidden")===!0)k=f.data("prevHiddenIndex"),f.next().data("prevHiddenIndex",void 0!==k?k:b),d.push(h(i(o,l,n,p),b,"hidden is-hidden"));else{var B=this.previousElementSibling&&"OPTGROUP"===this.previousElementSibling.tagName;if(!B&&c.options.hideDisabled&&(k=f.data("prevHiddenIndex"),void 0!==k)){var C=m.eq(k)[0].previousElementSibling;C&&"OPTGROUP"===C.tagName&&!C.disabled&&(B=!0)}B&&(g++,d.push(h("",null,"divider",e+"div"))),d.push(h(i(o,l,n,p),b))}c.liObj[b]=g}}),this.multiple||0!==this.$element.find("option:selected").length||this.options.title||this.$element.find("option").eq(0).prop("selected",!0).attr("selected","selected"),d.join("")},findLis:function(){return null==this.$lis&&(this.$lis=this.$menu.find("li")),this.$lis},render:function(b){var c,d=this,e=this.$element.find("option");b!==!1&&e.each(function(a){var b=d.findLis().eq(d.liObj[a]);d.setDisabled(a,this.disabled||"OPTGROUP"===this.parentNode.tagName&&this.parentNode.disabled,b),d.setSelected(a,this.selected,b)}),this.togglePlaceholder(),this.tabIndex();var f=e.map(function(){if(this.selected){if(d.options.hideDisabled&&(this.disabled||"OPTGROUP"===this.parentNode.tagName&&this.parentNode.disabled))return;var b,c=a(this),e=c.data("icon")&&d.options.showIcon?'<i class="'+d.options.iconBase+" "+c.data("icon")+'"></i> ':"";return b=d.options.showSubtext&&c.data("subtext")&&!d.multiple?' <small class="text-muted">'+c.data("subtext")+"</small>":"","undefined"!=typeof c.attr("title")?c.attr("title"):c.data("content")&&d.options.showContent?c.data("content").toString():e+c.html()+b}}).toArray(),g=this.multiple?f.join(this.options.multipleSeparator):f[0];if(this.multiple&&this.options.selectedTextFormat.indexOf("count")>-1){var h=this.options.selectedTextFormat.split(">");if(h.length>1&&f.length>h[1]||1==h.length&&f.length>=2){c=this.options.hideDisabled?", [disabled]":"";var i=e.not('[data-divider="true"], [data-hidden="true"]'+c).length,j="function"==typeof this.options.countSelectedText?this.options.countSelectedText(f.length,i):this.options.countSelectedText;g=j.replace("{0}",f.length.toString()).replace("{1}",i.toString())}}void 0==this.options.title&&(this.options.title=this.$element.attr("title")),"static"==this.options.selectedTextFormat&&(g=this.options.title),g||(g="undefined"!=typeof this.options.title?this.options.title:this.options.noneSelectedText),this.$button.attr("title",k(a.trim(g.replace(/<[^>]*>?/g,"")))),this.$button.children(".filter-option").html(g),this.$element.trigger("rendered.bs.select")},setStyle:function(a,b){this.$element.attr("class")&&this.$newElement.addClass(this.$element.attr("class").replace(/selectpicker|mobile-device|bs-select-hidden|validate\[.*\]/gi,""));var c=a?a:this.options.style;"add"==b?this.$button.addClass(c):"remove"==b?this.$button.removeClass(c):(this.$button.removeClass(this.options.style),this.$button.addClass(c))},liHeight:function(b){if(b||this.options.size!==!1&&!this.sizeInfo){var c=document.createElement("div"),d=document.createElement("div"),e=document.createElement("ul"),f=document.createElement("li"),g=document.createElement("li"),h=document.createElement("a"),i=document.createElement("span"),j=this.options.header&&this.$menu.find(".popover-title").length>0?this.$menu.find(".popover-title")[0].cloneNode(!0):null,k=this.options.liveSearch?document.createElement("div"):null,l=this.options.actionsBox&&this.multiple&&this.$menu.find(".bs-actionsbox").length>0?this.$menu.find(".bs-actionsbox")[0].cloneNode(!0):null,m=this.options.doneButton&&this.multiple&&this.$menu.find(".bs-donebutton").length>0?this.$menu.find(".bs-donebutton")[0].cloneNode(!0):null;if(i.className="text",c.className=this.$menu[0].parentNode.className+" open",d.className="dropdown-menu open",e.className="dropdown-menu inner",f.className="divider",i.appendChild(document.createTextNode("Inner text")),h.appendChild(i),g.appendChild(h),e.appendChild(g),e.appendChild(f),j&&d.appendChild(j),k){var n=document.createElement("input");k.className="bs-searchbox",n.className="form-control",k.appendChild(n),d.appendChild(k)}l&&d.appendChild(l),d.appendChild(e),m&&d.appendChild(m),c.appendChild(d),document.body.appendChild(c);var o=h.offsetHeight,p=j?j.offsetHeight:0,q=k?k.offsetHeight:0,r=l?l.offsetHeight:0,s=m?m.offsetHeight:0,t=a(f).outerHeight(!0),u="function"==typeof getComputedStyle&&getComputedStyle(d),v=u?null:a(d),w={vert:parseInt(u?u.paddingTop:v.css("paddingTop"))+parseInt(u?u.paddingBottom:v.css("paddingBottom"))+parseInt(u?u.borderTopWidth:v.css("borderTopWidth"))+parseInt(u?u.borderBottomWidth:v.css("borderBottomWidth")),horiz:parseInt(u?u.paddingLeft:v.css("paddingLeft"))+parseInt(u?u.paddingRight:v.css("paddingRight"))+parseInt(u?u.borderLeftWidth:v.css("borderLeftWidth"))+parseInt(u?u.borderRightWidth:v.css("borderRightWidth"))},x={vert:w.vert+parseInt(u?u.marginTop:v.css("marginTop"))+parseInt(u?u.marginBottom:v.css("marginBottom"))+2,horiz:w.horiz+parseInt(u?u.marginLeft:v.css("marginLeft"))+parseInt(u?u.marginRight:v.css("marginRight"))+2};document.body.removeChild(c),this.sizeInfo={liHeight:o,headerHeight:p,searchHeight:q,actionsHeight:r,doneButtonHeight:s,dividerHeight:t,menuPadding:w,menuExtras:x}}},setSize:function(){if(this.findLis(),this.liHeight(),this.options.header&&this.$menu.css("padding-top",0),this.options.size!==!1){var b,c,d,e,f,g,h,i,j=this,k=this.$menu,l=this.$menuInner,m=a(window),n=this.$newElement[0].offsetHeight,o=this.$newElement[0].offsetWidth,p=this.sizeInfo.liHeight,q=this.sizeInfo.headerHeight,r=this.sizeInfo.searchHeight,s=this.sizeInfo.actionsHeight,t=this.sizeInfo.doneButtonHeight,u=this.sizeInfo.dividerHeight,v=this.sizeInfo.menuPadding,w=this.sizeInfo.menuExtras,x=this.options.hideDisabled?".disabled":"",y=function(){var b,c=j.$newElement.offset(),d=a(j.options.container);j.options.container&&!d.is("body")?(b=d.offset(),b.top+=parseInt(d.css("borderTopWidth")),b.left+=parseInt(d.css("borderLeftWidth"))):b={top:0,left:0};var e=j.options.windowPadding;f=c.top-b.top-m.scrollTop(),g=m.height()-f-n-b.top-e[2],h=c.left-b.left-m.scrollLeft(),i=m.width()-h-o-b.left-e[1],f-=e[0],h-=e[3]};if(y(),"auto"===this.options.size){var z=function(){var m,n=function(b,c){return function(d){return c?d.classList?d.classList.contains(b):a(d).hasClass(b):!(d.classList?d.classList.contains(b):a(d).hasClass(b))}},u=j.$menuInner[0].getElementsByTagName("li"),x=Array.prototype.filter?Array.prototype.filter.call(u,n("hidden",!1)):j.$lis.not(".hidden"),z=Array.prototype.filter?Array.prototype.filter.call(x,n("dropdown-header",!0)):x.filter(".dropdown-header");y(),b=g-w.vert,c=i-w.horiz,j.options.container?(k.data("height")||k.data("height",k.height()),d=k.data("height"),k.data("width")||k.data("width",k.width()),e=k.data("width")):(d=k.height(),e=k.width()),j.options.dropupAuto&&j.$newElement.toggleClass("dropup",(f>g&&b-w.vert<d)||j.$element[0].className.indexOf("dropupalways")!=-1),j.$newElement.hasClass("dropup")&&(b=f-w.vert),"auto"===j.options.dropdownAlignRight&&k.toggleClass("dropdown-menu-right",h>i&&c-w.horiz<e-o),m=x.length+z.length>3?3*p+w.vert-2:0,k.css({"max-height":b+"px",overflow:"hidden","min-height":m+q+r+s+t+"px"}),l.css({"max-height":b-q-r-s-t-v.vert+"px","overflow-y":"auto","min-height":Math.max(m-v.vert,0)+"px"})};z(),this.$searchbox.off("input.getSize propertychange.getSize").on("input.getSize propertychange.getSize",z),m.off("resize.getSize scroll.getSize").on("resize.getSize scroll.getSize",z)}else if(this.options.size&&"auto"!=this.options.size&&this.$lis.not(x).length>this.options.size){var A=this.$lis.not(".divider").not(x).children().slice(0,this.options.size).last().parent().index(),B=this.$lis.slice(0,A+1).filter(".divider").length;b=p*this.options.size+B*u+v.vert,j.options.container?(k.data("height")||k.data("height",k.height()),d=k.data("height")):d=k.height(),j.options.dropupAuto&&this.$newElement.toggleClass("dropup",f>g&&b-w.vert<d),k.css({"max-height":b+q+r+s+t+"px",overflow:"hidden","min-height":""}),l.css({"max-height":b-v.vert+"px","overflow-y":"auto","min-height":""})}}},setWidth:function(){if("auto"===this.options.width){this.$menu.css("min-width","0");var a=this.$menu.parent().clone().appendTo("body"),b=this.options.container?this.$newElement.clone().appendTo("body"):a,c=a.children(".dropdown-menu").outerWidth(),d=b.css("width","auto").children("button").outerWidth();a.remove(),b.remove(),this.$newElement.css("width",Math.max(c,d)+"px")}else"fit"===this.options.width?(this.$menu.css("min-width",""),this.$newElement.css("width","").addClass("fit-width")):this.options.width?(this.$menu.css("min-width",""),this.$newElement.css("width",this.options.width)):(this.$menu.css("min-width",""),this.$newElement.css("width",""));this.$newElement.hasClass("fit-width")&&"fit"!==this.options.width&&this.$newElement.removeClass("fit-width")},selectPosition:function(){this.$bsContainer=a('<div class="bs-container" />');var b,c,d,e=this,f=a(this.options.container),g=function(a){e.$bsContainer.addClass(a.attr("class").replace(/form-control|fit-width/gi,"")).toggleClass("dropup",a.hasClass("dropup")),b=a.offset(),f.is("body")?c={top:0,left:0}:(c=f.offset(),c.top+=parseInt(f.css("borderTopWidth"))-f.scrollTop(),c.left+=parseInt(f.css("borderLeftWidth"))-f.scrollLeft()),d=a.hasClass("dropup")?0:a[0].offsetHeight,e.$bsContainer.css({top:b.top-c.top+d,left:b.left-c.left,width:a[0].offsetWidth})};this.$button.on("click",function(){var b=a(this);e.isDisabled()||(g(e.$newElement),e.$bsContainer.appendTo(e.options.container).toggleClass("open",!b.hasClass("open")).append(e.$menu))}),a(window).on("resize scroll",function(){g(e.$newElement)}),this.$element.on("hide.bs.select",function(){e.$menu.data("height",e.$menu.height()),e.$bsContainer.detach()})},setSelected:function(a,b,c){c||(this.togglePlaceholder(),c=this.findLis().eq(this.liObj[a])),c.toggleClass("selected",b).find("a").attr("aria-selected",b)},setDisabled:function(a,b,c){c||(c=this.findLis().eq(this.liObj[a])),b?c.addClass("disabled").children("a").attr("href","#").attr("tabindex",-1).attr("aria-disabled",!0):c.removeClass("disabled").children("a").removeAttr("href").attr("tabindex",0).attr("aria-disabled",!1)},isDisabled:function(){return this.$element[0].disabled},checkDisabled:function(){var a=this;this.isDisabled()?(this.$newElement.addClass("disabled"),this.$button.addClass("disabled").attr("tabindex",-1).attr("aria-disabled",!0)):(this.$button.hasClass("disabled")&&(this.$newElement.removeClass("disabled"),this.$button.removeClass("disabled").attr("aria-disabled",!1)),this.$button.attr("tabindex")!=-1||this.$element.data("tabindex")||this.$button.removeAttr("tabindex")),this.$button.click(function(){return!a.isDisabled()})},togglePlaceholder:function(){var a=this.$element.val();this.$button.toggleClass("bs-placeholder",null===a||""===a||a.constructor===Array&&0===a.length)},tabIndex:function(){this.$element.data("tabindex")!==this.$element.attr("tabindex")&&this.$element.attr("tabindex")!==-98&&"-98"!==this.$element.attr("tabindex")&&(this.$element.data("tabindex",this.$element.attr("tabindex")),this.$button.attr("tabindex",this.$element.data("tabindex"))),this.$element.attr("tabindex",-98)},clickListener:function(){var b=this,c=a(document);c.data("spaceSelect",!1),this.$button.on("keyup",function(a){/(32)/.test(a.keyCode.toString(10))&&c.data("spaceSelect")&&(a.preventDefault(),c.data("spaceSelect",!1))}),this.$button.on("click",function(){b.setSize()}),this.$element.on("shown.bs.select",function(){if(b.options.liveSearch||b.multiple){if(!b.multiple){var a=b.liObj[b.$element[0].selectedIndex];if("number"!=typeof a||b.options.size===!1)return;var c=b.$lis.eq(a)[0].offsetTop-b.$menuInner[0].offsetTop;c=c-b.$menuInner[0].offsetHeight/2+b.sizeInfo.liHeight/2,b.$menuInner[0].scrollTop=c}}else b.$menuInner.find(".selected a").focus()}),this.$menuInner.on("click","li a",function(c){var d=a(this),f=d.parent().data("originalIndex"),g=b.$element.val(),h=b.$element.prop("selectedIndex"),i=!0;if(b.multiple&&1!==b.options.maxOptions&&c.stopPropagation(),c.preventDefault(),!b.isDisabled()&&!d.parent().hasClass("disabled")){var j=b.$element.find("option"),k=j.eq(f),l=k.prop("selected"),m=k.parent("optgroup"),n=b.options.maxOptions,o=m.data("maxOptions")||!1;if(b.multiple){if(k.prop("selected",!l),b.setSelected(f,!l),d.blur(),n!==!1||o!==!1){var p=n<j.filter(":selected").length,q=o<m.find("option:selected").length;if(n&&p||o&&q)if(n&&1==n)j.prop("selected",!1),k.prop("selected",!0),b.$menuInner.find(".selected").removeClass("selected"),b.setSelected(f,!0);else if(o&&1==o){m.find("option:selected").prop("selected",!1),k.prop("selected",!0);var r=d.parent().data("optgroup");b.$menuInner.find('[data-optgroup="'+r+'"]').removeClass("selected"),b.setSelected(f,!0)}else{var s="string"==typeof b.options.maxOptionsText?[b.options.maxOptionsText,b.options.maxOptionsText]:b.options.maxOptionsText,t="function"==typeof s?s(n,o):s,u=t[0].replace("{n}",n),v=t[1].replace("{n}",o),w=a('<div class="notify"></div>');t[2]&&(u=u.replace("{var}",t[2][n>1?0:1]),v=v.replace("{var}",t[2][o>1?0:1])),k.prop("selected",!1),b.$menu.append(w),n&&p&&(w.append(a("<div>"+u+"</div>")),i=!1,b.$element.trigger("maxReached.bs.select")),o&&q&&(w.append(a("<div>"+v+"</div>")),i=!1,b.$element.trigger("maxReachedGrp.bs.select")),setTimeout(function(){b.setSelected(f,!1)},10),w.delay(750).fadeOut(300,function(){a(this).remove()})}}}else j.prop("selected",!1),k.prop("selected",!0),b.$menuInner.find(".selected").removeClass("selected").find("a").attr("aria-selected",!1),b.setSelected(f,!0);!b.multiple||b.multiple&&1===b.options.maxOptions?b.$button.focus():b.options.liveSearch&&b.$searchbox.focus(),i&&(g!=b.$element.val()&&b.multiple||h!=b.$element.prop("selectedIndex")&&!b.multiple)&&(e=[f,k.prop("selected"),l],b.$element.triggerNative("change"))}}),this.$menu.on("click","li.disabled a, .popover-title, .popover-title :not(.close)",function(c){c.currentTarget==this&&(c.preventDefault(),c.stopPropagation(),b.options.liveSearch&&!a(c.target).hasClass("close")?b.$searchbox.focus():b.$button.focus())}),this.$menuInner.on("click",".divider, .dropdown-header",function(a){a.preventDefault(),a.stopPropagation(),b.options.liveSearch?b.$searchbox.focus():b.$button.focus()}),this.$menu.on("click",".popover-title .close",function(){b.$button.click()}),this.$searchbox.on("click",function(a){a.stopPropagation()}),this.$menu.on("click",".actions-btn",function(c){b.options.liveSearch?b.$searchbox.focus():b.$button.focus(),c.preventDefault(),c.stopPropagation(),a(this).hasClass("bs-select-all")?b.selectAll():b.deselectAll()}),this.$element.change(function(){b.render(!1),b.$element.trigger("changed.bs.select",e),e=null})},liveSearchListener:function(){var c=this,d=a('<li class="no-results"></li>');this.$button.on("click.dropdown.data-api",function(){c.$menuInner.find(".active").removeClass("active"),c.$searchbox.val()&&(c.$searchbox.val(""),c.$lis.not(".is-hidden").removeClass("hidden"),d.parent().length&&d.remove()),c.multiple||c.$menuInner.find(".selected").addClass("active"),setTimeout(function(){c.$searchbox.focus()},10)}),this.$searchbox.on("click.dropdown.data-api focus.dropdown.data-api touchend.dropdown.data-api",function(a){a.stopPropagation()}),this.$searchbox.on("input propertychange",function(){if(c.$lis.not(".is-hidden").removeClass("hidden"),c.$lis.filter(".active").removeClass("active"),d.remove(),c.$searchbox.val()){var e,f=c.$lis.not(".is-hidden, .divider, .dropdown-header");if(e=c.options.liveSearchNormalize?f.not(":a"+c._searchStyle()+'("'+b(c.$searchbox.val())+'")'):f.not(":"+c._searchStyle()+'("'+c.$searchbox.val()+'")'),e.length===f.length)d.html(c.options.noneResultsText.replace("{0}",'"'+j(c.$searchbox.val())+'"')),c.$menuInner.append(d),c.$lis.addClass("hidden");else{e.addClass("hidden");var g,h=c.$lis.not(".hidden");h.each(function(b){var c=a(this);c.hasClass("divider")?void 0===g?c.addClass("hidden"):(g&&g.addClass("hidden"),g=c):c.hasClass("dropdown-header")&&h.eq(b+1).data("optgroup")!==c.data("optgroup")?c.addClass("hidden"):g=null}),g&&g.addClass("hidden"),f.not(".hidden").first().addClass("active"),c.$menuInner.scrollTop(0)}}})},_searchStyle:function(){var a={begins:"ibegins",startsWith:"ibegins"};return a[this.options.liveSearchStyle]||"icontains"},val:function(a){return"undefined"!=typeof a?(this.$element.val(a),this.render(),this.$element):this.$element.val()},changeAll:function(b){if(this.multiple){"undefined"==typeof b&&(b=!0),this.findLis();var c=this.$element.find("option"),d=this.$lis.not(".divider, .dropdown-header, .disabled, .hidden"),e=d.length,f=[];if(b){if(d.filter(".selected").length===d.length)return}else if(0===d.filter(".selected").length)return;d.toggleClass("selected",b);for(var g=0;g<e;g++){var h=d[g].getAttribute("data-original-index");f[f.length]=c.eq(h)[0]}a(f).prop("selected",b),this.render(!1),this.togglePlaceholder(),this.$element.triggerNative("change")}},selectAll:function(){return this.changeAll(!0)},deselectAll:function(){return this.changeAll(!1)},toggle:function(a){a=a||window.event,a&&a.stopPropagation(),this.$button.trigger("click")},keydown:function(b){var c,d,e,f,g=a(this),h=g.is("input")?g.parent().parent():g.parent(),i=h.data("this"),j=":not(.disabled, .hidden, .dropdown-header, .divider)",k={32:" ",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9"};if(f=i.$newElement.hasClass("open"),!f&&(b.keyCode>=48&&b.keyCode<=57||b.keyCode>=96&&b.keyCode<=105||b.keyCode>=65&&b.keyCode<=90))return i.options.container?i.$button.trigger("click"):(i.setSize(),i.$menu.parent().addClass("open"),f=!0),void i.$searchbox.focus();if(i.options.liveSearch&&/(^9$|27)/.test(b.keyCode.toString(10))&&f&&(b.preventDefault(),b.stopPropagation(),i.$menuInner.click(),i.$button.focus()),/(38|40)/.test(b.keyCode.toString(10))){if(c=i.$lis.filter(j),!c.length)return;d=i.options.liveSearch?c.index(c.filter(".active")):c.index(c.find("a").filter(":focus").parent()),e=i.$menuInner.data("prevIndex"),38==b.keyCode?(!i.options.liveSearch&&d!=e||d==-1||d--,d<0&&(d+=c.length)):40==b.keyCode&&((i.options.liveSearch||d==e)&&d++,d%=c.length),i.$menuInner.data("prevIndex",d),i.options.liveSearch?(b.preventDefault(),g.hasClass("dropdown-toggle")||(c.removeClass("active").eq(d).addClass("active").children("a").focus(),g.focus())):c.eq(d).children("a").focus()}else if(!g.is("input")){var l,m,n=[];c=i.$lis.filter(j),c.each(function(c){a.trim(a(this).children("a").text().toLowerCase()).substring(0,1)==k[b.keyCode]&&n.push(c)}),l=a(document).data("keycount"),l++,a(document).data("keycount",l),m=a.trim(a(":focus").text().toLowerCase()).substring(0,1),m!=k[b.keyCode]?(l=1,a(document).data("keycount",l)):l>=n.length&&(a(document).data("keycount",0),l>n.length&&(l=1)),c.eq(n[l-1]).children("a").focus()}if((/(13|32)/.test(b.keyCode.toString(10))||/(^9$)/.test(b.keyCode.toString(10))&&i.options.selectOnTab)&&f){if(/(32)/.test(b.keyCode.toString(10))||b.preventDefault(),i.options.liveSearch)/(32)/.test(b.keyCode.toString(10))||(i.$menuInner.find(".active a").click(),g.focus());else{var o=a(":focus");o.click(),o.focus(),b.preventDefault(),a(document).data("spaceSelect",!0)}a(document).data("keycount",0)}(/(^9$|27)/.test(b.keyCode.toString(10))&&f&&(i.multiple||i.options.liveSearch)||/(27)/.test(b.keyCode.toString(10))&&!f)&&(i.$menu.parent().removeClass("open"),i.options.container&&i.$newElement.removeClass("open"),i.$button.focus())},mobile:function(){this.$element.addClass("mobile-device")},refresh:function(){this.$lis=null,this.liObj={},this.reloadLi(),this.render(),this.checkDisabled(),this.liHeight(!0),this.setStyle(),
this.setWidth(),this.$lis&&this.$searchbox.trigger("propertychange"),this.$element.trigger("refreshed.bs.select")},hide:function(){this.$newElement.hide()},show:function(){this.$newElement.show()},remove:function(){this.$newElement.remove(),this.$element.remove()},destroy:function(){this.$newElement.before(this.$element).remove(),this.$bsContainer?this.$bsContainer.remove():this.$menu.remove(),this.$element.off(".bs.select").removeData("selectpicker").removeClass("bs-select-hidden selectpicker")}};var m=a.fn.selectpicker;a.fn.selectpicker=c,a.fn.selectpicker.Constructor=l,a.fn.selectpicker.noConflict=function(){return a.fn.selectpicker=m,this},a(document).data("keycount",0).on("keydown.bs.select",'.bootstrap-select [data-toggle=dropdown], .bootstrap-select [role="listbox"], .bs-searchbox input',l.prototype.keydown).on("focusin.modal",'.bootstrap-select [data-toggle=dropdown], .bootstrap-select [role="listbox"], .bs-searchbox input',function(a){a.stopPropagation()}),a(window).on("load.bs.select.data-api",function(){a(".selectpicker").each(function(){var b=a(this);c.call(b,b.data())})})}(a)});
!function(a,b){"use strict";"undefined"!=typeof module&&module.exports?module.exports=b(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],function(a){return b(a)}):b(a.jQuery)}(this,function(a){"use strict";var b=function(c,d){this.$element=a(c),this.options=a.extend({},b.defaults,d),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.select=this.options.select||this.select,this.autoSelect="boolean"!=typeof this.options.autoSelect||this.options.autoSelect,this.highlighter=this.options.highlighter||this.highlighter,this.render=this.options.render||this.render,this.updater=this.options.updater||this.updater,this.displayText=this.options.displayText||this.displayText,this.itemLink=this.options.itemLink||this.itemLink,this.followLinkOnSelect=this.options.followLinkOnSelect||this.followLinkOnSelect,this.source=this.options.source,this.delay=this.options.delay,this.$menu=a(this.options.menu),this.$appendTo=this.options.appendTo?a(this.options.appendTo):null,this.fitToElement="boolean"==typeof this.options.fitToElement&&this.options.fitToElement,this.shown=!1,this.listen(),this.showHintOnFocus=("boolean"==typeof this.options.showHintOnFocus||"all"===this.options.showHintOnFocus)&&this.options.showHintOnFocus,this.afterSelect=this.options.afterSelect,this.afterEmptySelect=this.options.afterEmptySelect,this.addItem=!1,this.value=this.$element.val()||this.$element.text(),this.keyPressed=!1,this.focused=this.$element.is(":focus")};b.prototype={constructor:b,setDefault:function(a){if(this.$element.data("active",a),this.autoSelect||a){var b=this.updater(a);b||(b=""),this.$element.val(this.displayText(b)||b).text(this.displayText(b)||b).change(),this.afterSelect(b)}return this.hide()},select:function(){var a=this.$menu.find(".active").data("value");if(this.$element.data("active",a),this.autoSelect||a){var b=this.updater(a);b||(b=""),this.$element.val(this.displayText(b)||b).text(this.displayText(b)||b).change(),this.afterSelect(b),this.followLinkOnSelect&&this.itemLink(a)?(document.location=this.itemLink(a),this.afterSelect(b)):this.followLinkOnSelect&&!this.itemLink(a)?this.afterEmptySelect(b):this.afterSelect(b)}else this.afterEmptySelect(b);return this.hide()},updater:function(a){return a},setSource:function(a){this.source=a},show:function(){var b,c=a.extend({},this.$element.position(),{height:this.$element[0].offsetHeight}),d="function"==typeof this.options.scrollHeight?this.options.scrollHeight.call():this.options.scrollHeight;if(this.shown?b=this.$menu:this.$appendTo?(b=this.$menu.appendTo(this.$appendTo),this.hasSameParent=this.$appendTo.is(this.$element.parent())):(b=this.$menu.insertAfter(this.$element),this.hasSameParent=!0),!this.hasSameParent){b.css("position","fixed");var e=this.$element.offset();c.top=e.top,c.left=e.left}var f=a(b).parent().hasClass("dropup"),g=f?"auto":c.top+c.height+d,h=a(b).hasClass("dropdown-menu-right"),i=h?"auto":c.left;return b.css({top:g,left:i}).show(),!0===this.options.fitToElement&&b.css("width",this.$element.outerWidth()+"px"),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(b){if(this.query=void 0!==b&&null!==b?b:this.$element.val(),this.query.length<this.options.minLength&&!this.options.showHintOnFocus)return this.shown?this.hide():this;var c=a.proxy(function(){a.isFunction(this.source)&&3===this.source.length?this.source(this.query,a.proxy(this.process,this),a.proxy(this.process,this)):a.isFunction(this.source)?this.source(this.query,a.proxy(this.process,this)):this.source&&this.process(this.source)},this);clearTimeout(this.lookupWorker),this.lookupWorker=setTimeout(c,this.delay)},process:function(b){var c=this;return b=a.grep(b,function(a){return c.matcher(a)}),b=this.sorter(b),b.length||this.options.addItem?(b.length>0?this.$element.data("active",b[0]):this.$element.data("active",null),"all"!=this.options.items&&(b=b.slice(0,this.options.items)),this.options.addItem&&b.push(this.options.addItem),this.render(b).show()):this.shown?this.hide():this},matcher:function(a){return~this.displayText(a).toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(a){for(var b,c=[],d=[],e=[];b=a.shift();){var f=this.displayText(b);f.toLowerCase().indexOf(this.query.toLowerCase())?~f.indexOf(this.query)?d.push(b):e.push(b):c.push(b)}return c.concat(d,e)},highlighter:function(a){var b=this.query;if(""===b)return a;var c,d=a.match(/(>)([^<]*)(<)/g),e=[],f=[];if(d&&d.length)for(c=0;c<d.length;++c)d[c].length>2&&e.push(d[c]);else e=[],e.push(a);b=b.replace(/[\(\)\/\.\*\+\?\[\]]/g,function(a){return"\\"+a});var g,h=new RegExp(b,"g");for(c=0;c<e.length;++c)(g=e[c].match(h))&&g.length>0&&f.push(e[c]);for(c=0;c<f.length;++c)a=a.replace(f[c],f[c].replace(h,"<strong>$&</strong>"));return a},render:function(b){var c=this,d=this,e=!1,f=[],g=c.options.separator;return a.each(b,function(a,c){a>0&&c[g]!==b[a-1][g]&&f.push({__type:"divider"}),!c[g]||0!==a&&c[g]===b[a-1][g]||f.push({__type:"category",name:c[g]}),f.push(c)}),b=a(f).map(function(b,f){if("category"==(f.__type||!1))return a(c.options.headerHtml).text(f.name)[0];if("divider"==(f.__type||!1))return a(c.options.headerDivider)[0];var g=d.displayText(f);return b=a(c.options.item).data("value",f),b.find(c.options.itemContentSelector).addBack(c.options.itemContentSelector).html(c.highlighter(g,f)),this.followLinkOnSelect&&b.find("a").attr("href",d.itemLink(f)),g==d.$element.val()&&(b.addClass("active"),d.$element.data("active",f),e=!0),b[0]}),this.autoSelect&&!e&&(b.filter(":not(.dropdown-header)").first().addClass("active"),this.$element.data("active",b.first().data("value"))),this.$menu.html(b),this},displayText:function(a){return void 0!==a&&void 0!==a.name?a.name:a},itemLink:function(a){return null},next:function(b){var c=this.$menu.find(".active").removeClass("active"),d=c.next();d.length||(d=a(this.$menu.find("li")[0])),d.addClass("active");var e=this.updater(d.data("value"));this.$element.val(this.displayText(e)||e)},prev:function(a){var b=this.$menu.find(".active").removeClass("active"),c=b.prev();c.length||(c=this.$menu.find("li").last()),c.addClass("active");var d=this.updater(c.data("value"));this.$element.val(this.displayText(d)||d)},listen:function(){this.$element.on("focus.bootstrap3Typeahead",a.proxy(this.focus,this)).on("blur.bootstrap3Typeahead",a.proxy(this.blur,this)).on("keypress.bootstrap3Typeahead",a.proxy(this.keypress,this)).on("propertychange.bootstrap3Typeahead input.bootstrap3Typeahead",a.proxy(this.input,this)).on("keyup.bootstrap3Typeahead",a.proxy(this.keyup,this)),this.eventSupported("keydown")&&this.$element.on("keydown.bootstrap3Typeahead",a.proxy(this.keydown,this)),"ontouchstart"in document.documentElement?this.$menu.on("touchstart","li",a.proxy(this.touchstart,this)).on("touchend","li",a.proxy(this.click,this)):this.$menu.on("click",a.proxy(this.click,this)).on("mouseenter","li",a.proxy(this.mouseenter,this)).on("mouseleave","li",a.proxy(this.mouseleave,this)).on("mousedown",a.proxy(this.mousedown,this))},destroy:function(){this.$element.data("typeahead",null),this.$element.data("active",null),this.$element.unbind("focus.bootstrap3Typeahead").unbind("blur.bootstrap3Typeahead").unbind("keypress.bootstrap3Typeahead").unbind("propertychange.bootstrap3Typeahead input.bootstrap3Typeahead").unbind("keyup.bootstrap3Typeahead"),this.eventSupported("keydown")&&this.$element.unbind("keydown.bootstrap3-typeahead"),this.$menu.remove(),this.destroyed=!0},eventSupported:function(a){var b=a in this.$element;return b||(this.$element.setAttribute(a,"return;"),b="function"==typeof this.$element[a]),b},move:function(a){if(this.shown)switch(a.keyCode){case 9:case 13:case 27:a.preventDefault();break;case 38:if(a.shiftKey)return;a.preventDefault(),this.prev();break;case 40:if(a.shiftKey)return;a.preventDefault(),this.next()}},keydown:function(b){this.keyPressed=!0,this.suppressKeyPressRepeat=~a.inArray(b.keyCode,[40,38,9,13,27]),this.shown||40!=b.keyCode?this.move(b):this.lookup()},keypress:function(a){this.suppressKeyPressRepeat||this.move(a)},input:function(a){var b=this.$element.val()||this.$element.text();this.value!==b&&(this.value=b,this.lookup())},keyup:function(a){if(!this.destroyed)switch(a.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:if(!this.shown||this.showHintOnFocus&&!this.keyPressed)return;this.select();break;case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide()}},focus:function(a){this.focused||(this.focused=!0,this.keyPressed=!1,this.options.showHintOnFocus&&!0!==this.skipShowHintOnFocus&&("all"===this.options.showHintOnFocus?this.lookup(""):this.lookup())),this.skipShowHintOnFocus&&(this.skipShowHintOnFocus=!1)},blur:function(a){this.mousedover||this.mouseddown||!this.shown?this.mouseddown&&(this.skipShowHintOnFocus=!0,this.$element.focus(),this.mouseddown=!1):(this.select(),this.hide(),this.focused=!1,this.keyPressed=!1)},click:function(a){a.preventDefault(),this.skipShowHintOnFocus=!0,this.select(),this.$element.focus(),this.hide()},mouseenter:function(b){this.mousedover=!0,this.$menu.find(".active").removeClass("active"),a(b.currentTarget).addClass("active")},mouseleave:function(a){this.mousedover=!1,!this.focused&&this.shown&&this.hide()},mousedown:function(a){this.mouseddown=!0,this.$menu.one("mouseup",function(a){this.mouseddown=!1}.bind(this))},touchstart:function(b){b.preventDefault(),this.$menu.find(".active").removeClass("active"),a(b.currentTarget).addClass("active")},touchend:function(a){a.preventDefault(),this.select(),this.$element.focus()}};var c=a.fn.typeahead;a.fn.typeahead=function(c){var d=arguments;return"string"==typeof c&&"getActive"==c?this.data("active"):this.each(function(){var e=a(this),f=e.data("typeahead"),g="object"==typeof c&&c;f||e.data("typeahead",f=new b(this,g)),"string"==typeof c&&f[c]&&(d.length>1?f[c].apply(f,Array.prototype.slice.call(d,1)):f[c]())})},b.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu" role="listbox"></ul>',item:'<li><a class="dropdown-item" href="#" role="option"></a></li>',itemContentSelector:"a",minLength:1,scrollHeight:0,autoSelect:!0,afterSelect:a.noop,afterEmptySelect:a.noop,addItem:!1,followLinkOnSelect:!1,delay:0,separator:"category",headerHtml:'<li class="dropdown-header"></li>',headerDivider:'<li class="divider" role="separator"></li>'},a.fn.typeahead.Constructor=b,a.fn.typeahead.noConflict=function(){return a.fn.typeahead=c,this},a(document).on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(b){var c=a(this);c.data("typeahead")||c.typeahead(c.data())})});/* jquery.okayNav.js 1.0.1
* Created by Vergil Penkov (http://vergilpenkov.com/), MIT license. */
!function(n,i,a,e){function t(i,e){this.options=n.extend({},v,e),_okayNav=this,_invisibleNavState=!1,_options=this.options,$document=n(a),$body=n("body"),$navigation=n(i),""==this.options.parent?this.options.parent=$navigation.parent():"",_okayNav.init()}var o="okayNav",v={parent:"",toggle_icon_class:"okayNav__menu-toggle",toggle_icon_content:"<span /><span /><span />",beforeopen:function(){},open:function(){},beforeclose:function(){},close:function(){}};t.prototype={init:function(){_okayNav.setupElements($navigation),$nav_visible=$navigation.children(".okayNav__nav--visible"),$nav_invisible=$navigation.children(".okayNav__nav--invisible"),$nav_toggle_icon=$navigation.children("."+_options.toggle_icon_class),_nav_toggle_icon_width=$nav_toggle_icon.outerWidth(!0),_last_visible_child_width=0,_okayNav.initEvents()},setupElements:function(){$body.addClass("okayNav-loaded"),$navigation.addClass("okayNav loaded").children("ul").addClass("okayNav__nav--visible"),$navigation.append('<ul class="okayNav__nav--invisible" />').append('<a href="#" class="'+_options.toggle_icon_class+'">'+_options.toggle_icon_content+"</a>")},initEvents:function(){$document.on("click.okayNav","."+_options.toggle_icon_class,function(n){n.preventDefault(),_okayNav.toggleInvisibleNav()}),$document.on("click.okayNav",function(i){if(_invisibleNavState===!0){var a=n(i.target);a.parents().hasClass("okayNav")||_okayNav.closeInvisibleNav()}}),n(i).on("load.okayNav resize.okayNav",function(){_okayNav.recalcNav()})},getParent:function(){return _options.parent},getVisibleNav:function(){return $nav_visible},getInvisibleNav:function(){return $nav_invisible},getNavToggleIcon:function(){return $nav_toggle_icon},openInvisibleNav:function(){_options.beforeopen.call(),$nav_toggle_icon.addClass("icon--active"),$nav_invisible.addClass("nav-open"),_invisibleNavState=!0,_options.open.call(),$document.trigger("okayNav:open")},closeInvisibleNav:function(){_options.beforeclose.call(),$nav_toggle_icon.removeClass("icon--active"),$nav_invisible.removeClass("nav-open"),_invisibleNavState=!1,_options.close.call(),$document.trigger("okayNav:close")},toggleInvisibleNav:function(){_invisibleNavState?(_invisibleNavState=!1,_okayNav.closeInvisibleNav()):(_invisibleNavState=!0,_okayNav.openInvisibleNav())},getParentWidth:function(i){var a=i||_options.parent,e=n(a).outerWidth(!0);return e},getChildrenWidth:function(i){var a=0;return n(i).children().each(function(){a+=n(this).outerWidth(!0)}),a},countNavItems:function(i){var a=n(i),e=n("li",a).length;return e},recalcNav:function(){var i=n(_options.parent).outerWidth(!0),a=$navigation.outerWidth(!0),e=_okayNav.countNavItems($nav_visible),t=$nav_visible.outerWidth(!0)+_nav_toggle_icon_width-1,o=_okayNav.getChildrenWidth(_options.parent)+_last_visible_child_width+_nav_toggle_icon_width;e>0&&t>=a&&_okayNav.collapseNavItem(),i>o&&_okayNav.expandNavItem(),0==n("li",$nav_invisible).length?$nav_toggle_icon.hide():$nav_toggle_icon.show()},collapseNavItem:function(){var i=n("li:last-child",$nav_visible);_last_visible_child_width=i.outerWidth(!0),i.detach().prependTo($nav_invisible),_okayNav.recalcNav(),$document.trigger("okayNav:collapseItem")},expandNavItem:function(){n("li:first-child",$nav_invisible).detach().appendTo($nav_visible),$document.trigger("okayNav:expandItem")},destroy:function(){n("li",$nav_invisible).appendTo($nav_visible),$nav_invisible.remove(),$nav_visible.removeClass("okayNav__nav--visible"),$nav_toggle_icon.remove(),$document.unbind(".okayNav"),n(i).unbind(".okayNav")}},n.fn[o]=function(i){var a=arguments;if(i===e||"object"==typeof i)return this.each(function(){n.data(this,"plugin_"+o)||n.data(this,"plugin_"+o,new t(this,i))});if("string"==typeof i&&"_"!==i[0]&&"init"!==i){var v;return this.each(function(){var e=n.data(this,"plugin_"+o);e instanceof t&&"function"==typeof e[i]&&(v=e[i].apply(e,Array.prototype.slice.call(a,1))),"destroy"===i&&n.data(this,"plugin_"+o,null)}),v!==e?v:this}}}(jQuery,window,document);

function invalid_input_msg(obj,msg,class_name){class_name=typeof(class_name)=='undefined'?'mandatory':class_name;obj.className+=" "+class_name;if(typeof(top.fAlert)!="undefined"){top.fAlert(msg);}else if(typeof(fancyAlert)!="undefined"){top.fancyAlert(msg);}
obj.select();obj.focus();obj.value='';}
String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"");};String.prototype.trimMultiSpace=function(){return this.replace(/\s{2,}/g," ");};String.prototype.trimHyphen=function(){return this.replace(/^\-|\-$/g,"");};String.prototype.trimMultiHyphen=function(){return this.replace(/\-{2,}/g,"-");};function set_phone_format(objPhone,default_format,phone_length,msg_txt,class_name){phone_length=phone_length||top.phone_length;phone_min_length=top.phone_min_length;default_format=default_format||top.phone_format;msg_txt=msg_txt||"phone";class_name=typeof(class_name)=='undefined'?'mandatory':class_name;phone_reg_exp_js=(typeof(top.phone_reg_exp_js)!="undefined"&&typeof(top.phone_reg_exp_js)!=null&&top.phone_reg_exp_js!='')?top.phone_reg_exp_js:"[^0-9+]";regExp=new RegExp(phone_reg_exp_js,'g');var refinedPh=objPhone.value.replace(regExp,"");refinedPh=refinedPh.trim();refinedPh=refinedPh.trimHyphen();refinedPh=refinedPh.trimMultiHyphen();refinedPh=refinedPh.trimMultiSpace();if(refinedPh.length<phone_min_length){invalid_input_msg(objPhone,"Please Enter a valid "+msg_txt+" number",class_name);return;}else{refinedPh=refinedPh.substr(0,phone_length);switch(default_format){case"###-###-####":objPhone.value=refinedPh.substring(0,3)+"-"+refinedPh.substring(3,6)+"-"+refinedPh.substring(6,10);break;case"(###) ###-####":objPhone.value="("+refinedPh.substring(0,3)+") "+refinedPh.substring(3,6)+"-"+refinedPh.substring(6,10);break;case"(##) ###-####":objPhone.value="("+refinedPh.substring(0,2)+") "+refinedPh.substring(2,5)+"-"+refinedPh.substring(5,9);break;case"(###) ###-###":objPhone.value="("+refinedPh.substring(0,3)+") "+refinedPh.substring(3,6)+"-"+refinedPh.substring(6,9);break;case"(####) ######":objPhone.value="("+refinedPh.substring(0,4)+") "+refinedPh.substring(4,10);break;case"(####) #####":objPhone.value="("+refinedPh.substring(0,4)+") "+refinedPh.substring(4,9);break;case"(#####) #####":objPhone.value="("+refinedPh.substring(0,5)+") "+refinedPh.substring(5,10);break;case"(#####) ####":objPhone.value="("+refinedPh.substring(0,5)+") "+refinedPh.substring(5,9);break;default:objPhone.value=refinedPh;break;}}}
function core_phone_format(phone,default_format,phone_length){phone_length=phone_length||top.phone_length;phone_min_length=top.phone_min_length;default_format=default_format||top.phone_format;phone_reg_exp_js=(typeof(top.phone_reg_exp_js)!="undefined"&&typeof(top.phone_reg_exp_js)!=null&&top.phone_reg_exp_js!='')?top.phone_reg_exp_js:"[^0-9+]";regExp=new RegExp(phone_reg_exp_js,'g');var refinedPh=phone.replace(regExp,"");refinedPh=refinedPh.trim();refinedPh=refinedPh.trimHyphen();refinedPh=refinedPh.trimMultiHyphen();refinedPh=refinedPh.trimMultiSpace();var formatted_phone='';if(refinedPh.length<phone_min_length){return formatted_phone;}else{refinedPh=refinedPh.substr(0,phone_length);switch(default_format){case"###-###-####":formatted_phone=refinedPh.substring(0,3)+"-"+refinedPh.substring(3,6)+"-"+refinedPh.substring(6,10);break;case"(###) ###-####":formatted_phone="("+refinedPh.substring(0,3)+") "+refinedPh.substring(3,6)+"-"+refinedPh.substring(6,10);break;case"(##) ###-####":formatted_phone="("+refinedPh.substring(0,2)+") "+refinedPh.substring(2,5)+"-"+refinedPh.substring(5,9);break;case"(###) ###-###":formatted_phone="("+refinedPh.substring(0,3)+") "+refinedPh.substring(3,6)+"-"+refinedPh.substring(6,9);break;case"(####) ######":formatted_phone="("+refinedPh.substring(0,4)+") "+refinedPh.substring(4,10);break;case"(####) #####":formatted_phone="("+refinedPh.substring(0,4)+") "+refinedPh.substring(4,9);break;case"(#####) #####":formatted_phone="("+refinedPh.substring(0,5)+") "+refinedPh.substring(5,10);break;case"(#####) ####":formatted_phone="("+refinedPh.substring(0,5)+") "+refinedPh.substring(5,9);break;default:formatted_phone=refinedPh;break;}
return formatted_phone;}}
function isDefined(variable){return(!(!(variable||false)))}
window.onload=make_maindiv_full;function make_maindiv_full(){wh=window.screen.availHeight-100;if(isDefined(dgi('main'))){dgi('main').style.height=wh+'px';if(isDefined(dgi('iMedicDiv')))dgi('iMedicDiv').style.height=wh-180+"px";if(isDefined(dgi('iMedicFrame')))dgi('iMedicFrame').style.height=wh-182+"px";}}
function foo(){}
function ele(id,task){dgi(id).style.display=task;}
function dgi(id){return document.getElementById(id);}
function dgn(name){return document.getElementsByName(name);}
function dgt(tag){return document.getElementsByTagName(tag);}
function charlimit(field,count,showin){var tex=field.value;var len=tex.length;if(len>count){tex=tex.substring(0,count);field.value=tex;return false;}dgi(showin).innerHTML=count-len;}
function trim(val){return val.replace(/^\s+|\s+$/,'');}
function alphanum(o,w){var r={'special':/[\W]/g};o.value=o.value.replace(r[w],'');}
function emv(entered){with(entered){apos=entered.indexOf("@");dotpos=entered.lastIndexOf(".");lastpos=entered.length-1;if(apos<1||dotpos-apos<2||lastpos-dotpos>3||lastpos-dotpos<2){return false;}else{return true;}}}
function wl(url){window.location.href=url;}
function pageWidth(){return window.innerWidth!=null?window.innerWidth:document.documentElement&&document.documentElement.clientWidth?document.documentElement.clientWidth:document.body!=null?document.body.clientWidth:null;}
function pageHeight(){return window.innerHeight!=null?window.innerHeight:document.documentElement&&document.documentElement.clientHeight?document.documentElement.clientHeight:document.body!=null?document.body.clientHeight:null;}
function topPosition(){return typeof window.pageYOffset!='undefined'?window.pageYOffset:document.documentElement&&document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop?document.body.scrollTop:0;}
function leftPosition(){return typeof window.pageXOffset!='undefined'?window.pageXOffset:document.documentElement&&document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft?document.body.scrollLeft:0;}
function fancyAlert(msg,title,callback,obj,facnyBtn1,facnyBtn2,func1,func2,mask,maskOpacity,width,height_adjustment,autoClose,showClose,left,top,drag,facnyBtn3,func3){var isCenter="";left=left||"";top=top||"";if(typeof(width)=="undefined")width=300;if(typeof(autoClose)=="undefined"||!autoClose)autoClose="yes";if(typeof(title)!="string")title='imwemr';if(title=="")title='imwemr';if(callback==null){callback='';}
if(!facnyBtn1){facnyBtn1='OK';}
if(!facnyBtn2){facnyBtn2=false;}
if(!facnyBtn3){facnyBtn3=false;}
if(!func1){func1=callback;}
if(!func2){func2=callback;}
if(!func3){func3=callback;}
if(typeof(mask)!="boolean"){mask=true;}
if(typeof(drag)!="boolean"){drag=true;}
if(autoClose=="yes"){func1='closeDialog();'+func1;func2='closeDialog();'+func2;}
if((left!="")||(top!="")){isCenter=false}
dialogBox(title,msg,facnyBtn1,facnyBtn2,func1,func2,false,mask,drag,callback,width,"",isCenter,left,top,showClose,obj,maskOpacity,height_adjustment,facnyBtn3,func3);}
function dialogBox(title,msgg,btn1,btn2,func1,func2,btnCancel,mask,drag,callback,w,h,isCenter,l,t,showClose,inThis,maskOpacity,height_adjustment,btn3,func3)
{var text='';if((typeof(w)=="string"&&w=='default')||typeof(w)=="undefined"||w<=0){w="500px";}else{w=(parseInt(w)+60)+"px";}
if((typeof(h)=="string"&&h=='default')||typeof(h)=="undefined"||h<=0){h="auto";}else{h=parseInt(h)+"px";}
if(typeof(isCenter)!="boolean"){isCenter=true;}
if(!maskOpacity){maskOpacity=50;maskBrowserOpacity=0.5;}
if(typeof(mask)!="boolean"){mask=false;maskOpacity=0;maskBrowserOpacity=0;}
if(maskOpacity>0){maskBrowserOpacity=maskOpacity/100;}
if(typeof(drag)!="boolean"){drag=false;}
if(typeof(btnCancel)!="boolean"){btnCancel=false;}
if(typeof(showClose)!="boolean"){showClose=true;}
var width=pageWidth();var height=pageHeight();var left=leftPosition();var topP=topPosition();if(typeof(l)!="undefined"&&!isCenter){left=l+"px";}
if(typeof(t)!="undefined"&&!isCenter){topP=t+"px";}
var dialogwidth=w;var dialogheight=h;var topposition=100;var leftposition=parseInt(left)+(width/2)-(parseInt(dialogwidth)/2);if(typeof(dialogBoxCounter)=="undefined")dialogBoxCounter=0;else dialogBoxCounter++;if(callback==null){callback=false;}else if(callback==''){callback=false;}
var butonnsArr=new Array();YsAction=NoAction=ThirdAction='';if(typeof(btn1)=="string"&&typeof(func1)=="string"){butonnsArr[0]={'id':0,'label':btn1,'val':'Y'}
YsAction=func1;if(YsAction.indexOf('window.top.')==-1&&YsAction.indexOf('top.')==0){YsAction="window."+YsAction;}}
if(typeof(btn2)=="string"&&typeof(func2)=="string"){butonnsArr[butonnsArr.length]={'id':1,'label':btn2,'val':'N'}
if(func2!='return'&&func2!='return false'){NoAction=func2;if(NoAction!=false&&NoAction.indexOf('window.top.')==-1&&NoAction.indexOf('top.')==0){NoAction="window."+NoAction;}}}
if(typeof(btn3)=="string"&&typeof(func3)=="string"){butonnsArr[butonnsArr.length]={'id':2,'label':btn3,'val':'three'}
if(func3!='return'&&func3!='return false'){ThirdAction=func3;if(ThirdAction!=false&&ThirdAction.indexOf('window.top.')==-1&&ThirdAction.indexOf('top.')==0){ThirdAction="window."+NoAction;}}}
MessiOptionsArr={'title':title,'modal':true,'closeButton':true,'width':w,'height':h,'buttons':butonnsArr,'callback':function(val){if(val=='Y'){eval(YsAction);}else if(val=='N'&&NoAction!=false){eval(NoAction);}else if(val=='three'&&ThirdAction!=false){eval(ThirdAction);}}};max_h=parseInt(height)-180;msgg='<div style="max-height:'+max_h+'px; overflow:auto;">'+msgg+'</div>';new window.top.Messi(msgg,MessiOptionsArr);}
function closeDialog(callback){return;if(callback==null){callback=false;}else if(callback==''){callback=false;}else{callback='function(){'+callback+';}';}
$('body .dialogMask').fadeOut('slow');$('#divCon').fadeOut('slow');$('#divCon').parent('div,span').html('');}
var DragHandler={_oElem:null,attach:function(oElem){oElem.onmousedown=DragHandler._dragBegin;oElem.dragBegin=new Function();oElem.drag=new Function();oElem.dragEnd=new Function();return oElem;},_dragBegin:function(e){var oElem=DragHandler._oElem=this;if(isNaN(parseInt(oElem.style.left))){oElem.style.left='0px';}
if(isNaN(parseInt(oElem.style.top))){oElem.style.top='0px';}
var x=parseInt(oElem.style.left);var y=parseInt(oElem.style.top);e=e?e:window.event;oElem.mouseX=e.clientX;oElem.mouseY=e.clientY;oElem.dragBegin(oElem,x,y);document.onmousemove=DragHandler._drag;document.onmouseup=DragHandler._dragEnd;return false;},_drag:function(e){var oElem=DragHandler._oElem;var x=parseInt(oElem.style.left);var y=parseInt(oElem.style.top);e=e?e:window.event;oElem.style.left=x+(e.clientX-oElem.mouseX)+'px';oElem.style.top=y+(e.clientY-oElem.mouseY)+'px';oElem.mouseX=e.clientX;oElem.mouseY=e.clientY;oElem.drag(oElem,x,y);return false;},_dragEnd:function(){var oElem=DragHandler._oElem;var x=parseInt(oElem.style.left);var y=parseInt(oElem.style.top);oElem.dragEnd(oElem,x,y);document.onmousemove=null;document.onmouseup=null;DragHandler._oElem=null;}}
function isScrolledV(id){id='#'+id;OuterHeight=$(id).height();InnerHeight=$(id).prop('scrollHeight');Scrolled=$(id).scrollTop();if(OuterHeight+Scrolled>=InnerHeight)return true;else return false;}
window.document.onkeydown=function(event)
{switch(event.keyCode){case 121:event.returnValue=false;event.keyCode=0;alert('This will Close all the work and LogOut');return false;break;case 122:event.returnValue=false;event.keyCode=0;top.preview_patient_details(event);return false;break;case 27:case 116:do_audit='no';auditHome='no';audit='no';var switchUser=($("#div_switch_user").data('bs.modal')||{}).isShown;if(switchUser===true){return false;}
break;case 82:if(event.ctrlKey){do_audit='no';auditHome='no';audit='no';var switchUser=($("#div_switch_user").data('bs.modal')||{}).isShown;if(switchUser===true){event.preventDefault();return false;}}
break;}}
window.document.oncontextmenu=function(event){var switchUser=($("#div_switch_user").data('bs.modal')||{}).isShown;if(switchUser===true){event.stopPropagation();return false;}}
function fAlert(msg,title,actionToPerform,width,height,BtnCaption,ModalMode){if(typeof(title)=='undefined'||title=='')title='imwemr';if(typeof(actionToPerform)=='undefined')actionToPerform='';if(typeof(width)=='undefined'||width=='')width='500px';if(typeof(height)=='undefined'||height=='')height='auto';if(typeof(BtnCaption)=='undefined'||BtnCaption=='')BtnCaption='OK';if(typeof(ModalMode)!='boolean')ModalMode=true;if(BtnCaption=='CLOSE'||BtnCaption=='Close'){closeBtn=false;}else{closeBtn=true;}
msg='<div style="max-height:500px; overflow:auto;">'+msg+'</div>';if(typeof(Messi)=='function'){new Messi(msg,{'title':title,modal:ModalMode,'width':width,'closeButton':closeBtn,buttons:[{id:0,label:BtnCaption,val:'X'}],callback:function(){if(typeof(actionToPerform)=='string'&&actionToPerform!=''&&actionToPerform.indexOf('/*callmebeforeclosingmessi*/')>=0){actionToPerform;}else if(typeof(actionToPerform)=='string'&&actionToPerform!=''&&actionToPerform.indexOf('/*callmebeforeclosingmessi*/')<0){eval(actionToPerform);}else if(typeof(actionToPerform)=='object'){actionToPerform.focus();}}});}else if(typeof(window.top.Messi)=='function'){new window.top.Messi(escape(msg),{'title':title,modal:ModalMode,'width':width,'closeButton':closeBtn,buttons:[{id:0,label:BtnCaption,val:'X'}],callback:function(){if(typeof(actionToPerform)=='string'&&actionToPerform!=''&&actionToPerform.indexOf('/*callmebeforeclosingmessi*/')>=0){actionToPerform;}else if(typeof(actionToPerform)=='string'&&actionToPerform!=''&&actionToPerform.indexOf('/*callmebeforeclosingmessi*/')<0){eval(actionToPerform);}else if(typeof(actionToPerform)=='object'){actionToPerform.focus();}}});}}
function fancyConfirm(msg,title,YsAction,NoAction,width,height,btn1,btn2){if(typeof(YsAction)=='undefined'){YsAction=title;title='';}
if(typeof(title)=='undefined'||title=='')title='imwemr';if(typeof(width)=='undefined'||width=='')width='500px';if(typeof(NoAction)=='undefined'||NoAction=='')NoAction=false;if(YsAction.indexOf('window.top.')==-1&&YsAction.indexOf('top.')==0){YsAction="window."+YsAction;}
if(NoAction!=false&&NoAction.indexOf('window.top.')==-1&&NoAction.indexOf('top.')==0){NoAction="window."+NoAction;}
if(typeof(btn1)=='undefined'||btn1=='')btn1='Yes';if(typeof(btn2)=='undefined'||btn2=='')btn2='No';new window.top.Messi(msg,{'title':title,modal:true,'width':width,buttons:[{id:0,label:btn1,val:'Y',"class":'btn-success'},{id:1,label:btn2,val:'N',"class":'btn-danger'}],callback:function(val){if(val=='Y'){eval(YsAction);}else if(val=='N'&&NoAction!=false){eval(NoAction);}}});}
function fancyModal(html,title,w,h,closeBtn,po,ModalMode){if(typeof(title)!="string")title=null;if(typeof(w)!="string")w='';if(typeof(h)!="string")h='';if(typeof(closeBtn)=="undefined")closeBtn=true;if(typeof(po)!='undefined'){of=$(po).offset();}else po=false;if(typeof(ModalMode)!='boolean')ModalMode=true;if(po){new top.Messi(html,{'title':title,modal:ModalMode,'width':w,'height':h,'closeButton':closeBtn,center:false,viewport:{top:of.top+25,left:of.left+25}});}
else{new top.Messi(html,{'title':title,modal:ModalMode,'width':w,'height':h,'closeButton':closeBtn});}}
function removeMessi(){window.top.$('.messi-modal,.messi').remove();}
if(typeof($)!='undefined'){$(document).ready(function(e){$('form, input').attr('autocomplete','off');});$(document).ajaxComplete(function(event,request,settings){if(request.getResponseHeader('REQUIRES_AUTH')==='1'){top.window.location=top.JS_WEB_ROOT_PATH+'/interface/login/index.php';}});}
function fnArrDate(dateString,format){dateString=dateString||'';format=format||'yyyy-mm-dd'
separator=get_date_separator(dateString)
arrBirthDate=dateString.split(separator);switch(format){case"dd"+separator+"mm"+separator+"yyyy":date=arrBirthDate[0];month=arrBirthDate[1];year=arrBirthDate[2];break;case"mm"+separator+"dd"+separator+"yyyy":month=arrBirthDate[0];date=arrBirthDate[1];year=arrBirthDate[2];break;case"yyyy"+separator+"mm"+separator+"dd":year=arrBirthDate[0];month=arrBirthDate[1];date=arrBirthDate[2];break;case"yyyy"+separator+"dd"+separator+"mm":year=arrBirthDate[0];month=arrBirthDate[2];date=arrBirthDate[1];break;default:month=arrBirthDate[0];date=arrBirthDate[1];year=arrBirthDate[2];}
return[year,month,date]}
function get_date_separator(date){date=date||'';separator='-';if(date.search("-")!="-1")
separator="-";else if(date.search("/")!="-1")
separator="/";else if(date.search("/\\/")!="-1")
separator="\\";return separator;}
function validate_date(objName,format){date=typeof(objName)=="object"?objName.value:objName;if(date!=''){if(typeof(top.jquery_date_format)!="undefined"){jquery_date_format=top.jquery_date_format;}else if(typeof(opener.top.jquery_date_format)!="undefined"){jquery_date_format=opener.top.jquery_date_format;}else if(typeof(top.opener.top.jquery_date_format)!="undefined"){jquery_date_format=top.opener.top.jquery_date_format;}
format=format||jquery_date_format;separator=get_date_separator(format);var regex="";switch(format){case"dd"+separator+"mm"+separator+"yyyy":var regex=new RegExp("(((0[1-9]|[12][0-9]|3[01])["+separator+"](0[13578]|1[02])["+separator+"](19|20[0-9]{2}))|((0[1-9]|[12][0-9]|3[0])["+separator+"](0[469]|1[1])["+separator+"](19|20[0-9]{2}))|((0[1-9]|1[0-9]|2[0-9])["+separator+"](02)["+separator+"]((19|20)(04|08|[2468][048]|[13579][26])))|((0[1-9]|1[0-9]|2[0-8])["+separator+"](02)["+separator+"]((19|20)[0-9]{2})))");if(typeof(objName)=="object")
date=date.replace(/(\d{2})(\d{2})(\d{4})/,'$1'+separator+'$2'+separator+'$3');break;case"mm"+separator+"dd"+separator+"yyyy":var regex=new RegExp("(((0[13578]|1[02])["+separator+"](0[1-9]|[12][0-9]|3[01])["+separator+"](19|20[0-9]{2}))|((0[469]|1[1])["+separator+"](0[1-9]|[12][0-9]|3[0])["+separator+"](19|20[0-9]{2}))|((02)["+separator+"](0[1-9]|1[0-9]|2[0-9])["+separator+"]((19|20)(04|08|[2468][048]|[13579][26])))|((02)["+separator+"](0[1-9]|1[0-9]|2[0-8])["+separator+"]((19|20)[0-9]{2})))");if(typeof(objName)=="object")
date=date.replace(/(\d{2})(\d{2})(\d{4})/,'$1'+separator+'$2'+separator+'$3');break;case"mm"+separator+"dd"+separator+"yy":alert("mm"+separator+"dd"+separator+"yy");var regex=new RegExp("(((0[13578]|1[02])["+separator+"](0[1-9]|[12][0-9]|3[01])["+separator+"](19|20[0-9]{2}))|((0[469]|1[1])["+separator+"](0[1-9]|[12][0-9]|3[0])["+separator+"](19|20[0-9]{2}))|((02)["+separator+"](0[1-9]|1[0-9]|2[0-9])["+separator+"]((19|20)(04|08|[2468][048]|[13579][26])))|((02)["+separator+"](0[1-9]|1[0-9]|2[0-8])["+separator+"]((19|20)[0-9]{2})))");if(typeof(objName)=="object")
date=date.replace(/(\d{2})(\d{2})(\d{2})/,'$1'+separator+'$2'+separator+'$3');break;case"yyyy"+separator+"mm"+separator+"dd":var regex=new RegExp("(((19|20[0-9]{2})["+separator+"](0[13578]|1[02])["+separator+"](0[1-9]|[12][0-9]|3[01]))|((19|20[0-9]{2})["+separator+"](0[469]|1[1])["+separator+"](0[1-9]|[12][0-9]|3[0]))|(((19|20)(04|08|[2468][048]|[13579][26]))["+separator+"](02)["+separator+"](0[1-9]|1[0-9]|2[0-9]))|(((19|20)[0-9]{2}["+separator+"](02)["+separator+"](0[1-9]|1[0-9]|2[0-8]))))");if(typeof(objName)=="object")
date=date.replace(/(\d{4})(\d{2})(\d{2})/,'$1'+separator+'$2'+separator+'$3');break;case"yyyy"+separator+"dd"+separator+"mm":var regex=new RegExp("(((19|20[0-9]{2})["+separator+"](0[1-9]|[12][0-9]|3[01])["+separator+"](0[13578]|1[02]))|((19|20[0-9]{2})["+separator+"](0[1-9]|[12][0-9]|3[0])["+separator+"](0[469]|1[1]))|(((19|20)(04|08|[2468][048]|[13579][26]))["+separator+"](0[1-9]|1[0-9]|2[0-9])["+separator+"](02))|(((19|20)[0-9]{2}["+separator+"](0[1-9]|1[0-9]|2[0-8])["+separator+"](02))))");if(typeof(objName)=="object")
date=date.replace(/(\d{4})(\d{2})(\d{2})/,'$1'+separator+'$2'+separator+'$3');break;default:var regex=new RegExp("(((0[13578]|1[02])["+separator+"](0[1-9]|[12][0-9]|3[01])["+separator+"](19|20[0-9]{2}))|((0[469]|1[1])["+separator+"](0[1-9]|[12][0-9]|3[0])["+separator+"](19|20[0-9]{2}))|((02)["+separator+"](0[1-9]|1[0-9]|2[0-9])["+separator+"]((19|20)(04|08|[2468][048]|[13579][26])))|((02)["+separator+"](0[1-9]|1[0-9]|2[0-8])["+separator+"]((19|20)[0-9]{2})))");if(typeof(objName)=="object")
date=date.replace(/(\d{4})(\d{2})(\d{2})/,'$1'+separator+'$2'+separator+'$3');}
if(regex.test(date)){flag=true;objName.value=date;}
else flag=false;return flag;}}
function getDateFormat(date,inFormat,outFormat){arrDate=fnArrDate(date,inFormat);yy=arrDate[0];mm=arrDate[1];dd=arrDate[2];date_result='';if(date!=''){opener_top_date_format=''
if(opener!=null)opener_top_date_format=opener.top.date_format
outFormat=outFormat||top.date_format||opener_top_date_format;separator=get_date_separator(outFormat);switch(outFormat){case"dd"+separator+"mm"+separator+"yyyy":date_result=dd+separator+mm+separator+yy;break;case"yyyy"+separator+"mm"+separator+"dd":date_result=yy+separator+mm+separator+dd;break;case"yyyy"+separator+"dd"+separator+"mm":date_result=yy+separator+dd+separator+mm;break;default:date_result=mm+separator+dd+separator+yy;}}
return date_result;}
function validate_zip(inpObj){var borwser_name=get_browser();if(typeof(top.int_country)!="undefined"&&top.int_country=="UK")return true;zip_type=(typeof(opener)!='undefined'&&borwser_name!='chrome')?opener.top.zip_type:top.zip_type;switch(zip_type){case"numeric":regex=new RegExp("^[0-9- ]{0,"+top.zip_length+"}$","gi");replaceExp=new RegExp("[^0-9- ]","gi");break;case"alphanumeric":regex=new RegExp("^[0-9a-zA-Z- ]{0,"+top.zip_length+"}$","gi");replaceExp=new RegExp("[^0-9a-zA-Z- ]","gi");break;default:regex=new RegExp("^[0-9- ]{0,"+top.zip_length+"}$","gi");replaceExp=new RegExp("[^0-9- ]","gi");}
zip=inpObj.value;newZip='';if(zip!="")
newZip=zip.replace(replaceExp,"");if(zip!=newZip)
inpObj.value=newZip
if(regex.test(zip))
return true
else{return false;}}
function validate_ssn(objName,format,length){ssn=typeof(objName)=="object"?objName.value:objName;format=format||top.ssn_format;length=length||top.ssn_length;ssn_reg_exp_js=(typeof(top.ssn_reg_exp_js)!="undefined"&&typeof(top.ssn_reg_exp_js)!=null&&top.ssn_reg_exp_js!='')?top.ssn_reg_exp_js:"[^0-9\-+]";regExp=new RegExp(ssn_reg_exp_js,'g');refinedSSN=ssn.replace(regExp,"");refinedSSN=refinedSSN.replace(/[^0-9A-Za-z+]/g,'');refinedSSN=refinedSSN.substr(0,length);ssnLength=refinedSSN.replace(/[^0-9A-Za-z+]/g,'').length;if(ssnLength>0&&((format!=''&&ssnLength!=length)||(format==''&&ssnLength>length))){if(typeof(opener)!="undefined"){top.fAlert("Invalid Social Security Number (SSN)");}else{top.fAlert("Invalid Social Security Number (SSN)");}
objName.value='';return false;}else{switch(format){case"###-###-####":objName.value=refinedSSN.replace(/(\d{3})(\d{3})(\d{4})/,'$1-$2-$3');break;case"###-##-####":objName.value=refinedSSN.replace(/(\d{3})(\d{2})(\d{4})/,'$1-$2-$3');break;default:objName.value=refinedSSN;}}
return true;}
function checkdate(objName,type){type=type||'';if(validate_date(objName,type)==false&&objName.value!=''){objName.value="";objName.focus();if(typeof(opener)=='undefined'&&typeof(top.opener)=='undefined'){fAlert('Please enter a valid Date');top.document.getElementById("divCommonAlertMsg").style.display="block";}else{fAlert('Please enter a valid Date');}
return false;}
else{return true;}}
function get_browser(){browser='';if(navigator.userAgent.indexOf("MSIE")!=-1||!!navigator.userAgent.match(/Trident\/7\./)){browser="ie";}
else if(typeof(window.mozilla)=="object"){browser="mozilla";}
else if(typeof(window.chrome)=="object"){browser="chrome";}else if(navigator.userAgent.indexOf("Safari")!=-1){browser="safari";}
return browser;}
function show_clock(){var newDate=new Date();var C=new Date(newDate);var h=C.getHours();var m=C.getMinutes();var s=C.getSeconds();var dn="PM";if(h<12)dn="AM";if(h>12)h=h-12;if(h==0)h=12;if(h<=9)h="0"+h;if(m<=9)m="0"+m;if(s<=9)s="0"+s;var tm=h+":"+m+":"+s+" "+dn;dgi("tick2").innerHTML=tm;setTimeout("show_clock()",1000);}
function set_caret_position(elemId,caretPos)
{var elem=document.getElementById(elemId);if(elem!=null)
{if(elem.createTextRange)
{var range=elem.createTextRange();range.move('character',caretPos);range.select();}
else
{if(elem.selectionStart)
{elem.focus();elem.setSelectionRange(caretPos,caretPos);}
else
elem.focus();}}}
function get_focus_obj(obj)
{var obj_id=obj.id;if(document.getElementById(obj_id))
{var str=document.getElementById(obj_id).value;if(str&&str.length>0)
set_caret_position(obj_id,str.length);}}
function alert_notification_show(m)
{o1=$('#div_alert_notifications');o2=$('#div_alert_notifications').find('.notification_span').html(m);o1.fadeIn('slow');ACT=2;t=setInterval(function(){if(ACT>0){ACT--;}else{clearInterval(t);o1.fadeOut('slow');o2.html('');}},1000);}
function show_modal(div_id,header_title,content,footer_cont,cont_height,size,dismissible,cross_btn){if(header_title==''||typeof(header_title)!='string'){header_title='imwemr';}
if(footer_cont==''||typeof(footer_cont)!='string'){footer_cont='<button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>';}
if(cont_height==''||typeof(cont_height)!='string'){cont_height='300';}
var cross_btn_html='<button type="button" class="close" data-dismiss="modal"></button>';if(typeof(cross_btn)!=='undefined'&&cross_btn!=''){cross_btn_html='';}
var header_content='<div class="modal-header bg-primary">'+cross_btn_html+'<h4 class="modal-title">'+header_title+'</h4></div>';var body_content='<div class="modal-body" style="max-height:'+cont_height+'px;overflow:auto;overflow-y:scroll">'+content+'</div>';var footer_content='<div id="module_buttons" class="modal-footer ad_modal_footer"><div class="col-sm-12">'+footer_cont+'</div></div>';var final_str=header_content+body_content+footer_content;var modal='';modal+='<div class="common_modal_wrapper">';modal+='<div class="modal-dialog '+size+'"><div class="modal-content">'+final_str+'</div></div>';modal+='</div>';if($('#'+div_id+'').length>0){$('#'+div_id+'').html(modal);}else{$('body').append('<div class="modal" id="'+div_id+'" role="dialog"><div>');$('#'+div_id+'').html(modal);}
if(dismissible!='false'){$('#'+div_id+'').modal({backdrop:'static',keyboard:false,});}
$('#'+div_id+'').modal('show');return false;}
function checkIfAlphabet(e,ctrlId)
{txtVal='';var txtVal=dgi(ctrlId).value;if(txtVal!=''){var unicode=e.keyCode?e.keyCode:e.charCode;if(!(unicode>=65&&unicode<=90)&&!(unicode==8||unicode==46||unicode==13||unicode==9||unicode==16||unicode==17||unicode==18||unicode==37||unicode==38||unicode==39||unicode==40||unicode==32)){alert("Only Character values accepted");var rightVal=txtVal.substr(0,parseInt(txtVal.length)-1);dgi(ctrlId).value=rightVal;return false;}}}
function imw_msg_js(key){var msgArray={'no_rec':'No record found.','drop_sel':'Please Select.','sel_rec':'Please select a record.','del_rec':'Are you sure to delete the selected record(s) ?'};if(key!=""){return msgArray[key];}else{return msgArray;}}
function set_val_text(ths,menuId,elemId,liId){if(ths===''||typeof(ths)==='undefined'){if(typeof(liId)!='undefined'){var parent_elem=$('#drop_li_'+liId).parent();parent_elem.find('.dropdown-submenu').each(function(id,elem){if($(elem).attr('id')!='drop_li_'+liId){$(elem).find('.dropdown-menu').removeClass('show');}});}}else{if($('.dropdown-menu').hasClass("show")){$('.dropdown-menu').removeClass('show');$('#'+elemId).parent().find('.open').removeClass('open');}
var elem_val=$(ths).parent().find('input').val();if(elem_val!=''||typeof(elem_val)!='undefined'){$('#'+elemId+'').val(elem_val).change();$('#'+menuId+'').dropdown('toggle');}}}
if(window.jQuery){$(document).ready(function(){$('body').on("click",".dropdown-submenu a",function(e){if($(this).next('ul').hasClass("show")){$('.dropdown-submenu').removeClass('show');}else{$('.dropdown-submenu').removeClass('show');$(this).next('ul').toggleClass('show');}
e.stopPropagation();e.preventDefault();$('.dropdown').on('hide.bs.dropdown',function(){if($('.dropdown-menu .dropdown-submenu').find('ul').hasClass('show')){$('.dropdown-menu .dropdown-submenu').find('ul').removeClass('show').addClass('hide');}});});$('body').on('show.bs.dropdown','.dropdown',function(elem){var target_dropdown=elem.currentTarget;var get_dropDown=$(target_dropdown).find('ul.dropdown-menu').width();var obj_offset=$(target_dropdown).offset();if($(window).width()<(obj_offset.left+get_dropDown)){var difference=$(window).width()-(obj_offset.left+get_dropDown+10);$(target_dropdown).find('ul.dropdown-menu').css('left',difference);}});});}
function reload_simple_menu(id,val){if($('#'+id)){$('#'+id).find('label').remove();var final_val=$('#'+id).html()+val;$('#'+id).html(final_val);}}
function html_to_pdf(html_file_loc,op,pdf_name,on_page,one_page_pdf,call_for){var on_page_dir=false;if(on_page!=''&&typeof(on_page)!='undefined')
{on_page_dir=on_page;}
if(html_file_loc!=''&&typeof(html_file_loc)!='undefined'&&html_file_loc.length>0){if(op==''||typeof(op)=='undefined'){op='p';}
if(pdf_name==''||typeof(pdf_name)=='undefined'){pdf_name='new_pdf';}
if(call_for==''||typeof(call_for)=='undefined'){call_for='html_to_pdf';}
var wo=top.JS_WEB_ROOT_PATH;if(on_page_dir==true)
{if(typeof(wo)=='undefined'){wo=window.opener.top.JS_WEB_ROOT_PATH;}
window.location.href=wo+'/library/'+call_for+'/createPdf.php?onePage='+one_page_pdf+'&op='+op+'&file_location='+html_file_loc+'&pdf_name='+pdf_name+'';}
else
{window.open(''+wo+'/library/'+call_for+'/createPdf.php?onePage='+one_page_pdf+'&op='+op+'&file_location='+html_file_loc+'&pdf_name='+pdf_name+'');}}else{alert('Invalid file location provided');}}
function era_file_fun(){var enc_id="";if(top.fmain.$('#enc_id_read').length>0){enc_id=top.fmain.$('#enc_id_read').val();}
var wname="ERA";var features="width=1200px,height=450px,resizable=1,scrollbars=1";top.popup_win("../../interface/accounting/era_file.php?enc_id="+enc_id,features);}
function claim_file_fun(clm_status){var enc_id="";if(top.fmain.$('#enc_id_read').length>0){enc_id=top.fmain.$('#enc_id_read').val();}
var url='../../interface/accounting/claims_file.php?enc_id='+enc_id;var wname="Claims";var features="width=1200px,height=450px,resizable=1,scrollbars=1";if(claim_status_request_js=='YES'){if(typeof(clm_status)!='undefined'&&clm_status!=''){var url='../../interface/accounting/claims_status.php?clm_status=true&enc_id='+enc_id;var wname="ClaimsStatus";}}
top.popup_win(url,features);}
function statement_file_fun(){var patid="";if(typeof(pat_js)!='undefined'&&pat_js!=''){patid=pat_js;}else{if($('#patient_id').length>0){patid=$('#patient_id').val();}}
var url='../../interface/reports/accountingStatementsResult.php?Submit=Get Report&pevious=yes&patientId='+patid;var wname="statements";var features="width=900px,height=650px,resizable=1,scrollbars=1";if(patid>0){top.popup_win(url,features);}else{top.fAlert('Please select a patient.');}}
function stop_enter_key_on(idd){$('#'+idd).bind('keypress',function(e){if((e.keyCode||e.which)==13){e.preventDefault();return false;}});}
function hasNumbers(t){return/\d/.test(t);}
function search_pt(callback_function){var parWidth=parseInt($(window).width()-500);var win_height=parseInt($(window).height());top.popup_win(top.JS_WEB_ROOT_PATH+'/interface/billing/search_patient_popup.php?callback_function='+callback_function+'',"width="+parWidth+",scrollbars=0,resizable=yes,height="+win_height+",top=0,left=10,addressbar=1");}
function check_checkboxes(){$('#chk_sel_all').click(function(){var status=this.checked;$('.chk_sel').each(function(){this.checked=status;});});}
function current_date(d_format,year_digit,time,t_format)
{d_format=d_format||top.jquery_date_format||window.top.opener.jquery_date_format;d_format=d_format.toLowerCase()
year_digit=parseInt(year_digit)
year_digit=(year_digit!==2&&year_digit!==4)?4:year_digit;time=time||false;time=(typeof time!='boolean')?false:time;t_format=t_format||'12'
t_format=(t_format=='24'||t_format=='12')?t_format:'12'
var t=new Date();var mon=(parseInt(t.getMonth())+1).toString();var d=('0'+t.getDate()).slice(-2);var m=('0'+mon).slice(-2);var y=t.getFullYear()
if(year_digit===2)y=y.toString().substr(2,2);d_format=d_format.replace(/y/g,y);d_format=d_format.replace(/m/g,m);d_format=d_format.replace(/d/g,d);var time_string='';if(time)
{var h=parseInt(t.getHours());var m=parseInt(t.getMinutes());var a=(h<12)?'AM':'PM';m=m<10?'0'+m:m;h=(t_format=='12'&&h>12)?h-12:h;time_string=' '+h+':'+m+(t_format==12?' '+a:'');}
return d_format+time_string;}
function section_highlight(section_id,arr_all_sections,di_highlight_all){$(arr_all_sections).each(function(){$('#'+this).css({'background-color':'#FFF'});});if(typeof(di_highlight_all)=='undefined'||!di_highlight_all){$('#'+section_id).css({'background-color':'#FFFFCC'});}}
function search_email(e,div_object,left,top)
{var object=document.getElementById(div_object);var nextObject=object.getElementsByTagName('select').item(0);if(e.keyCode==64&&object.style.display=="none"){object.style.left=left;object.style.top=top;object.style.display="block";nextObject.options[0].selected=true;nextObject.focus();}else if(e.keyCode!=64&&object.style.display=="block"){object.style.display="none";}}
var typed_val="";function select_option(e,object,object_id){var text=document.getElementById(object_id);var value=text.value;var splited_value=value.split("@");if(e.keyCode==13){var value_without_website_address=splited_value[0];var value_with_new_website_address=value_without_website_address+object.value;text.value=value_with_new_website_address;object.parentNode.style.display="none";text.focus();}else if(e.keyCode!=103&&e.keyCode!=104&&e.keyCode!=109&&e.keyCode!=97){if(typed_val!=""){var value_without_website_address=splited_value[0]+"@"+typed_val;}else{var value_without_website_address=splited_value[0]+"@";}
var value_with_new_website_address=value_without_website_address;text.value=value_with_new_website_address;typed_val="";object.parentNode.style.display="none";text.focus();}else{typed_val=typed_val+String.fromCharCode(e.keyCode);}}
function select_option_with_mouse(object,object_id){var text=document.getElementById(object_id);var value=text.value;var splited_value=value.split("@");var value_without_website_address=splited_value[0];var value_with_new_website_address=value_without_website_address+object.value;text.value=value_with_new_website_address;object.parentNode.style.display="none";}
function gebi(el){return document.getElementById(el);}
function zip_vs_state_R6(objZip,objCity,objState,objCountry,objCounty)
{zip_code=$(objZip).val();if(zip_code==''){$(objCity).val('');$(objState).val('');return false;}
$.ajax({url:top.JS_WEB_ROOT_PATH+"/interface/patient_info/ajax/demographics/add_city_state.php?zipcode="+zip_code,success:function(data)
{var changecolor='#F6C67A';var val=data.split("-");var city=$.trim(val[0]);var state=$.trim(val[1]);var country=$.trim(val[3]);var county=$.trim(val[4]);if(city!="")
{$(objCity).val(city);$(objState).val(state);if(country){$(objCountry).val(country);}
if(county){$(objCounty).val(county);}
return;if(typeof(top.int_country)!="undefined"&&top.int_country=="UK"){if(typeof(document.getElementById("zipCodeStatus"))!="undefined"&&document.getElementById("zipCodeStatus")!=null&&document.getElementById("zipCodeStatus")!="undefined")
document.getElementById("zipCodeStatus").value="OK";return;}
if(typeof(top.stop_zipcode_validation)!="undefined"&&top.stop_zipcode_validation=="YES"){return;}
$(objZip).val("");changeClass(document.getElementById($(objZip).attr("id")),1)
if(typeof(top.fAlert)!="undefined")
top.fAlert('Please enter correct '+top.zipLabel);else{alert('Please enter correct '+top.zipLabel);}
$(objZip).select();$(objCity).val("");$(objState).val("");$(objCounty).val("");}}});}
function set_header_title(title){top.$('#acc_page_name').html(title);}
function showHidemodal(action,div_id,dismissible,backdrop){action=(action=='show'||'hide')?action:'show';backdrop=(typeof backdrop==='boolean')?backdrop:false;dismissible=(typeof dismissible==='boolean')?dismissible:false;if(action=='hide'){$('#'+div_id+'').modal(action);}
else{backdrop=(dismissible)?'static':backdrop;$('#'+div_id+'').modal({backdrop:backdrop,keyboard:false});if(!$('#'+div_id+'').hasClass('in')){$('#'+div_id+'').modal('show');}}
return false;}
function ado_scan_fun(show,formNme,editId){if(typeof show=='undefined')show='scan';if(typeof formNme=='undefined')return;if(typeof editId=='undefined'||editId=='')editId=0;var url=top.JS_WEB_ROOT_PATH+'/library/classes/scan_ptinfo_medhx_images.php?formName='+formNme+'&show='+show;url+=(editId>0)?'&edit_id='+editId:'';top.popup_win(url,'scan_patient_info');}
function set_modal_btns(parent_id,btn_arr){var parent_elem='';var btn_str='';var footer_str='';var default_type='button';var btn_debug_arr=new Array;if($('#'+parent_id).length>0){parent_elem=$('#'+parent_id);}else if($('.'+parent_id).length>0){parent_elem=$('.'+parent_id);}
var onclick='';if(parent_id=='new_priv_div .modal-footer'){onclick='onclick="resetToOldPriv();"';}
if(parent_elem.length){parent_elem.addClass('btn-ftr-unique');parent_elem.attr('id','module_buttons');if(btn_arr.length>0){$.each(btn_arr,function(id,val){var btn_name_str='';var btn_val=btn_arr[id][0].charAt(0).toUpperCase()+btn_arr[id][0].slice(1);var btn_class=get_btn_class(btn_val);var btn_name=btn_arr[id][1];var btn_func=btn_arr[id][2];var btn_type=default_type;if(btn_name.length){btn_type='submit';btn_name_str='name="'+btn_name+'" value="'+btn_name+'"';}
btn_str+='<button type="'+btn_type+'" class="'+btn_class+'" '+btn_name_str+' id="'+btn_val+'" onclick="'+btn_func+'">'+btn_val+'</button>';});btn_str+='<button type="button" class="btn btn-danger" data-dismiss="modal" '+onclick+'>Close</button>';footer_str='<div class="row mdl_btns_dp"><div class="col-sm-12 text-center">'+btn_str+'</div></div>';}else{btn_str+='<button type="button" class="btn btn-danger" data-dismiss="modal" '+onclick+'>Close</button>';footer_str='<div class="row mdl_btns_dp"><div class="col-sm-12 text-center">'+btn_str+'</div></div>';}
if($('body').find('.btn-ftr-unique .mdl_btns_dp').length==0){$('body').find('.btn-ftr-unique').find('[type=button],[type=submit]').not('input[type=hidden]').remove();$('body').find('.btn-ftr-unique').append(footer_str);}else{$('body').find('.btn-ftr-unique .mdl_btns_dp').html(footer_str);}
if($('body').find('.btn-ftr-unique').hasClass('ad_modal_footer')===false){$('body').find('.btn-ftr-unique').addClass('ad_modal_footer');}
if(parent_elem.hasClass('btn-ftr-unique')){parent_elem.removeClass('btn-ftr-unique');}}}
function get_btn_class(btn_val){var btn_class='btn btn-default';switch(btn_val.toLowerCase()){case'save':case'done':case'ok':case'yes':btn_class='btn btn-success';break;case'cancel':case'no':case'Close':btn_class='btn btn-danger';break;case'delete selected':btn_class='btn btn-danger';break;case'print':case'download':case'add':case'upload':btn_class='btn btn-info';break;}
return btn_class;}
function set_modal_height(object,debug){var obj='';var debug_arr=new Array;if(typeof(object)=='object'){obj=$(object);}else{if($('#'+object).length>0){obj=$('#'+object);}else if($('.'+object).length>0){obj=$('.'+object);}}
debug_arr['object']=obj;if(obj!=''){if(obj.hasClass('in')){var elem=obj;var elem_height=elem.outerHeight();debug_arr['modal_height']=elem_height;var header_position=$('#first_toolbar',top.document).position();var window_height=parseInt(window.innerHeight-$('footer',top.document).outerHeight()-header_position.top-$('#first_toolbar').outerHeight());debug_arr['window_height']=window_height;if(elem_height>window_height){var diff=parseInt(elem_height-window_height);var new_height=parseInt(elem_height-diff);var modal_extra=parseInt(elem.find('.modal-header').outerHeight()+elem.find('.modal-footer').outerHeight());new_height=parseInt(new_height-modal_extra)
debug_arr['modal_extra_height']=new_height;elem.find('.modal-body').css('max-height',new_height);if(elem.find('.modal-body').css("overflow-x")!='hidden'){elem.find('.modal-body').css({overflow:'auto','overflow-x':'hidden'});}}}}
if(debug){console.log(debug_arr);}}
function checkSingle(elemId,grpName){var obgrp=document.getElementsByName(grpName);var objele=document.getElementById(elemId);var len=obgrp.length;if(objele.checked==true){for(var i=0;i<len;i++){if((obgrp[i].id!=objele.id)&&(obgrp[i].checked==true)){obgrp[i].checked=false;}}}}
function changeChbxColor(grpNode){var objGrp=$('input[name="'+grpNode+'"]');var len=objGrp.length;var is_checked=false;for(var i=0;i<len;i++){if(objGrp[i].checked==true){is_checked=true;}}
if(is_checked)
objGrp.parent('div').removeClass('checkbox-mandatory');else
objGrp.parent('div').addClass('checkbox-mandatory');}
function day_charges(){var sc_wd=(screen.availWidth)-100;var sc_hg=(screen.availHeight)-120;var features='width='+sc_wd+',height='+sc_hg+',left=150,top=80,location=0,status=1,resizable=1,left=0,top=0,scrollbars=0';top.popup_win("../../interface/accounting/day_charges_list.php",features);}
function popup_resize(maxWidth,maxHeight,maxAvail)
{maxWidth=maxWidth||1270;maxHeight=maxHeight||850;maxAvail=maxAvail||0.9;var avail_w_90=(screen.availWidth*maxAvail)
var avail_h_90=(screen.availHeight*maxAvail)
var parWidth=(screen.availWidth>maxWidth)?maxWidth:avail_w_90;var parHeight=(screen.availHeight>maxHeight)?maxHeight:avail_h_90;window.resizeTo(parWidth,parHeight);var t=parseInt((screen.availHeight-window.outerHeight)/2)
var l=parseInt((screen.availWidth-window.outerWidth)/2)
window.moveTo(l,t);}
function show_iportal_changes_alert_data(filter,pt_id){var form_data='iportal_filter='+filter+'&iportal_pt='+pt_id;var modal_title='';var modal_id='';switch(filter){case'demographics':case'medical':modal_title='Patient Portal - Demographics Changes';modal_id='iportal_changes_demograph';break;case'cl_order':modal_title='Patient Portal - Contact Lens Order';modal_id='iportal_changes_cl_order';break;case'registered_patients':modal_title='Patient Portal - Patient Registration';modal_id='iportal_changes_reg_pt';break;case'iportal_payments':modal_title='Patient Portal - Payment(s)';modal_id='iportal_patient_payments';break;}
$.ajax({url:top.JS_WEB_ROOT_PATH+'/interface/physician_console/handle_pt_changes.php',data:form_data,type:'POST',dataType:'JSON',beforeSend:function(){},success:function(response){if(response){if(response.data_length>0&&response.data.length){var modal_html=generate_iportal_alert_html(response,filter);if(modal_html){var div_id=modal_id;var title=modal_title;var footer='<button type="button" class="btn btn-danger" data-dismiss="modal">Close</button><button type="button" class="btn btn-success" onclick="window.top.fmain.location.reload();">Reload with approved changes</button><button type="button" class="btn btn-success" onclick="top.fmain.approve_all_operation(0,\''+modal_id+'\', \''+filter+'\');">Approve All</button>';if(filter=='iportal_payments'){footer='<button type="button" class="btn btn-danger" data-dismiss="modal">Close</button><button type="button" class="btn btn-success" onclick="top.fmain.iportal_payment_message_read(0,\''+modal_id+'\', \''+filter+'\');">Ok</button>';}
if(!top.$('#iportal_modal_val_'+modal_id).length){show_modal(div_id,title,modal_html,footer,'400','modal_90');}
$('body').on('hide.bs.modal','#'+modal_id,function(event){var iportal_input=$('<input>');iportal_input.attr({'id':'iportal_modal_val_'+modal_id,'value':'shown','type':'hidden',});top.$('body').append(iportal_input);});}
else{if($("#"+modal_id).length>0)$("#"+modal_id).html('').modal('hide');}}}},complete:function(){top.show_loading_image('hide');}});}
function generate_iportal_alert_html(result,filter)
{var $_html='';if(result.data_length==0)return false;var table_header='';var table_rows='';if(filter=='medical'||filter=='demographics'){table_header+='<th class="col-xs-1 text-nowrap">Field Changed</th>';table_header+='<th class="col-xs-4">Old Value</th>';table_header+='<th class="col-xs-4">New Value</th>';table_header+='<th class="col-xs-3">Action</th>';$.each(result.data,function(id,val){table_rows+='<tr>';table_rows+='<td>'+val['col_lbl']+'</td>';table_rows+='<td>'+val['old_val']+'</td>';table_rows+='<td>'+val['new_val']+'</td>';table_rows+='<td id="iportal_approve_'+val['id']+'" class="text-center">';table_rows+='<div class="btn-group">';table_rows+='<button class="btn btn-success" data-filter="'+filter+'" onClick="top.fmain.approve_operation(\''+val['id']+'\', this);">Approve</button>';table_rows+='<button class="btn btn-danger"data-filter="'+filter+'" onClick="top.fmain.disapprove_operation(\''+val['id']+'\', this);">Decline</button>';table_rows+='</div>';table_rows+='</td>';table_rows+='</tr>';});}
if(filter=='iportal_payments'){table_header+='<th class="col-xs-4 text-nowrap">Field Changed</th>';table_header+='<th class="col-xs-8">New Value</th>';$.each(result.data,function(id,val){table_rows+='<tr>';table_rows+='<td>'+val['col_lbl']+'</td>';table_rows+='<td>'+val['new_val']+'</td>';table_rows+='</tr>';});}
if(filter=='cl_order'){table_header+='<th>Patient</th>';table_header+='<th class="text-nowrap">Date</th>';table_header+='<th>Eye</th>';table_header+='<th>Brand</th>';table_header+='<th>Manufacturer</th>';table_header+='<th>Disposable</th>';table_header+='<th>Supplies</th>';table_header+='<th>#Boxes</th>';table_header+='<th>Action</th>';var eye_str='';var old_order_num=0;$.each(result.data,function(id,val){var td_date='';var td_patient='';var td_approval='';var ordNum=val['temp_order_num'];if(old_order_num!=ordNum){cnt=0;}
if(cnt==0){rowspan=val['order_count'];td_date='<td rowspan="'+rowspan+'">'+val['orderedDate']+'</td>';td_patient='<td rowspan="'+rowspan+'">'+val['pt_name']+'</td>';td_approval+='<td id="iportal_approve_'+val['id']+'" class="text-center" rowspan="'+rowspan+'">';td_approval+='<div class="btn-group">';td_approval+='<button class="btn btn-success" data-filter="'+filter+'" onClick="top.fmain.approve_operation(\''+ordNum+'\', this);">Approve</button>';td_approval+='<button class="btn btn-danger" data-filter="'+filter+'" onClick="top.fmain.disapprove_operation(\''+ordNum+'\', this);">Decline</button>';td_approval+='</div>';td_approval+='</td>';}
table_rows+='<tr>';table_rows+=td_patient;table_rows+=td_date;table_rows+='<td>'+val['eye']+'</td>';table_rows+='<td>'+val['brand']+'</td>';table_rows+='<td>'+val['manufacturer']+'</td>';table_rows+='<td>'+val['disposable']+'</td>';table_rows+='<td>'+val['supplies']+'</td>';table_rows+='<td>'+val['boxes']+'</td>';table_rows+=td_approval;table_rows+='</tr>';old_order_num=ordNum;cnt++;});}
if(filter=='registered_patients'){table_header+='<th>Patient Data</th>';table_header+='<th>Email Verification</th>';table_header+='<th>Action</th>';$.each(result.data,function(id,val){var pt_details='';pt_details+='<div class="row">';pt_details+='<div class="col-sm-4">';pt_details+='<div class="form-group">';pt_details+='<strong>First Name :</strong>  '+val['fname'];pt_details+='</div>';pt_details+='</div>';pt_details+='<div class="col-sm-4">';pt_details+='<div class="form-group">';pt_details+='<strong>Last Name :</strong>  '+val['lname'];pt_details+='</div>';pt_details+='</div>';pt_details+='<div class="clearfix"></div>';pt_details+='<div class="col-sm-4">';pt_details+='<div class="form-group">';pt_details+='<strong>Sex :</strong>  '+val['sex'];pt_details+='</div>';pt_details+='</div>';pt_details+='<div class="col-sm-4">';pt_details+='<div class="form-group">';pt_details+='<strong>DOB :</strong>  '+val['dob'];pt_details+='</div>';pt_details+='</div>';pt_details+='<div class="col-sm-4">';pt_details+='<div class="form-group">';pt_details+='<strong>Email :</strong>  '+val['email'];pt_details+='</div>';pt_details+='</div>';pt_details+='<div class="clearfix"></div>';pt_details+='<div class="col-sm-4">';pt_details+='<div class="form-group">';pt_details+='<strong>Home Phone :</strong>  '+val['phone_home'];pt_details+='</div>';pt_details+='</div>';pt_details+='<div class="col-sm-4">';pt_details+='<div class="form-group">';pt_details+='<strong>Cell Phone :</strong>  '+val['phone_cell'];pt_details+='</div>';pt_details+='</div>';pt_details+='<div class="col-sm-4">';pt_details+='<div class="form-group">';pt_details+='<strong>Work Phone :</strong>  '+val['phone_biz_ext']+' '+val['phone_biz'];pt_details+='</div>';pt_details+='</div>';pt_details+='<div class="clearfix"></div>';pt_details+='<div class="col-sm-4">';pt_details+='<div class="form-group">';pt_details+='<div class="row">';pt_details+='<div class="col-sm-4">';pt_details+='<strong>Address :</strong>';pt_details+='</div>';pt_details+='<div class="col-sm-8">';pt_details+=val['address'];pt_details+='</div>';pt_details+='</div>';pt_details+='</div>';pt_details+='</div>';pt_details+='<div class="col-sm-4">';pt_details+='<div class="form-group">';pt_details+='<strong>City :</strong>  '+val['city'];pt_details+='</div>';pt_details+='</div>';pt_details+='<div class="col-sm-4">';pt_details+='<div class="form-group">';pt_details+='<strong>'+top.zipLabel+' :</strong>  '+val['postal_code'];pt_details+='</div>';pt_details+='</div>';pt_details+='</div>';table_rows+='<tr>';table_rows+='<td>'+pt_details+'</td>';table_rows+='<td>'+val['auth_status']+'</td>';table_rows+='<td id="iportal_approve_'+val['id']+'" class="text-center">';table_rows+='<div class="btn-group">';table_rows+='<button class="btn btn-success" data-filter="'+filter+'" onClick="top.fmain.approve_operation(\''+val['id']+'\', this);">Approve</button>';table_rows+='<button class="btn btn-danger" data-filter="'+filter+'"  onClick="top.fmain.disapprove_operation(\''+val['id']+'\', this);">Decline</button>';table_rows+='</div>';table_rows+='</td>';table_rows+='</tr>';});}
$_html+='<div class="row">';var h1_title=' Following Patients has registered from Patient Portal ';var h2_title=' Please take the appropriate action.';if(filter=='iportal_payments'){h1_title=' Following Payment(s) made from Patient Portal ';h2_title=' This is alert message for patient payment(s). ';}
$_html+='<h1 style="font-size:18px;font-weight:normal;margin:0px;padding:0px;">'+h1_title+'</h1>';$_html+='<h2 style="font-size:14px;font-weight:normal;margin:5px 0px 10px 0px;padding:0px;">'+h2_title+'</h2>';$_html+='<div class="col-xs-12">';$_html+='<table class="table table-bordered table-hover table-striped">';$_html+='<thead class="header">';$_html+='<tr class="grythead">';$_html+=table_header;$_html+='</tr>';$_html+='</thead>';$_html+='<tbody id="newTbodyBorder">';$_html+=table_rows;$_html+='</tbody>';$_html+='</table>';$_html+='<input type="hidden" name="hidd_iportal_approve" id="hidd_iportal_approve" value="'+result.row_id_str+'">';$_html+='</div>';$_html+='</div>';return $_html;}
function approve_operation(row_id,ths)
{var processing_btn='<button class="btn btn-warning"><span class="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span> Processing...</button>';var approved_btn='<button class="btn btn-success"><span class="glyphicon glyphicon-ok"></span> Successfully Approved</button>';var filter=$(ths).data('filter');var url='/interface/physician_console/handle_pt_changes.php';if(filter=='cl_order'){url='/iportal_config/approve_cl_orders.php';}
if(filter=='registered_patients'){url='/iportal_config/handle_pt_registration.php';}
ths_parent=$(ths).parent();if(row_id!=""&&parseInt(row_id))
{ths_parent.html(processing_btn);}
$.ajax({url:top.JS_WEB_ROOT_PATH+url,data:'sel_op=approve&row_id='+row_id+'&alert_filter='+filter,type:'POST',success:function(response){if(filter=='registered_patients'){var resp=JSON.parse(response);if(resp.status=="success"){ths_parent.html(approved_btn).append('<div style="color:#090;font-weight:bold;">Approved<br />Patient Id: '+resp.pt_id+'</div>');}
else if(resp.status=="error"){ths_parent.html(processing_btn).append('<div style="color:#CC0000;font-weight:bold;">Error while approving</div>');}}},complete:function(respData){if(filter=='registered_patients'){}else{ths_parent.html(approved_btn);}}});return false;}
function disapprove_operation(row_id,ths)
{var processing_btn='<button class="btn btn-warning"><span class="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span> Processing...</button>';var declined_btn='<button class="btn btn-success"><span class="glyphicon glyphicon-ok"></span> Successfully Declined</button>';var filter=$(ths).data('filter');var url='/interface/physician_console/handle_pt_changes.php';if(filter=='cl_order'){url='/iportal_config/approve_cl_orders.php';}
if(filter=='registered_patients'){url='/iportal_config/handle_pt_registration.php';}
ths_parent=$(ths).parent();if(row_id!=""&&parseInt(row_id))
{ths_parent.html(processing_btn);}
$.ajax({url:top.JS_WEB_ROOT_PATH+url,data:'sel_op=decline&row_id='+row_id,type:'POST',complete:function(respData)
{resultData=respData.responseText;ths_parent.html(declined_btn);}});}
function approve_all_operation(indx,modal_id,filter)
{var url='/interface/physician_console/handle_pt_changes.php';if(filter=='cl_order'){url='/iportal_config/approve_cl_orders.php';}
if(filter=='registered_patients'){url='/iportal_config/handle_pt_registration.php';}
var processing_btn='<button class="btn btn-warning"><span class="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span> Processing...</button>';var approved_btn='<button class="btn btn-success"><span class="glyphicon glyphicon-ok"></span> Successfully Approved</button>';all_id=$('#'+modal_id+' #hidd_iportal_approve').val();var all_id_arr=new Array();if(all_id)
{all_id_arr=all_id.split(',');row_id=all_id_arr[indx];if(all_id_arr.length>indx)
{if(row_id!=""&&parseInt(row_id))
{if($('#iportal_approve_'+row_id).text()!="Declined")
$('#iportal_approve_'+row_id).html(processing_btn);}
$.ajax({url:top.JS_WEB_ROOT_PATH+url,data:'sel_op=approve&row_id='+row_id+'&alert_filter='+filter,type:'POST',complete:function(r)
{if(r.responseText=="approved")
$('#iportal_approve_'+row_id).html(approved_btn);approve_all_operation(parseInt(indx)+1,modal_id,filter);}});}
if(all_id_arr.length==indx)top.fmain.location.reload(true);}else{if($("#"+modal_id).length>0)$("#"+modal_id).html('').modal('hide');}
return false;}
function iportal_payment_message_read(indx,modal_id,filter){var url='/interface/physician_console/handle_pt_changes.php';var all_id=$('#'+modal_id+' #hidd_iportal_approve').val();var all_id_arr=new Array();if(all_id)
{all_id_arr=all_id.split(',');var row_id=all_id_arr[indx];if(all_id_arr.length>indx)
{$.ajax({url:top.JS_WEB_ROOT_PATH+url,data:'sel_op=iportal_payment_read&row_id='+row_id+'&alert_filter='+filter,type:'POST',complete:function(r)
{iportal_payment_message_read(parseInt(indx)+1,modal_id,filter);}});}
if(all_id_arr.length==indx)top.fmain.location.reload(true);}else{if($("#"+modal_id).length>0)$("#"+modal_id).html('').modal('hide');}
return false;}
function view_only_acc_call(mode){top.fAlert("You do not have permission to perform this action.",'',340);if(mode==1){return false;}}
function changeColumnSelection(e){var fid=e.currentTarget.id
var obj=$('#'+fid);var values=obj.val();var page=obj.data('page');$.ajax({url:top.JS_WEB_ROOT_PATH+'/interface/common/column_settings.php',type:'post',dataType:'json',data:{page:page,cols:(values?values.join(','):'')},beforeSend:function(){top.show_loading_image('show');},complete:function(){top.show_loading_image('hide');},success:function(r){if(r.success){obj.find('option').each(function(){var v=$(this).attr('value');var t=v.replace(/-/g,"");if($.inArray(v,values)===-1){$("td."+t).addClass('hide');}
else
$("td."+t).removeClass('hide');});}
else
top.fAlert('Error: please try again');}})}
function loadItsDesc(selObj,textObj){var val=selObj.value;var arrVal=val.split('-');textObj.style.visibility="visible";if(arrVal[2]){textObj.value=arrVal[2];}
else{textObj.value="";}}
function loadItsDescImmu(selObj,textObj){var val=selObj.value;var arrVal=val.split('-');textObj.style.visibility="visible";if(arrVal[2]){textObj.value=arrVal[2];}
else if(arrVal[0]==""){textObj.value="";textObj.style.visibility="hidden";}
else{textObj.value="";}}
function drag_div_move(ele,ev){$(ele).draggable();}
function acknowledged(op,form){op=op||0;if(document.getElementById('patSpesificDivAlert')){if(op==1){$(form).children('#disablePatAlertThisSession').val('yes');}
else{$(form).children('#disablePatAlertThisSession').val('');}
$(form).children('#patSpesificDivAlert').css('display','none');}}
function manage_section_height(dest_obj,source_obj_array,flexibility){if(typeof(flexibility)=='undefined')flexibility=0;h=0;$(source_obj_array).each(function(index,element){h+=$(source_obj_array[index]).height();});if(flexibility<0)h=h-parseInt(flexibility);else h=h+parseInt(flexibility);wh=window.innerHeight;$(dest_obj).height(wh-h);}
function newPatient_info_main(){var parWidth=parseInt($(window).width()-500);var win_height=$(window).height();top.popup_win(top.JS_WEB_ROOT_PATH+"/interface/scheduler/common/new_patient_info_popup_new.php?source=demographics&search=true&frm_status=show_check_in&popheight="+win_height,"width="+parWidth+",scrollbars=0,resizable=yes,height="+win_height+",top=0,left=10,addressbar=1")}
function check_rule_manager(obj_value,section){section=(section)?section:'';var post_data={obj_value:obj_value,section:section}
$.ajax({url:top.JS_WEB_ROOT_PATH+'/interface/common/assign_new_task.php',type:'post',dataType:'json',data:post_data,beforeSend:function(){top.show_loading_image('show');},complete:function(){top.show_loading_image('hide');},success:function(r){}});}
var o='';function del_doc(__this,confirm){o=__this||o;if(typeof confirm=='undefined'){top.fmain.frames[0].document.write('');top.fancyConfirm("Sure! you want to delete this document ?","top.del_doc('',true)");}
else{var u=$(o).data('url');if($(o).length>0&&typeof u!=='undefined'){if(top.fmain)top.fmain.location.href=u;if(top.all_data)top.all_data.location.href=u;}
else
top.fAlert('Unable to delete. Please refresh the tab and try again. ')}}
function dismissTaskAlert(){top.master_ajax_tunnel(top.JS_WEB_ROOT_PATH+'/interface/core/ajax_handler.php?task=task_alert_shown');$("#task_alerts",top.document).modal('hide');}
function ZeissViewer(pid,user,pass,path){if(pid=="")pid=window.top.$("#patient_id").val();u=user;p=pass;params=" -username "+u+" -password "+p+" -patientId "+pid;exeURL='"'+path+'\\launchFORUM.cmd"'+params;try{WSH=new ActiveXObject("WScript.Shell");WSH.run(exeURL);}catch(e){if(e!=''){try{exeURL=exeURL.replace('Program Files','Program Files (x86)');WSH=new ActiveXObject("WScript.Shell");WSH.run(exeURL);}catch(er){top.fAlert('<div class="text-center">Check if Zeiss Application installed.<br>'+er.message+'</div>');}}}}
function sig_web_alert(){var msg='Error, make sure you have installed SigWeb.<br> <a href="https://www.topazsystems.com/software/sigweb.exe" target="_BLANK" class="purple-text">Click here</a> to download SigWeb service.<br>';msg+='<a href="https://www.topazsystems.com/Software/sigweb_install.pdf" target="_BLANK" class="purple-text">Click here</a> to read installation instructions before installing';top.fAlert(msg);}
var heardAboutSearch=['Family','Friends','Doctor','Previous Patient.','Previous Patient'];function searchHeardAbout(){var WRP=top.JS_WEB_ROOT_PATH
var search_val=$("#heardAbtSearch").val();search_val=$.trim(search_val);target_search_val='';if(search_val!="")
{search_val_arr=search_val.split(',');if(search_val_arr[0]!=""&&typeof search_val_arr[0]!="undefined")
{last_name_val=$.trim(search_val_arr[0]);last_mid_name_arr=last_name_val.split(' ');target_search_val=$.trim(last_mid_name_arr[1]);if(target_search_val==""||typeof target_search_val=="undefined")
{target_search_val=last_mid_name_arr[0];}}
else
{target_search_val=$.trim(search_val_arr[0]);}}
if(!target_search_val)return false;var heardAbtVal=$("#elem_heardAbtUs").val();var tmpArr=heardAbtVal.split("-");heardAbtVal=tmpArr[1].trim();if(!heardAbtVal)return false;if($.inArray(heardAbtVal,heardAboutSearch)!==-1){if(WRP=='undefined'){if(typeof window.opener!=='undefined'){WRP=window.opener.top.JS_WEB_ROOT_PATH;}}
if(heardAbtVal=='Doctor'){window.open(WRP+"/interface/admin/users/searchPhysician.php?btn_sub=search&sel_by=LastName&txt_for="+target_search_val,"window1","width=800,height=500,scrollbars=yes, status=1");}
else{var w=window.open(WRP+"/interface/scheduler/search_patient_popup.php?sel_by=Active&txt_for="+target_search_val+"&btn_sub=Search&call_from=demographics","PatientWindow","width=800,height=500,top=420,left=150,scrollbars=yes");}}}
function setHeardAboutUsVal(pid,name){document.getElementById('heardAbtSearchId').value=pid;document.getElementById('heardAbtSearch').value=name+'-'+pid;}
function get_phy_name_from_search(strVal,id){if(top.$('#appt_scheduler_status').val()=='loaded'){document.getElementById('front_primary_care_id').value=id;document.getElementById('front_primary_care_name').value=strVal;}
else{document.getElementById('heardAbtSearchId').value=id;document.getElementById('heardAbtSearch').value=strVal;}}
function validate_num(obj){var num=$(obj).val();num=num.trim();if(num!=""){num=num.replace(/[^\d.]/,'');if(num=="")num=0;}
$(obj).val(num);}
function capitalize_letter(str){return str.replace(/(^\S|\s\S)/g,function(match,g1,offset,origstr){return g1.toUpperCase();});}
function view_only_call(){top.fAlert("You do not have permission to perform this action.");return false;}
var icd10_unique_obj_id='';function icd10_split(val){return val.split(/>>\s*/);}
function icd10_extractLast(term){return icd10_split(term).pop();}
function icd10_extractICD10(str){ICD10='';vARR=str.split('[ICD-10: ');if(vARR.length>1){ICD10_ARR=vARR[1].split(',');if(ICD10_ARR.length>1){ICD10=ICD10_ARR[0];}}
return ICD10;}
function bind_autocomp(obj,getDataFilePath,showMode,hiddenOBJ){var flg_LitSev=0;if(typeof(showMode)=='undefined'){showMode='';}
obj.bind("focus",function(){if($(obj).attr('id')!=icd10_unique_obj_id){icd10_unique_obj_id=$(obj).attr('id');delete(uV);delete(vARR);delete(ICD10_ARR);delete(ICD10);delete(uV1);delete(vARR1);delete(ICD10_ARR1);delete(laterality);delete(dX_code);delete(NewdX_code);}});obj.bind("click",function(){fv=obj.val();if(fv.substr(-1,1)=='-'&&fv.substr(-2,2)!='--'&&fv.substr(-3,3)!='-X-'&&fv.substr(-3,3)!='-x-'){fv=fv.replace('-','');}else if(fv.substr(-2,2)=='--'){fv=fv.replace('--','');}else if(fv.substr(-3,3)!='-x-'||fv.substr(-3,3)!='-X-'){fv=fv.replace('-x-','');fv=fv.replace('-X-','');}
obj.val(fv);obj.keydown();});var autoConfig={source:function(request,response){uV=request.term;vARR=uV.split('[ICD-10: ');if(vARR.length>1){ICD10_ARR=vARR[1].split(',');if(ICD10_ARR.length>1){ICD10=""+ICD10_ARR[0];request.term=""+ICD10;}}else{delete ICD10;if($("#tblSuperbill").length>0&&""+uV.indexOf("-")!=-1){ICD10=""+uV;}}
flg_LitSev=0;var str_data="term="+request.term;var oe=this.element[0];if(oe.name.indexOf("elem_assessment_dxcode")!=-1||$(oe).hasClass("dxallcodes")){str_data+="&show_pop=1";}
var chart_dos="";if(typeof($("#elem_dos").val())!="undefined"&&(typeof(sb_testName)=="undefined"||sb_testName=="")&&(oe.name.indexOf("elem_assessment_dxcode")!=-1||$(oe).hasClass("dxallcodes"))){chart_dos=$("#elem_dos").val();}else if(typeof($("#elem_examDate").val())!="undefined"){chart_dos=$("#elem_examDate").val();}else if(typeof($("#dos_id").val())!="undefined"){chart_dos=$("#dos_id").val();}else if(typeof($("#date_of_service").val())!="undefined"){chart_dos=$("#date_of_service").val();}else if(typeof($("#elem_chart_DOS").val())!="undefined"){chart_dos=$("#elem_chart_DOS").val();}
if(chart_dos!=""){str_data+="&chart_dos="+chart_dos;}
if(typeof($(oe).data("val1stsrch"))=="undefined"){$(oe).data("val1stsrch",request.term);}
if((typeof(ICD10)!='undefined'&&typeof(ICD10)=='string'&&""+ICD10.substr(-1)=='-')||($(oe).val().indexOf('>>')>0)){var str_dx_id="";if(typeof($(oe).data("dxid"))!="undefined"){var srch_dxid=$.trim($(oe).data("dxid"));if(srch_dxid!=""){str_data+="&dxid="+srch_dxid;}}}
$.ajax({url:getDataFilePath,data:str_data,dataType:"json",success:function(availableTags){if(typeof(availableTags.flg_LitSev)!="undefined"&&(availableTags.flg_LitSev==1||availableTags.flg_LitSev==0)){flg_LitSev=availableTags.flg_LitSev;if(typeof(availableTags.icd10_dxdb)!="undefined"){$(oe).data("valbakdb",availableTags.icd10_dxdb);}
if(typeof(availableTags.srchd_code)!="undefined"){$(oe).data("valsrchd",availableTags.srchd_code);}
if(typeof(availableTags.icd10_dxdesc)!="undefined"){$(oe).data("valdxdesc",availableTags.icd10_dxdesc);}
availableTags=availableTags.results;}
var tmp=0;if(vARR.length>1||($("#tblSuperbill").length>0&&""+uV.indexOf("-")!=-1)){request.term='';}
if(flg_LitSev==1){response(availableTags);tmp=1;}
if(tmp==0){response($.ui.autocomplete.filter(availableTags,icd10_extractLast(request.term)));}}});},response:function(event,ui){if(flg_LitSev){if(cn_isFulldxAdded(this)){}else{$("#"+this.id).removeData("val1stsrch");if($("#dialogLSS").length>0){$("#dialogLSS").remove();}
var rr="";for(var i=0;i<3;i++){var ee="",ee1="";var lat_ct=0;for(var x in ui['content'][i]){lat_ct=parseInt(lat_ct)+1;var lat_ct_show="";var tmp=""+ui['content'][i][x];if(typeof(tmp)=="undefined"||tmp==""||tmp=="undefined"){continue;}
var arr_tmp=tmp.split("-");var showtxt=$.trim(arr_tmp[0]);var showval=$.trim(arr_tmp[1]);var fldid=""+this.id;if(i==0){lat_ct_show="txt_lat";}else if(i==1){lat_ct_show="txt_sev";}else if(i==2){lat_ct_show="txt_stag";}
ee+="<span id='txt_span_latt' onclick=\"cn_resetasval('"+fldid+"', '"+showval+"','"+i+"', this);\"></span>";if(i==0){if(showtxt.toLowerCase().indexOf("lid")!=-1){if(showtxt.toLowerCase().indexOf("right")!=-1){ee+="<tr><td  id='"+lat_ct_show+"_"+lat_ct+"' dbid='"+showval+"'  onclick=\"cn_resetasval('"+fldid+"', '"+showval+"','"+i+"', this);\">"+showtxt+"</td></tr>";}else{ee1+="<tr><td  id='"+lat_ct_show+"_"+lat_ct+"' dbid='"+showval+"' onclick=\"cn_resetasval('"+fldid+"', '"+showval+"','"+i+"', this);\">"+showtxt+"</td></tr>";}
continue;}}
ee+="<tr><td  id='"+lat_ct_show+"_"+lat_ct+"' dbid='"+showval+"' onclick=\"cn_resetasval('"+fldid+"', '"+showval+"','"+i+"', this);\">"+showtxt+"</td></tr>";}
if(ee!=""){var hd="";if(i==0){hd="Eye";}else if(i==1){hd="Stage";}else if(i==2){hd="Encounter";}
if(i==0&&ee1!=""){ee="<table id='LSS_od"+i+"' >"+"<tr><td><b>Right Eye</b></td></tr>"+ee+""+"</table>";rr+="<td>"+ee+"</td>";ee1="<table id='LSS_os"+i+"' >"+"<tr><td><b>Left Eye</b></td></tr>"+ee1+"</table>";rr+="<td>"+ee1+"</td>";}else{ee="<table id='LSS"+i+"' >"+"<tr><td><b>"+hd+"</b></td></tr>"+ee+"</table>";rr+="<td>"+ee+"</td>";}
if(i==1||i==2){break;}}}
if(rr!=""){var js_icd_data_str="";var js_icd_data_ee="";var full_dx_val=$.trim($("#"+fldid).data("valbakdb"));var final_dx_val=full_dx_val.toLowerCase();if(typeof(js_icd_data_arr)!="undefined"&&typeof(js_icd_data_arr[final_dx_val])!="undefined"){for(var k=0;k<js_icd_data_arr[final_dx_val].length;k++){js_icd_data_str+=js_icd_data_arr[final_dx_val][k];}}
if(js_icd_data_str!=""){js_icd_data_ee="<table id='LSk3'><tr><td style='padding:0px 0px 4px 0px;'><input type='hidden' id='fldid_chk' name='fldid_chk' value='"+fldid+"' ><b>Causative Factors</b></td></tr>"+js_icd_data_str+"</table>";}
var obj_comm_div="";if(fldid.indexOf("elem_assessment_dxcode")!=-1){var fldid_comm_id=fldid.replace("_dxcode","");var obj_comm_exp=($("#"+fldid_comm_id).val()).split(';');var obj_comm_val="";if(typeof(obj_comm_exp[2])!="undefined"){for(l=1;l<obj_comm_exp.length;l++){var obj_comm_exp_chk="";if(obj_comm_exp[l]!=""&&typeof(obj_comm_exp[l])!="undefined"){obj_comm_exp_chk=$.trim(obj_comm_exp[l].toLowerCase());if(l==1&&obj_comm_exp_chk!='ou'&&obj_comm_exp_chk!='od'&&obj_comm_exp_chk!='os'){}else{if(obj_comm_val!=''){obj_comm_val+=';';}
obj_comm_val+=obj_comm_exp[l];}}}}
var comm_width="410px";if(js_icd_data_ee!=""){comm_width="630px";}
obj_comm_div="<table id='dvLssComm'style='padding:5px 0px 5px 0px;'><tr><td><b>Comment</b></td></tr><tr><td><textarea class='input_text_10' name='elem_ass_comm' id='elem_ass_comm' style='width:"+comm_width+"; height:40px;'>"+obj_comm_val+"</textarea></td></tr></table>";}
if(fldid.indexOf("elem_assessment_dxcode")!=-1||fldid.indexOf("elem_assessment")!=-1){var show_ass_id=fldid.replace("elem_assessment_dxcode","elem_assessment");if($("#"+show_ass_id).val()==""){var show_ass_val=($("#"+fldid).val()).split(';');}else{var show_ass_val=($("#"+show_ass_id).val()).split(';');}
show_ass_val=(show_ass_val[0]).split('[');}else{var show_ass_id=fldid;var show_ass_val=($("#"+show_ass_id).val()).split('[');}
rr="<div class=\"dvLss\"><table id=\"bigtbl\" border='0' width='100%'><tr valign='top'>"+rr+"</tr></table></div>";var dd="<div id=\"dialogLSS\" title=\"Select ICD 10 Dx code\">"+"<input type=\"hidden\" id=\"pop_ass_flag\" value=\"1\" ><textarea class=\"input_text_10\" id='pop_"+show_ass_id+"' name='pop_elem_assessment[]' style=\"width:410px;height:20px;\">"+show_ass_val[0]+"</textarea>"+
rr+"<input type=\"hidden\" id=\"olen\" value=\"1\" >"+
js_icd_data_ee+obj_comm_div+"</div>";var del_btn_val="Delete Dx code";if(fldid.indexOf("elem_assessment_dxcode")!=-1){del_btn_val="Delete Assessment and Dx code";}
var show_staging_link_val=show_staging_link(show_ass_id);$("body").append(dd);var obtns=[];if(show_staging_link_val!=""){obtns[obtns.length]={id:"dmb_staging_code",text:"Staging Code",click:function(){staging_div_view('show');}}}
obtns[obtns.length]={text:"Done",'class':"ui-btn-sucus",click:function(){if($("#dialogLSS table[id*=LSk3]").length>0){$("#dialogLSS table[id*=LSk3] td").addClass("doneCF");}
if($("#dialogLSS table[id*=LSS_o]").length>0){$("#dialogLSS table[id*=LSS_o] td").addClass("doneLPU");}
if($("#dialogLSS table[id*=LSS0]").length>0){$("#dialogLSS table[id*=LSS0] td").addClass("doneLPU");}else if($("#dialogLSS table[id*=LSS1]").length>0){$("#dialogLSS table[id*=LSS1] td").addClass("doneLPU");}else if($("#dialogLSS table[id*=LSS2]").length>0){$("#dialogLSS table[id*=LSS2] td").addClass("doneLPU");}
if($("#dialogLSS td.highlight").length>0){$("#dialogLSS td.highlight").eq(0).triggerHandler("click");}else{if($("#elem_ass_comm").val()!=""){$("#dialogLSS td [id=txt_span_latt]").eq(0).triggerHandler("click");}}
if($("#elem_ass_comm")){$("#elem_ass_comm").val('');}
$(this).dialog("close");}}
obtns[obtns.length]={id:"dmb_reset",text:"Reset",click:function(){reset_assessment(fldid);}}
if(fldid.indexOf("elem_assessment_dxcode")!=-1){obtns[obtns.length]={id:"dialog_add_mutli_dx",text:"Add Multiple Dx",display:"none",click:function(){$("#dialogLSS").append("");$("#dialogLSS div.dvLss table#bigtbl").clone().appendTo("#dialogLSS  div.dvLss");var len=$("#dialogLSS table[id*=bigtbl]").length;var inx=len-1;var oo=$("#dialogLSS table[id*=bigtbl]").get(inx);oo.id="bigtbl"+inx;$("#dialogLSS table[id*="+oo.id+"] td").removeClass("highlight highlight_2");$("#dialogLSS #olen").val(len);}}}
if(js_icd_data_ee!=""){var dialogLSS_width='700';}else{var dialogLSS_width='450';}
$("#dialogLSS").dialog({close:function(){if($("#elem_ass_comm")){$("#elem_ass_comm").val('');}},buttons:obtns,minWidth:dialogLSS_width});$("#dialog_add_mutli_dx").hide();$("#dmb_reset").css({"float":"right"});$("#dmb_staging_code").css({"float":"left","background":"none","color":"purple","border":"none","font-weight":"bold"});cn_typeahead();var SeverityArr=["Mild","Moderate","Severe","Indeterminate","Unspecified","Early","Intermediate","Adv atrophic w/o subfoveal Involvement","Adv atrophic w subfoveal Involvement","Active neovascularization","Inactive neovasculization","Inactive scar","w/ macular edema","w/ret neovaculaization","stable"];var StageArr=["Initial Encounter","Subsequent Encounter","Sequlae"];var StageArr_Sec=["Initial Encounter Closed Fracture","Initial Encounter Open Fracture","Subsequent Encounter for Fracture with Routine Healing","Subsequent Encounter for Fracture with Delayed Healing","Subsequent Encounter for Fracture with Non Union","Sequela"];var StageArr_Small=["Initial","Subsequent","Sequlae"];var StageArr_Sec_Small=["Closed","Open","Routine","Delayed","Union","Sequela"];if($("#dialog_add_mutli_dx").length>0){if(fldid.indexOf("elem_assessment_dxcode")!=-1){var tt=$("#"+fldid).val();var tt_as=fldid.replace("_dxcode","");var tt_as_v=$("#"+tt_as).val();var ar_tt_as_v=tt_as_v.split(";");var ar_tt_as_v_op=[];if(typeof(ar_tt_as_v[1])!="undefined"){var ar_tt_as_v_1=$.trim(""+ar_tt_as_v[1]);ar_tt_as_v_op=ar_tt_as_v_1.split(", ");}
if(tt.indexOf("[ICD-10:")==-1){var artt=tt.split(",");var lentt=artt.length;if(typeof(ar_tt_as_v_1)!="undefined"){if(""+ar_tt_as_v_1.toLowerCase().indexOf("lid")!=-1){lentt=1;}}}else{var artt=[tt];var lentt=1;}
for(var t1=0;t1<lentt;t1++){if(typeof(ar_tt_as_v_op[t1])!="undefined"&&ar_tt_as_v_op[t1]!=""){var tmpspx=(t1==0)?"":t1;var ar_tt_as_v_op_last=replace_cid10_extra_string(ar_tt_as_v_op[t1]);ar_tt_as_v_op_last=ar_tt_as_v_op_last.split(" ");var chk_stg_len=$("#dialogLSS table[id*=LSS1]").length;if((ar_tt_as_v_op_last[0]=="Right"||ar_tt_as_v_op_last[0]=="Left"||ar_tt_as_v_op_last[0]=="Both")&&typeof(ar_tt_as_v_op_last[1])=="undefined"&&chk_stg_len<1){}else if($.inArray(ar_tt_as_v_op[0],SeverityArr)!=-1){if(t1>0){$("#dialog_add_mutli_dx").trigger("click");}
if(typeof(ar_tt_as_v_op_last[0])!="undefined"&&ar_tt_as_v_op_last[0]!=""){$("#dialogLSS table[id*=bigtbl"+tmpspx+"] table[id*=LSS1] td").each(function(){var strchk=$(this).html();if(typeof(strchk)!="undefined"&&strchk!=""&&ar_tt_as_v_op_last[0].indexOf(strchk)!=-1){var set_val=$(this).attr("dbid");$(this).addClass("highlight");$(this).data("vval",set_val);}else{$(this).removeClass("highlight");}});}}else if($.inArray(ar_tt_as_v_op[0],StageArr)!=-1){if(t1>0){$("#dialog_add_mutli_dx").trigger("click");}
ar_tt_as_v_op_last[0]=replace_cid10_extra_string(ar_tt_as_v_op_last[0]);if(typeof(ar_tt_as_v_op_last[0])!="undefined"&&ar_tt_as_v_op_last[0]!=""){$("#dialogLSS table[id*=bigtbl"+tmpspx+"] table[id*=LSS2] td").each(function(){var strchk=$(this).html();strchk=replace_cid10_extra_string(strchk);if(typeof(strchk)!="undefined"&&strchk!=""&&ar_tt_as_v_op_last[0].indexOf(strchk)!=-1){var set_val=$(this).attr("dbid");$(this).addClass("highlight");$(this).data("vval",set_val);}else{$(this).removeClass("highlight");}});}}else if($.inArray(ar_tt_as_v_op[0],StageArr_Sec)!=-1){if(t1>0){$("#dialog_add_mutli_dx").trigger("click");}
ar_tt_as_v_op_last[0]=replace_cid10_extra_string(ar_tt_as_v_op[0]);if(typeof(ar_tt_as_v_op_last[0])!="undefined"&&ar_tt_as_v_op_last[0]!=""){$("#dialogLSS table[id*=bigtbl"+tmpspx+"] table[id*=LSS2] td").each(function(){var strchk=$(this).html();strchk=replace_cid10_extra_string(strchk);if(typeof(strchk)!="undefined"&&strchk!=""&&ar_tt_as_v_op_last[0].indexOf(strchk)!=-1){var set_val=$(this).attr("dbid");$(this).addClass("highlight");$(this).data("vval",set_val);}else{$(this).removeClass("highlight");}});}}else if(ar_tt_as_v_op[0].indexOf("Right eye category")!=-1||ar_tt_as_v_op[0].indexOf("Left eye category")!=-1){if(t1>0){$("#dialog_add_mutli_dx").trigger("click");}
for(var zt=0;zt<2;zt++){var lss_td_id=zt;if(typeof(ar_tt_as_v_op[t1])!="undefined"&&ar_tt_as_v_op[t1]!=""){$("#dialogLSS table[id*=bigtbl"+tmpspx+"] table[id*=LSS"+lss_td_id+"] td").each(function(){var strchk=$(this).html();if(typeof(strchk)!="undefined"&&strchk!=""&&ar_tt_as_v_op[t1].indexOf(strchk)!=-1){var set_val=$(this).attr("dbid");$(this).addClass("highlight");$(this).data("vval",set_val);}else{$(this).removeClass("highlight");}});}}}else{if(t1>0){$("#dialog_add_mutli_dx").trigger("click");}
for(var zt=0;zt<3;zt++){var lss_td_id=zt;if($.inArray(ar_tt_as_v_op_last[zt],StageArr_Small)!=-1||$.inArray(ar_tt_as_v_op_last[zt],StageArr_Sec_Small)!=-1){var lss_td_id=2;}
if(typeof(ar_tt_as_v_op_last[zt])!="undefined"&&ar_tt_as_v_op_last[zt]!=""){$("#dialogLSS table[id*=bigtbl"+tmpspx+"] table[id*=LSS"+lss_td_id+"] td").each(function(){var strchk=$(this).html();strchk=replace_cid10_extra_string(strchk);if(typeof(strchk)!="undefined"&&strchk!=""&&ar_tt_as_v_op_last[zt].indexOf(strchk)!=-1){var set_val=$(this).attr("dbid");$(this).addClass("highlight");$(this).data("vval",set_val);}else{$(this).removeClass("highlight");}});}}}}}
for(var t1=0;t1<3;t1++){if(typeof(ar_tt_as_v_op[t1])!="undefined"){var tmpspx=0;var ar_tt_as_v_op_last=replace_cid10_extra_string(ar_tt_as_v_op[t1]);ar_tt_as_v_op_last=ar_tt_as_v_op_last.split(" ");var chk_stg_len=$("#dialogLSS table[id*=LSS1]").length;if((ar_tt_as_v_op_last[0]=="Right"||ar_tt_as_v_op_last[0]=="Left"||ar_tt_as_v_op_last[0]=="Both")&&typeof(ar_tt_as_v_op_last[1])=="undefined"&&chk_stg_len<1){if(typeof(ar_tt_as_v_op[t1])!="undefined"&&ar_tt_as_v_op[t1]!=""){$("#dialogLSS table[id*=bigtbl] table[id*=LSS"+tmpspx+"] td").each(function(){var strchk=$(this).html();strchk=replace_cid10_extra_string(strchk);if(typeof(strchk)!="undefined"&&strchk!=""&&ar_tt_as_v_op[t1].indexOf(strchk)!=-1){var set_val=$(this).attr("dbid");$(this).addClass("highlight");$(this).data("vval",set_val);}else{}});}}}}
for(var t1=0;t1<4;t1++){var tmpspx=0;if(typeof(ar_tt_as_v_op[t1])!="undefined"){if(""+ar_tt_as_v_op[t1].toLowerCase().indexOf("lid")!=-1){if(typeof(ar_tt_as_v_op[t1])!="undefined"&&ar_tt_as_v_op[t1]!=""){$("#dialogLSS table[id*=bigtbl] table[id*=LSS_od"+tmpspx+"] td").each(function(){var strchk=$(this).html();if(typeof(strchk)!="undefined"&&strchk!=""&&ar_tt_as_v_op[t1].indexOf(strchk)!=-1){var set_val=$(this).attr("dbid");$(this).addClass("highlight");$(this).data("vval",set_val);}else{}});$("#dialogLSS table[id*=bigtbl] table[id*=LSS_os"+tmpspx+"] td").each(function(){var strchk=$(this).html();if(typeof(strchk)!="undefined"&&strchk!=""&&ar_tt_as_v_op[t1].indexOf(strchk)!=-1){var set_val=$(this).attr("dbid");$(this).addClass("highlight");$(this).data("vval",set_val);}else{}});}}}}}}}}
$(this).autocomplete("close");}
return false;},focus:function(){return false;},close:function(event,ui){if(obj){if((typeof(ICD10)!='undefined'&&typeof(ICD10)=='string'&&""+ICD10.substr(-1)=='-')||(obj.val().indexOf('>>')>0)){obj.autocomplete("search");}}},select:function(event,ui){if(typeof(hiddenOBJ)!='undefined'&&hiddenOBJ.get(0)){hiddenOBJ.val('');}
uV1=ui.item.value;if(showMode=='mhx'&&uV1.indexOf('[ICD-10: ')>-1){uV=uV1;}
vARR1=uV1.split('[ICD-10: ');if(vARR1.length>1){ICD10_ARR1=vARR1[1].split(',');if(ICD10_ARR1.length>1){uV1=ICD10_ARR1[0];}}
laterality=uV1.substr((uV1.length-1),1);if(showMode!='ap'){if(uV1.indexOf('.')>0&&uV1.indexOf('-')<0){ICD10=uV1;}else if(uV1.length>=3&&uV1.indexOf('-')<0){ICD10=uV1;}}
if(laterality=='-'){laterality=false;var terms=icd10_split(this.value);terms.pop();terms.push(ui.item.value);terms.push("");this.value=terms.join(">>");}else if(typeof(ICD10)!='undefined'&&ICD10!=null&&typeof(ICD10)=='string'){dX_code=""+ICD10.replace('-',laterality);if(flg_LitSev){}else{FirstHyphen=dX_code.indexOf("-");if(FirstHyphen>=7){icd_value=this.value;NewdX_code=""+ICD10.replace('-',laterality);dX_code=icd_value.replace(ICD10,NewdX_code);dX_code=dX_code.replace('>>','');if(typeof(hiddenOBJ)!='undefined'&&hiddenOBJ.get(0)){hiddenOBJ.val(NewdX_code);}}}
if(showMode=='ap'){icd_value=this.value;NewdX_code=""+ICD10.replace('-',laterality);dX_code=icd_value.replace(ICD10,NewdX_code);dX_code=dX_code.replace('>>','');if(typeof(hiddenOBJ)!='undefined'&&hiddenOBJ.get(0)){hiddenOBJ.val(NewdX_code);}}
if(showMode=='mhx'&&dX_code.indexOf('-')==-1){var prob_arr_dX_code=uV.split('[ICD-10:');var prob_dX_code=prob_arr_dX_code[0]+' (ICD-10-CM '+dX_code+')';dX_code=prob_dX_code;}
this.value=dX_code;}else{if(showMode=='ap'){this.value=ui.item.value;if(typeof(hiddenOBJ)!='undefined'&&hiddenOBJ.get(0)){hiddenOBJ.val(uV1);}}else{FirstHyphen=ui.item.value.indexOf("-");if(FirstHyphen>=7){this.value=ui.item.value;}else{this.value=uV1;}}}
var dxid=(typeof(ui.item.id)!="undefined")?ui.item.id:"";if(dxid!=""){$(this).data("dxid",dxid);}
return false;}}
if(showMode=='mhx'){autoConfig['position']={my:"left bottom",at:"left top"}}
obj.bind("keydown",function(event){if(typeof(hiddenOBJ)!='undefined'&&hiddenOBJ.get(0)){hiddenOBJ.val('');}
if(event.keyCode===$.ui.keyCode.TAB&&$(this).data("ui-autocomplete").menu.active){event.preventDefault();}}).autocomplete(autoConfig);}
function cn_set_sub_dx(id,val_post){var nogo=1;if($("#fldid_chk")){$(".elem_sub_dx").each(function(){var chk_box_id=this.id;var chk_box_val=$('#'+chk_box_id).data("valbakdb");chk_box_val_exp=chk_box_val.split("-");if(chk_box_val_exp.length>1){var val=$("#dialogLSS #bigtbl table[id*=LSS0] td.highlight").data("vval");if(val!=null&&val!=""&&typeof(val)!="undefined"){chk_box_val=chk_box_val.replace('-',val);nogo=0;$('#'+chk_box_id).val(""+chk_box_val);}}else{if(typeof($('#LSS0').html())!="undefined"){var val=$("#dialogLSS #bigtbl table[id*=LSS0] td.highlight").data("vval");if(val!=null&&val!=""&&typeof(val)!="undefined"){nogo=0;}}else{nogo=0;}}});}
if(nogo==1){return;}
var ass_id=fldid_chk.value;if(ass_id.indexOf("elem_assessment")!=-1||ass_id.indexOf("elem_assessment_dxcode")!=-1){for(var j=1;j<=50;j++){var ass_new_id_num=j;if($('#elem_assessment'+ass_new_id_num).val()==""&&$('#elem_assessment_dxcode'+ass_new_id_num).val()==""){break;}}
var ass_id="elem_assessment"+ass_new_id_num;var ass_dx_id="elem_assessment_dxcode"+ass_new_id_num;var chk_box_id="elem_sub_"+id;var chk_box_val=$('#'+chk_box_id).val();var chk_box_desc_id="elem_sub_desc_"+id;var chk_box_desc_val=$('#'+chk_box_desc_id).val();if(val_post!="yes"){$(".elem_sub_dx").each(function(){if(this.id!=chk_box_id){$('label[for='+this.id+']').css({"color":"purple","font-weight":"normal"}).removeClass("highlight");this.checked=false;}});}
if($('#'+chk_box_id).is(':checked')==true){$('label[for='+chk_box_id+']').css({"color":"red","font-weight":"bold"}).addClass("highlight");if(val_post=="yes"){$('#'+ass_id).val(chk_box_desc_val);$('#'+ass_dx_id).val(chk_box_val);$("#"+ass_id).triggerHandler("change");$("#"+ass_id).triggerHandler("blur");}}else{$('label[for='+chk_box_id+']').css({"color":"purple","font-weight":"normal"}).removeClass("highlight");}}else{var chk_box_id="elem_sub_"+id;var chk_box_val=$('#'+chk_box_id).val();for(var k=1;k<13;k++){if(val_post!="yes"){$(".elem_sub_dx").each(function(){if($('#elem_dxCode_'+k).val()==this.value){$('#elem_dxCode_'+k).val('');}
if(this.id!=chk_box_id){$('label[for='+this.id+']').css({"color":"purple","font-weight":"normal"}).removeClass("highlight");this.checked=false;}});}
var elem_dxCode=$('#elem_dxCode_'+k);var elem_dxCode_val=$('#elem_dxCode_'+k).val();if($('#'+chk_box_id).is(':checked')==true){$('label[for='+chk_box_id+']').css({"color":"red","font-weight":"bold"}).addClass("highlight");if($('#elem_dxCode_'+k)&&elem_dxCode_val==""&&val_post=="yes"){$('#elem_dxCode_'+k).val(chk_box_val);return false;}}else{$('label[for='+chk_box_id+']').css({"color":"purple","font-weight":"normal"}).removeClass("highlight");if(elem_dxCode_val==chk_box_val&&val_post=="yes"){$('#elem_dxCode_'+k).val('');return false;}}}}}
function show_sec_icd(val){var show_icd="";if($('.'+val).css('display')=='none'){var show_icd=val;$('.icd10_data_td').css({"display":"none"});}
$('.icd10_data_td').css({"display":"none"});if(show_icd!=""){$('.'+show_icd).css({"display":"table-row"});}}
function show_staging_link(id){var ass_id="";var show_staging="";if(id.indexOf("elem_assessment_dxcode")!=-1){ass_id=id;}else if(id.indexOf("elem_assessment")!=-1){ass_id=id.replace("elem_assessment","elem_assessment_dxcode");if($("#"+ass_id).val()==""){ass_id=id.replace("elem_assessment_dxcode","elem_assessment");}}else if(id.indexOf("elem_dxCode")!=-1){ass_id=id;}
if(ass_id!=""){var ass_val=($("#"+ass_id).val()).split('.');if($.trim(ass_val[0])=='H40'||$.trim(ass_val[0])=='h40'){show_staging=$("#"+ass_id).val();}else{ass_val=(ass_val[0]).split(':');if($.trim(ass_val[1])=='H40'||$.trim(ass_val[1])=='h40'){show_staging=$("#"+ass_id).val();}}}
return show_staging;}
function cn_isFulldxAdded(ob){var fldid04=""+ob.id;var dxdb=$("#"+fldid04).data("valbakdb");var dxdsc=$("#"+fldid04).data("valdxdesc");var st1srch=""+$("#"+fldid04).data("val1stsrch");var srchval=""+$("#"+fldid04).data("valsrchd").toUpperCase().trim();var ar_st1srch=st1srch.split(",");st1srch=$.trim(ar_st1srch[ar_st1srch.length-1]);st1srch=st1srch.toUpperCase().trim();$("#"+fldid04).removeData("val1stsrch");if(typeof(dxdb)!="undefined"&&typeof(dxdsc)!="undefined"){if(""+st1srch!=""+srchval&&srchval.indexOf("-")==-1){if(ob.id.indexOf("elem_assessment")!=-1&&ob.id.indexOf("_dxcode")==-1){ob.value=dxdsc;$(ob).triggerHandler("blur");$(ob).triggerHandler("change");var dx_id=ob.id.replace("elem_assessment","elem_assessment_dxcode");$("#"+dx_id).val(srchval);}else if(ob.id.indexOf("elem_assessment_dxcode")!=-1){ob.value=srchval;var as_id=ob.id.replace("elem_assessment_dxcode","elem_assessment");if($.trim($("#"+as_id).val())==""&&$("#"+as_id).length>0){$("#"+as_id).val(dxdsc);$("#"+as_id).triggerHandler("blur");$("#"+as_id).triggerHandler("change");}}else{ob.value=srchval;}
return true;}}
return false;}
function getIEtextareaCaret(el){var start=0;if(typeof(el.createTextRange)=="function"&&document.selection&&typeof(document.selection.createRange())!="undefined"){var range=el.createTextRange(),range2=document.selection.createRange().duplicate(),range2Bookmark=range2.getBookmark();range.moveToBookmark(range2Bookmark);while(range.moveStart('character',-1)!==0){start++;}}else if(el.selectionStart){var val=el.value;start=val.slice(0,el.selectionStart).length;}else{start=el.length;}
if(typeof(start)=="undefined"){start=0;}
return start;}
function jq_extractLast(term,side,o){var term_full=term;var cat=getIEtextareaCaret(o);term=term.substring(0,cat);var n0=term.lastIndexOf("\n");term=$.trim(term);var ret="",ret2="";if(side==1){ret=""+$.trim(term.substring(n0+1));}else if(side==2){ret=""+$.trim(term.substring(0,n0))+"\n";srch=""+$.trim(term.substring(n0+1));ret2=""+$.trim(term_full.substring(n0))+"";cat=cat-srch.length;}
if(ret2.length>0){ret2=ret2.replace(srch,"");}
if(cat<0){cat=0;}
return(side==2)?[ret,ret2,cat,srch]:ret;}
function jq_getStarter(term){var r="";var o=new RegExp("^(\\-|((\\d+|\\w)\\.))","i");if(o.test(term)){r=o.exec(term);r=r[0];term=term.replace(o,"");term=$.trim(term);}
return[r,term];}
function cn_rem_escp_char(s){if(s!=""){s=s.replace(/\\'/g,"'");s=s.replace(/\\&/g,"&");}
return s;}
function cn_adjustSearchValue(hystck,ndl){var ar_ndl=ndl.split(" ");var last_ndl="",flgFull=0;if(ar_ndl.length>1){last_ndl=ar_ndl[ar_ndl.length-1];}
if(hystck.toLowerCase().indexOf(ndl.toLowerCase())!=-1||flgFull==1){return hystck;}else{var tmp="";if(last_ndl!=""&&hystck.toLowerCase().indexOf(last_ndl.toLowerCase())!=-1){ar_ndl.length=ar_ndl.length-1;var tmp=ar_ndl.join(" ");if($.trim(tmp)!=""){tmp=tmp+" ";}}
return tmp+hystck;}}
var chk_term_length=function(term){var art=term.split(" "),art_ln=art.length;if(art_ln>0){var t=$.trim(art[art_ln-1]);if(t.length<3){return false;}}
return true;};var cn_ta1_no_assess=function(ota1,strExamName){if(typeof(strExamName)=="undefined"){strExamName="";}
$(ota1).autocomplete({source:function(request,response){var mode="";if(this.element[0].name&&typeof(this.element[0].name)!="undefined"&&(this.element[0].name=="elem_visMrDesc"||this.element[0].name.indexOf("elem_visMrDescOther")!=-1)){var tmpICD10=$("#hid_icd10").val();tmpICD10=(tmpICD10==1)?1:0;mode="&mode=MR&ICD10="+tmpICD10;}
var str_prfx="";if(typeof(top.JS_WEB_ROOT_PATH)!="undefined"){str_prfx=top.JS_WEB_ROOT_PATH+"/interface/chart_notes/";}
$.getJSON(str_prfx+"requestHandler.php?elem_formAction=TypeAhead"+strExamName+mode,{term:jq_extractLast(request.term,1,this.element[0])},response);},search:function(){var term=jq_extractLast(this.value,1,this);var o=jq_getStarter(term);this.strter=o[0];return chk_term_length(term);},minLength:3,autoFocus:true,focus:function(event,ui){return false;},select:function(event,ui){if(ui.item.value!=""){arr=ui.item.value.split("~~");ui.item.value=arr[0];var t=jq_extractLast(this.value,2,this);var r=""+ui.item.value;r=cn_adjustSearchValue(r,t[3]);if(this.strter!=""){r=$.trim(this.strter+" "+r);}
this.value=$.trim(""+t[0]+""+r+t[1]);if(typeof(setCursorAtEnd)!="undefined"){setCursorAtEnd(this,t[2]+r.length);}
$(this).triggerHandler("change");$(this).triggerHandler("blur");$(this).triggerHandler("click");return false;}}}).filter("textarea[id^=elem_plan]").each(function(){$(this).triggerHandler('keyup');});};function cn_typeahead_order(){var ta3=function(ota3){$(ota3).autocomplete({source:zPath+"/chart_notes/requestHandler.php?elem_formAction=TypeAhead&mode=getorder&req_ptwo=1",minLength:2,autoFocus:true,focus:function(event,ui){return false;},select:function(event,ui){if(ui.item.value!=""){var r=""+ui.item.value;this.value=$.trim(""+r);$(this).parent().find(":hidden[id*=med_id]").val(ui.item.id);$(this).triggerHandler("change");$(this).triggerHandler("blur");$(this).triggerHandler("click");return false;}}});};$("input[type=text][id*=ele_order_name]").bind("focus",function(event){if(!$(this).hasClass("ui-autocomplete-input")){ta3(this);};});}
function cn_ta_cvf_ag(ptrn){$(ptrn).bind("focus",function(){if(!$(this).hasClass("ui-autocomplete-input")){cn_ta1_no_assess(this,"");};});}
function cn_typeahead(flg){var browser=navigator.appName;var b_version=navigator.appVersion;var version=parseFloat(b_version);if(typeof(rv_lens_used)!="undefined"){rv_lens_used();}
var strExamName="";var ptrntextbox="";if(typeof(examName)!="undefined"&&(examName!="")){strExamName="&exmnm="+examName;ptrntextbox=",input[name][type=text]:not(.mulPressure input[name][type=text])";}
if(version!=4){$("textarea[name]:not(textarea[name^='elem_assessment'])"+ptrntextbox).bind("focus",function(){if(!$(this).hasClass("ui-autocomplete-input")){cn_ta1_no_assess(this,strExamName);};});$("#assessplan .col-sm-12-pl textarea[name^='elem_plan'], #commentsForPatient, #elem_consult_reason, #PC  textarea[name^='elem_visPcDesc'], #MR  textarea[name^='elem_visMrDesc'], #elem_notes").each(function(){$(this).triggerHandler('keyup');});getDataFilePath='requestHandler.php?elem_formAction=TypeAhead&mode=assessment&callFrom=wv';var flg_LitSev="";var ta2=function(ota2){$(ota2).bind("keydown",function(event){}).autocomplete({open:function(event,ui){$(ota2).autocomplete("widget").css("width",parseInt($(window).width()*3/4)+"px");},source:function(request,response){showMode="ap";assessment=uV=request.term;vARR=uV.split('[ICD-10: ');if(vARR.length>1){ICD10_ARR=vARR[1].split(',');if(ICD10_ARR.length>1){ICD10=ICD10_ARR[0];request.term=ICD10;assessment=vARR[0];}}else{delete ICD10;}
request.term=request.term.replace(/^\s|\s$/g,'');var term=jq_extractLast(request.term,1,this.element[0]);var o=jq_getStarter(term);this.element[0].strter=o[0];flg_LitSev=0;if(typeof(examName)!="undefined"&&examName=="Fundus"){var tmpICD10=window.opener.top.fmain.$("#hid_icd10").val();tmpICD10=(tmpICD10==1)?1:0;var chart_dos="";if(typeof(window.opener.top.fmain.$("#elem_dos").val())!="undefined"&&$("textarea[name^='elem_assessment']")){chart_dos=window.opener.top.fmain.$("#elem_dos").val();}}else{var tmpICD10=$("#hid_icd10").val();tmpICD10=(tmpICD10==1)?1:0;var chart_dos="";if(typeof($("#elem_dos").val())!="undefined"&&$("textarea[name^='elem_assessment']")){chart_dos=$("#elem_dos").val();}}
if(getDataFilePath=="../common/getICD10data.php"){getDataFilePath="requestHandler.php?elem_formAction=TypeAhead&mode=getICD10Data&term="+term+"&ICD10="+tmpICD10+"&show_pop=1";}else{getDataFilePath=getDataFilePath+'&term='+term+'&ICD10='+tmpICD10+'&show_pop=1&chart_dos='+chart_dos;}
var oe=this.element[0];if(typeof($(oe).data("val1stsrch"))=="undefined"){$(oe).data("val1stsrch",term);}
$.ajax({url:getDataFilePath,dataType:"json",success:function(availableTags){if(typeof(availableTags.flg_LitSev)!="undefined"&&(availableTags.flg_LitSev==1||availableTags.flg_LitSev==0)){flg_LitSev=availableTags.flg_LitSev;if(typeof(availableTags.icd10_dxdb)!="undefined"){$(oe).data("valbakdb",availableTags.icd10_dxdb);}
if(typeof(availableTags.srchd_code)!="undefined"){$(oe).data("valsrchd",availableTags.srchd_code);}
if(typeof(availableTags.icd10_dxdesc)!="undefined"){$(oe).data("valdxdesc",availableTags.icd10_dxdesc);}
availableTags=availableTags.results;}
if(vARR&&vARR.length>1){request.term='';}request.term='';if(flg_LitSev==1){response(availableTags);}else{response($.ui.autocomplete.filter(availableTags,icd10_extractLast(request.term)));}}});},response:function(event,ui){if(flg_LitSev){if(cn_isFulldxAdded(this)){}else{$("#"+this.id).removeData("val1stsrch");if($("#dialogLSS").length>0){if($("#pop_ass_flag").length>0){var fldid01=""+this.id;var fldid02=fldid01.replace("pop_","");if(fldid02.indexOf("elem_assessment_dxcode")!=-1||fldid02.indexOf("elem_assessment")!=-1){var fldid03=fldid02.replace("elem_assessment","elem_assessment_dxcode");var elem_ass_comm=$("#elem_ass_comm").val();var fldid03_exp=$("#"+fldid01).val().split('[ICD-10: ');var fldid03_arr="";if(fldid03_exp.length>1){fldid03_arr=fldid03_exp[1].split(',');}
if(elem_ass_comm!=""&&typeof(elem_ass_comm)!="undefined"){$("#"+fldid02).val($("#"+fldid01).val()+";;"+elem_ass_comm);}else{$("#"+fldid02).val($("#"+fldid01).val());}
$("#"+fldid03).val(fldid03_arr[0]);$("#"+fldid03).data("valbakdb",fldid03_arr[0]);$("#dialogLSS").remove();$("#"+fldid02).triggerHandler("click");$("#"+fldid02).triggerHandler("blur");$("#"+fldid02).triggerHandler("change");}else if(fldid02.indexOf("elem_dxCode")!=-1){var fldid03_exp=$("#"+fldid01).val().split('[ICD-10: ');var fldid03_arr="";if(fldid03_exp.length>1){fldid03_arr=fldid03_exp[1].split(',');}else{fldid03_arr=fldid03_exp[1];}
$("#"+fldid02).val(fldid03_arr[0]);$("#"+fldid02).data("valbakdb",fldid03_arr[0]);$("#dialogLSS").remove();$("#"+fldid02).triggerHandler("click");$("#"+fldid02).triggerHandler("blur");$("#"+fldid02).triggerHandler("change");}}else{$("#dialogLSS").remove();}}
var rr="";var i=1;for(var i=0;i<3;i++){var ee="",ee1="";var lat_ct=0;for(var x in ui['content'][i]){lat_ct=parseInt(lat_ct)+1;var lat_ct_show="";var tmp=""+ui['content'][i][x];if(typeof(tmp)=="undefined"||tmp==""||tmp=="undefined"){continue;}
var arr_tmp=tmp.split("-");var showtxt=$.trim(arr_tmp[0]);var showval=$.trim(arr_tmp[1]);var fldid=""+this.id;fldid=fldid.replace("pop_","");if(i==0){lat_ct_show="txt_lat";}else if(i==1){lat_ct_show="txt_sev";}else if(i==2){lat_ct_show="txt_stag";}
ee+="<span id='txt_span_latt' onclick=\"cn_resetasval('"+fldid+"', '"+showval+"','"+i+"', this);\"></span>";if(i==0){if(showtxt.toLowerCase().indexOf("lid")!=-1){if(showtxt.toLowerCase().indexOf("right")!=-1){ee+="<tr><td  id='"+lat_ct_show+"_"+lat_ct+"' dbid='"+showval+"' onclick=\"cn_resetasval('"+fldid+"', '"+showval+"','"+i+"', this);\">"+showtxt+"</td></tr>";}else{ee1+="<tr><td  id='"+lat_ct_show+"_"+lat_ct+"' dbid='"+showval+"' onclick=\"cn_resetasval('"+fldid+"', '"+showval+"','"+i+"', this);\">"+showtxt+"</td></tr>";}
continue;}}
ee+="<tr><td id='"+lat_ct_show+"_"+lat_ct+"' dbid='"+showval+"' onclick=\"cn_resetasval('"+fldid+"', '"+showval+"','"+i+"', this);\">"+showtxt+"</td></tr>";}
if(ee!=""){var hd="";if(i==0){hd="Eye";}else if(i==1){hd="Stage";}else if(i==2){hd="Encounter";}
if(i==0&&ee1!=""){ee="<table id='LSS_od"+i+"' >"+"<tr><td><b>Right Eye</b></td></tr>"+ee+""+"</table>";rr+="<td>"+ee+"</td>";ee1="<table id='LSS_os"+i+"' >"+"<tr><td><b>Left Eye</b></td></tr>"+ee1+"</table>";rr+="<td>"+ee1+"</td>";}else{ee="<table id='LSS"+i+"' >"+"<tr><td><b>"+hd+"</b></td></tr>"+ee+"</table>";rr+="<td>"+ee+"</td>";}
if(i==1||i==2){break;}}}
if(rr!=""){var js_icd_data_str="";var js_icd_data_ee="";var full_dx_val=$.trim($("#"+fldid).data("valbakdb"));var final_dx_val=full_dx_val.toLowerCase();if(typeof(js_icd_data_arr)!="undefined"&&js_icd_data_arr&&typeof(js_icd_data_arr[final_dx_val])!="undefined"){for(var k=0;k<js_icd_data_arr[final_dx_val].length;k++){js_icd_data_str+=js_icd_data_arr[final_dx_val][k];}}
if(js_icd_data_str!=""){js_icd_data_ee="<table id='LSk3'><tr><td style='padding:0px 0px 4px 0px;'><input type='hidden' id='fldid_chk' name='fldid_chk' value='"+fldid+"' ><b>Causative Factors</b></td></tr>"+js_icd_data_str+"</table>";}
var obj_comm_div="";if(fldid.indexOf("elem_assessment")!=-1){var fldid_comm_id=fldid.replace("_dxcode","");var obj_comm_exp=($("#"+fldid_comm_id).val()).split(';');var obj_comm_val="";if(typeof(obj_comm_exp[2])!="undefined"){for(l=1;l<=obj_comm_exp.length;l++){var obj_comm_exp_chk="";if(obj_comm_exp[l]!=""&&typeof(obj_comm_exp[l])!="undefined"){obj_comm_exp_chk=$.trim(obj_comm_exp[l].toLowerCase());if(l==1&&obj_comm_exp_chk!='ou'&&obj_comm_exp_chk!='od'&&obj_comm_exp_chk!='os'){}else{if(obj_comm_val!=''){obj_comm_val+=';';}
obj_comm_val+=obj_comm_exp[l];}}}}
var comm_width="410px";if(js_icd_data_ee!=""){comm_width="630px";}
obj_comm_div="<table id='dvLssComm'style='padding:5px 0px 5px 0px;'><tr><td><b>Comment</b></td></tr><tr><td><textarea class='input_text_10' name='elem_ass_comm' id='elem_ass_comm' style='width:"+comm_width+"; height:40px;'>"+obj_comm_val+"</textarea></td></tr></table>";}
if(fldid.indexOf("elem_assessment_dxcode")!=-1||fldid.indexOf("elem_assessment")!=-1){var show_ass_id=fldid.replace("elem_assessment_dxcode","elem_assessment");}else{var show_ass_id=fldid.replace("pop_","");}
var show_ass_val=($("#"+show_ass_id).val()).split('[');rr="<div class=\"dvLss\"><table id=\"bigtbl\" border='0' width='100%'><tr valign='top'>"+rr+"</tr></table></div>";var dd="<div id=\"dialogLSS\" title=\"Select ICD 10 Dx code\">"+"<input type=\"hidden\" id=\"pop_ass_flag\" value=\"1\" ><textarea class=\"input_text_10\" id='pop_"+show_ass_id+"' name='pop_elem_assessment[]' style=\"width:410px;height:20px;\">"+show_ass_val[0]+"</textarea>"+
rr+"<input type=\"hidden\" id=\"olen\" value=\"1\" >"+
js_icd_data_ee+obj_comm_div+"</div>";var del_btn_val="Delete Dx code";if(fldid.indexOf("elem_assessment_dxcode")!=-1||fldid.indexOf("elem_assessment")!=-1){del_btn_val="Delete Assessment and Dx code";}
if(js_icd_data_ee!=""){var dialogLSS_width='700';}else{var dialogLSS_width='450';}
var show_staging_link_val=show_staging_link(show_ass_id);$("body").append(dd);$("#dialogLSS").dialog({close:function(){if($("#elem_ass_comm")){$("#elem_ass_comm").val('');}},buttons:[{text:"Done",'class':"ui-btn-sucus",click:function(){if($("#dialogLSS table[id*=LSk3]").length>0){$("#dialogLSS table[id*=LSk3] td").addClass("doneCF");}
if($("#dialogLSS table[id*=LSS_o]").length>0){$("#dialogLSS table[id*=LSS_o] td").addClass("doneLPU");}
if($("#dialogLSS table[id*=LSS0]").length>0){$("#dialogLSS table[id*=LSS0] td").addClass("doneLPU");}else if($("#dialogLSS table[id*=LSS1]").length>0){$("#dialogLSS table[id*=LSS1] td").addClass("doneLPU");}else if($("#dialogLSS table[id*=LSS2]").length>0){$("#dialogLSS table[id*=LSS2] td").addClass("doneLPU");}
if($("#dialogLSS td.highlight").length>0){$("#dialogLSS td.highlight").eq(0).triggerHandler("click");}else{if($("#elem_ass_comm").val()!=""){$("#dialogLSS td [id=txt_span_latt]").eq(0).triggerHandler("click");}}
if($("#elem_ass_comm")){$("#elem_ass_comm").val('');}
$(this).dialog("close");}},{id:"dmb_reset",text:"Reset",click:function(){reset_assessment(fldid);}},{id:"dmb_staging_code",text:"Staging Code",click:function(){staging_div_view('show');}},{id:"dialog_add_mutli_dx",text:"Add Multiple Dx",click:function(){$("#dialogLSS").append("");$("#dialogLSS div.dvLss table#bigtbl").clone().appendTo("#dialogLSS div.dvLss");var len=$("#dialogLSS table[id*=bigtbl]").length;var inx=len-1;var oo=$("#dialogLSS table[id*=bigtbl]").get(inx);oo.id="bigtbl"+inx;$("#dialogLSS #olen").val(len);}}],minWidth:dialogLSS_width});$("#dmb_reset").css({"float":"right"});if(show_staging_link_val==""){$("#dmb_staging_code").hide();}
$("#dmb_staging_code").css({"float":"left","background":"none","color":"purple","border":"none","font-weight":"bold"});$("#dialog_add_mutli_dx").hide();cn_typeahead();if($("#dialog_add_mutli_dx").length>0){if(fldid.indexOf("elem_assessment")!=-1){var fldid_as=fldid.replace(/elem_assessment/,"elem_assessment_dxcode");var tt=$("#"+fldid_as).val();var artt=tt.split(",");var lentt=artt.length;for(var t1=1;t1<lentt;t1++){$("#dialog_add_mutli_dx").trigger("click");}}}}}
$(this).autocomplete("close");}
return false;},minLength:1,focus:function(){return false;},close:function(){if((typeof(ICD10)=='string'&&ICD10.substr((ICD10.length-1),1)=='-')||($(this).val().indexOf('>>')>0)){getDataFilePath='../common/getICD10data.php';if(hiddenOBJ.val()==""||""+hiddenOBJ.val().indexOf("-")!=-1)
$(this).autocomplete("search");}else{getDataFilePath='requestHandler.php?elem_formAction=TypeAhead&mode=assessment&callFrom=wv';}},select:function(event,ui){var flgInWv=(typeof(examName)!="undefined"&&examName=="Fundus")?0:1;if(flgInWv){getForthAssess();}
arr=ui.item.value.split("~~");index=$(this).attr('id').match(/\d+$/);if($(this).attr('id').indexOf("elem_assessment_dxcode")!=-1||$(this).attr('id').indexOf("elem_assessment")!=-1){hiddenOBJ=$("#elem_assessment_dxcode"+index);}else{hiddenOBJ=$("#elem_dxCode_"+index);}
if(this.value.indexOf(";")==-1){if(typeof(hiddenOBJ)!='undefined'&&hiddenOBJ.get(0)){hiddenOBJ.val('');hiddenOBJ.data("dxid","");}}
if(arr[1]=='commu'||arr[1]=='phy'||arr[1]=='dyn'||arr[1]=='dx'){var tmp_val="";ui.item.value=arr[0];var tmp_ival=cn_rem_escp_char(ui.item.value);uV1=tmp_ival;if(uV1.slice(-1)==")"&&uV1.indexOf(" \t\r(")!=-1){arr1=uV1.split(/\([^\(]*$/);tmp_val=arr1[0];if(this.value.indexOf(";")==-1||hiddenOBJ.val()==""){var tmp_dx_id=(typeof(ui.item.dxid)!="undefined")?ui.item.dxid:"";vARR1=uV1.split("(").pop().replace(/\)$/g,'');if(typeof(asmt_sep_multi_dx_code)=="undefined"||flgInWv==0){asmt_sep_multi_dx_code=0;}
if(asmt_sep_multi_dx_code==1&&typeof(vARR1)!="undefined"&&vARR1!=""&&(vARR1.indexOf(",")!=-1||vARR1.indexOf(";")!=-1)){if(vARR1.indexOf(",")!=-1){var ardx=vARR1.split(",");}else if(vARR1.indexOf(";")!=-1){var ardx=vARR1.split(";");}
if(ardx.length>1){var ardxid=tmp_dx_id.split(",");for(var d=0;d<ardx.length;d++){var t=""+$.trim(ardx[d]);var tid=(typeof(ardxid[d])!="undefined")?""+$.trim(ardxid[d]):"";if(t!=""){if(d==0){hiddenOBJ.val(t).data("dxid",tid);hiddenOBJ.triggerHandler("blur");}
else{addAssessOptionExe("","","","","",t,'','',1,tid);}}}}}else{hiddenOBJ.val(vARR1).data("dxid",tmp_dx_id);hiddenOBJ.triggerHandler("blur");}}}else{tmp_val=uV1;if(this.value.indexOf(";")==-1){hiddenOBJ.val('');if(flgInWv==1){show_asmt_site(hiddenOBJ,'');}}}
var t=jq_extractLast(this.value,2,this);var r=""+tmp_val;r=cn_adjustSearchValue(r,t[3]);if(this.strter!=""){r=$.trim(this.strter+" "+r);}
this.value=$.trim(""+t[0]+""+r+t[1]);$(this).triggerHandler("change");$(this).triggerHandler("blur");$(this).triggerHandler("click");return false;}
code='';uV1=assessment=ui.item.value;vARR1=uV1.split('[ICD-10: ');if(vARR1.length>1){ICD10_ARR1=vARR1[1].split(',');if(ICD10_ARR1.length>1){uV1=ICD10_ARR1[0];code=ICD10_ARR1[0];}}
laterality=uV1.substr((uV1.length-1),1);if(showMode!='ap'&&uV1.indexOf('.')>0&&uV1.indexOf('-')<0){ICD10=uV1;}
if(laterality=='-'){laterality=false;var terms=icd10_split(this.value);terms.pop();terms.push(ui.item.value);terms.push("");this.value=terms.join(">>");var tmp=typeof(ui.item.id)!="undefined"?ui.item.id:"";if(tmp!=""){hiddenOBJ.data("dxid",tmp);}}else if(typeof(ICD10)!='undefined'&&ICD10!=null&&typeof(ICD10)=='string'){dX_code=ICD10.replace('-',laterality);if(showMode=='ap'){icd_value=this.value;NewdX_code=ICD10.replace('-',laterality);dX_code=icd_value.replace(ICD10,NewdX_code);dX_code=dX_code.replace('>>','');vARR2=dX_code.split(' [ICD-10: ');if(vARR2.length>1){assessment=vARR2[0];}
if(typeof(hiddenOBJ)!='undefined'&&hiddenOBJ.get(0)){hiddenOBJ.val(NewdX_code);}}
this.value=assessment;$(this).triggerHandler("change");$(this).triggerHandler("blur");$(this).triggerHandler("click");}else{if(showMode=='ap'){if(vARR1.length>1){this.value=vARR1[0];if(typeof(hiddenOBJ)!='undefined'&&hiddenOBJ.get(0)){hiddenOBJ.val(code);if(typeof(ui.item.id)!="undefined"&&$.trim(ui.item.id)!=""){hiddenOBJ.data("dxid",ui.item.id);}
if(flgInWv==1){show_asmt_site(hiddenOBJ,code);}}
var fldid01=""+this.id;var fldid02=fldid01.replace("pop_","");if($("#dialogLSS").length>0){if($("#pop_ass_flag").length>0){if(fldid02.indexOf("elem_assessment_dxcode")!=-1||fldid02.indexOf("elem_assessment")!=-1){var elem_ass_comm="";if($("#elem_ass_comm").val()!=""){elem_ass_comm="; \n"+$("#elem_ass_comm").val();}
$("#"+fldid02).val($("#"+fldid01).val()+elem_ass_comm);$("#dialogLSS").remove();}else{$("#dialogLSS").remove();}}}
$("#"+fldid02).triggerHandler("click");$("#"+fldid02).triggerHandler("blur");$("#"+fldid02).triggerHandler("change");}else{if(this.value.indexOf(";")==-1){if(typeof(hiddenOBJ)!='undefined'&&hiddenOBJ.get(0)){hiddenOBJ.val(code);}}
tmp_val=""+ui.item.value;var t=jq_extractLast(this.value,2,this);var r=""+tmp_val;r=cn_adjustSearchValue(r,t[3]);if(this.strter!=""){r=$.trim(this.strter+" "+r);}
this.value=$.trim(""+t[0]+""+r+t[1]);$(this).triggerHandler("change");$(this).triggerHandler("blur");$(this).triggerHandler("click");}}else{this.value=assessment;$(this).triggerHandler("change");$(this).triggerHandler("blur");$(this).triggerHandler("click");}}
return false;}});};$("#assessplan .col-sm-7-as textarea[name^='elem_assessment']").bind("focus",function(){if($(this).attr('id')!=icd10_unique_obj_id){icd10_unique_obj_id=$(this).attr('id');delete uV;delete vARR;delete ICD10;delete uV1;delete vARR1;delete ICD10_ARR1;delete laterality;delete dX_code;delete NewdX_code;delete ICD10_ARR;}});$("#assessplan .col-sm-7-as textarea[name='elem_assessment[]'], #dialogLSS textarea[name='pop_elem_assessment[]'], #rprtIntrModal textarea[name='elem_assessment[]'] ").bind("focus",function(event){if(!$(this).hasClass("ui-autocomplete-input")){ta2(this);};});}else if(version==4){var ta3=function(ota3){$(ota3).autocomplete({source:"requestHandler.php?elem_formAction=TypeAhead"+strExamName,minLength:2,autoFocus:true,focus:function(event,ui){return false;},select:function(event,ui){if(ui.item.value!=""){var t=jq_extractLast(this.value,2,this);var r=""+ui.item.value;r=cn_adjustSearchValue(r,t[3]);if(this.strter!=""){r=$.trim(this.strter+" "+r);}
this.value=$.trim(""+t[0]+""+r+t[1]);$(this).triggerHandler("change");$(this).triggerHandler("blur");$(this).triggerHandler("click");setCursorAtEnd(this,t[2]+r.length);}}}).filter("textarea[id^=elem_plan]").each(function(){$(this).triggerHandler('keyup');});};$("textarea:not(textarea[name^='elem_assessment'])"+ptrntextbox).bind("focus",function(event){if(!$(this).hasClass("ui-autocomplete-input")){ta3(this);};});if(typeof(examName)!="undefined"&&examName!=""){return;}
var ta4=function(ota4){$(ota4).autocomplete({source:"requestHandler.php?elem_formAction=TypeAhead&mode=assessment",minLength:2,autoFocus:true,focus:function(event,ui){return false;},select:function(event,ui){if(ui.item.value!=""){var t=jq_extractLast(this.value,2,this);var r=""+ui.item.value;r=cn_adjustSearchValue(r,t[3]);this.value=$.trim(""+t[0]+""+r);$(this).triggerHandler("change");$(this).triggerHandler("blur");$(this).triggerHandler("click");return false;}}});};$("#assessplan textarea[name^='elem_assessment']").bind("focus",function(event){if(!$(this).hasClass("ui-autocomplete-input")){ta4(this);};});}
if(typeof(examName)!="undefined"&&examName!=""){return;}
var ta5=function(ota5){$(ota5).autocomplete({source:"requestHandler.php?elem_formAction=TypeAhead&mode=OcuMed",minLength:2,autoFocus:true,focus:function(event,ui){return false;},select:function(event,ui){if(ui.item.value!=""){this.value=""+ui.item.value;if(this.id!="blank_med"){}}}});};$("#tblOcMeds input[type=text], #blank_med").bind("focus",function(event){if(!$(this).hasClass("ui-autocomplete-input")){ta5(this);};});if(typeof(multiphy_typeahead)!="undefined"){multiphy_typeahead(5);}
if(typeof(referral_code_typeahead)!="undefined"){referral_code_typeahead();}
if(typeof(cn_ta_fu)!="undefined"){cn_ta_fu();}
if(typeof(cn_ta_clr_npsych)!="undefined"){cn_ta_clr_npsych();}
if(typeof(cn_ta_procedures)!="undefined"){cn_ta_procedures();}}
function rv_lens_used(){if(typeof(examName)!="undefined"&&examName=="Fundus"){if(typeof(arr_lens_used)!="undefined"){cn_ta_clr_npsych("#el_lens_used");}
sb_dx_typeahead();}}
function referral_code_typeahead(){var ta1=function(ota1){$(ota1).autocomplete({source:zPath+"/chart_notes/requestHandler.php?elem_formAction=TypeAhead&mode=referralCode",minLength:2,autoFocus:true,open:function(){$(this).autocomplete('widget').zIndex(1000000);},change:function(event,ui){if(this.id.indexOf("elem_refer_code")!=-1){ohid=this.id.replace(/(txt|elem)/,"hid");if((!ui.item&&$.trim(this.value)!=""&&$.trim($("#"+ohid).val())=="")||$.trim(this.value).length<2){this.value="";$("#"+ohid).val("");}}},response:function(event,ui){if(this.id.indexOf("elem_refer_code")!=-1){ohid=this.id.replace(/(txt|elem)/,"hid");$("#"+ohid).val("");}},select:function(event,ui){ohid=this.id.replace(/(txt|elem)/,"hid");if(ui.item.value!=""){this.value=""+ui.item.value;$("#"+ohid).val(this.value);$(this).triggerHandler("mouseover");}}});};$(":input[type=text][id='elem_refer_code']").bind("focus",function(event){if(!$(this).hasClass("ui-autocomplete-input")){ta1(this);};});}
function cn_ta_procedures(){var ta5=function(ota5){$(ota5).autocomplete({source:zPath+"/chart_notes/requestHandler.php?elem_formAction=TypeAhead&mode=getorder",minLength:2,autoFocus:true,focus:function(event,ui){return false;},select:function(event,ui){if(ui.item.value!=""){this.value=""+ui.item.value;this.onchange();set_qty_in_hand(this,arr_med_name,arr_item_no_qty,arr_thrash,arr_lot_no);}}});};$("#divPreOpMeds input[type=text], #divIntraVitrealMeds  input[type=text], #divPostOpMeds  input[type=text]").bind("focus",function(event){if(!$(this).hasClass("ui-autocomplete-input")){ta5(this);};});var ta6=function(ota6){$(":input[name=elem_providers]").autocomplete({source:function(request,response){$.getJSON(zPath+"/chart_notes/requestHandler.php?elem_formAction=TypeAhead&mode=getproviders",{term:jq_extractLast(request.term,1)},response);},search:function(){var term=jq_extractLast(this.value,1);var o=jq_getStarter(term);this.strter=o[0];if(o[1].length<2){return false;}},minLength:2,autoFocus:true,focus:function(event,ui){return false;},select:function(event,ui){if(ui.item.value!=""){var t=jq_extractLast(this.value,2);var r=""+ui.item.value;if(this.strter!=""){r=$.trim(this.strter+" "+r);}
this.value=$.trim(""+t+""+r+",");$(this).triggerHandler("change");$(this).triggerHandler("blur");$(this).triggerHandler("click");return false;}}});};$(":input[name=elem_providers]").bind("focus",function(event){if(!$(this).hasClass("ui-autocomplete-input")){ta6(this);};});cn_ta_clr_npsych("#elem_iopType");}
function cn_ta_clr_npsych(str){var ta5=function(ota5){$(ota5).autocomplete({source:function(request,response){var oe=this.element[0];var tags=[];var flgSrch=0;if(oe&&oe.name&&oe.name.indexOf("eyeColorCc")!=-1){tags=["Amber","Black","Blue","Brown","Grey","Green","Hazel","Violet"];}else if(oe&&oe.name&&oe.name.indexOf("elem_mfocal")!=-1){tags=["Restor","Tecnis"];}else if(oe&&oe.name&&oe.name.indexOf("elem_descTa")!=-1){tags=["Squeezing","Holding lids","Taped lids","Unreliable","Unable"];flgSrch=1;}else if(oe&&oe.name&&$(oe).hasClass("iop_method")){tags=["Applanation","Pnuematic","Puff","Tactile","Tonopen"];}else if(oe&&oe.name&&oe.name.indexOf("el_lens_used")!=-1){tags=arr_lens_used;}else{tags=["Agitated","AAOx3","Confused","Flat","Cognitive Impairment","Too Young (Pediatric Patient)","Uncooperative"];}
var matcher=new RegExp(""+$.ui.autocomplete.escapeRegex(request.term),"i");response($.grep(tags,function(item){return flgSrch||matcher.test(item);}));},minLength:0,autoFocus:true,focus:function(event,ui){return false;},select:function(event,ui){if(ui.item.value!=""){var t=""+ui.item.value;if(this.name&&this.name.indexOf("elem_descTa")!=-1){var s=this.value,tid=this.id,t1;if(typeof(s)!="undefined"&&s!=""){t1=s+" "+t;$("#"+tid).val(t1);return false;}}else{this.value=""+t1;}}}});};if(typeof(str)=="undefined"||$.trim(str)==""){str="#elem_eyeColorCc, #elem_mfocalOd_pciol_opts, #elem_mfocalOs_pciol_opts";}
$(""+str).bind("focus",function(event){if(!$(this).hasClass("ui-autocomplete-input")){ta5(this);};$(this).autocomplete("search","");});}
function multiphy_typeahead(id){if(typeof(zPath)!="undefined"&&zPath!=""){}else{zPath="";}
var obj;if(id=="2"){obj="txtCoPhyArr";}else if(id=="3"){obj="txtPCPMedHxArr";}else if(id=="4"){obj="txtPCPDemoArr";}else if(id=="5"){obj="elem_doctorName_refphy";}else if(id=="6"){obj="elem_fsta_phy_name";}else{obj="txtRefPhyArr";}
var u=(typeof(zPath_remote)!="undefined")?zPath_remote:zPath;var ta6=function(ota6){$(ota6).autocomplete({source:u+"/chart_notes/requestHandler.php?elem_formAction=TypeAhead&mode=refPhy&w="+id,minLength:2,autoFocus:true,open:function(){$(this).autocomplete('widget').zIndex(1000000);},focus:function(event,ui){ohid=this.id.replace(/(txt|elem)/,"hid");if(typeof(reff_multi_add_popup)!="undefined"){reff_multi_add_popup($(this),document.getElementById(ohid),'WV');}return false;},change:function(event,ui){if(this.id.indexOf("elem_doctorName_refphy")!=-1){ohid=this.id.replace(/(txt|elem)/,"hid");if((!ui.item&&$.trim(this.value)!=""&&$.trim($("#"+ohid).val())=="")||$.trim(this.value).length<2){this.value="";$("#"+ohid).val("");}}},response:function(event,ui){if(this.id.indexOf("elem_doctorName_refphy")!=-1){ohid=this.id.replace(/(txt|elem)/,"hid");$("#"+ohid).val("");}},select:function(event,ui){ohid=this.id.replace(/(txt|elem)/,"hid");if(ui.item.value!=""){this.value=""+ui.item.value;$("#"+ohid).val(""+ui.item.refid);reff_multi_add_popup($(this),document.getElementById(ohid),'WV');if(obj=="elem_doctorName_refphy"){$(this).triggerHandler("mouseover");}
if(id=="6"&&ui.item.address){$(":input[name=elem_fsta_phy_address]").val(""+ui.item.address);}}}});};$(":input[type=text][id*='"+obj+"']").bind("focus",function(event){if(!$(this).hasClass("ui-autocomplete-input")){ta6(this);};});}
function getIcdContructed(ICD10,liter,sever,stage){var ICD10_tmp=ICD10;if(liter!=""&&typeof(liter)!="undefined"){var lit_w=6;if((ICD10_tmp.indexOf("-")!=-1&&(ICD10_tmp.indexOf("E1")!=-1||ICD10_tmp.indexOf("E0")!=-1)&&ICD10_tmp.indexOf(".9")==-1)){lit_w=7;}
if(ICD10_tmp.charAt(lit_w)=='-'){var tt=ICD10_tmp.substr(0,lit_w);var tt1=ICD10_tmp.substr(lit_w+1);ICD10_tmp=tt+liter+tt1;}else{var tt=ICD10_tmp.substr(0,5);var tt1=ICD10_tmp.substr(6);ICD10_tmp=tt+liter+tt1;}}
if(sever!=""&&typeof(sever)!="undefined"){ICD10_tmp=ICD10_tmp.replace('-',sever);}else if(stage!=""&&typeof(stage)!="undefined"){ICD10_tmp=ICD10_tmp.replace('-',stage);}
return ICD10_tmp;}
function icd10_split(val){var x=new RegExp(">>\s*");return val.split(x);}
function icd10_extractLast(term){return icd10_split(term).pop();}
function cn_resetasval(id,val,wh,otd){var sever_full=[],liter_full=[],stage_full=[];var sever=[],liter=[],stage=[];var t_sever=[],t_sever_full=[],t_stage=[],t_stage_full=[];var f_svr_stg_lid=0;var t_opt=0;if($("#dialogLSS").length>0){if(($("#dialogLSS table[id*=LSS_od0]").length>0||$("#dialogLSS table[id*=LSS0]").length>0)&&$("#dialogLSS table[id*=LSS1]").length<=0&&$("#dialogLSS table[id*=LSS2]").length<=0){t_opt=parseInt(t_opt)+1;}
var len_multi=$("#dialogLSS #olen").val();if(t_opt==1){if($(otd).attr("class")=='highlight'||$(otd).attr("class")=='highlight_2'||$(otd).attr("class")=='highlight highlight_2'){$(otd).removeClass("highlight highlight_2");}else{$(otd).addClass("highlight");}}else{if($("#dialogLSS table[id*=LSS_od0]").length>0||$("#dialogLSS table[id*=LSS0]").length>0||$("#dialogLSS table[id*=LSS1]").length>0||$("#dialogLSS table[id*=LSS2]").length>0){var otd_id=$(otd).attr('id');var otd_id_exp=otd_id.split('_');if(otd_id_exp[1]=='lat'){if($(otd).attr("class")=='highlight'||$(otd).attr("class")=='highlight_2'||$(otd).attr("class")=='highlight highlight_2'){$(otd).removeClass("highlight highlight_2");}else{if($("#dialogLSS table[id*=LSS]  td.doneLPU").length>0||$("#dialogLSS table[id*=LSk3] td.doneCF").length>0){}else{if($("#dialogLSS td[id*=txt_lat_1]").hasClass("highlight")==true&&val==1){$(otd).removeClass("highlight highlight_2");}else if($("#dialogLSS td[id*=txt_lat_2]").hasClass("highlight")==true&&val==2){$(otd).removeClass("highlight highlight_2");}else if($("#dialogLSS td[id*=txt_lat_2]").hasClass("highlight")==false&&val==2){$(otd).parent().parent().find("td.highlight").removeClass("highlight highlight_2");$(otd).addClass("highlight");}else if($("#dialogLSS td[id*=txt_lat_1]").hasClass("highlight")==false&&val==1){$(otd).parent().parent().find("td.highlight").removeClass("highlight highlight_2");$(otd).addClass("highlight");}else{$(otd).addClass("highlight");}}}
if($("#dialogLSS table[id*=LSS]  td.doneLPU").length>0||$("#dialogLSS table[id*=LSk3] td.doneCF").length>0){if($("#dialogLSS div.dvLss table[id=bigtbl1] td[id*=txt_lat_]").hasClass("highlight")==false){$("#dialogLSS div.dvLss table#bigtbl1").remove();$("#dialogLSS #olen").val(parseInt($("#dialogLSS #olen").val())-1);}
if($("#dialogLSS #olen").val()==0){$("#dialogLSS #olen").val(1);}
len_multi=$("#dialogLSS #olen").val();}else{var tot_lat=$("#dialogLSS div.dvLss table[id*=bigtbl]").find("table[id*=LSS0]").length;var tot_h_lat=$("#dialogLSS div.dvLss table[id*=bigtbl]").find("table[id*=LSS0] td.highlight").length;if($(otd).parents("table[id*=bigtbl]").find("table[id*=LSS0] td.highlight").length>0){if($("#dialogLSS td[id*=txt_lat_3]").hasClass("highlight")==true){if(val==3){$("#dialogLSS div.dvLss table#bigtbl1").remove();$("#dialogLSS table[id*=bigtbl] .highlight").removeClass("highlight highlight_2");$("#dialogLSS td[id*=txt_lat_3]").addClass("highlight");}else if(val<3){$("#dialogLSS td[id*=txt_lat_3]").removeClass("highlight highlight_2");$("#dialogLSS").append("");$("#dialogLSS div.dvLss table#bigtbl").clone().appendTo("#dialogLSS  div.dvLss");var len=$("#dialogLSS table[id*=bigtbl]").length;var inx=len-1;var oo=$("#dialogLSS table[id*=bigtbl]").get(inx);oo.id="bigtbl"+inx;$("#dialogLSS table[id*="+oo.id+"] td").removeClass("highlight highlight_2");$("#dialogLSS #olen").val(len);$($("#dialogLSS table[id*="+oo.id+"] td[id="+otd_id+"]")).data("vval",val);}}else if(tot_lat>1){}else{$("#dialogLSS").append("");$("#dialogLSS div.dvLss table#bigtbl").clone().appendTo("#dialogLSS  div.dvLss");var len=$("#dialogLSS table[id*=bigtbl]").length;var inx=len-1;var oo=$("#dialogLSS table[id*=bigtbl]").get(inx);oo.id="bigtbl"+inx;$("#dialogLSS table[id*="+oo.id+"] td").removeClass("highlight highlight_2");$("#dialogLSS #olen").val(len);$($("#dialogLSS table[id*="+oo.id+"] td[id="+otd_id+"]")).data("vval",val);}}}}else{$(otd).parents("table[id*=LSS]").find("td").removeClass("highlight highlight_2");$(otd).addClass("highlight");}}}
$(otd).data("vval",val);if($("#dialogLSS table[id*=LSS]  td.doneLPU").length>0||$("#dialogLSS table[id*=LSk3] td.doneCF").length>0){$("#dialogLSS table[id*=LSS] td").removeClass("doneLPU");}else{return;}
for(var k=0;k<len_multi;k++){var btid_indx=k;var btid_spx=k;if(btid_indx==0){btid_indx=0;btid_spx="";}
if($("#dialogLSS #bigtbl"+btid_spx).length<=0){continue;}
if(t_opt==1){var btid_indx_tmp=0;$('.highlight').each(function(){var txt_lat_id=$(this).attr('id');var txt_lat_id_exp=txt_lat_id.split('_');btid_indx_tmp=parseInt(btid_indx_tmp)+1;if(txt_lat_id_exp[1]=='lat'){liter[btid_indx_tmp]=$("#"+txt_lat_id).data("vval");liter_full[btid_indx_tmp]=$("#"+txt_lat_id).html();}
if(txt_lat_id_exp[1]=='sev'){sever[btid_indx_tmp]=$("#"+txt_lat_id).data("vval");sever_full[btid_indx_tmp]=$("#"+txt_lat_id).html();}
if(txt_lat_id_exp[1]=='stag'){stage[btid_indx_tmp]=$("#"+txt_lat_id).data("vval");stage_full[btid_indx_tmp]=$("#"+txt_lat_id).html();}});len_multi=btid_indx_tmp;}else{if($("#dialogLSS #bigtbl"+btid_spx+" table[id*=LSS1]").length>0&&$("#dialogLSS #bigtbl"+btid_spx+" table[id*=LSS1] td.highlight").length>0){sever[btid_indx]=""+$("#dialogLSS #bigtbl"+btid_spx+" table[id*=LSS1] td.highlight").data("vval");sever_full[btid_indx]=""+$("#dialogLSS #bigtbl"+btid_spx+" table[id*=LSS1] td.highlight").html();}
if($("#dialogLSS #bigtbl"+btid_spx+" table[id*=LSS2]").length>0&&$("#dialogLSS #bigtbl"+btid_spx+" table[id*=LSS2] td.highlight").length>0){stage[btid_indx]=""+$("#dialogLSS #bigtbl"+btid_spx+" table[id*=LSS2] td.highlight").data("vval");stage_full[btid_indx]=""+$("#dialogLSS #bigtbl"+btid_spx+" table[id*=LSS2] td.highlight").html();}
if($("#dialogLSS #bigtbl"+btid_spx+" table[id*=LSS0]").length>0&&$("#dialogLSS #bigtbl"+btid_spx+" table[id*=LSS0] td.highlight").length>0){liter[btid_indx]=""+$("#dialogLSS #bigtbl"+btid_spx+" table[id*=LSS0] td.highlight").data("vval");liter_full[btid_indx]=""+$("#dialogLSS #bigtbl"+btid_spx+" table[id*=LSS0] td.highlight").html();}}}
if(f_svr_stg_lid==0&&$("#dialogLSS #bigtbl"+btid_spx+" table[id*=LSS0]").length>0&&($("#dialogLSS #bigtbl"+btid_spx+" table[id*=LSS1]").length>0||$("#dialogLSS #bigtbl"+btid_spx+" table[id*=LSS2]").length>0)){f_svr_stg_lid=1;}
if(t_sever.length>sever.length){sever=t_sever;sever_full=t_sever_full;}else if(t_stage.length>stage.length){stage=t_stage;stage_full=t_stage_full;}}
var assess=$("#"+id).val();var oassess=$("#"+id).get(0);var valChkdb=$.trim($("#"+id).data("valbakdb"));var arr=assess.split("~~");index=$("#"+id).attr('id').match(/\d+$/);if(id.indexOf("elem_assessment_dxcode")==-1&&!$("#"+id).hasClass("dxallcodes")){hiddenOBJ=$("#elem_assessment_dxcode"+index);if(oassess.value.indexOf(";")==-1){if(typeof(hiddenOBJ)!='undefined'&&hiddenOBJ.get(0)){hiddenOBJ.val('');}}}
var code='';var uV1=assessment=assess;var vARR1=uV1.split('[ICD-10: ');if(vARR1.length>1){ICD10_ARR1=vARR1[1].split(',');if(ICD10_ARR1.length>1){uV1=ICD10_ARR1[0];code=ICD10_ARR1[0];}}
if(typeof(valChkdb)=="string"&&valChkdb!=""){ICD10=""+valChkdb;}
if(typeof(ICD10)=='string'&&ICD10!=null){var ICD10_tmp=getIcdContructed(ICD10,liter[0],sever[0],stage[0]);dX_code=ICD10_tmp;var dx_code_modifier_text="";var dcmtmp="";if((typeof(showMode)!="undefined"&&showMode=='ap')||id.indexOf("elem_assessment_dxcode")!=-1||$("#"+id).hasClass("dxallcodes")){icd_value=oassess.value;NewdX_code=dX_code;dX_code=icd_value.replace(ICD10,NewdX_code);dX_code=dX_code.replace('>>','');vARR2=dX_code.split(' [ICD-10: ');if(vARR2.length>1){assessment=vARR2[0];}
if(len_multi>0){var str_as_m="";if(t_opt==1){for(var t_m=1;t_m<=len_multi;t_m++){var ICD10_tmp_m=getIcdContructed(ICD10,liter[t_m],sever[t_m],stage[t_m]);if(ICD10_tmp_m!=""){if(str_as_m!=""){str_as_m+=",";}
str_as_m+=ICD10_tmp_m;if(dx_code_modifier_text!=""){dx_code_modifier_text=$.trim(dx_code_modifier_text)+", ";}
var dcmtmp="";if(typeof(liter_full[t_m])!="undefined"&&liter_full[t_m]!=""){dcmtmp+=liter_full[t_m]+" ";}
if(typeof(sever_full[t_m])!="undefined"&&sever_full[t_m]!=""){dcmtmp+=sever_full[t_m]+" ";}
if(typeof(stage_full[t_m])!="undefined"&&stage_full[t_m]!=""){dcmtmp+=stage_full[t_m]+" ";}
dx_code_modifier_text+=dcmtmp;}}}else{for(var t_m=0;t_m<len_multi;t_m++){var ICD10_tmp_m=getIcdContructed(ICD10,liter[t_m],sever[t_m],stage[t_m]);if(ICD10_tmp_m!=""){if(str_as_m!=""){str_as_m+=",";}
str_as_m+=ICD10_tmp_m;if(dx_code_modifier_text!=""){dx_code_modifier_text=$.trim(dx_code_modifier_text)+", ";}
var dcmtmp="";if(typeof(liter_full[t_m])!="undefined"&&liter_full[t_m]!=""){dcmtmp+=liter_full[t_m]+" ";}
if(typeof(sever_full[t_m])!="undefined"&&sever_full[t_m]!=""){dcmtmp+=sever_full[t_m]+" ";}
if(typeof(stage_full[t_m])!="undefined"&&stage_full[t_m]!=""){dcmtmp+=stage_full[t_m]+" ";}
dx_code_modifier_text+=dcmtmp;}}}
if(str_as_m!=""){if(id.indexOf("elem_assessment_dxcode")!=-1&&icd_value.indexOf(",")!=-1&&icd_value.indexOf(">>")==-1){var check_dx_family_val=f_svr_stg_lid;if(check_dx_family_val=="0"){var tmp=icd_value.replace(ICD10,"");tmp=$.trim(tmp);tmp=tmp.replace(/,$/,"");var ar_t=tmp.split(",");var ar_as_m=str_as_m.split(",");if(ar_t.length<ar_as_m.length){str_as_m=str_as_m+","+tmp;}
if(ar_as_m.length>0){ar_as_m=jQuery.unique(ar_as_m);str_as_m=ar_as_m.join(", ");}}}
NewdX_code=str_as_m;}}
if(id.indexOf("elem_assessment_dxcode")!=-1||$("#"+id).hasClass("dxallcodes")){assessment=NewdX_code;}else{if(id.indexOf("elem_assessment")!=-1){assessment+="; "+dx_code_modifier_text;}
if(typeof(hiddenOBJ)!='undefined'&&hiddenOBJ.get(0)){hiddenOBJ.val(NewdX_code);hiddenOBJ.attr("title",NewdX_code);hiddenOBJ.trigger("change");hiddenOBJ.trigger("blur");}}}
oassess.value=assessment;if(oassess.id.indexOf("elem_dxCode")!=-1&&oassess.value!=""&&oassess.value.indexOf(",")!=-1){var t_ar_su_dx=oassess.value.split(",");var t_su_dxid=$(oassess).data("dxid");if(typeof t_su_dxid=="undefined"){t_su_dxid="";}
t_su_dxid=$.trim(t_su_dxid);oassess.value="";$(oassess).data("dxid","");for(var tinx in t_ar_su_dx){var tdx=$.trim(t_ar_su_dx[tinx]);if(tdx!=""&&$("input[id*=elem_dxCode][value='']").length>0&&$("input[id*=elem_dxCode][value='"+tdx+"']").length<=0){var flgbrk=0;$("input[id*=elem_dxCode][value='']").each(function(){if($.trim(this.value)==""&&flgbrk==0){this.value=tdx;$(this).data("dxid",t_su_dxid);$(this).trigger("blur");flgbrk=1;}});}}}
if(id.indexOf("elem_assessment")!=-1&&liter&&typeof(liter)!="undefined"){var asindx=id.replace(/(elem_assessment_dxcode|elem_assessment)/gi,"");if($.inArray('3',liter)!=-1&&$.inArray("Both Eyes",liter_full)!=-1){if($("#elem_apOu"+asindx).is(':checked')==false){$("#elem_apOs"+asindx+", #elem_apOd"+asindx).prop("checked",false);$("#elem_apOu"+asindx).trigger("click");}}else if($.inArray('2',liter)!=-1&&$.inArray('1',liter)!=-1&&$.inArray("Left Eye",liter_full)!=-1&&$.inArray("Right Eye",liter_full)!=-1){if($("#elem_apOu"+asindx).is(':checked')==false){$("#elem_apOs"+asindx+", #elem_apOd"+asindx).prop("checked",false);$("#elem_apOu"+asindx).trigger("click");}}else if($.inArray('2',liter)!=-1&&$.inArray("Left Eye",liter_full)!=-1){if($("#elem_apOs"+asindx).is(':checked')==false){$("#elem_apOu"+asindx+", #elem_apOd"+asindx).prop("checked",false);$("#elem_apOs"+asindx).trigger("click");}}else if($.inArray('1',liter)!=-1&&$.inArray("Right Eye",liter_full)!=-1){if($("#elem_apOd"+asindx).is(':checked')==false){$("#elem_apOs"+asindx+", #elem_apOu"+asindx).prop("checked",false);$("#elem_apOd"+asindx).trigger("click");}}else{var teye1="",teye2="";if(($.inArray('1',liter)!=-1&&$.inArray("Right Upper Lid",liter_full)!=-1)||($.inArray('2',liter)!=-1&&$.inArray("Right Lower Lid",liter_full)!=-1)){teye2="1";}
if(($.inArray('4',liter)!=-1&&$.inArray("Left Upper Lid",liter_full)!=-1)||($.inArray('5',liter)!=-1&&$.inArray("Left Lower Lid",liter_full)!=-1)){teye1="1";}
if(teye1=="1"&&teye2=="1"){if($("#elem_apOu"+asindx).is(':checked')==false){$("#elem_apOu"+asindx).trigger("click");}}else if(teye1=="1"){if($("#elem_apOs"+asindx).is(':checked')==false){$("#elem_apOs"+asindx).trigger("click");}}else if(teye2=="1"){if($("#elem_apOd"+asindx).is(':checked')==false){$("#elem_apOd"+asindx).trigger("click");}}}}
var asid=id.replace("_dxcode","");if(id.indexOf("elem_assessment_dxcode")!=-1){oassess.title=assessment;var tv_as=$("#"+asid).val();var tv_asp=$("#"+id).val();var tv_asp_val="";if(tv_asp.indexOf("]>>")!=-1){if(tv_asp.indexOf(",")!=-1){var tv_asp_exp=tv_asp.split(",");if(tv_asp_exp.length>1){for(var ik=0;ik<tv_asp_exp.length;ik++){if(tv_asp_exp[ik].indexOf("[")==-1&&tv_asp_exp[ik].indexOf("]")==-1&&tv_asp_exp[ik].match(/[0-9]/)!==null){if(tv_asp_val!=""){tv_asp_val+=',';}
tv_asp_val+=tv_asp_exp[ik];}}
$("#"+id).val(tv_asp_val);}}}
if(typeof(tv_as)!="undefined"&&tv_as!=""){if(tv_as.indexOf(";")==-1){tv_as+=";";}else{var tmp_tv_as=tv_as.split(";");tv_as=tmp_tv_as[0]+";";}}
var tv_as_exp=tv_as.split('[ICD-10: ');if(tv_as_exp.length>1){tv_as=$.trim(tv_as_exp[0])+";";}else{if($("#pop_"+asid)){tv_as=$.trim($("#pop_"+asid).val())+";";}}
tv_as+=" "+dx_code_modifier_text;if($("#elem_ass_comm").val()!=""){tv_as+=";\n"+$("#elem_ass_comm").val();}
$("#"+asid).val(tv_as).triggerHandler("change");$("#"+asid).triggerHandler("blur");$("#"+asid).triggerHandler("keyup");}else{if(id.indexOf("elem_assessment")!=-1){if($("#elem_ass_comm").val()!=""){oassess.value=assessment+";\n"+$("#elem_ass_comm").val();}}}
if($("#LSk3")){var extra_dx_code_id="";$("input[name='elem_sub_dx']").each(function(){if($('#'+this.id).is(':checked')){extra_dx_code_id=this.id.replace("elem_sub_","");}});if(extra_dx_code_id>0){cn_set_sub_dx(extra_dx_code_id,'yes');}}
$(oassess).triggerHandler("change");$(oassess).triggerHandler("blur");$(oassess).triggerHandler("keyup");if(id.indexOf("elem_assessment_dxcode")!=-1&&icd_value.indexOf(",")!=-1){if($(oassess).val().indexOf("-")!=-1&&f_svr_stg_lid==0){$("#"+asid).triggerHandler("click");}}}else{if(typeof(showMode)!="undefined"&&showMode=='ap'){if(vARR1.length>1){oassess.value=vARR1[0];$(oassess).triggerHandler("change");$(oassess).triggerHandler("blur");}else{if(oassess.value.indexOf(";")==-1){if(typeof(hiddenOBJ)!='undefined'&&hiddenOBJ.get(0)){hiddenOBJ.val(code);}}
tmp_val=""+ui.item.value;var t=jq_extractLast(oassess.value,2,oassess);var r=""+tmp_val;r=cn_adjustSearchValue(r,t[3]);if(oassess.strter!=""){r=$.trim(oassess.strter+" "+r);}
oassess.value=$.trim(""+t[0]+""+r+t[1]);$(oassess).triggerHandler("change");$(oassess).triggerHandler("blur");$(oassess).triggerHandler("click");}}else{oassess.value=assessment;$(oassess).triggerHandler("change");$(oassess).triggerHandler("blur");$(oassess).triggerHandler("click");}}}
function epost_addTypeAhead(wh,zpth){var wh=(typeof(wh)!="undefined"&&wh!="")?wh:".epost textarea";var zPath1=(typeof(zpth)!="undefined"&&zpth!="")?zpth:zPath;var ta8=function(ota8){$(ota8).autocomplete({source:function(request,response){$.getJSON(zPath1+"/chart_notes/requestHandler.php?elem_formAction=TypeAhead",{term:jq_extractLast(request.term,1,this.element[0])},response);},search:function(){var term=jq_extractLast(this.value,1,this);var o=jq_getStarter(term);this.strter=o[0];},minLength:2,autoFocus:true,focus:function(event,ui){return false;},select:function(event,ui){if(ui.item.value!=""){var t=jq_extractLast(this.value,2,this);var r=""+ui.item.value;r=cn_adjustSearchValue(r,t[3]);if(typeof(this.strter)!="undefined"&&this.strter!=""){r=$.trim(this.strter+" "+r);}
this.value=$.trim(""+t[0]+""+r+t[1]);$(this).triggerHandler("blur");return false;}}});};$(""+wh).bind("focus",function(event){if(!$(this).hasClass("ui-autocomplete-input")){ta8(this);};});}
function sb_dx_typeahead(){if(typeof(zPath)!="undefined"&&zPath!=""){}else{zPath="";}
var url=zPath+"/chart_notes/requestHandler.php?elem_formAction=TypeAhead&mode=getICD10Data";$(".dxallcodes, textarea[name^='elem_assessment_dxcode']").each(function(indx){bind_autocomp($(this),url);});}
function sb_addTypeAhead(){if(typeof(zPath)!="undefined"&&zPath!=""){}else{zPath="";}
var ta7=function(ota7){$(ota7).autocomplete({source:function(request,response){$.ajax({url:zPath+"/chart_notes/requestHandler.php?elem_formAction=TypeAhead&mode=cptdropdown",dataType:"json",data:{term:request.term},success:function(data){response($.map(data,function(item){var tmp_Lbl=tmp_Val="";if(typeof(item)=="object"){tmp_Lbl=item.label?item.label:item.value;tmp_Val=item.value;}else{tmp_Lbl=item;tmp_Val=item;}
return{label:tmp_Lbl,value:tmp_Val}}));}});},minLength:2,autoFocus:true,focus:function(event,ui){return false;},select:function(event,ui){if(ui.item.value!=""){this.value=""+ui.item.value;this.onblur();}}});};$(".cptcode").bind("focus",function(event){if(!$(this).hasClass("ui-autocomplete-input")){ta7(this);};});var tmp=$("#hid_icd10").val();if(typeof(tmp)!="undefined"&&tmp==1){sb_dx_typeahead();}else{var ta8=function(ota8){$(ota8).autocomplete({source:zPath+"/chart_notes/requestHandler.php?elem_formAction=TypeAhead&mode=dxdropdown",minLength:2,autoFocus:true,focus:function(event,ui){return false;},select:function(event,ui){if(ui.item.value!=""){this.value=""+ui.item.value;this.onblur();}}});};$(".dxallcodes, textarea[name^='elem_assessment_dxcode']").bind("focus",function(event){if(!$(this).hasClass("ui-autocomplete-input")){ta8(this);};});}
var ta9=function(ota9){$(ota9).autocomplete({source:zPath+"/chart_notes/requestHandler.php?elem_formAction=TypeAhead&mode=moddropdown",minLength:1,autoFocus:true,focus:function(event,ui){return false;},select:function(event,ui){if(ui.item.value!=""){this.value=""+ui.item.value;this.onblur();}}});};$(".modcode").bind("focus",function(event){if(!$(this).hasClass("ui-autocomplete-input")){ta9(this);};});}
if($.ui&&$.ui.autocomplete){$.ui.autocomplete.prototype._renderItem=function(ul,item){arr=item.label.split("~~");var clss="";if(arr[1]=='commu'){clss="text-warning";}
if(arr[1]=='phy'){clss="text-success";}
if(arr[1]=='dyn'){clss="text-primary";}
if(clss!=""){var term=this.term,formattedLabel="<span class=\'"+clss+"\'>"+arr[0]+"</span>";}else{var term=this.term,formattedLabel=item.label;}
return $("<li></li>").data("item.autocomplete",item).append("<a>"+formattedLabel+"</a>").appendTo(ul);};}
function fu_add(flg){var otbl=$("#listFU");var len=otbl.find(".fu").length;var iter=$("#listFU").attr("data-cntrfu");iter=parseInt(iter)+1;var vCords1=$("#listFU").attr("data-fuCntr1");var vCords2=$("#listFU").attr("data-fuCntr2");var fuProDD="";if($("#listFU .fu select[id*='elem_fuProName_']").length>0){fuProDD="<select name=\"elem_fuProName[]\" id=\"elem_fuProName_"+iter+"\" class=\"form-control \" "+" onchange=\"fu_pro_change(this)\" "+" onmouseover=\"if(this.selectedIndex)this.title=this.options[this.selectedIndex].text+'-'+this.value;\" tabindex=\""+iter+"4\" >";fuProDD+=$("#listFU .fu select[id*='elem_fuProName_']").eq(0).html();fuProDD+="</select> ";}
var fuInpCheck="";var embedin=$("#listFU").attr("data-fuembedin")||"";if(embedin=="work_view"){fuInpCheck+="<div class=\"checkbox\"><input type=\"checkbox\" id=\"el_fu_choose_"+iter+"\" value=\""+iter+"\" checked title=\"click to add\" tabindex=\""+iter+"0\" ><label for=\"el_fu_choose_"+iter+"\"></label></div>";}
var mn=$("#listFU .fu .menu_followUpNumber")[0].outerHTML;mn=mn.replace(/elem_followUpNumber_1/g,"elem_followUpNumber_"+iter);var mv=$("#listFU .fu .menu_followUpVistType")[0].outerHTML;mv=mv.replace(/elem_followUpVistType_1/g,"elem_followUpVistType_"+iter);var str="<div class=\"row fu\" > "+"<div class=\"col-sm-1\" >"+
fuInpCheck+"</div>"+"<div class=\"col-sm-2\" >"+"<div class=\"input-group plain\" >"+"<input type=\"text\" name=\"elem_followUpNumber[]\" id=\"elem_followUpNumber_"+iter+"\" value=\"\""+" onchange=\"fu_refineNum(this)\" class=\"form-control \" tabindex=\""+iter+"1\"> "+
mn+"</div>"+"</div>"+"<div class=\"col-sm-2\" >"+"<select name=\"elem_followUp[]\" id=\"elem_followUp_"+iter+"\" onchange=\"fu_move(this)\" class=\"form-control \"  tabindex=\""+iter+"2\">"+"<option value=\"\"></option>"+"<option value=\"Days\" >Days</option>"+"<option value=\"Weeks\" >Weeks</option>"+"<option value=\"Months\" >Months</option>"+"<option value=\"Year\" >Year</option>"+"</select> "+"</div>"+"<div class=\"col-sm-3\" >"+"<div class=\"input-group plain\" >"+"<input type=\"text\" name=\"elem_followUpVistType[]\" id=\"elem_followUpVistType_"+iter+"\" value=\"\" onchange=\"changeOther(this);\" class=\"form-control \" tabindex=\""+iter+"3\" > "+"<input type=\"hidden\" name=\"elem_followUpVistTypeOther[]\" id=\"elem_followUpVistTypeOther_"+iter+"\" value=\"\">"+
mv+"</div>"+"</div>"+"<div class=\"col-sm-3\" >"+
fuProDD+"</div>"+"<div class=\"col-sm-1\">"+"<span class=\"glyphicon glyphicon-remove\" title=\"Remove FU\" id=\"fu_del"+iter+"\" onclick=\"fu_del('"+iter+"')\"  />"+"</div>"+"</div>";$(str).insertBefore($("#listFU #elem_fuCntr"));otbl.attr("data-cntrfu",iter);wv_activate_menu_click(".fu:last-of-type .menu a");if(fuProDD!=""){var tmp=alwaysDocFU;if(typeof(alwaysDocFU)=='undefined'||alwaysDocFU==''){if(typeof(ssFollowPhy)!="undefined"&&ssFollowPhy!=""){tmp=ssFollowPhy;}else if($(":input[name*=elem_physicianId][value!=''][type!=text]").length>0){tmp=""+$(":input[name*=elem_physicianId][value!=''][type!=text]").val();}}
$("#elem_fuProName_"+iter).val(tmp);}
cn_ta_fu();if(flg==1){return iter;}}
function fu_del(itr){if(itr>1){$("#listFU>.fu:has(#elem_followUp_"+itr+")").remove();}else{$("#listFU>.fu:has(#elem_followUp_"+itr+") :input").val("");}}
function fu_checkChoosebtn(obj){ochk=$("#"+obj.id.replace(/elem_followUpNumber_|elem_followUp_|elem_followUpVistType_|elem_fuProName_/,"el_fu_choose_"));if(ochk.length>0){ochk.prop("checked",true);}}
function fu_pro_change(obj){fu_checkChoosebtn(obj);}
function fu_refineNum(obj){var arr=obj.value.split(",");var len=arr.length;var str="";var tmp="";var flgMv=0;if(len>1){tmp=arr[0];if(tmp=="-"){if(arr[1].indexOf("-")==-1)str=arr[1]+tmp;}else{var ar2=arr[1].split("-");if(typeof ar2[1]=="string")ar2[1]=$.trim(ar2[1]);if(ar2.length==2&&typeof ar2[1]!="undefined"&&ar2[1]==""){str=arr[1]+tmp;flgMv=1;}else{str=tmp;}}}else{str=obj.value;}
obj.value=""+$.trim(str);fu_checkChoosebtn(obj);var oSel=null;if(obj.id){oSel=gebi(obj.id.replace(/elem_followUpNumber_/,"elem_followUp_"));if(oSel){oSel.disabled=false;}}
if(obj.value.indexOf("Calendar")!=-1){obj.value="";$("#"+obj.id).datepicker({dateFormat:z_js_dt_frmt});$("#"+obj.id).datepicker('show');if(oSel){oSel.disabled=true;}
return;}else{$("#"+obj.id).datepicker('destroy');}
if(flgMv==1){fu_move(obj);}}
function fu_move(obj){var id=obj.id;var t=null;if(id.indexOf("elem_followUpNumber")!=-1){t=gebi(id.replace(/elem_followUpNumber/,"elem_followUp"));}else if(id.indexOf("elem_followUp")!=-1){t=gebi(id.replace(/elem_followUp/,"elem_followUpVistType"));}
if((obj.value!="")&&(t!=null)){t.focus();}
fu_checkChoosebtn(obj);}
function changeOther(obj,val){fu_checkChoosebtn(obj);if((obj.value=='Other')||(typeof val!='undefined')){val=(typeof val=='undefined')?"":val;var idOthr=obj.id.replace(/elem_followUpVistType/g,"elem_followUpVistTypeOther");var idOthrIcon=obj.id.replace(/elem_followUpVistType/g,"sp_fu_vis_other");var oOthr=gebi(idOthr);var oOthrIcon=gebi(idOthrIcon);if(oOthr&&oOthrIcon){oOthr.value="1";obj.value="";obj.focus();oOthrIcon.style.visibility="visible";}}}
function removeMe(id){var objTxt=gebi("elem_followUpVistType_"+id);var objOthr=gebi("elem_followUpVistTypeOther_"+id);var objOthrIcon=gebi("sp_fu_vis_other_"+id);if(objOthr&&objOthrIcon&&objTxt){objTxt.value=objTxt.defaultValue;objOthr.value="0";objOthrIcon.style.visibility="hidden";}}
function fu_checkEmpty_Dup(num,tm,tp){var eid="";var dup=0;var oiter=gebi("elem_fuCntr");var otbl=gebi("tblFU");var len=$("#listFU").attr("data-cntrfu");len=parseInt(len);var n,t,p;for(var i=1;i<=len;i++){if($("#elem_followUpNumber_"+i).length>0){n=$("#elem_followUpNumber_"+i).val();t=$("#elem_followUp_"+i).val();p=$("#elem_followUpVistType_"+i).val();if(eid==""&&n==""&&t==""&&p==""){eid=i;}
if($.trim(n)==$.trim(num)&&$.trim(t)==$.trim(tm)&&$.trim(p)==$.trim(tp)){dup=1;break;}}}
return{"e":eid,"d":dup};}
function fu_addOpts(num,tm,tp,prid){var oCh=fu_checkEmpty_Dup(num,tm,tp);if(oCh.d==1){return;}
var itr="";if(oCh.e!=""){itr=oCh.e;}else{itr=fu_add(1);}
if(itr!=""){$("#elem_followUpNumber_"+itr).val(num);$("#elem_followUp_"+itr).val(tm);$("#elem_followUpVistType_"+itr).val(tp);if(typeof(prid)!="undefined"&&prid!=""){$("#elem_fuProName_"+itr).val(prid);}else if($(":input[name=elem_curPhysicianId]").val()!=""){$("#elem_fuProName_"+itr).val(""+$(":input[name=elem_curPhysicianId]").val());}}}
function cn_ta_fu(){var ta7=function(ota7){$(ota7).autocomplete({source:"requestHandler.php?elem_formAction=TypeAhead&mode=FUVisit&wh="+ota7.name,minLength:1,autoFocus:true,focus:function(event,ui){return false;},select:function(event,ui){if(event.keyCode===9){return false;}if(ui.item.value!=""){this.value=""+ui.item.value;}}});};$("#listFU input[type=text]").bind("focus",function(event){if(!$(this).hasClass("ui-autocomplete-input")){ta7(this);};});}
function op_fu_sec(dv){if(dv==1||dv==3){if(dv==1){$("#listFU input[type=checkbox]").each(function(indx){if(this.checked==false){j=indx+1;fu_del(j);}});}
$("#dv_fu_sec").removeClass("fubig panel panel-success");$("#dv_fu_sec .fu_con").removeClass("panel-body");$("#dv_fu_sec .fu_con").css({"max-height":"none","overflow":"visible"});}else{$("#listFU input[type=checkbox]").each(function(indx){this.checked=false;});$("#dv_fu_sec").addClass("fubig panel panel-success");$("#dv_fu_sec .fu_con").addClass("panel-body");$('#dv_fu_sec').draggable({handle:$('#assessplan #follow_up .fubig .hdr')});$("#dv_fu_sec .fu_con").css({"max-height":""+parseInt($(window).height()*70/100)+"px","overflow":"auto"});}}
function clearSuperBill(){opRemAllCptRow(3);$(".dxallcodes,#superbill input[name=elem_todaysCharges],#elem_levelComplexity,#elem_proc_only_visit,#elem_post_op_visit,#elem_visitCode").val("");if(""+$("#elem_flgIsPtNew").val()=="Yes_confirmed"){$("#elem_flgIsPtNew").val("New");}else if(""+$("#elem_flgIsPtNew").val()=="No_confirmed"){$("#elem_flgIsPtNew").val("Establish");}
$(".dxallcodes").tooltip("destroy");}
var z_flg_diabetes="",z_flg_diab_sb="";function sb_clearDiabetesAssessments(flgonlychk,clrtake){clrtake=(typeof(clrtake)!="undefined"&&clrtake=="1")?"1":"0";var pln="";var ret=0;var ar_dm_as=["Diabetes Type 1 No retinopathy","DM Type 1 Mild with ME","DM Type 1 Mod with ME","DM Type 1 Severe with ME","DM Type 1 Proliferative with ME","DM Type 1 Mild without ME","DM Type 1 Mod without ME","DM Type 1 Severe without ME","DM Type 1 Proliferative without ME","DM Type 1","DM Type 1 no retinopathy","Diabetes Type 1","Diabetes Type I","Diabetes 1","DM 1"];var ass_nm="textarea[id*=elem_assessment]";if(typeof(wpage)!="undefined"&&wpage=="accSB"){ass_nm=".assnm";}
$(ass_nm).each(function(indx){if(this.id.toLowerCase().indexOf("dx")==-1){var tmp=$.trim(this.value);if($.trim(tmp)!=""){tmp=tmp.toLowerCase();var ar_tmp=tmp.split(";");tmp=$.trim(ar_tmp[0]);if(typeof(flgonlychk)!="undefined"&&flgonlychk==1){}
else{if(clrtake==1){if(isDbTakeAssess(tmp)){this.value='';var asdxid=this.id.replace("elem_assessment","elem_assessment_dxcode");$("#"+asdxid).val('');var asplid=this.id.replace("elem_assessment","elem_plan");$("#"+asplid).val('');var indxid=this.id.replace("elem_assessment","");$("#elem_apOu"+indxid).prop("checked",false);$("#elem_apOd"+indxid).prop("checked",false);$("#elem_apOs"+indxid).prop("checked",false);$("#no_change_"+indxid).prop("checked",false).triggerHandler("click");$("#elem_resolve"+indxid).prop("checked",false).triggerHandler("click");return;}}}
for(var t in ar_dm_as){var dm1=ar_dm_as[t].toLowerCase();var dm2=(ar_dm_as[t]=="Diabetes Type I")?"Diabetes Type II".toLowerCase():ar_dm_as[t].replace("1","2").toLowerCase();var flgdm1=false;var flgdm2=false;if(isDiabetesAssess(tmp,2)){flgdm1=(tmp.indexOf(dm1)!=-1)?true:false;flgdm2=(tmp.indexOf(dm2)!=-1)?true:false;}
if(tmp==dm1||flgdm1||tmp==dm2||flgdm2){if(typeof(flgonlychk)!="undefined"&&flgonlychk==1){if(typeof(z_flg_diab_sb)=="undefined"||(z_flg_diab_sb!="2"&&z_flg_diab_sb!="3")){var tmp_dx_mod=$.trim(ar_tmp[1]);tmp_dx_mod=tmp_dx_mod.toLowerCase();if(typeof(tmp_dx_mod)!="undefined"&&tmp_dx_mod!=""){if(z_flg_diab_sb=="1"){if((tmp_dx_mod.indexOf("mild")!=-1||tmp_dx_mod.indexOf("mod")!=-1||tmp_dx_mod.indexOf("severe")!=-1||tmp_dx_mod.indexOf("proliferative")!=-1)){tmp=tmp+"; "+tmp_dx_mod;}}else{tmp=tmp+"; "+tmp_dx_mod;}}}
if(tmp!="DM Type 1".toLowerCase()&&tmp!="Diabetes Type 1".toLowerCase()&&tmp!="DM Type 2".toLowerCase()&&tmp!="Diabetes Type 2".toLowerCase()&&tmp!="Diabetes Type I".toLowerCase()&&tmp!="Diabetes Type II".toLowerCase()){ret=1;}
else{var neid=this.id.replace("elem_assessment","no_change_");if($("#"+neid).prop("checked")==true){ret=1;}}}else{this.value='';var asdxid=this.id.replace("elem_assessment","elem_assessment_dxcode");$("#"+asdxid).val('');var asplid=this.id.replace("elem_assessment","elem_plan");pln=$("#"+asplid).val();$("#"+asplid).val('');var indxid=this.id.replace("elem_assessment","");$("#elem_apOu"+indxid).prop("checked",false);$("#elem_apOd"+indxid).prop("checked",false);$("#elem_apOs"+indxid).prop("checked",false);$("#no_change_"+indxid).prop("checked",false).triggerHandler("click");$("#elem_resolve"+indxid).prop("checked",false).triggerHandler("click");if($.trim(pln)!=""){break;}}}}}}});if(typeof(flgonlychk)!="undefined"&&flgonlychk==1){return ret;}else{return pln;}}
function sb_clearDbAsTaking(){var ass_nm="textarea[id*=elem_assessment]";if(typeof(wpage)!="undefined"&&wpage=="accSB"){ass_nm=".assnm";}
$(ass_nm).each(function(indx){var tmp=$.trim(this.value);if($.trim(tmp)!=""){tmp=tmp.toLowerCase();var ar_tmp=tmp.split(";");tmp=$.trim(ar_tmp[0]);if(isDbTakeAssess(tmp)){this.value='';var asdxid=this.id.replace("elem_assessment","elem_assessment_dxcode");$("#"+asdxid).val('');var asplid=this.id.replace("elem_assessment","elem_plan");pln=$("#"+asplid).val();$("#"+asplid).val('');var indxid=this.id.replace("elem_assessment","");$("#elem_apOu"+indxid).prop("checked",false);$("#elem_apOd"+indxid).prop("checked",false);$("#elem_apOs"+indxid).prop("checked",false);$("#no_change_"+indxid).prop("checked",false).triggerHandler("click");$("#elem_resolve"+indxid).prop("checked",false).triggerHandler("click");return;}}});}
function sb_addAssessOption(a,b,c,d,e,f,g){if(typeof(addAssessOption)=="function"){addAssessOption(a,b,c,d,e,f,g);}else{if($("#assessplan .planbox .assnm[id*=elem_assessment][value='']").length>0){var tmpid=$("#assessplan .planbox .assnm[id*=elem_assessment][value='']")[0].id;$("#"+tmpid).val(a);var tmpdxid=tmpid.replace(/elem_assessment/g,"elem_assessment_dxcode");$("#"+tmpdxid).val(f);if((finalize_flag==0||isReviewable==1)&&elem_per_vo!="1"&&$("#hid_icd10").val()=="1"){a=encodeURI(a);f=encodeURI(f);var fid=$("#elem_masterId").val();if(typeof(setProcessImg)!='undefined')setProcessImg(1,"superbill");$.get(zPath+"/chart_notes/saveCharts.php?elem_saveForm=SET_DIABETES_IN_ASMNT&as="+a+"&dx="+f+"&fid="+fid,function(data){if(typeof(setProcessImg)!='undefined')setProcessImg(0,"superbill");});}}else{}}}
function isDiabetesAssess(str,fstp){str=$.trim(str);if(fstp=="2"){var ar_str=str.split(";");if(ar_str.length>0){str=$.trim(ar_str[0]);}}
var ret=str.match(/^((diabetes|diabetes\s+mellitus|dm)\s+type\s+[1|2])/gi);str=str.toLowerCase();if(str=="diabetes 1"||str=="diabetes 2"||str=="dm 1"||str=="dm 2"||str=="diabetes type 1 no retinopathy"||str=="diabetes type 2 no retinopathy"){ret=str;}return ret;}
function isDbTakeAssess(s){return s.match(/Long\s+term\s+\(current\)\s+use\s+of/gi);}
function sb_getSeverityScaleObj(){return{text:"Severity Scale",id:"dmb_svrt_scl",click:function(){var x=""+"<div class=\"section\" id=\"svrt_scl_info\" >"+"<div id=\"staging_code_header\" class=\"purple_bar\">Severity Scale <span title=\"Close\"  onClick=\"$('#svrt_scl_info').remove();\" class=\"glyphicon glyphicon-remove pull-right\"  ></span> </div>"+"<div >"+"<ol type=\"a\">"+"<li><b>Mild</b> = microaneurysms"+"</li>"+"<li><b>Moderate</b> = more than just microaneurysms but less than severe NPDR"+"</li>"+"<li><b>Severe</b> = any of the following (4-2-1 rule) and no signs of PDR"+"<ol type=\"i\">"+"<li>Severe intraretinal hemorrhages and microaneurysms  in each of 4 quadrants </li>"+"<li>Definite venous beading in two or more quadrants </li>"+"<li>Moderate IRMA in one or more quadrants</li>"+"</ol>"+"</li>"+"<li><b>PDR</b>  = neovascularization or vitreous/pre-retinal hemorrhage"+"</li>"+"</ol>"+"</div>"+"</div>";$("#svrt_scl_info").remove();$("body").append(x);$("#svrt_scl_info").show();$("#svrt_scl_info").draggable({handle:"#staging_code_header"});}};}
function opSuperBill(flg_ids,flg_medComp){if(typeof(flg_ids)=="undefined"){z_flg_diab_sb="1";sb_checkDiabetes();return;}
sb_getProcId4del();clearSuperBill();var lenAssess=$("#assessplan .planbox").length;var strAssess="";var valAssess,valAssessDx,idAsmtDx;var oAssess,oAssessDx;var oNe,ores;for(var i=1;i<lenAssess;i++){oAssess=gebi("elem_assessment"+i);oNe=gebi("no_change_"+i);ores=gebi("elem_resolve"+i);oAssessDx=gebi("elem_assessment_dxcode"+i);valAssessDx=valAssess=idAsmtDx="";if(oAssess){valAssess=(typeof oAssess.value!="undefined")?oAssess.value:"";}
if(oAssessDx&&typeof oAssessDx.value!="undefined"&&$.trim(oAssessDx.value)!=""){valAssessDx=oAssessDx.value;idAsmtDx=$(oAssessDx).data("dxid");if(typeof idAsmtDx=="undefined"){idAsmtDx="";}}
if(oNe&&ores&&(valAssess!="")){if(((oNe.type=="checkbox"&&oNe.checked==false)&&(ores.type=="checkbox"&&ores.checked==false))||((oNe.type=="hidden"&&oNe.value==0)&&(ores.type=="hidden"&&ores.value==0))){strAssess+="&elem_assessment"+i+"="+valAssess;if(valAssessDx!=""){strAssess+="&elem_assessmentDx"+i+"="+valAssessDx;if(idAsmtDx!=""){strAssess+="&elem_asmtDxId"+i+"="+idAsmtDx;}}}}}
strAssess+="&elem_mxLen="+lenAssess;getDxCodesFromAssess(strAssess);}
function isTestOrderBySelected(){var oOp=document.getElementById("elem_opidTestOrdered");if(oOp&&oOp.value!=""){return true;}else{return false;}}
function opTestSuperBill(){if(typeof sb_testName=="undefined"){return;}
if(!isTestOrderBySelected()){top.fAlert("Please select order by.");var oOp=document.getElementById("elem_opidTestOrdered");if(oOp){oOp.focus();}
return;}
var test_eye="";if(sb_testName=="HRT"||sb_testName=="OCT"||sb_testName=="OCT-RNFL"||sb_testName=="GDX"){test_eye=""+$(":checked[name=elem_scanLaserEye]").val();}else if(sb_testName=="VF"||sb_testName=="VF_GL"){test_eye=""+$(":checked[name=elem_vfEye]").val();}else if(sb_testName=="Pachy"){test_eye=""+$(":checked[name=elem_pachyMeterEye]").val();}else if(sb_testName=="IVFA"){test_eye=""+$(":checked[name=elem_ivfa_od]").val();}else if(sb_testName=="ICG"){test_eye=""+$(":checked[name=elem_icg_od]").val();if(test_eye==1){test_eye="OU";}
else if(test_eye==2){test_eye="OD";}
else if(test_eye==3){test_eye="OS";}}else if(sb_testName=="Fundus"||sb_testName=="External"){test_eye=""+$(":checked[name=elem_photoEye]").val();}else if(sb_testName=="Topography"||sb_testName=="TestOther"||sb_testName=="TestLabs"){test_eye=""+$(":checked[name=elem_topoMeterEye]").val();}else if(sb_testName=="CellCount"){test_eye=""+$(":checked[name=elem_cellCntEye]").val();}else if(sb_testName=="A/Scan"||sb_testName=="iOLMaster"){var tod=""+$(":input[name=performedByOD]").val();var tos=""+$(":input[name=performedByOS]").val();var tod_2=""+$(":input[name=performedByPhyOD]").val();var tos_2=""+$(":input[name=phyTechListOS]").val();if(tod!=""||tod_2!=""){test_eye="OD";}
if(tos!=""||tos_2!=""){test_eye=(test_eye=="OD")?"OU":"OS";}}else if(sb_testName=="BScan"){test_eye=""+$(":checked[name=elem_bscanMeterEye]").val();}
var sb_testName_2=sb_testName;if(sb_testName=="OCT"){var a=$(":checked[name=elem_scanLaserOct]").val();if(a==2){sb_testName_2="OCT-Retina";}else if(a==3){sb_testName_2="OCT-Anterior Segment";}}else if(sb_testName=="External"){var a=$(":checked[name=elem_fundusDiscPhoto]").val();if(a==2){sb_testName_2="Anterior Segment Photos";}else{sb_testName_2="External Photos";}}else if(sb_testName=="iOLMaster"){sb_testName_2="IOL Master";}else if(sb_testName=="BScan"){sb_testName_2="B-Scan";}else if(sb_testName=="CellCount"){sb_testName_2="Cell Count";}else if(sb_testName=="VF_GL"){sb_testName_2="VF-GL";}else if(sb_testName=="TestLabs"){sb_testName_2="Laboratories";}
custom_test_variation_subid=0;if($('#hidd_test_cpt_preference_variation_id').get(0)!='undefined'){custom_test_variation_subid=$('#hidd_test_cpt_preference_variation_id').val();}
if(typeof(test_eye)=="undefined"||test_eye==""){test_eye="OU";}
$.get(zPath+"/chart_notes/requestHandler.php?elem_formAction=GetTestCptCodes&testname="+sb_testName_2+"&eye="+test_eye+"&variation_id="+custom_test_variation_subid,function(data){var obj=data.dx;if(obj!=null){var ln=obj.length;var y=1;if(ln>0){for(var x in obj){if(typeof(obj[x])!="undefined"&&obj[x]!=""){var ad=obj[x].split(" :Dsc: ");var dx=$.trim(ad[0]);var dx_dsc=$.trim(ad[1]);$("#elem_dxCode_"+y).val(dx).attr("title",dx_dsc).tooltip();y+=1;}if(y>12){break;}}if(y>1){$("#elem_dxCode_1").trigger("blur");}}}
var obj=data.cpt;if(obj==null||obj[0]==null){top.fAlert("No CPT code is specified for this Test.You can enter yourself.");}else{var strCptAlrdySel="";for(var x in obj){var ocpt=obj[x];if($.trim(ocpt["practice_code"])){var units=ocpt["units"];var ccodeDesc=ocpt["desc"];var arrMd=ocpt["modifier"];var cCpt=$.trim(ocpt["practice_code"]);var mxSbId=gebi("elem_mxSBId").value;var indxTbl=indxTblEmpty="";var cFlag=false;var eTblSb=gebi("tblSuperbill");var oRows=eTblSb.rows;var lenRows=oRows.length;for(var i=0;i<lenRows;i++){var tCptId=oRows[i].id.replace(/elem_trSB/,"elem_cptCode_");var oCpt=gebi(tCptId);var sCpt=$.trim(oCpt.value);if((indxTblEmpty=="")&&(sCpt=="")){indxTblEmpty=(i+1);}
if(oCpt&&(sCpt!="")&&(sCpt==cCpt)){indxTbl=""+i;}}
if(indxTbl!=""){strCptAlrdySel=""+cCpt+" ";continue;}
if(indxTblEmpty!=""){var oCpt=gebi("elem_cptCode_"+indxTblEmpty);oCpt.value=cCpt;oCpt.title=ccodeDesc;renew_title(oCpt,ccodeDesc);$("#elem_procUnits_"+indxTblEmpty).val(units);if(arrMd.length>0){for(var a=0;a<4;a++){if($.trim(arrMd[a])!=""){$("#elem_modCode_"+indxTblEmpty+"_"+(a+1)).val(arrMd[a]);}}}
if(typeof oCpt.onblur=="function"){checkDB4Code_flg=0;oCpt.onblur();}}else{var oVal={"cptCode":cCpt,"procId":"","units":units,"arrDx":new Array(),"arrMd":arrMd,"cptDesc":ccodeDesc};opAddCptRow(mxSbId,oVal);}}}
if(strCptAlrdySel!=""){window.status="CPT code ("+strCptAlrdySel+") already exists in super bill! ";}}},"json");}
function opProcedureSuperBill(){setSuperBillValue_onchange();}
function setMedComplexity(obj,flg){var val=obj.value;$("input[type=checkbox][id*=elem_chkMedComp_]").each(function(inx){if(obj.checked&&this.value!=val&&this.checked){this.checked=false;}});var val=$(":checked[id*=elem_chkMedComp_]").val();var oPrnt=top.fmain;if(typeof(wpage)!="undefined"&&wpage=="accSB"){oPrnt=top;}
var oComp=gebi("elem_levelComplexity");if(oComp){if(val==6){$("#elem_post_op_visit").val("1");oComp.value="";}else if(val==5){$("#elem_proc_only_visit").val("1");oComp.value="";}else{oComp.value=val;$("#elem_proc_only_visit").val("");$("#elem_post_op_visit").val("");}
var objCategory=gebi("elem_category");if($("#elem_flgIsPtNew").val()=="Yes_confirmed"||$("#elem_flgIsPtNew").val()=="No_confirmed"||$("#elem_flgIsPtNew").val()=="Establish"){if(typeof(flg_checkAssocPqri4All_checkvisitcode)!="undefined"&&flg_checkAssocPqri4All_checkvisitcode!=0&&flg_checkAssocPqri4All_checkvisitcode!=""){checkAssocPqri4All_checkvisitcode(flg_checkAssocPqri4All_checkvisitcode);}else{checkAssocPqri4All();}}}}
function getLOSfromCode(cd){var cd=cd.toString();if(cd=="Intermediate"){return 2;}else if(cd=="Comprehensive"){return 4;}else if((typeof cd!="undefined")&&(cd.length==5)){var lastDgt=cd.substring(4);return lastDgt;}
return"";}
function makeVisitCode(obj){var practiceBillCode=obj["elem_practiceBillCode"];var strCategory=obj["elem_category"];var levelOfService=obj["elem_levelOfService"];var visitCode=category="";if(strCategory!=null&&practiceBillCode!=null)
{category=getPatientCategoryCode(strCategory,practiceBillCode);}
if(practiceBillCode&&strCategory&&levelOfService)
{visitCode=practiceBillCode+category+levelOfService;}
var ptrn="^[0-9]{5}$";var reg=new RegExp(ptrn,"g");var iscodeOk=visitCode.match(reg);return(iscodeOk)?visitCode:false;}
function sb_getVisitCodeCPTCost(vpbc){var parm="";var ar=["920","992"];var str_stop_dup="";for(var z in ar){var t=ar[z];var c=0;$(":input[type=checkbox][id*=lb_qlfy_lvl_code"+t+"]").each(function(){if(this.checked){var qd=$(this).val();if(typeof(qd)=="undefined"){qd="";}
if(qd!=""){if(str_stop_dup.indexOf(qd+",")==-1){str_stop_dup+=qd+",";parm+="&lb_qlfy_lvl_code"+t+"="+qd;c++;}}}});}
for(var z in ar){var t=ar[z];var tv="$0.00";$("label[id*=lb_rs_qlfy_def_"+t+"]").html(tv);$("label[id*=lb_rs_qlfy_ins_"+t+"]").html(tv);}
if(parm==""){$("label[id*=lb_rs_qlfy_ins_], #lb_rs_ins_v").html(tv).hide();return;}
var ins=$("#elem_masterCaseId").val();if(typeof(ins)=="undefined"){ins="";}
parm+="&elem_insCaseId="+ins;parm+="&elem_dos="+$("#elem_dos").val();var url=zPath+"/chart_notes/requestHandler.php?elem_formAction=sb_getVisitCodeCPTCost"+parm;$.get(url,function(data){for(var x in data){var xd=x.replace("lb_qlfy_lvl_code","lb_rs_qlfy_def_");var xi=x.replace("lb_qlfy_lvl_code","lb_rs_qlfy_ins_");var tv=(data[x]&&data[x]["def"]&&typeof(data[x]["def"])!="undefined")?"$"+data[x]["def"]:"$0.00";$("label[id*="+xd+"]").html(tv).show();var tv=(data[x]&&data[x]["ins"]&&typeof(data[x]["ins"])!="undefined")?"$"+data[x]["ins"]:"$0.00";$("label[id*="+xi+"]").html(tv).show();}
var flg=0;$("label[id*=lb_rs_qlfy_ins_]").each(function(){var t=$(this).html();if(t!="$0.00"){flg=1;}});if(flg==0){$("label[id*=lb_rs_qlfy_ins_], #lb_rs_ins_v").html(tv).hide();}},"json");}
function confirmVisitCode_v3(){var oCat=gebi("elem_category");var oPBC=gebi("elem_practiceBillCode");var olvlHis=gebi("elem_levelHistory");var olvlComp=gebi("elem_levelComplexity");var olvlService=gebi("elem_levelOfService");var oPoeVC=gebi("elem_poe_visit_code");var opov=gebi("elem_proc_only_visit");var opopv=gebi("elem_post_op_visit");var close_flg=0;if((oPoeVC.value==sb_cpt_code_poe)){setVisitCode(oPoeVC.value);close_flg=1;}else if(typeof(opov.value)!="undefined"&&opov.value=="1"){close_flg=1;}
else if(typeof(opopv.value)!="undefined"&&opopv.value=="1"){setVisitCode(oPoeVC.value);close_flg=1;}
if(close_flg==1){$("#dialog-Mdc-cum-new-pt").remove();return;}
var objEye={"elem_category":oCat.value,"elem_practiceBillCode":oPBC.value,"elem_levelOfService":olvlService.value};var strVisitCodeEye=makeVisitCode(objEye);if(strVisitCodeEye&&(strVisitCodeEye!="-1")&&($.trim(strVisitCodeEye)!="")){var prmptComp=($.trim(olvlComp.value)=="")?1:0;var lvlInsert=5;if(oPBC.value=="920"){lvlInsert=4;}
if(lvlInsert==olvlService.value){confirmVisitCode_v2();}else{confirmVisitCode_v2();}}}
function confirmVisitCode_v2(){var oCat=gebi("elem_category");var olvlHis=gebi("elem_levelHistory");var olvlComp=gebi("elem_levelComplexity");var opov=gebi("elem_proc_only_visit");var opopv=gebi("elem_post_op_visit");var olvlSerEye=gebi("elem_levelOfServiceEye");var olvlSerEM=gebi("elem_levelOfServiceEM");var oExNotDoneEye=gebi("elem_strExmNotDoneEye");var oExNotDoneEM=gebi("elem_strExmNotDoneEM");var oElem_pls_sel_nq_em=gebi("elem_pls_sel_nq_em");var oElem_pls_sel_nq_eye=gebi("elem_pls_sel_nq_eye");var detailEye="";var detailEM="";var objEye={"elem_category":oCat.value,"elem_practiceBillCode":"920","elem_levelOfService":olvlSerEye.value};var strVisitCodeEye=makeVisitCode(objEye);if(strVisitCodeEye){var obj={"vCode":strVisitCodeEye,"elem_levelOfService":olvlSerEye.value,"elem_practiceBillCode":"920","elem_strExmNotDone":oExNotDoneEye.value,"elem_pls_sel_nq":oElem_pls_sel_nq_eye.value};detailEye=getVisitCodeDetail(obj);}
var str_tbl_hdr_em=["",""];if($("#elem_practiceBillCode").val()=="992"){var objEM={"elem_category":oCat.value,"elem_practiceBillCode":"992","elem_levelOfService":olvlSerEM.value};var strVisitCodeEM=makeVisitCode(objEM);if(strVisitCodeEM){var obj={"vCode":strVisitCodeEM,"elem_levelOfService":olvlSerEM.value,"elem_practiceBillCode":"992","elem_strExmNotDone":oExNotDoneEM.value,"elem_pls_sel_nq":oElem_pls_sel_nq_em.value};detailEM=getVisitCodeDetail(obj);}
str_tbl_hdr_em[0]="<td width=\"1\"></td><td width=\"550\" valign=\"top\"><b>E/M Code</b></td>";str_tbl_hdr_em[1]="<td width=\"3\" height=\"1\" ><div style=\"background-color:gray;width:1px;height:100%;\"></div></td><td valign=\"top\" id=\"td_em_cd\">"+detailEM+"</td>";}
if(($.trim(detailEM)=="")&&($.trim(detailEye)=="")){return;}
var msg="<table class=\"table table-bordered\"  border=\"0\" width=\"100%\" >"+"<tr><td width=\"550\" valign=\"top\"><b>Eye Code</b></td>"+str_tbl_hdr_em[0]+"</tr>"+"<tr><td valign=\"top\" id=\"td_eye_cd\">"+detailEye+"</td>"+str_tbl_hdr_em[1]+"</tr>"+"</table>";var title="Assessed Service Level";var btn1="0";var btn2="0";if(typeof top.fmain=="undefined"){var func=((olvlSerEye.value!="0")||(olvlSerEM.value!="0"))?"decideLevelofService2":"decideLevelofService2";}else{var func=((olvlSerEye.value!="0")||(olvlSerEM.value!="0"))?"top.fmain.decideLevelofService2":"top.fmain.decideLevelofService2";}
var oArr={};if(olvlSerEye.value!="0"){oArr["Current Eye Code"]="Eye Code";}
if($("#elem_practiceBillCode").val()=="992"){if(olvlSerEM.value!="0"){oArr["Current E/M Code"]="EM Code";}
var pLeft=100;}else{var pLeft=200;}
var misc=((olvlSerEye.value!="0")||(olvlSerEM.value!="0"))?new Array(oArr):new Array({"OK":"OK"});var btnhtm="";var len=misc.length;for(var i=0;i<len;i++)
{var tmp=misc[i];for(x in tmp)
{btnhtm+="<input type=\"button\" value=\""+x+"\" onClick=\"window."+func+"('"+tmp[x]+"')\" class=\"btn btn-success\">&nbsp;";}}
btnhtm+='<input type="button" value="Cancel" onClick="window.'+func+'(-1)" class="btn btn-danger">';msg=msg+"<div id=\"module_buttons\" class=\"pt10 row\"><div class=\"col-sm-12 text-center\"><div class=\"form-group\">"+btnhtm+"</div></div></div>";if($("#div_as_srv_lvl").length<=0){var htm="<div id=\"dialog-Mdc-cum-new-pt\">"+"<div style=\"\">"+"<table class=\"table\" height=\"30\"><tr class='purple_bar'><th>Assessed Service Level<span class=\"glyphicon glyphicon-remove pull-right\" title=\"close\"></span></th></tr></table>"+"</div>"+"<div id=\"div_as_srv_lvl\"></div>"+"</div>";$("#dialog-Mdc-cum-new-pt").remove();$("body").append(htm);$("#dialog-Mdc-cum-new-pt").draggable({"handle":"th"});$("#dialog-Mdc-cum-new-pt th span[title=close]").bind("click",function(){$("#dialog-Mdc-cum-new-pt").remove();});$("#dialog-Mdc-cum-new-pt th").css({"cursor":"move"});}
$("#div_as_srv_lvl").html(msg);sb_getVisitCodeCPTCost();var pTop=60;$("#div_as_srv_lvl").find("tr").css({"background-color":"white"});$("#div_as_srv_lvl").find("input[id*=lb_qlfy_lvl_code]").bind("click",function(){var d=this.checked;var f=this.name;var e=this.id;$("input[type=checkbox][name*="+f+"]").each(function(index){if(this.id==e){$(this).prop("checked",d);}else{$(this).prop("checked",false);}});var clr=(d)?"red":"transparent";$("label[for*="+f+"]").each(function(index){if($(this).attr("for")==e){$(this).css({"border":"1px solid "+clr});}else{$(this).css({"border":"1px solid transparent"});}});if(this.value=="Procedure only visit"){$("#elem_proc_only_visit").val("1");}else{$("#elem_proc_only_visit").val("");}
if(this.value=="Post Op Visit"){$("#elem_post_op_visit").val("1");}else{$("#elem_post_op_visit").val("");}
if(d){opRemAllCptRow(3);checkAssocPqri4All();}else{sb_getVisitCodeCPTCost();}
stopClickBubble();});$("#div_as_srv_lvl #td_eye_cd .seprtr").each(function(ii){$(this).css({"width":"200px"});});if($("#elem_practiceBillCode").val()=="920"){$("#dialog-Mdc-cum-new-pt").css({"width":"60%","left":"250px"});var lalign=($("#div_as_srv_lvl").find("input[type=button][value='OK']").length>0)?"50%":"70%";}}
function sb_get_vc_opt(vcd,vpbc,vcat){var vcat_in="";if(vcat=="New"){vcat_in="0";}else if(vcat=="Establish"){vcat_in="1";}
if(vpbc=="920"){var ar=["Intermediate - "+vpbc+vcat_in+"2","Comprehensive - "+vpbc+vcat_in+"4"];}else{var ar=["992"+vcat_in+"1","992"+vcat_in+"2","992"+vcat_in+"3","992"+vcat_in+"4","992"+vcat_in+"5"];}
var ret="<label class=\"lbl_asl_1\">Qualify for: </label><div class=\"seprtr\"><label for=\"lb_qlfy_lvl_code"+vpbc+"_0\">None</label></div>";ret="";for(var z in ar){var sel=(vcd==ar[z])?"checked":"";var tmp=ar[z].replace(/(Intermediate\s+\-\s+|Comprehensive\s+\-\s+)/g,"");ret+="<div class=\"seprtr\"><input type=\"checkbox\" name=\"lb_qlfy_lvl_code"+vpbc+"\" id=\"lb_qlfy_lvl_code"+vpbc+"_"+z+"\" value=\""+tmp+"\" "+sel+" ><label for=\"lb_qlfy_lvl_code"+vpbc+"_"+z+"\">"+ar[z]+"</label></div>";}
if($("#elem_practiceBillCode").val()=="920"){z=z+1;ret+="<div class=\"seprtr\" style=\"float:right; text-align:left;\"><input type=\"checkbox\" name=\"lb_qlfy_lvl_code"+vpbc+"\" id=\"lb_qlfy_lvl_code"+vpbc+"_"+z+"\" value=\""+"Procedure only visit"+"\" ><label for=\"lb_qlfy_lvl_code"+vpbc+"_"+z+"\">"+"Procedure only visit"+"</label></div>";z=z+1;ret+="<br/><div class=\"seprtr\" style=\"float:right;text-align:left;\"><input type=\"checkbox\" name=\"lb_qlfy_lvl_code"+vpbc+"\" id=\"lb_qlfy_lvl_code"+vpbc+"_"+z+"\" value=\""+"Post Op Visit"+"\" ><label for=\"lb_qlfy_lvl_code"+vpbc+"_"+z+"\">"+"Post Op Visit"+"</label></div>";}
if(ret!=""){ret="<label class=\"lbl_asl_1\">Qualify for: </label>"+ret;ret+="<br><label class=\"lbl_asl_1\" id=\"lb_rs_def_v\">Default Fees: </label><label id=\"lb_rs_qlfy_def_"+vpbc+"\" >Loading..</label>"+"<br><label class=\"lbl_asl_1\" id=\"lb_rs_ins_v\">Ins. Contract Fees: </label><label id=\"lb_rs_qlfy_ins_"+vpbc+"\">Loading..</label>";}
return ret;}
function getVisitCodeDetail(obj){var oPBC=obj["elem_practiceBillCode"];var objCategory=gebi("elem_category");var vCode_cpt=vCode=obj["vCode"];var pls_sel_nq=obj["elem_pls_sel_nq"];var msg="";if(vCode!=false){var oLoS=obj["elem_levelOfService"];var oNotDoneExm=obj["elem_strExmNotDone"];var arrNotDoneExm=(typeof oNotDoneExm!="undefined")?oNotDoneExm.split(","):new Array();var nxtVCode=(oLoS<"5"&&pls_sel_nq=="")?eval(vCode)+1:eval(vCode);if(oPBC=="920"){if(oLoS=="2"){vCode="Intermediate";}else if(oLoS=="4"){vCode="Comprehensive";}
nxtVCode=(oLoS<="1")?"Intermediate":"Comprehensive";}else{if(pls_sel_nq==""){if(nxtVCode==99201){nxtVCode="99202";}else if(nxtVCode==99211){nxtVCode="99212";}}}
if(pls_sel_nq!=""){nxtVCode=vCode;}
var nxtLos=getLOSfromCode(nxtVCode);if((oLoS=="0")){vCode="None";vCode_cpt="";}else{vCode_cpt=" - "+vCode_cpt;}
if(vCode==nxtVCode&&pls_sel_nq==""){nxtVCode="None";}
if(oPBC=="992"){vCode_cpt="";}
msg=""+"<br>"+sb_get_vc_opt(vCode+""+vCode_cpt,oPBC,objCategory.value)+"";msg+="<br>";if(((oLoS<"5")&&(vCode!="Comprehensive"))||(pls_sel_nq!="")){var tmp_list="";var arrExmCate=new Array();var len=arrNotDoneExm.length;for(var i=0;i<len;i++){if((typeof arrNotDoneExm[i]!="undefined")&&(arrNotDoneExm[i]!="")){if((arrNotDoneExm[i].indexOf("Fundus Exams")!=-1)||(arrNotDoneExm[i].indexOf("SLE")!=-1)||(arrNotDoneExm[i].indexOf("L&A")!=-1)){if(arrNotDoneExm[i].indexOf("-")!=-1){var arrTmpCate=arrNotDoneExm[i].split("-");var key=$.trim(arrTmpCate[0]);var val=$.trim(arrTmpCate[1]);if(typeof arrExmCate[key]=="undefined"){arrExmCate[key]=new Array();}
arrExmCate[key].push(val);}}else{tmp_list+="<br>   - "+arrNotDoneExm[i];}}}
for(var i in arrExmCate){tmp_list+="<br>   - "+i;var len2=arrExmCate[i].length;for(var j=0;j<len2;j++){var strSubCate=$.trim(arrExmCate[i][j]);if(strSubCate!=""){strSubCate=strSubCate.replace(/;/g,", ");tmp_list+="<br>&nbsp;&nbsp;&nbsp;&nbsp;- "+strSubCate;}}}
if(tmp_list!=""){msg+="<br>List items that must be completed to qualify for level - "+nxtVCode+"";msg+="<div class=\"dv_ls_todo_exm\">"+tmp_list+"</div>";}}
msg+="";}
return msg;}
function checkCurrRowId(currRowId){var tbl=gebi("tblSuperbill");var lastRow=tbl.rows.length;for(var i=0;i<lastRow;i++){var tId="elem_trSB"+(i+1);var temp=gebi(tId);if(temp==null){currRowId=(i+1);break;}}
return currRowId;}
function getRealIndx(id,strTr,strTbl){if(typeof strTbl=="undefined"){strTbl="tblSuperbill";strTr="elem_trSB";}
var rowId=strTr+id;var tbl=gebi(strTbl);var lastRow=tbl.rows.length;var i=0;for(i=0;i<lastRow;i++){var temp=tbl.rows[i];if(rowId==temp.id){return i;break;}}
if(id=="LASTINDX"){return i-1;}
return 0;}
function editSBRowValues(oVal){var strCpt=oVal.cptCode;var arrMd=new Array();arrMd=oVal.arrMd;if($.trim(strCpt)!=""){var mxId=gebi("elem_mxSBId").value;var tbl=gebi("tblSuperbill");var lastRow=tbl.rows.length;for(var i=0;i<mxId;i++){var tId="elem_cptCode_"+(i+1);var temp=gebi(tId);if(temp&&(temp.value!="")&&(typeof temp.value!="undefined")&&($.trim(temp.value)==$.trim(strCpt))){for(var j=1;j<=4;j++){var oMd=gebi("elem_modCode_"+(i+1)+"_"+j);if(oMd){oMd.value=(typeof arrMd[j-1]!="undefined")?""+arrMd[j-1]:"";}}}}}}
function Save_form(i,cnfrm){if(typeof(del_proc_noti)=="undefined"||del_proc_noti=="0"||del_proc_noti==""){cnfrm=true;}
if(typeof(cnfrm)=="undefined"){var str="top.Save_form('"+i+"',true)";if(typeof(top.fmain)!="undefined"){if(typeof(top.fmain.ifrm_FolderContent)!="undefined"&&typeof(top.fmain.ifrm_FolderContent.Save_form)=="function"){var str="top.fmain.ifrm_FolderContent.Save_form('"+i+"',true)";}else{var str="top.fmain.Save_form('"+i+"',true)";}}
top.fancyConfirm("Would you like to delete the selected CPT row from superbill ?","",""+str);}
else{opRemCptRow(i);if(document.getElementById('save_form')){document.getElementById('save_form').value='1';document.frmSuperBill.submit();}}}
function opAddCptRow(indx,oVal,flagStpGtMx,fRindx,sup_enc_chk){var enc_chk=false;if(sup_enc_chk==1){enc_chk=true;}
var cptCode="";var procId="";var units="1";var arrDx=new Array();var arrMd=new Array();var tmp="";var cptDesc="";flagStpGtMx=(typeof flagStpGtMx!="undefined")?flagStpGtMx:0;if(typeof sb_pdiv=="undefined"&&gebi("divWorkView")){sb_pdiv="divWorkView";}
if(typeof oVal!="undefined"&&oVal!=""){cptCode=oVal.cptCode;procId=oVal.procId;units=oVal.units;arrDx=oVal.arrDx;arrMd=oVal.arrMd;cptDesc=(typeof oVal.cptDesc!="undefined")?oVal.cptDesc:"";}
var w_dx=$(".dxcodeshd td").eq(2).prop("width");var oTbl=$("#tblSuperbill").get(0);var lastRow=oTbl.rows.length;var currRowId=lastRow+1;var elemId;if(indx=="new"){indx=lastRow;}
var rIndx=(fRindx==1)?indx:getRealIndx(indx);rIndx=parseInt(rIndx);var row=oTbl.insertRow(rIndx+1);currRowId=checkCurrRowId(currRowId);row.id="elem_trSB"+currRowId;var cellCpt=row.insertCell(0);$(cellCpt).addClass("cpt_td");cellCpt.innerHTML=""+"<div class=\"input-group\">"+"<label class=\"pointer input-group-addon text-center contno\" onclick=\"sb_swap_vals(this)\">"
+currRowId+"</label>"+"<input type=\"text\" id=\"elem_cptCode_"+currRowId+"\" name=\"elem_cptCode_"+currRowId+"\" value=\""+cptCode+"\" title=\""+cptDesc+"\" class=\"cptcode form-control\" onblur=\"checkCptCodesChart(this);\">"+"<input type=\"hidden\" id=\"elem_procedureId_"+currRowId+"\" name=\"elem_procedureId_"+currRowId+"\" value=\""+procId+"\">"+"<input type=\"hidden\" id=\"elem_procedureOrder_"+currRowId+"\" name=\"elem_procedureOrder_"+currRowId+"\" value=\""+(rIndx+1)+"\">"+"</div>";var cellUnits=row.insertCell(1);$(cellUnits).addClass("unit");cellUnits.innerHTML="<input type=\"text\" id=\"elem_procUnits_"+currRowId+"\"  name=\"elem_procUnits_"+currRowId+"\" value=\""+units+"\" class=\"cptunit form-control\" onchange=\"checkProcUnitsChart(this);\">";var dxw=$("#elem_trSB1 .dx").attr("width");var cellDx=row.insertCell(2);elemId="elem_dxCodeAssoc_"+currRowId;cellDx.innerHTML="<select  id=\""+elemId+"\" name=\""+elemId+"[]\" multiple=\"multiple\" data-width=\"100%\" class=\"diagText_all_css minimal selectpicker dropupalways\" data-actions-box=\"true\" title=\"\">"+"</select>";cellDx.width=dxw;var dxCdId=elemId;for(var i=1;i<=4;i++){var cellMod=row.insertCell(i+2);$(cellMod).addClass("md");elemId="elem_modCode_"+currRowId+"_"+i;tmp=(typeof arrMd[i-1]!="undefined")?""+arrMd[i-1]:"";cellMod.innerHTML=""+"<div class=\"input-group\"><input type=\"text\" id=\""+elemId+"\" name=\""+elemId+"\" value=\""+tmp+"\" class=\"form-control modcode\" onblur=\"checkModCodesChart(this);\"></div>"+"";}
var cellLast=row.insertCell(7);$(cellMod).prop("valign","middle");cellLast.innerHTML="<span class=\"glyphicon glyphicon-remove\" onclick=\"Save_form('"+currRowId+"');\" title=\"Delete\" ></span> "+"<span class=\"glyphicon glyphicon-plus\" onclick=\"opAddCptRow('"+currRowId+"')\" title=\"Insert\"  ></span> ";if(flagStpGtMx!=1){var objsbnr=getMxSB(1);}
gebi("elem_cptCode_"+currRowId).onblur();sb_addTypeAhead();sb_crt_dx_dropdown("#"+dxCdId,'',arrDx);fun_mselect("#"+dxCdId,'render');fun_mselect("#"+dxCdId,'onchange',function(){dx_assoc_cpt(this);});fun_mselect("#"+dxCdId,'width');sb_reorder_srno();sb_add_menu();}
function sb_reorder_srno(){$("#tblSuperbill tr").each(function(i){$(this).find(".contno").html(""+(i+1)+"");});}
var st_sb_dx=ed_sb_dx=st_sb_rw=ed_sb_rw=0;function sb_swap_vals(obj){if(typeof(elem_per_vo)=="undefined"){elem_per_vo="0";}
if(typeof(finalize_flag)=="undefined"){finalize_flag="0";}
if(typeof(isReviewable)=="undefined"){isReviewable="0";}
if((elem_per_vo=="1")||((finalize_flag=="1")&&(isReviewable!="1"))){return;}
var id=($(obj).parents("#tblSuperbill").length>0)?"tblSuperbill":$(obj).parents("table").attr("id");if(id=="tblSuperbill"){var num=""+$(obj).parents("tr").attr("id");num=parseInt(num.replace(/elem_trSB/,""));if(st_sb_rw==0){st_sb_rw=num;obj.style.color="red";return;}else{ed_sb_rw=num;}
if((st_sb_rw!=0)&&(ed_sb_rw!=0)){$("#tblSuperbill tr").each(function(i){$(this).find("td:first-child .contno").css("color","white");});var tcv=$("#elem_cptCode_"+ed_sb_rw).val();var tct=$("#elem_cptCode_"+ed_sb_rw).attr("title");var tcvd=$("#elem_cptCode_"+ed_sb_rw).attr("valid_dxcodes");var tcpv=$("#elem_procedureId_"+ed_sb_rw).val();var tcov=$("#elem_procedureOrder_"+ed_sb_rw).val();var tcuv=$("#elem_procUnits_"+ed_sb_rw).val();var tcm1v=$("#elem_modCode_"+ed_sb_rw+"_1").val();var tcm1t=$("#elem_modCode_"+ed_sb_rw+"_1").attr("title");var tcm2v=$("#elem_modCode_"+ed_sb_rw+"_2").val();var tcm2t=$("#elem_modCode_"+ed_sb_rw+"_2").attr("title");var tcm3v=$("#elem_modCode_"+ed_sb_rw+"_3").val();var tcm3t=$("#elem_modCode_"+ed_sb_rw+"_3").attr("title");var tcm4v=$("#elem_modCode_"+ed_sb_rw+"_4").val();var tcm4t=$("#elem_modCode_"+ed_sb_rw+"_4").attr("title");var tcdxv=""+fun_mselect("#elem_dxCodeAssoc_"+ed_sb_rw,'val');var tcdxt=""+fun_mselect("#elem_dxCodeAssoc_"+ed_sb_rw,'title');$("#elem_cptCode_"+ed_sb_rw).val($("#elem_cptCode_"+st_sb_rw).val());$("#elem_cptCode_"+ed_sb_rw).attr("title",$("#elem_cptCode_"+st_sb_rw).attr("title"));$("#elem_cptCode_"+ed_sb_rw).attr("valid_dxcodes",$("#elem_cptCode_"+st_sb_rw).attr("valid_dxcodes"));$("#elem_procedureId_"+ed_sb_rw).val($("#elem_procedureId_"+st_sb_rw).val());$("#elem_procedureOrder_"+ed_sb_rw).val($("#elem_procedureOrder_"+st_sb_rw).val());$("#elem_procUnits_"+ed_sb_rw).val($("#elem_procUnits_"+st_sb_rw).val());$("#elem_modCode_"+ed_sb_rw+"_1").val($("#elem_modCode_"+st_sb_rw+"_1").val());$("#elem_modCode_"+ed_sb_rw+"_1").attr("title",$("#elem_modCode_"+st_sb_rw+"_1").attr("title"));$("#elem_modCode_"+ed_sb_rw+"_2").val($("#elem_modCode_"+st_sb_rw+"_2").val());$("#elem_modCode_"+ed_sb_rw+"_2").attr("title",$("#elem_modCode_"+st_sb_rw+"_2").attr("title"));$("#elem_modCode_"+ed_sb_rw+"_3").val($("#elem_modCode_"+st_sb_rw+"_3").val());$("#elem_modCode_"+ed_sb_rw+"_3").attr("title",$("#elem_modCode_"+st_sb_rw+"_3").attr("title"));$("#elem_modCode_"+ed_sb_rw+"_4").val($("#elem_modCode_"+st_sb_rw+"_4").val());$("#elem_modCode_"+ed_sb_rw+"_4").attr("title",$("#elem_modCode_"+st_sb_rw+"_4").attr("title"));var scdxv=""+fun_mselect("#elem_dxCodeAssoc_"+st_sb_rw,'val');var scdxt=""+fun_mselect("#elem_dxCodeAssoc_"+st_sb_rw,'title');fun_mselect("#elem_dxCodeAssoc_"+ed_sb_rw,'select',scdxv,scdxt);$("#elem_cptCode_"+st_sb_rw).val(tcv);$("#elem_cptCode_"+st_sb_rw).attr("title",tct);renew_title("#elem_cptCode_"+st_sb_rw,tct);$("#elem_cptCode_"+st_sb_rw).attr("valid_dxcodes",tcvd);$("#elem_procedureId_"+st_sb_rw).val(tcpv);$("#elem_procedureOrder_"+st_sb_rw).val(tcov);$("#elem_procUnits_"+st_sb_rw).val(tcuv);$("#elem_modCode_"+st_sb_rw+"_1").val(tcm1v);$("#elem_modCode_"+st_sb_rw+"_1").attr("title",tcm1t);renew_title("#elem_modCode_"+st_sb_rw+"_1",tcm1t);$("#elem_modCode_"+st_sb_rw+"_2").val(tcm2v);$("#elem_modCode_"+st_sb_rw+"_2").attr("title",tcm2t);renew_title("#elem_modCode_"+st_sb_rw+"_2",tcm2t);$("#elem_modCode_"+st_sb_rw+"_3").val(tcm3v);$("#elem_modCode_"+st_sb_rw+"_3").attr("title",tcm3t);renew_title("#elem_modCode_"+st_sb_rw+"_3",tcm3t);$("#elem_modCode_"+st_sb_rw+"_4").val(tcm4v);$("#elem_modCode_"+st_sb_rw+"_4").attr("title",tcm4t);renew_title("#elem_modCode_"+st_sb_rw+"_4",tcm4t);fun_mselect("#elem_dxCodeAssoc_"+st_sb_rw,'select',tcdxv,tcdxt);getMxSB();st_sb_rw=ed_sb_rw=0;}}else{var num=parseInt($(obj).html());if(st_sb_dx==0){st_sb_dx=num;obj.style.color="red";return;}else{ed_sb_dx=num;}
if((st_sb_dx!=0)&&(ed_sb_dx!=0)){$("#tblSBDX tr").each(function(i){$(this).find("th").css({"color":"black"});});var tv=$("#elem_dxCode_"+ed_sb_dx).val();var tt=$("#elem_dxCode_"+ed_sb_dx).attr("title");var tlv=$("#lit_diagText_"+ed_sb_dx).val();var tdocv=$("#dx_oldCode_"+ed_sb_dx).val();$("#elem_dxCode_"+ed_sb_dx).val($("#elem_dxCode_"+st_sb_dx).val());$("#elem_dxCode_"+ed_sb_dx).attr("title",$("#elem_dxCode_"+st_sb_dx).attr("title"));$("#lit_diagText_"+ed_sb_dx).val($("#lit_diagText_"+st_sb_dx).val());$("#dx_oldCode_"+ed_sb_dx).val($("#dx_oldCode_"+st_sb_dx).val());$("#elem_dxCode_"+st_sb_dx).val(tv);$("#elem_dxCode_"+st_sb_dx).attr("title",tt);renew_title("#elem_dxCode_"+st_sb_dx,tt);$("#lit_diagText_"+st_sb_dx).val(tlv);$("#dx_oldCode_"+st_sb_dx).val(tdocv);st_sb_dx=ed_sb_dx=0;}}}
function emptyFirstRowSB(){for(var i=1;i<=4;i++){if(i==1){var cptCode=gebi("elem_cptCode_"+i);var procid=gebi("elem_procedureId_"+i);var units=gebi("elem_procUnits_"+i);cptCode.value=cptCode.title="";procid.value="";units.value="1";sb_crt_dx_dropdown("#elem_dxCodeAssoc_"+i,flgSetEmpty=1);renew_title(cptCode,"");}
if(i<=4){var mdCode=gebi("elem_modCode_1_"+i);mdCode.value="";}}}
function opRemAllCptRow(n){if(typeof(n)=="undefined")n=1;var tbl=gebi("tblSuperbill");if(!tbl)return;var lastRow=tbl.rows.length;for(var i=lastRow-1;i>=0;i--){if(i==0){emptyFirstRowSB();break;}else{tbl.deleteRow(i);}}
if(n>1){for(var i=1;i<n;i++){opAddCptRow("LASTINDX");}}
var objsbnr=getMxSB();}
function opRemCptRow(indx){var tbl=gebi("tblSuperbill");var lastRow=tbl.rows.length;var rIndx=getRealIndx(indx);if(typeof(indx)!="undefined"){var v=$("#elem_procedureId_"+indx).val();if(typeof(v)!="undefined"&&v!=""){var y=$("#elem_proc_del_id").val();if(y!=""){y+=",";}
$("#elem_proc_del_id").val(y+v);}}
if(indx>1){tbl.deleteRow(rIndx);}else{emptyFirstRowSB();}
var objsbnr=getMxSB();setSBTodayCharges();sb_reorder_srno();}
function getMxSB(flgAdd){var tbl=gebi("tblSuperbill");var lastRow=tbl.rows.length;var str="";var mx=0;var strCode="";var strUnit="";var tmpUnit="";var isCptElemVacant=1;var oCpt,flagLastRow=0;var checkId="";for(var i=0;i<lastRow;i++){var temp=tbl.rows[i];str+=""+temp.id+",";var id=temp.id.replace(/elem_trSB/,"");mx=(id>mx)?id:mx;var cptId=temp.id.replace(/elem_trSB/,"elem_cptCode_");var unitId=temp.id.replace(/elem_trSB/,"elem_procUnits_");oCpt=gebi(cptId);var oUnit=gebi(unitId);checkId+=id+", ";if(oCpt&&(typeof oCpt.value!="undefined")&&($.trim(oCpt.value)!="")){strCode+=(strCode!="")?","+oCpt.value:""+oCpt.value;tmpUnit=(oUnit&&(typeof oUnit.value!="undefined")&&($.trim(oUnit.value)!=""))?oUnit.value:1;strUnit+=(strUnit!="")?","+tmpUnit:""+tmpUnit;flagLastRow=i;var proOrdrId=temp.id.replace(/elem_trSB/,"elem_procedureOrder_");proOrdrId=gebi(proOrdrId);proOrdrId.value=(i+1);}else{flagLastRow=0;}}
lastRow=((typeof lastRow!="undefined"))?lastRow:4;mx=(mx>lastRow)?mx:lastRow;strCode=$.trim(strCode);strCode=strCode.replace(/,$/,"");strUnit=$.trim(strUnit);strUnit=strUnit.replace(/,$/,"");gebi("elem_mxSBId").value=mx;gebi("elem_procOrder").value=strCode;gebi("elem_procUnitOrder").value=strUnit;if(flgAdd==1&&flagLastRow!=0){if(sup_enc==1){opAddCptRow("LASTINDX",'','','',sup_enc);}else{opAddCptRow("LASTINDX");}}}
function checkChiefComplaintDetailed(){var ret="false";var c=getRvsDoneSt();if(c>=3){ret="true";}
return ret;}
var zChiefCompElemName="";function decideChiefComp(val){if(val=="1"){}else if(val=="0"){var oElem=gebi(zChiefCompElemName);if(oElem){oElem.value="";}}
zPqriElemName="";var objsbnr=getMxSB();setSBTodayCharges();}
function getCptDescJs(cptCode){var ret="";cptCode=$.trim(cptCode);if((cptCode!="")&&(typeof arrCptCodeDescActive[0]!="undefined")){for(var x in arrCptCodeDescActive[0]){if(arrCptCodeDescActive[0][x]==cptCode){ret=x;break;}}}
return ret;}
var sb_cw4WD_flgnoalert="";function sb_checknwarn4WrongDxcode(obj){var flgnoalert=sb_cw4WD_flgnoalert;if(typeof(flgnoalert)=="undefined"||flgnoalert==""){flgnoalert=0;}
var v_icd_10=$("#hid_icd10").val();var indx=obj.id.replace(/elem_cptCode_|elem_dxCodeAssoc_/g,"");var valid_dxCode="",cur_dxCode="";if(obj.id.indexOf("elem_cptCode_")!=-1){var proc_code=$.trim(""+obj.value);valid_dxCode=obj.getAttribute("valid_dxcodes");cur_dxCode=""+fun_mselect("#elem_dxCodeAssoc_"+indx,'val');}else{var proc_code=$("#elem_cptCode_"+indx).val();valid_dxCode=$("#elem_cptCode_"+indx).attr("valid_dxcodes");cur_dxCode=""+fun_mselect(obj,'val');}
if(typeof(valid_dxCode)!="undefined"){valid_dxCode=""+valid_dxCode;}
if(typeof(proc_code)!="undefined"){proc_code=""+proc_code;}
if(proc_code==""){var strtitle="";$("#elem_dxCodeAssoc_"+indx).find('option').each(function(){if(cur_dxCode.indexOf(""+$(this).val())!=-1){strtitle+=this.text+" - "+$(this).data("desc")+"\n";}});fun_mselect("#elem_dxCodeAssoc_"+indx,"settitle",strtitle);return;}
if(v_icd_10=="1"){if(valid_dxCode&&valid_dxCode!="null"&&valid_dxCode!=""&&typeof(valid_dxCode)!="undefined"&&cur_dxCode&&cur_dxCode!="null"&&typeof(cur_dxCode)!="undefined"&&cur_dxCode!=""){var ar_valid_dxCode=valid_dxCode.toLowerCase().split(",");var ar_cur_dxCode=cur_dxCode.split(",");var ar_wrong_dx=[];if(ar_cur_dxCode.length>0&&valid_dxCode.length>0){for(var x in ar_cur_dxCode){var tmp=$.trim(ar_cur_dxCode[x]);if(tmp=="")continue;var arr_tmp=tmp.split("**");if(arr_tmp[0]&&""+arr_tmp[0]!=""){arr_tmp[0]=$.trim(""+arr_tmp[0]).toLowerCase();if(ar_valid_dxCode.indexOf(""+arr_tmp[0])==-1){if(v_icd_10=="1"){var q1=""+arr_tmp[0].slice(0,-1)+"-";var q2=""+arr_tmp[0].slice(0,-2)+"--";var q3=""+arr_tmp[0].slice(0,-3)+"-x-";if(ar_valid_dxCode.indexOf(""+q1)!=-1||ar_valid_dxCode.indexOf(""+q2)!=-1||ar_valid_dxCode.indexOf(""+q3)!=-1){continue;}}
ar_wrong_dx[ar_wrong_dx.length]=""+arr_tmp[0];fun_mselect("#elem_dxCodeAssoc_"+indx,"unselect",tmp);}}}}
if(ar_wrong_dx.length>0&&flgnoalert==0){var dx_alert=ar_wrong_dx.join();dx_alert=dx_alert.toUpperCase();top.fAlert("Dx code(s) "+dx_alert+" can not be applied for procedure "+proc_code+".");}}}
if(v_icd_10!="1"){var arcurdx=""+fun_mselect("#elem_dxCodeAssoc_"+indx,'val');if(arcurdx&&arcurdx!="null"&&arcurdx!=""){var tmp_arcurdx=arcurdx.split(",");var lm=4;if(tmp_arcurdx.length>lm){if(flgnoalert==0){top.fAlert("You cannot select more than 4 Dx codes for a procedure.");}
for(var x in tmp_arcurdx){var tmp=$.trim(tmp_arcurdx[x]);if(tmp=="")continue;var arr_tmp=tmp.split("**");if(arr_tmp[0]&&""+arr_tmp[0]!=""){if(x>=lm){fun_mselect("#elem_dxCodeAssoc_"+indx,"unselect",tmp);}}}}}}
sb_setDxCodeTitle($("#elem_dxCodeAssoc_"+indx)[0]);}
function sb_setDxCodeTitle(obj){var strtitle="";var cur_dxCode=""+fun_mselect(obj,'val');$(obj).find('option').each(function(){if(cur_dxCode.indexOf(""+$(this).val())!=-1){var tmp=(typeof($(this).data("desc"))!="undefined")?" - "+$(this).data("desc"):"";strtitle+=this.text+""+tmp+"\n";}});fun_mselect(obj,"settitle",strtitle);}
function sb_getProcId4del(){var flg=0;var str="";$("#superbill :hidden[name*=elem_procedureId_]").filter(function(){return this.value!=='';}).each(function(){if(str!=""){str+=",";}str+=""+this.value;});var s=$("#elem_proc_del_id").val();if(typeof(s)!="undefined"&&s!=""){if(str!=""){str+=",";}
str+=s;}
$("#elem_proc_del_id").val(str);}
var flgMultiVisitCodeShowOnce=[],flgcheckingMVC=0,flgMultiVisitCodeShowOnce_2=[];function checkCptCodesChart(obj,fOk){if(document.getElementById('tat_table'))return;var cptCd=$.trim(obj.value);var cptCdFull=$.trim(obj.value);if((obj.value!="")&&(cptCd.length>=2)){if(typeof fOk=="undefined"){var indx=cptCd.lastIndexOf("~!~");cptCd=(indx!=-1)?$.trim(cptCd.substring(0,indx)):cptCd;obj.value=cptCd;checkDB4Code(obj,"Cpt");return;}
if((typeof sb_testName=="undefined"||sb_testName=="")&&(typeof examName=="undefined"||examName!="Procedures")){var pTop=200;var pLeft=300;if(typeof gebi("elem_masterPtVisit")!="undefined"){var typeVisit=gebi("elem_masterPtVisit").value;}else{var typeVisit="";}
var cpt4cd=obj.getAttribute("cpt4code");var prcBillCd=$("#elem_practiceBillCode").val();if((prcBillCd=="992"&&((cpt4cd=="99205")||(cpt4cd=="99204")||(cpt4cd=="99203")||(cpt4cd=="99202")||(cpt4cd=="99201")||(cpt4cd=="99215")||(cpt4cd=="99214")||(cpt4cd=="99213")||(cpt4cd=="99212")||(cpt4cd=="99211")))||(cpt4cd=="92004")||(cpt4cd=="92002")||(cpt4cd=="92014")||(cpt4cd=="92012")){if(setVisitProcedure_nochk==1){setVisitProcedure_nochk=0;}else{obj.value="";decideLevelofService2_obj_id=obj.id;checkAssocPqri4All_checkvisitcode(cpt4cd);getMxSB();setSBTodayCharges();return;}}
if(($.trim(typeVisit).toUpperCase()=="FOLLOW-UP")&&((cpt4cd=="99205")||(cpt4cd=="99204")||(cpt4cd=="99203")||(cpt4cd=="99215")||(cpt4cd=="99214")||(cpt4cd=="99213")||(cpt4cd=="99245")||(cpt4cd=="99244")||(cpt4cd=="99243")||(cpt4cd=="92005")||(cpt4cd=="92004")||(cpt4cd=="92003")||(cpt4cd=="92015")||(cpt4cd=="92014")||(cpt4cd=="92013"))){var msgFollowUp="Visit Type is Follow-up.<br>Are you sure you want to code to next level?";if((obj.value!="")&&((cpt4cd=="99204")||(cpt4cd=="99205")||(cpt4cd=="99214")||(cpt4cd=="99215")||(cpt4cd=="99244")||(cpt4cd=="99245"))){var chkStr=checkChiefComplaintDetailed();if(chkStr=="false"){var msgFollowUp="1. You have not detailed minimum requirements of 4 points of the chief complaint<br>"+"2. Visit Type is Follow-up and you are coding to next level.<br>"+"Are you sure you would like to use the selected visit code? ";}}
zChiefCompElemName=obj.name;var title="Visit code comfirmation";var msg=""+msgFollowUp+"<BR>";var btn1="Yes";var btn2="No";var func="decideChiefComp";var oDiv;displayConfirmYesNo_v2(title,msg,btn1,btn2,func,0);}else if(($.trim(typeVisit).toUpperCase()=="CEE")&&((cpt4cd=="99201")||(cpt4cd=="99202")||(cpt4cd=="99203")||(cpt4cd=="99211")||(cpt4cd=="99212")||(cpt4cd=="99213")||(cpt4cd=="99241")||(cpt4cd=="99242")||(cpt4cd=="99243")||(cpt4cd=="92001")||(cpt4cd=="92002")||(cpt4cd=="92003")||(cpt4cd=="92011")||(cpt4cd=="92012")||(cpt4cd=="92013"))){}else{if((obj.value!="")&&((cpt4cd=="99204")||(cpt4cd=="99205")||(cpt4cd=="99214")||(cpt4cd=="99215")||(cpt4cd=="99244")||(cpt4cd=="99245"))){var chkStr=checkChiefComplaintDetailed();if(chkStr=="false"){zChiefCompElemName=obj.name;var msgPrompt="You have not detailed minimum requirements of 4 points of the chief complaint<br>"+"Are you sure you would like to use the selected visit code?";var title="Chief Complaint Requirement";var msg=""+msgPrompt+"<BR>";var btn1="Yes";var btn2="No";var func="decideChiefComp";var oDiv;displayConfirmYesNo_v2(title,msg,btn1,btn2,func,0);}}}
var tmp=chk_multi_visit_code_exist(obj);}
remif_multi_Ophtha_code_exist(obj);sb_checknwarn4WrongDxcode(obj);}else{obj.value=obj.title=obj.cpt4code="";obj.setAttribute("valid_dxcodes","");if($("#superbill .cptcode").filter(function(){return this.value!=='';}).length==0&&$("#superbill :hidden[name*=elem_procedureId_]").filter(function(){return this.value!=='';}).length>0){flg=confirm("You have removed all CPTs of this super bill ! Are you sure?");if(flg){sb_getProcId4del();}}}
var objsbnr=getMxSB(1);setSBTodayCharges();}
function chk_multi_visit_code_exist(obj){if(typeof(sb_multi_vst_cd_noalert)!="undefined"&&sb_multi_vst_cd_noalert==1){return true;}
if(obj.value!=""){var visit_code_arr=["92001","92011","92002","92012","92004","92014","99201","99202","99203","99204","99205","99241","99242","99243","99244","99245","99211","99212","99213","99214","99215"];var a=visit_code_arr.indexOf(obj.value);if(a!=-1){var cvc=0;var cvc_flg=0,cvc_flg_2=0;var strCptCodes="";var tmp_arCptCodes=[];$(".cptcode").each(function(){var tmp="";var tmp=$.trim($(this).attr("cpt4code"));if(typeof(tmp)=="undefined"||tmp==""){tmp=$.trim(this.value);}
if(tmp!=""){var a=visit_code_arr.indexOf(tmp);if(a!=-1){cvc=cvc+1;if(flgMultiVisitCodeShowOnce.indexOf(tmp+cvc)==-1){flgMultiVisitCodeShowOnce[flgMultiVisitCodeShowOnce.length]=tmp+cvc;cvc_flg=1;}
if(flgMultiVisitCodeShowOnce_2.indexOf(tmp+cvc)==-1){cvc_flg_2=1;if(strCptCodes!=""){strCptCodes+=",";}
strCptCodes+="'"+tmp+"'";tmp_arCptCodes[tmp_arCptCodes.length]=tmp;flgMultiVisitCodeShowOnce_2[flgMultiVisitCodeShowOnce_2.length]=tmp+cvc;}}}});if(cvc>=2&&cvc_flg==1){top.fAlert("Visit Code already exists for DOS "+$("#elem_dos").val());}else if(strCptCodes!=""&&cvc_flg_2==1){if(flgcheckingMVC==0){flgcheckingMVC=1;var url=zPath+"/chart_notes/requestHandler.php";var params="elem_formAction=checkMultiVisitCode";params+="&elem_strCptCodes="+strCptCodes;params+="&elem_superbillDOS="+$("#elem_dos").val();params+="&elem_encounterId="+$("#elem_masterEncounterId").val();$.get(url,params,function(data){if(data=="1"){top.fAlert("Visit Code already exists for DOS "+$("#elem_dos").val());}
flgcheckingMVC=0;});}}}}}
function has_ophtha_code(o){if($.trim(o.value)==""){return false;}
var code_arr=["92201","92202","92225","92226"];var obj4cd=$(o).attr("cpt4code");if(typeof(obj4cd)=="undefined"||obj4cd==""){obj4cd=$.trim(o.value);}
var a=code_arr.indexOf(obj4cd);return(a!=-1)?true:false;}
function chk_multi_Ophtha_code_exist(){var cvc=0,ret=false;$(".cptcode").each(function(){if(has_ophtha_code(this)){cvc=cvc+1;}});if(cvc>=2){ret=true;}
return ret;}
function remif_multi_Ophtha_code_exist(obj){if(has_ophtha_code(obj)){var res=chk_multi_Ophtha_code_exist();if(res==true){top.fAlert("Ophthalmoscopy Code already exists in this superbill!");obj.value=obj.title=obj.cpt4code="";}}}
function checkProcUnitsChart(obj){if(obj.name.indexOf("elem_procUnits_")!=-1){var n=$.trim(obj.value);obj.value=n;if((n=="")||!isFinite(n)||(n<=0)){top.fAlert("Units can not be less than zero.");obj.value="1";}
var idCpt=obj.name.replace(/elem_procUnits_/g,"elem_cptCode_");var oCpt=gebi(idCpt);if(oCpt&&($.trim(oCpt.value)!="")){var objsbnr=getMxSB();setSBTodayCharges();}}}
function show_asmt_site(obj,dx,fop){var ch=$(obj)[0].id;if(typeof(ch)=="undefined"||ch.indexOf("elem_assessment_dxcode")==-1){return;}
var op=0;if(typeof(fop)!='undefined'&&fop!=''){op=fop;}else{op=(typeof(dx)!='undefined'&&dx!=''&&dx.indexOf("-")==-1)?1:0;}
var indx=ch.replace(/elem_assessment_dxcode/,"");if(op==1){$("#el_amst_site"+indx).parent().removeClass("hidden");$("#elem_assessment"+indx).parent().removeClass("col-sm-12").addClass("col-sm-11");var s="";if($("#elem_apOu"+indx).prop("checked")){s="OU";}
else if($("#elem_apOd"+indx).prop("checked")){s="OD";}
else if($("#elem_apOs"+indx).prop("checked")){s="OS";}
$("#el_amst_site"+indx).val(""+s);}else{$("#el_amst_site"+indx).parent().addClass("hidden");$("#elem_assessment"+indx).parent().addClass("col-sm-12").removeClass("col-sm-11");$("#el_amst_site"+indx).val("");}}
function checkDXCodesChart(obj){if(document.getElementById('tat_table'))return;var dxCd=$.trim(obj.value);var icd10=$("#hid_icd10").val();if(icd10==1){if(dxCd==""){obj.title="";}}
var fOk=false;if((dxCd!="")&&(dxCd.length>=3)){if(dxCd.indexOf("-")==-1){$(obj).removeClass('mandatory');}else{}
checkDB4Code(obj,"Dx");}else{obj.value=obj.title="";$(obj).removeData("dxid");renew_title(obj,'');if(obj.id.indexOf("elem_dxCode")!=-1){sb_crt_dx_dropdown();}}}
function checkModCodesChart(obj){if(document.getElementById('tat_table'))return;var mdCd=$.trim(obj.value);var fOk=false;if((mdCd!="")&&(mdCd.length>=2)){checkDB4Code(obj,"Md");}else{obj.value="";setSBTodayCharges();}}
function checkSBDxCodeFilled(obj,num){var oDx=gebi("elem_dxCode_"+num);if(obj.checked==true){if(oDx){obj.checked=($.trim(oDx.value)!="")?true:false;}else{obj.checked=false;}}}
function insertExamsDoneSB(arrED){var mxSbId=gebi("elem_mxSBId").value;var eTblSb=$("#tblSuperbill").get(0);var lenArrED=arrED.length;var arrDxCodesNotUsed=new Array();for(var j=0;j<lenArrED;j++){if((typeof arrED[j]!="undefined")){var flag=true;var oRows=eTblSb.rows;var lenTbl=oRows.length;var cTryAgain=0;for(var b=0;b<lenTbl;b++){if(oRows[b]){var tCptId=oRows[b].id.replace(/elem_trSB/,"elem_cptCode_");var oCpt=gebi(tCptId);var cCpt=(oCpt)?$.trim(oCpt.value):null;if(oCpt&&(cCpt!="")&&(cCpt==arrED[j]["cpt"])){var tMdId=tCptId.replace(/elem_cptCode_/,"elem_modCode_");var curMd="",insrtMd="";for(var inMd=1;inMd<=4;inMd++){var oMd=gebi(tMdId+"_"+inMd);curMd+=((oMd)&&(typeof oMd.value!=""))?oMd.value:"";insrtMd+=(typeof arrED[j]["modifier"+inMd]!="undefined")?arrED[j]["modifier"+inMd]:"";}
var tUntId=tCptId.replace(/elem_cptCode_/,"elem_procUnits_");var curUnt="",insrtUnt="";var oUnt=gebi(tUntId);curUnt=((oUnt)&&(typeof oUnt.value!=""))?oUnt.value:"";insrtUnt=(typeof arrED[j]["units"]!="undefined")?arrED[j]["units"]:"";if(insrtMd==curMd&&curUnt==insrtUnt){if(cCpt=="92133"&&arrED[j]["norepeat"]==0){cTryAgain=cTryAgain+1;}else if(cCpt.indexOf("J")!=-1&&curMd=="JW"){}else{flag=false;break;}}}}}
if(cTryAgain>=2){flag=false;}
if(flag==true){var v_prc_o_visit=$("#elem_proc_only_visit").val();v_prc_o_visit=(typeof(v_prc_o_visit)!="undefined"&&v_prc_o_visit==1)?0:1;for(var k=v_prc_o_visit;k<lenTbl;k++){var rowId=oRows[k].id.replace(/elem_trSB/,"");var tCptId="elem_cptCode_"+rowId;var oCpt=gebi(tCptId);if(oCpt&&(($.trim(oCpt.value)==""))){oCpt.value=arrED[j]["cpt"];oCpt.title=arrED[j]["cptDesc"];if(typeof(arrED[j]["valid_dxcodes"])!="undefined"&&arrED[j]["valid_dxcodes"]!=""){oCpt.setAttribute("valid_dxcodes",""+arrED[j]["valid_dxcodes"]);}
var oMod=gebi("elem_modCode_"+(rowId)+"_1");if(oMod&&(typeof arrED[j]["modifier1"]!="undefined")){oMod.value=arrED[j]["modifier1"];}
var oMod=gebi("elem_modCode_"+(rowId)+"_2");if(oMod&&(typeof arrED[j]["modifier2"]!="undefined")){oMod.value=arrED[j]["modifier2"];}
var oMod=gebi("elem_modCode_"+(rowId)+"_3");if(oMod&&(typeof arrED[j]["modifier3"]!="undefined")){oMod.value=arrED[j]["modifier3"];}
var oMod=gebi("elem_modCode_"+(rowId)+"_4");if(oMod&&(typeof arrED[j]["modifier4"]!="undefined")){oMod.value=arrED[j]["modifier4"];}
var ounits=gebi("elem_procUnits_"+(rowId));if(ounits&&(typeof arrED[j]["units"]!="undefined")){ounits.value=arrED[j]["units"];}
var dxcntr=1;while(true){if(typeof(arrED[j]["dx"+dxcntr])!="undefined"){var indEmptyDxCd=null;var flgSet=false;for(var d=1;d<=12;d++){var oDx=gebi("elem_dxCode_"+d);if(oDx&&($.trim(oDx.value)!="")){var tdx=$.trim(oDx.value);var tdxId=$(oDx).data("dxid");if(typeof tdxId=="undefined"){tdxId="";}
var tdx1=tdx,tdx2=tdx,tdx3=tdx;if(arrED[j]["dx"+dxcntr].indexOf("-")!=-1){var tdx1=""+tdx.slice(0,-1)+"-";var tdx2=""+tdx.slice(0,-2)+"--";var tdx3=""+tdx.slice(0,-3)+"-x-";}
if(tdx==arrED[j]["dx"+dxcntr]||tdx1==arrED[j]["dx"+dxcntr]||tdx2==arrED[j]["dx"+dxcntr]||tdx3==arrED[j]["dx"+dxcntr]){var flgDxIdNM=1;if(tdxId!=""&&typeof arrED[j]["dx"+dxcntr+"Id"]!="undefined"&&$.trim(arrED[j]["dx"+dxcntr+"Id"])!=$.trim(tdxId)){flgDxIdNM=0;}
var oDxElem=gebi("elem_dxCodeAssoc_"+(rowId));if(oDxElem&&flgDxIdNM==1){sb_crt_dx_dropdown("#elem_dxCodeAssoc_"+(rowId),'',new Array(arrED[j]["dx"+dxcntr]));flgSet=true;break;}}}else if(oDx&&($.trim(oDx.value)=="")&&(indEmptyDxCd==null)){indEmptyDxCd=d;}}
if((flgSet==false)){if(indEmptyDxCd!=null){var oDx=gebi("elem_dxCode_"+indEmptyDxCd);var oDxElem=gebi("elem_dxCodeAssoc_"+(rowId));if(oDx){oDx.value=""+arrED[j]["dx"+dxcntr];var ttitle=(typeof arrED[j]["dx"+dxcntr+"Desc"]!="undefined")?""+arrED[j]["dx"+dxcntr+"Desc"]:"";renew_title(oDx,ttitle);var tdxid=(typeof arrED[j]["dx"+dxcntr+"Id"]!="undefined")?arrED[j]["dx"+dxcntr+"Id"]:"";$(oDx).data("dxid",tdxid);$(oDx).triggerHandler("blur");if(oDxElem){sb_crt_dx_dropdown("#elem_dxCodeAssoc_"+(rowId),'',new Array(arrED[j]["dx"+dxcntr]));flgSet=true;}}}else{var tmp=(typeof arrED[j]["dx"+dxcntr+"Desc"]!="undefined")?""+arrED[j]["dx"+dxcntr+"Desc"]:"";arrDxCodesNotUsed[arrDxCodesNotUsed.length]=new Array(arrED[j]["dx"+dxcntr],tmp);}}}else{break;}
dxcntr=dxcntr+1;if(dxcntr>50){break;}}
for(var ia=1;ia<=4;ia++){if(typeof arrED[j]["adx"+ia]!="undefined"&&arrED[j]["adx"+ia]!=""){for(var d=1;d<=12;d++){var oDx=gebi("elem_dxCode_"+d);if(oDx&&($.trim(oDx.value)!="")){var flgMtch=0;if($("#hid_icd10").val()=="1"){var p0=$.trim(""+arrED[j]["adx"+ia].toLowerCase());var q=q0=$.trim(""+oDx.value.toLowerCase());var q1=""+q0.slice(0,-1)+"-";var q2=""+q0.slice(0,-2)+"--";var q3=""+q0.slice(0,-3)+"-x-";if(q0==p0||q1==p0||q2==p0||q3==p0){flgMtch=1;}}else{if(($.trim(oDx.value)==arrED[j]["adx"+ia])){flgMtch=1;}}
if(flgMtch==1){var oDxElem=gebi("elem_dxCodeAssoc_"+(rowId));if(oDxElem){sb_crt_dx_dropdown("#elem_dxCodeAssoc_"+(rowId),'',new Array(arrED[j]["adx"+ia]));break;}}}}}}
if(sup_enc==1){opAddCptRow("LASTINDX",'','','',sup_enc);}else{opAddCptRow("LASTINDX");}
break;}}}}}
setSBTodayCharges();if(arrDxCodesNotUsed.length>0){}
var objsbnr=getMxSB(1);}
function getSelPQRICodes(actn){var oDiv=gebi("divChoosePqriCodes");if(actn==0){oDiv.style.display="none";return;}
var mxSbId=gebi("elem_mxSBId").value;var selectedCode=gebi("elem_procOrder").value;var oElems=oDiv.getElementsByTagName("INPUT");var len=oElems.length;var arrChoosenPqri=new Array();for(var i=0;i<len;i++){if((oElems[i].type=="checkbox")&&(oElems[i].checked==true)){var tmpCode=oElems[i].value;var tmpDx=oElems[i].getAttribute("dx");if(selectedCode.indexOf(tmpCode)==-1){arrChoosenPqri[arrChoosenPqri.length]=[tmpCode,tmpDx];}}}
oDiv.style.display="none";if(arrChoosenPqri.length>0){for(var x in arrChoosenPqri){var cpt=arrChoosenPqri[x][0];var dx=arrChoosenPqri[x][1];var tmpDesc=getCptDescJs(cpt);var oVal={"cptCode":cpt,"procId":"","units":1,"arrDx":[dx],"arrMd":new Array(),"cptDesc":tmpDesc};if(sup_enc==1){opAddCptRow(1,oVal,1,'',sup_enc);}else{opAddCptRow(1,oVal,1);}}}
var objsbnr=getMxSB(1);}
var setVisitProcedure_nochk=0;function setVisitProcedure(ccode)
{var mxSbId=gebi("elem_mxSBId").value;if(!isVisitCodeUsed(ccode)){return;}
var arrED=new Array();var arrtemp=new Array();arrtemp["cpt"]=ccode;arrED[arrED.length]=arrtemp;var cFlag=false;var eTblSb=gebi("tblSuperbill");var oRows=eTblSb.rows;var lenRows=oRows.length;for(var i=0;i<lenRows;i++){if(typeof oRows[i].id=="undefined"||oRows[i].id==""){continue;}
var tCptId=oRows[i].id.replace(/elem_trSB/,"elem_cptCode_");var oCpt=gebi(tCptId);var sCpt=$.trim(oCpt.value);if((sCpt=="92001")||(sCpt=="92011")||(sCpt=="92002")||(sCpt=="92012")||(sCpt=="92004")||(sCpt=="92014")||(sCpt=="99201")||(sCpt=="99202")||(sCpt=="99203")||(sCpt=="99204")||(sCpt=="99205")||(sCpt=="99241")||(sCpt=="99242")||(sCpt=="99243")||(sCpt=="99244")||(sCpt=="99245")||(sCpt=="99211")||(sCpt=="99212")||(sCpt=="99213")||(sCpt=="99214")||(sCpt=="99215")){sCpt="";}
if(oCpt&&(sCpt=="")){oCpt.value=ccode;oCpt.title=getCptDescJs(ccode);cFlag=true;setVisitProcedure_nochk=1;if(typeof oCpt.onblur=="function"){oCpt.onblur();}
for(var j=1;j<=12;j++){var oEDx=gebi("elem_dxCode_"+j);if(oEDx.value!=""){if(sb_objRefraction.isRef==1&&sb_objRefraction.dxCode==oEDx.value){continue;}
var oT=gebi("elem_dxCodeAssoc_"+(i+1));if(oT){sb_crt_dx_dropdown("#elem_dxCodeAssoc_"+(i+1),'',new Array(oEDx.value));}}}
break;}}
if(cFlag==false){var arrDx=new Array();for(var i=0;i<12;i++){var oEDx=gebi("elem_dxCode_"+(i+1));if(oEDx.value!=""){if(sb_objRefraction.isRef==1&&sb_objRefraction.dxCode==oEDx.value){continue;}
arrDx[arrDx.length]=""+oEDx.value;}}
var ccodeDesc=getCptDescJs(ccode);var oVal={"cptCode":ccode,"procId":"","units":1,"arrDx":arrDx,"arrMd":new Array(),"cptDesc":ccodeDesc};opAddCptRow(mxSbId,oVal);}}
var decodePatientCategory=1;function getPatientCategoryCode(str,pracbillcode)
{category=false;if((decodePatientCategory==1)&&(str!=null))
{switch(str)
{case"New":case"0":category="0";break;case"Establish":case"1":category="1";break;case"Consult":case"2":case"4":category="4";if(pracbillcode==920){var newpt=$("#elem_ptcategory_consult").val();category=1;if(newpt==0||newpt=="New"){category="0";}}
break;}}
return category;}
function decideNewPatient(obj)
{var val=obj.value;if($("input[type=checkbox][id*=el_sb_pt_type_]").length>0){$("input[type=checkbox][id*=el_sb_pt_type_]").each(function(inx){if(obj.checked&&this.value!=val&&this.checked){this.checked=false;}});var val=$(":checked[id*=el_sb_pt_type_]").val();if(typeof(val)=="undefined"||val==""){val="No_confirmed";}}
var ctop=top;if(top.fmain){ctop=top.fmain;}
var objCategory=gebi("elem_category");if((val=="1")||(val=="Yes")||(val=="Yes_confirmed"))
{objCategory.value="New";decodePatientCategory=1;}
else
{objCategory.value="Establish";decodePatientCategory=1;}
if((val=="Yes_confirmed")||(val=="No_confirmed")){$("#elem_flgIsPtNew").val(val);var oPBC=gebi("elem_practiceBillCode");var oComp=gebi("elem_levelComplexity");if((oComp&&oComp.value!="")||oPBC.value=="920"||$("#elem_post_op_visit").val()=="1"||$("#elem_proc_only_visit").val()=="1"){if(typeof(flg_checkAssocPqri4All_checkvisitcode)!="undefined"&&flg_checkAssocPqri4All_checkvisitcode!=0&&flg_checkAssocPqri4All_checkvisitcode!=""){checkAssocPqri4All_checkvisitcode(flg_checkAssocPqri4All_checkvisitcode);}else{checkAssocPqri4All();}}
return;}
if((val=="Yes")||(val=="No")){confirmVisitCode_v3();}else{confirmVisitCode_v2();}}
var decideLevelofService2_obj_id;function decideLevelofService2(val)
{if((val!="-1")&&($.trim(val)!="")&&($.trim(val)!="OK")){if(val=="Eye Code"){val=$(":checked[id*=lb_qlfy_lvl_code920]").eq(0).val();}else if(val=="EM Code"){val=$(":checked[id*=lb_qlfy_lvl_code992]").eq(0).val();}
setVisitCode(val,decideLevelofService2_obj_id);}
decideLevelofService2_obj_id="";$("#dialog-Mdc-cum-new-pt").remove();}
function getVisitCode()
{var objPracticeBillCode=gebi("elem_practiceBillCode");var objCategory=gebi("elem_category");var objLevelOfService=gebi("elem_levelOfService");var objVisitCode=gebi("elem_visitCode");var visitCode=category="";if(objCategory.value!=null&&objPracticeBillCode!=null)
{category=getPatientCategoryCode(objCategory.value,objPracticeBillCode.value);}
if(objPracticeBillCode&&objCategory&&objLevelOfService&&objVisitCode)
{visitCode=objPracticeBillCode.value+category+objLevelOfService.value;}
var ptrn="^[0-9]{5}$";var reg=new RegExp(ptrn,"g");var iscodeOk=visitCode.match(reg);return(iscodeOk)?visitCode:false;}
function setVisitCode(val,flg_chk_mlti){var objVisitCode=gebi("elem_visitCode");var vCode=(typeof val!="undefined")?val:false;if(vCode!=false){if(typeof(flg_chk_mlti)!="undefined"&&flg_chk_mlti!=""){setVisitProcedure_nochk=1;checkDB4Code_chk_versions=1;$("#"+flg_chk_mlti).val(vCode).triggerHandler("blur");}
else{checkDB4Code_chk_versions=1;objVisitCode.value=vCode;objVisitCode.onchange();}
var objsbnr=getMxSB();setSBTodayCharges();fun_mselect('.selectpicker','width');}}
function isVisitCodeUsed(cCd){if(typeof(sb_multi_vst_cd_noalert)!="undefined"&&sb_multi_vst_cd_noalert==1){return true;}
var selectedCode=gebi("elem_procOrder").value;if(selectedCode.indexOf(cCd)!=-1)
{top.fAlert("CPT Code "+cCd+" is already selected.");return false;}
return true;}
function setVisitCodeFinal(objElem)
{var ptrn="^[0-9]{5}$";var reg=new RegExp(ptrn,"g");var matched=objElem.value.match(reg);if(matched)
{if(isVisitCodeUsed(objElem.value)){setVisitProcedure(objElem.value);}}else if(objElem.value==sb_cpt_code_poe){setVisitProcedure(objElem.value);}}
function getWantedDxCodes(flgnw){var oDivDxCode=gebi("divChooseDxCodes");var oElem=oDivDxCode.getElementsByTagName("INPUT");var len=oElem.length;var strdx="",dsc_tmp="";var arr=new Array(),arr_id=new Array();for(i=0;i<len;i++){if(oElem[i].name.indexOf("Lat")!=-1||oElem[i].name.indexOf("Svr")!=-1||oElem[i].name.indexOf("Stg")!=-1){continue;}
var t_dxid=$.trim($(oElem[i]).data("dxid"));if(typeof(t_dxid)=="undefined"||t_dxid==""){t_dxid="";}
if((oElem[i].type=="checkbox")&&(oElem[i].checked==true)){if(($.trim(oElem[i].value)!=""&&(arr.indexOf(oElem[i].value)==-1||(t_dxid!=""&&arr_id.indexOf(t_dxid)==-1)))&&$(oElem[i]).parents("tr").css("display")!="none"){arr[arr.length]=oElem[i].value;arr_id[arr_id.length]=t_dxid;}}else if((oElem[i].type=="text")&&(oElem[i].value!="")){if(arr.indexOf(oElem[i].value)==-1||(t_dxid!=""&&arr_id.indexOf(t_dxid)==-1)){arr[arr.length]=oElem[i].value;arr_id[arr_id.length]=t_dxid;}}}
if(arr.length>12){top.fAlert("You can choose maximum twelve dx codes.");}else{for(var i=0,j=0;j<12;j++){var oDxCode=gebi("elem_dxCode_"+(i+1));var tmp=((typeof arr[j]!="undefined"))?$.trim(arr[j]):"";var tmp_dxid=((typeof arr_id[j]!="undefined"))?$.trim(arr_id[j]):"";if((oDxCode)&&(($.trim(oDxCode.value)=="")||(typeof oDxCode.value=="undefined"))&&((typeof tmp!="undefined")&&(tmp!=""))){dx_exist=0;$("input[name^='elem_dxCode_']").each(function(index,element){if($(this).val()!=""&&$(this).val()==tmp&&$(this).data("dxid")==tmp_dxid){dx_exist=1;}});if(dx_exist==0){oDxCode.value=tmp;$(oDxCode).data("dxid",tmp_dxid);if(strdx!=""){strdx+=",";}
strdx+=tmp;i++;}}else{}}
oDivDxCode.style.display="none";setTimeout(function(){set_dx_code_titles();},100);if(typeof(flgnw)!="undefined"&&flgnw=="get_proc_dx_codes"){ogetprocdxcodes.dx=strdx.split(",");fill_codes_in_proc_sb(ogetprocdxcodes);}else{checkAssocPqri4All();}}}
function isSuperBillMade(){var SBill=false;var DXCodeOK=false;var DXCodeAssocOK=true;var CptNotAssoc="";var DXCodeComplete=true;var dxids="";var c_ophth_cd=0;var tbl=$("#tblSuperbill").get(0);if(tbl){var len=(gebi("elem_mxSBId"))?gebi("elem_mxSBId").value:0;var lastRow=(tbl.length>0)?tbl.rows.length:0;len=(typeof len=="undefined")?0:len;for(var i=0;i<len;i++){var tmp=gebi("elem_trSB"+(i+1));if(tmp==null){continue;}
var temp=gebi("elem_cptCode_"+(i+1));if(($.trim(temp.value)!="")){SBill=true;var tempAssoc=false;var elemDxAssoc=$("#elem_dxCodeAssoc_"+(i+1));var valDxAssoc=""+fun_mselect("#elem_dxCodeAssoc_"+(i+1),'val');if(valDxAssoc!=null&&typeof(valDxAssoc)!="undefined"&&$.trim(valDxAssoc)!=""&&valDxAssoc.indexOf("-")==-1){tempAssoc=true;}
if(tempAssoc==false){DXCodeAssocOK=false;CptNotAssoc+="\n\t-"+temp.value+"";}
if(has_ophtha_code(temp)){c_ophth_cd=c_ophth_cd+1;}}}
if(SBill==true){for(var i=0;i<12;i++){var oDxCode=$("#elem_dxCode_"+(i+1));var t=$.trim(oDxCode.val());var tdx="";if((t!="")){DXCodeOK=true;if(t.indexOf("-")!=-1){DXCodeComplete=false;}
var dxid=oDxCode.data("dxid");if(typeof(dxid)!="undefined"&&dxid!=""){tdx=dxid;}}
dxids=dxids+""+tdx+";";}}
var mul_ophth_cd=(c_ophth_cd>=2)?true:false;}
return{"SBill":SBill,"DXCodeOK":DXCodeOK,"DXCodeAssocOK":DXCodeAssocOK,"CptNotAssoc":CptNotAssoc,"DXCodeComplete":DXCodeComplete,"dxids":dxids,"mul_ophth_cd":mul_ophth_cd};}
function promptMedDecCom(opSB){var flg=0;if(opSB=="1"){flg=1;}
var oPrnt=top.fmain;var strPrnt="top.fmain";if(typeof(wpage)!="undefined"&&wpage=="accSB"){oPrnt=top;strPrnt="top";}
var msg=""+"<label style=\"width:250px;display:inline-block;\"><b>Medical Decision Complexity :</b> </label>"+"<div id=\"divmdc\" style=\"\">"+"<input type=\"checkbox\" id=\"elem_chkMedComp_Strght\" value=\"1\" onclick=\""+strPrnt+".setMedComplexity(this,"+flg+")\"><label for=\"elem_chkMedComp_Strght\" >Straight Forward</label>"+"<input type=\"checkbox\" id=\"elem_chkMedComp_Low\" value=\"2\" onclick=\""+strPrnt+".setMedComplexity(this,"+flg+")\"><label for=\"elem_chkMedComp_Low\" >Low Complexity</label>"+"<input type=\"checkbox\" id=\"elem_chkMedComp_Moderate\" value=\"3\" onclick=\""+strPrnt+".setMedComplexity(this,"+flg+")\"><label for=\"elem_chkMedComp_Moderate\" >Moderate Complexity</label>"+"<input type=\"checkbox\" id=\"elem_chkMedComp_High\" value=\"4\" onclick=\""+strPrnt+".setMedComplexity(this,"+flg+")\"><label for=\"elem_chkMedComp_High\" >High Complexity</label>"+"<input type=\"checkbox\" id=\"elem_chkMedComp_procovisit\" value=\"5\" onclick=\""+strPrnt+".setMedComplexity(this,"+flg+")\"><label for=\"elem_chkMedComp_procovisit\" >Procedure only Visit</label><br/>"+"<input type=\"checkbox\" id=\"elem_chkMedComp_postopvisit\" value=\"6\" onclick=\""+strPrnt+".setMedComplexity(this,"+flg+")\"><label for=\"elem_chkMedComp_postopvisit\" style=\"float:right;margin-top:10px;\" >Post Op Visit</label>"+"</div>"+"";return""+msg;}
function sb_check_dx_in_icd10(str_n,str_h){flgMtch=0;if($("#hid_icd10").val()=="1"){var p0=$.trim(""+str_n.toLowerCase());var q=q0=$.trim(""+str_h.toLowerCase());var q1=""+q0.slice(0,-1)+"-";var q2=""+q0.slice(0,-2)+"--";var q3=""+q0.slice(0,-3)+"-x-";var p1=""+p0.slice(0,-1)+"-";var p2=""+p0.slice(0,-2)+"--";var p3=""+p0.slice(0,-3)+"-x-";if(q0==p0||q1==p0||q2==p0||q3==p0||q0==p1||q0==p2||q0==p3){flgMtch=1;}
else if(q0.indexOf(p0)!=-1||q1.indexOf(p0)!=-1||q2.indexOf(p0)!=-1||q3.indexOf(p0)!=-1||p0.indexOf(q0)!=-1||p1.indexOf(q0)!=-1||p2.indexOf(q0)!=-1||p3.indexOf(q0)!=-1){flgMtch=1;}}
return flgMtch;}
function sb_crt_dx_dropdown(objid,flgSetEmpty,arrmoresel,olddx){var all_rec=new Array;var all_rec_title=new Array;var all_rec_old=new Array;var all_rec_id=new Array;var ptrnChckd=".dxallcodes[id*=elem_dxCode_]";$(""+ptrnChckd).each(function(){if($(this).val()!=""){all_rec.push($(this).val());var tdsc=$(this).attr("data-original-title");if(typeof(tdsc)=="undefined"||$.trim(tdsc)==""){tdsc=$(this).attr("title");if(typeof(tdsc)=="undefined"){tdsc="";}}
all_rec_title.push(tdsc);var tmpid=$(this).attr("id");var oldid=tmpid.replace("elem_dxCode","dx_oldCode");all_rec_old.push($("#"+oldid).val());var tdxid=$(this).data("dxid");if(typeof(tdxid)=="undefined"){tdxid="";}
all_rec_id.push(tdxid);}else{all_rec.push('');all_rec_title.push('');all_rec_old.push('');all_rec_id.push('');}});var txtRec="";var txtRecTitle="";var txtRecOld="";var txtRecId="";var all_rec_tmp=[];var all_rec_title_tmp=[];var all_rec_old_tmp=[];var all_rec_id_tmp=[];for(var s=0;s<12;s++){var tmpRec=$.trim(all_rec[s]);var tmpRecid=$.trim(all_rec_id[s]);var tmpRecTitle=$.trim(all_rec_title[s]);var tchk=tmpRec+tmpRecTitle+",";var tmpRecOld=$.trim(all_rec_old[s]);if(tmpRec!=""&&txtRec.indexOf(tchk)==-1){txtRec+=tchk;all_rec_tmp[s]=tmpRec;all_rec_id_tmp[s]=tmpRecid;all_rec_title_tmp[s]=tmpRecTitle;all_rec_old_tmp[s]=tmpRecOld;}}
all_rec=all_rec_tmp;all_rec_title=all_rec_title_tmp;all_rec_old=all_rec_old_tmp;all_rec_id=all_rec_id_tmp;var ptrn="select.diagText_all_css";if(typeof(objid)=="string"&&objid!=""){ptrn=objid;}
$(""+ptrn).each(function(){if(this.type!="select-multiple"){return true;}
var all_opt_data="";var dd_title="";if(flgSetEmpty!=1){var sel_val_arr=fun_mselect(this,'val');}
if(typeof(arrmoresel)!="undefined"&&arrmoresel!=""&&arrmoresel.length>0){if(typeof(sel_val_arr)=="undefined"||sel_val_arr==null||sel_val_arr==''){var sel_val_arr=[];}
sel_val_arr=sel_val_arr.concat(arrmoresel);}
if(typeof sel_val_arr!="undefined"&&sel_val_arr!=null&&sel_val_arr!=''){for(x in all_rec){if(all_rec[x]!=""){var sel_opt="";var yy=parseInt(x)+1;var chk_sel_rec=all_rec[x]+'**'+yy;var chk_sel_rec2=all_rec[x];if(typeof(olddx)!="undefined"&&olddx==1){var chk_sel_rec_old=all_rec_old[x]+'**'+yy;var chk_sel_rec2_old=all_rec_old[x];if($.inArray(chk_sel_rec_old,sel_val_arr)!=-1||$.inArray(chk_sel_rec2_old,sel_val_arr)!=-1){sel_opt="selected";}}else{if($.inArray(chk_sel_rec,sel_val_arr)!=-1||$.inArray(chk_sel_rec2,sel_val_arr)!=-1){sel_opt="selected";}else{for(var cc in sel_val_arr){var str_n=""+sel_val_arr[cc].split("**")[0];if(sb_check_dx_in_icd10(str_n,chk_sel_rec2)){sel_opt="selected";}}}}
var chk_title=all_rec_title[x];if(typeof(chk_title)=="undefined"){chk_title="";}
if(sel_opt=="selected"){dd_title+=""+all_rec[x]+" - "+chk_title+"\n";}
all_opt_data+='<option value="'+chk_sel_rec+'" '+sel_opt+' data-desc="'+chk_title+'"  >'+all_rec[x]+'</option>';}}}else{for(x in all_rec){if(all_rec[x]!=""){var yy=parseInt(x)+1;var chk_title=all_rec_title[x];if(typeof(chk_title)=="undefined"){chk_title="";}
all_opt_data+='<option value="'+all_rec[x]+'**'+yy+'" data-desc="'+chk_title+'" >'+all_rec[x]+'</option>';}}}
var tmpid=$(this).attr("id");$("#"+tmpid).attr("title",dd_title).attr("data-original-title",dd_title).html(all_opt_data);fun_mselect("#"+tmpid,'refresh');if(dd_title==""){fun_mselect("#"+tmpid,'settitle','');}});fun_mselect('.selectpicker','width');}
function sb_set_dx_typeahead_icd10(action){getDataFilePath="../common/getICD10data.php";for(var j=1;j<=12;j++){if(document.getElementById('enc_icd10').value==1){bind_autocomp($("#elem_dxCode_"+j),getDataFilePath);$('.diagText_span_'+j).css({"display":"table-cell"});}}}
function sb_copy_dx_codes(flgfrst){sb_cw4WD_flgnoalert=1;var copyvalues=[];$(".cptcode").each(function(){var id=this.id;var val=$.trim(this.value);var indx=id.replace("elem_cptCode_","");if(indx=="1"){copyvalues=fun_mselect("select[id=elem_dxCodeAssoc_"+indx+"]",'val');if(typeof(flgfrst)!="undefined"&&flgfrst==1){copyvalues.length=1;}}else{if(val==""){}else{if(copyvalues.length>0){fun_mselect("select[id=elem_dxCodeAssoc_"+indx+"]",'select',copyvalues);}}
fun_mselect("select[id=elem_dxCodeAssoc_"+indx+"]",'render');}
sb_checknwarn4WrongDxcode(this);});fun_mselect('.selectpicker','width');sb_cw4WD_flgnoalert="";}
function icd10_charts_popup(show_pop,obj,str,input_id){var str_val=(str.toLowerCase()).replace(">>","");if(show_pop==1){if(js_icd10_charts_data_arr){if($("#dialog-msg-charts").length<=0){$("body").append(js_icd10_charts_data_arr[str_val]);}
if(str_val=='congenital'){var wid=815;}else{var wid=500;}
$("#dialog-msg-charts").show().dialog({modal:true,width:wid,buttons:{Done:function(){icd10_charts_popup(0,'','',input_id);},Cancel:function(){$(this).dialog("destroy");$("#dialog-msg-charts").remove();}}});}}else{if(obj.id){var charts_chk_box_id=obj.id;if(($('#dialog-msg-heading').val()).toLowerCase()=="congenital"){$('label[for='+charts_chk_box_id+']').css({"color":"red","font-weight":"bold"}).addClass("highlight");$(".elem_sub_cong").each(function(){if(this.id!=charts_chk_box_id||$('#'+charts_chk_box_id).is(':checked')==false){$('label[for='+this.id+']').css({"color":"purple","font-weight":"normal"}).removeClass("highlight");this.checked=false;}});}else{if(obj.value.toLowerCase()=="unspecified"){if($('#'+charts_chk_box_id).is(':checked')==true){$(".unspecified_css").each(function(){$('label[for='+this.id+']').css({"color":"gray","font-weight":"normal"}).removeClass("highlight");this.checked=false;});}else{$(".unspecified_css").each(function(){$('label[for='+this.id+']').css({"color":"purple","font-weight":"normal"});});}}else if(obj.value.toLowerCase()=="alternating"){if($('#'+charts_chk_box_id).is(':checked')==true){$(".unspecified_css").each(function(){$('label[for='+this.id+']').css({"color":"purple","font-weight":"normal"});});$(".alternating_css").each(function(){$('label[for='+this.id+']').css({"color":"gray","font-weight":"normal"}).removeClass("highlight");this.checked=false;});}else{$(".unspecified_css").each(function(){$('label[for='+this.id+']').css({"color":"purple","font-weight":"normal"});});}}else{if($('#elem_sub_unspecified').is(':checked')==true){if(obj.value.toLowerCase()!="monocular"&&obj.value.toLowerCase()!="alternating"){$(".unspecified_css").each(function(){this.checked=false;});return;}else{$(".unspecified_css").each(function(){$('label[for='+this.id+']').css({"color":"purple","font-weight":"normal"});});}}else if($('#elem_sub_alternating').is(':checked')==true){if(obj.value.toLowerCase()=="left"||obj.value.toLowerCase()=="right"){$(".alternating_css").each(function(){this.checked=false;});return;}else{if(obj.value.toLowerCase()=="monocular"){$(".unspecified_css").each(function(){$('label[for='+this.id+']').css({"color":"purple","font-weight":"normal"});});}}}}
if(obj.value.toLowerCase()=="unspecified"||obj.value.toLowerCase()=="monocular"||obj.value.toLowerCase()=="alternating"){$('label[for='+charts_chk_box_id+']').css({"color":"red","font-weight":"bold"}).addClass("highlight");$(".elem_sub_charts1").each(function(){if(this.id!=charts_chk_box_id||$('#'+charts_chk_box_id).is(':checked')==false){$('label[for='+this.id+']').css({"color":"purple","font-weight":"normal"}).removeClass("highlight");this.checked=false;}});}
if(obj.value.toLowerCase()=="a"||obj.value.toLowerCase()=="v"||obj.value.toLowerCase()=="intermittent"){$('label[for='+charts_chk_box_id+']').css({"color":"red","font-weight":"bold"}).addClass("highlight");$(".elem_sub_charts2").each(function(){if(this.id!=charts_chk_box_id||$('#'+charts_chk_box_id).is(':checked')==false){$('label[for='+this.id+']').css({"color":"purple","font-weight":"normal"}).removeClass("highlight");this.checked=false;}});}
if(obj.value.toLowerCase()=="right"||obj.value.toLowerCase()=="left"){$('label[for='+charts_chk_box_id+']').css({"color":"red","font-weight":"bold"}).addClass("highlight");$(".elem_sub_charts3").each(function(){if(this.id!=charts_chk_box_id||$('#'+charts_chk_box_id).is(':checked')==false){$('label[for='+this.id+']').css({"color":"purple","font-weight":"normal"}).removeClass("highlight");this.checked=false;}});}}}else{var charts_val1="";var charts_val2="";var charts_val3="";var main_charts_val=$('#dialog-msg-heading').val();main_charts_val=main_charts_val.toLowerCase();if(main_charts_val=="congenital"){var full_ass_id=input_id.replace("elem_assessment_dxcode","");full_ass_id=full_ass_id.replace("elem_assessment","");var ass_id="elem_assessment"+full_ass_id;var ass_dx_id="elem_assessment_dxcode"+full_ass_id;$(".elem_sub_cong").each(function(){var charts_chk_box_id=this.id;if($('#'+charts_chk_box_id).is(':checked')==true){var charts_val_ass_dx=$('#'+charts_chk_box_id).val();var charts_val_ass=$('#'+charts_chk_box_id+"_desc").val();$('#'+ass_id).val(charts_val_ass);$('#'+ass_dx_id).val(charts_val_ass_dx);$("#dialog-msg-charts").remove();return;}});}else{var selected_opt_arr=new Array();var arr_i=0;selected_opt_arr[arr_i]=main_charts_val;$(".elem_sub_charts1").each(function(){var charts_chk_box_id=this.id;if($('#'+charts_chk_box_id).is(':checked')==true){charts_val1=$('#'+charts_chk_box_id).val();arr_i++;selected_opt_arr[arr_i]=charts_val1;}});$(".elem_sub_charts2").each(function(){var charts_chk_box_id=this.id;if($('#'+charts_chk_box_id).is(':checked')==true){charts_val2=$('#'+charts_chk_box_id).val();arr_i++;selected_opt_arr[arr_i]=charts_val2;}});$(".elem_sub_charts3").each(function(){var charts_chk_box_id=this.id;if($('#'+charts_chk_box_id).is(':checked')==true){charts_val3=$('#'+charts_chk_box_id).val();arr_i++;selected_opt_arr[arr_i]=charts_val3;}});for(var j=0;j<=js_icd10_charts_all_data_arr[main_charts_val].length;j++){var dx_flag_cont=0;if(typeof(js_icd10_charts_all_data_arr[main_charts_val][j])!="undefined"){var dx_org_val=js_icd10_charts_all_data_arr[main_charts_val][j].split('>>>');}else{var full_ass_id=input_id.replace("elem_assessment_dxcode","");full_ass_id=full_ass_id.replace("elem_assessment","");var ass_id="elem_assessment"+full_ass_id;var v=$("#"+ass_id).val();if(typeof(v)=="undefined"){v="";}
if(v!=""){v=v.replace(/>/g,'');$("#"+ass_id).val(v);}
$("#dialog-msg-charts").remove();return;}
var dx_org_val=js_icd10_charts_all_data_arr[main_charts_val][j].split('>>>');var dx_org_val_desc_spt=dx_org_val[0].split(',');var dx_org_val_desc="";for(var g=0;g<dx_org_val_desc_spt.length;g++){dx_org_val_desc+=dx_org_val_desc_spt[g];}
var dx_org_val_desc_exp=dx_org_val_desc.split(' ');if(dx_org_val[1]!=""){var dx_org_val_code=dx_org_val[1];for(var k=0;k<=dx_org_val_desc_exp.length;k++){var dx_org_val_desc_exp_final=dx_org_val_desc_exp[k];for(var l=0;l<selected_opt_arr.length;l++){if(selected_opt_arr[l]!=""){if(selected_opt_arr[l]==dx_org_val_desc_exp_final){dx_flag_cont=parseInt(dx_flag_cont)+1;}}}}}
if(selected_opt_arr.length==dx_flag_cont){var full_ass_id=input_id.replace("elem_assessment_dxcode","");full_ass_id=full_ass_id.replace("elem_assessment","");var ass_id="elem_assessment"+full_ass_id;var ass_dx_id="elem_assessment_dxcode"+full_ass_id;var elem_sub_ass_comm="";if($('#elem_sub_ass_comm').val()!=""){elem_sub_ass_comm=" ; \n"+$('#elem_sub_ass_comm').val();}
$('#'+ass_id).val(dx_org_val[0]+elem_sub_ass_comm);$('#'+ass_dx_id).val(dx_org_val_code);$("#dialog-msg-charts").remove();$("#"+ass_id).triggerHandler("click");$("#"+ass_id).triggerHandler("blur");$("#"+ass_id).triggerHandler("change");$("#"+ass_id).triggerHandler("keyup");return;}}}}}}
function isVisitCodeExits(){if(typeof(sb_cpt_code_poe)=="undefined"){sb_cpt_code_poe="";}
var allVisCd=["999",""+sb_cpt_code_poe,"92002","92012","92004","92014","99201","99202","99203","99204","99205","99211","99212","99213","99214","99215","99241","99242","99243","99244","99245","99024"];var ret=-1;var ln=$(".cptcode").length;for(var i=0;i<ln;i++){var v=$(".cptcode").eq(i).val();if(v!=""){if(allVisCd=="")continue;if(jQuery.inArray(v,allVisCd)!=-1){return 1;}else{ret=0;}}}
return ret;}
var set_multi_version_cpt_id;function set_multi_version_cpt(s){if(s==1&&typeof(set_multi_version_cpt_id)!="undefined"&&set_multi_version_cpt_id!=""){var x=$("#dialog-confirm :checked[name=el_multi_version_cpts]").val();if(typeof(x)!="undefined"&&x!=""){$("#"+set_multi_version_cpt_id).val(x).triggerHandler("blur");}}}
var checkDB4Code_flg=0;checkDB4Code_chk_versions="";function checkDB4Code(obj,str,type,cnfrm){if(cnfrm&&typeof(obj)=="string"){obj=document.getElementById(obj);}
if($.trim(obj.value).length==0||checkDB4Code_flg==1)
{return;}
var chk_versions=checkDB4Code_chk_versions;var type_chk=type;if(type_chk=="account"){var url=zPath+"/chart_notes/requestHandler.php";var elem_dxCode="diag1Text_";var elem_asDx="diag1Text_";}else if(type_chk=="superbill"){var url=zPath+"/chart_notes/requestHandler.php";var elem_dxCode=obj.name;var elem_asDx=obj.name;var elem_assessment_dxcode=obj.name;}else if(type_chk=="Procedures"){var url=zPath+"/chart_notes/requestHandler.php";var elem_dxCode=obj.name;var elem_asDx=obj.name;var elem_assessment_dxcode=obj.name;}else{var url=(typeof(wpage)!="undefined"&&wpage=="accSB")?zPath+"/chart_notes/requestHandler.php":zPath+"/chart_notes/requestHandler.php";var elem_dxCode="elem_dxCode_";var elem_asDx="elem_asDx";var elem_assessment_dxcode="elem_assessment_dxcode";}
var params={"elem_formAction":str,"elem_desc":encodeURI(obj.value),"check_versions":chk_versions};var icd10=($("#hid_icd10").length>0)?$("#hid_icd10").val():$("#enc_icd10").val();if(icd10==1){params.ICD10=1;}
if(typeof(setProcessImg)!='undefined')setProcessImg("1","tblSuperbill");if(checkDB4Code_flg==0){checkDB4Code_flg=1;}
if((obj.name.indexOf(elem_dxCode)==-1)&&(obj.name.indexOf(elem_asDx)==-1)&&(obj.name.indexOf(elem_assessment_dxcode)==-1)&&type_chk!="account"){$.post(url,params,function(data){checkDB4Code_chk_versions="";if(typeof(setProcessImg)!='undefined')setProcessImg("0","tblSuperbill");checkDB4Code_flg=0;var strTmp=data.code;strTmp=(strTmp)?$.trim(strTmp):"";if(strTmp!=""){if(str=="Cpt"&&data.all_version&&data.all_version.length>0){var msg="";for(var x in data.all_version){if(typeof(data.all_version[x])!="undefined"&&data.all_version[x]!=""){msg+="<div class=\"radio radio-inline\"><input type=\"radio\" name=\"el_multi_version_cpts\" id=\"el_multi_version_cpts"+x+"\" value=\""+data.all_version[x]+"\" ><label for=\"el_multi_version_cpts"+x+"\">"+data.all_version[x]+"</label></div>";}}
if(msg!=""){set_multi_version_cpt_id=obj.id;obj.value="";displayConfirmYesNo_v2("Multiple versions of CPT exists. Choose one.",""+msg,"Insert","","set_multi_version_cpt","",0);return;}}
obj.value=strTmp;if(data.desc)obj.title=data.desc;if(str=="Cpt"){if(data.units){var unitId=obj.name.replace(/elem_cptCode_/i,"elem_procUnits_");var tmp=$("#"+unitId).data("unit");if(typeof(tmp)!="undefined"&&tmp!=""){data.units=tmp;}
$("#"+unitId).val(""+data.units);}
var mId=obj.name.replace(/elem_cptCode_/i,"elem_modCode_");var tmod="";for(var m=1,n=0;m<=4;m++){var t=$.trim($("#"+mId+"_"+m).val());if(tmod.indexOf(t)!=-1){$("#"+mId+"_"+m).val("");}
if(data.mod&&data.mod[n]){if(typeof(t)=="undefined"||t==""){$("#"+mId+"_"+m).val(""+data.mod[n]);tmod+=""+data.mod[n]+",";n++;}else{if(t==data.mod[n]){tmod+=""+data.mod[n]+",";n++;}}}}
if(data.cpt4_code){obj.setAttribute("cpt4code",data.cpt4_code);}
if(data.dx_codes){obj.setAttribute("valid_dxcodes",data.dx_codes);}else{obj.setAttribute("valid_dxcodes","");}
checkCptCodesChart(obj,1);}else if(str=="Md"){setSBTodayCharges();}}else{if(typeof(cnfrm)=="undefined"){if(top.fmain){top.fancyConfirm("Entered Text Does not match with any code.<br />Do you want to use this?",'','','top.fmain.checkDB4Code("'+obj.id+'","'+str+'", "'+type+'",true)');}
else{top.fancyConfirm("Entered Text Does not match with any code.<br />Do you want to use this?",'','','top.checkDB4Code("'+obj.id+'","'+str+'", "'+type+'",true)');}
return;}
else{obj.value=obj.title=obj.cpt4code="";obj.setAttribute("valid_dxcodes","");}}},'json');}
else{var dxid=$(obj).data("dxid");if(typeof(dxid)!="undefined"){dxid=$.trim(dxid);if($.trim(dxid)!=""&&$.trim(dxid)!="0"){params.dxid=dxid;}}
$.post(url,params,function(data){if(typeof(setProcessImg)!='undefined')setProcessImg("0","tblSuperbill");checkDB4Code_flg=0;var xmlDoc=data;var arrDxCode=xmlDoc.getElementsByTagName("dxcode");var arrDxCodeDesc=xmlDoc.getElementsByTagName("dxcodedesc");var arrPqriCode=xmlDoc.getElementsByTagName("pqri");var arrDxCode_multi=xmlDoc.getElementsByTagName("otherdxCodes_multi");var arrDxCode_incomp=xmlDoc.getElementsByTagName("incomplete");var oDxCode=(arrDxCode.length>0)?xmlDoc.getElementsByTagName("dxcode")[0]:null;var oDxCodeDesc=(arrDxCodeDesc.length>0)?xmlDoc.getElementsByTagName("dxcodedesc")[0]:null;var oPqriCode=(arrPqriCode.length>0)?xmlDoc.getElementsByTagName("pqri")[0]:null;var oDxCode_multi=(arrDxCode_multi.length>0)?xmlDoc.getElementsByTagName("otherdxCodes_multi")[0]:null;var oDxCode_incomp=(arrDxCode_incomp.length>0)?arrDxCode_incomp[0]:null;if((oDxCode)&&(oDxCode.firstChild)){var tDx=$.trim(oDxCode.firstChild.data);if(type_chk!="account"&&type_chk!="superbill"){if((obj.name.indexOf("elem_asDx")!=-1)||(obj.name.indexOf("elem_assessment_dxcode")!=-1)){if(oDxCode_multi&&oDxCode_multi.firstChild.data){tDx=oDxCode_multi.firstChild.data+", "+tDx;}
obj.value=""+tDx;if(obj.name.indexOf("elem_asDx")!=-1){var tmp=$(obj).data("asindx");if(typeof(tmp)!="undefined"&&tmp!=""){var as_dx_id=tmp;}else{var as_dx_id=obj.name.replace(/(elem_asDx)/g,"");as_dx_id=as_dx_id.replace("_0","");as_dx_id=parseInt(as_dx_id)+1;}
$("#elem_assessment_dxcode"+as_dx_id).val(""+tDx);}else{var op=$.trim(oDxCode_incomp.firstChild.data);op=(op=="1")?"0":"1";show_asmt_site(obj,'',op);}
return;}}
fExists=false;for(var i=1;i<=12;i++){var oDxChk=document.getElementById("elem_dxCode"+i);if((oDxChk)&&($.trim(tDx)!="")&&(oDxChk.value==tDx)){fExists=true;if(oDxCodeDesc.firstChild){if($.trim(oDxCodeDesc.firstChild.data)!=""){renew_title(oDxChk,""+oDxCodeDesc.firstChild.data);}}}}
if(fExists==false){obj.value=tDx;if(oDxCodeDesc.firstChild){if($.trim(oDxCodeDesc.firstChild.data)!=""){renew_title(obj,""+oDxCodeDesc.firstChild.data);}}}}else{if($.trim(obj.value).substr(-2,2)=='>>'){return;}
$(obj).removeData("dxid");renew_title(obj,"");if(typeof(cnfrm)=="undefined"){if(top.fmain){top.fancyConfirm("Entered Text Does not match with any DxCode.<br />Do you want to use this?",'','','top.fmain.checkDB4Code("'+obj.id+'","'+str+'", "'+type+'",true)');}
else{top.fancyConfirm("Entered Text Does not match with any DxCode.<br />Do you want to use this?",'','','top.checkDB4Code("'+obj.id+'","'+str+'", "'+type+'",true)');}}
else{obj.value=obj.title="";}
return;}
if(obj.value!=""){var oPCodes=oPqriCode.childNodes;var len=oPCodes.length;var arrPqriCodes=new Array();var tmpCpt=[];for(var i=0;i<len;i++){if(oPCodes[i].firstChild){tmpCpt[tmpCpt.length]=oPCodes[i].firstChild.data;}}
if(tmpCpt.length>0){arrPqriCodes[obj.value]=tmpCpt;PqriSetter(arrPqriCodes);}}
sb_crt_dx_dropdown();},"xml");}}
function getRefInfoJs(giveonly){var arr=new Array();var len=$("#Vision #MR div[id*=row_mr_]").length;for(var i=1;i<=len;i++){var othr=(i>1)?"Other":"";var sfx=(i>2)?"_"+i:"";var ar1=new Array("elem_visMr"+othr+"OdS"+sfx,"elem_visMr"+othr+"OdC"+sfx,"elem_visMr"+othr+"OdA"+sfx,"elem_visMr"+othr+"OsS"+sfx,"elem_visMr"+othr+"OsC"+sfx,"elem_visMr"+othr+"OsA"+sfx,"elem_visMr"+othr+"OdAdd"+sfx,"elem_visMr"+othr+"OsAdd"+sfx,"elem_mrNoneGiven"+i);arr[arr.length]=ar1;}
var dx="";var flag=0;var eye="";for(var z in arr){var flg=isVisElemDone(arr[z]);if(flg){if(typeof(giveonly)!="undefined"&&giveonly=="1"){if($(":checked[name='"+arr[z][8]+"']").length<=0||!$(":checked[name='"+arr[z][8]+"']").hasClass("active")){continue;}}
flag=1;var add=gebi(arr[z][6]);var ads=gebi(arr[z][7]);var sd=gebi(arr[z][0]);var ss=gebi(arr[z][3]);if(eye==""){if(sd&&sd.value!=""){eye="OD";}
if(ss&&ss.value!=""){eye=(eye=="OD")?"OU":"OS";}}
if((add&&($.trim(add.value)!="")&&($.trim(add.value)!="+"))||(ads&&($.trim(ads.value)!="")&&($.trim(ads.value)!="+"))){dx="367.4";break;}else if((sd&&(sd.value!="-")&&(sd.value.indexOf("-")!=-1))||(ss&&(ss.value!="-")&&(ss.value.indexOf("-")!=-1))){dx="367.1";break;}else if((sd&&(sd.value!="+")&&(sd.value!=""))||(ss&&(ss.value!="+")&&(ss.value!=""))){dx="367.0";break;}}}
return{"flag":flag,"dx":dx,"eye":eye};}
function isAssessmentDone(){var lenAssess=$("#assessplan .planbox").length;for(var i=1;i<lenAssess;i++){var oAssess=gebi("elem_assessment"+i);if((oAssess)&&($.trim(oAssess.value)!="")){return true;}}
return false;}
function checkAssocPqri4All_getParam(cptcd){var params="elem_formAction=PQRI";params+="&elem_formId="+gebi("elem_masterId").value;for(var i=1,j=1;i<=12;i++,j++){var oDx=gebi("elem_dxCode_"+i);if(oDx&&(oDx.value!="")){params+="&elem_dxCode"+j+"="+oDx.value;}}
if(typeof getDCFA_strApId!="undefined"){params+="&elem_apid="+getDCFA_strApId;}
if($("#Vision").length>0){var oRefInfo=getRefInfoJs(sb_refGivenOnly);if(oRefInfo.flag==1){params+="&elem_refraction=1";params+="&elem_refractionDx="+oRefInfo.dx;params+="&elem_vision=1";params+="&elem_visionEye="+oRefInfo.eye;}else{var arrVisDis=new Array("elem_visDisOdSel1","elem_visDisOdSel2","elem_visDisOsSel1","elem_visDisOsSel2","elem_visDisOdTxt1","elem_visDisOdTxt2","elem_visDisOsTxt1","elem_visDisOsTxt2","elem_disDesc");var vis=(isVisElemDone(arrVisDis))?"1":"0";if(vis=="1"){params+="&elem_vision="+vis;params+="&elem_refraction=0";}else{params+="&elem_vision=0";params+="&elem_refraction=0";}}}else{params+="&elem_vision=db";params+="&elem_refraction=db";}
var oComp=gebi("elem_levelComplexity");if(oComp){var tmp=(typeof oComp.value!="undefined")?$.trim(oComp.value):"";params+="&elem_levelComplexity="+tmp;}
var opov=gebi("elem_proc_only_visit");if(opov){var tmp=(typeof opov.value!="undefined")?$.trim(opov.value):"";params+="&elem_proc_only_visit="+tmp;}
var opopv=gebi("elem_post_op_visit");if(opopv){var tmp=(typeof opopv.value!="undefined")?$.trim(opopv.value):"";params+="&elem_post_op_visit="+tmp;}
var oPrBillCd=gebi("elem_practiceBillCode");if(oPrBillCd){var tmp=(typeof oPrBillCd.value!="undefined")?$.trim(oPrBillCd.value):"";params+="&elem_practiceBillCode="+tmp;}
if(typeof getRvsDoneSt!="undefined"){var rvsSt=getRvsDoneSt();params+="&elem_rvs="+rvsSt;}else{params+="&elem_rvs=db";}
var oCCHx=gebi("elem_ccHx");var oCC=gebi("elem_ccompliant");if(oCCHx&&oCC){var strCCHx=oCC.value;var ptrn="\\s*A\\s*((\\d)+\\s*(years|months|days)\\s*old\\s*)?(Male|Female|male|female)\\s*with\\s*history\\s*of\\s*(\\r)?\\s*";strCCHx=regReplace(ptrn,"",strCCHx);if($.trim(strCCHx)==""&&oCCHx&&$.trim(oCCHx.value)!=""){strCCHx=regReplace(ptrn,"",oCCHx.value);}
params+="&elem_ccHx="+strCCHx;}else{params+="&elem_ccHx=db";}
if(typeof(isAssessmentDone)!="undefined"){var strAss=(isAssessmentDone())?"1":"0";params+="&elem_assessment="+strAss;}else{params+="&elem_assessment=db";}
var oNpsych=gebi("elem_neuroPsych");if(oNpsych){var strNpsych=($.trim(oNpsych.value)!="")?"1":"0";params+="&elem_neuroPsych="+strNpsych;}else{params+="&elem_neuroPsych=db";}
var oSBCaseId=gebi("elem_sb_insuranceCaseId");if(oSBCaseId&&(typeof oSBCaseId.value!="undefined")&&(oSBCaseId.value!="")&&(oSBCaseId.value!="0")){params+="&elem_insCaseId="+oSBCaseId.value;}else{var oMasterCaseId=gebi("elem_masterCaseId");if(oMasterCaseId&&(typeof oMasterCaseId.value!="undefined")){params+="&elem_insCaseId="+oMasterCaseId.value;}}
var oDOS=gebi("elem_dos");if(oDOS&&(typeof oDOS.value!="undefined")){params+="&elem_dos="+oDOS.value;}
var oPhyId=$("div.divsign :input[name*=elem_physicianId][value!=''][type!=text]");if(oPhyId&&oPhyId.length>0&&typeof(oPhyId.val())!="undefined"){params+="&elem_doctorId="+oPhyId.val();}
flgMergeSB=1;if(typeof(wpage)!="undefined"&&wpage=="accSB"){flgMergeSB=0;}
params+="&flgMergeSB="+flgMergeSB;var isnewpt=""+$("#elem_flgIsPtNew").val();params+="&elem_flgIsPtNew="+isnewpt;if($(":input[type=checkbox][id*=lb_qlfy_lvl_code]").length>0){var str_vc_check="";$(":checked[id*=lb_qlfy_lvl_code]").each(function(ini){str_vc_check+="&"+this.name+"="+this.value;});params+=str_vc_check;}else if(typeof(cptcd)!="undefined"&&cptcd!=""){var type_cpt="";if(cptcd.indexOf("992")!=-1){type_cpt="992";}else if(cptcd.indexOf("920")!=-1){type_cpt="920";}
if(type_cpt!=""){params+="&lb_qlfy_lvl_code"+type_cpt+"="+cptcd;}}
var v_icd10=""+$("#hid_icd10").val();params+="&elem_v_icd10="+v_icd10;return params;}
var flg_checkAssocPqri4All_checkvisitcode=0;function checkAssocPqri4All_checkvisitcode(cptcd){if(cptcd==""){return;}
if(cptcd.indexOf("920")!=-1){type_cpt="920";}else if(cptcd.indexOf("992")!=-1){type_cpt="992";}else{return;}
var isnewpt="Establish";if(typeof(cptcd)!="undefined"&&cptcd!=""){var isnewpt_t=cptcd.substr(-2,1);isnewpt=(isnewpt_t==0)?"Yes_confirmed":"No_confirmed";$("#elem_flgIsPtNew").val(isnewpt);}
flg_checkAssocPqri4All_checkvisitcode=cptcd;var prompt_msg="";if($("#elem_flgIsPtNew").val()=="New"){var ctop=top;var stop="top";if(top.fmain){ctop=top.fmain;stop="top.fmain";}
prompt_msg+="<label style=\"width:250px;display:inline-block;\"><b>Is this a New Patient?</b></label><div id=\"divisnwpt\">"+"<input type=\"checkbox\" name=\"el_sb_pt_type\" id=\"el_sb_pt_type_new\" value=\"Yes_confirmed\" onclick=\""+stop+".decideNewPatient(this)\"><label for=\"el_sb_pt_type_new\">Yes</label>"+"<input type=\"checkbox\" name=\"el_sb_pt_type\" id=\"el_sb_pt_type_estb\" value=\"No_confirmed\" onclick=\""+stop+".decideNewPatient(this)\"><label for=\"el_sb_pt_type_estb\">No</label></div>";}
var oPrBillCd=gebi("elem_practiceBillCode");if(oPrBillCd&&$.trim(oPrBillCd.value)=="992"){var oComp=gebi("elem_levelComplexity");var opov=gebi("elem_proc_only_visit");var opopv=gebi("elem_post_op_visit");if(oComp&&$.trim(oComp.value)==""&&(opov&&$.trim(opov.value)=="")&&(opopv&&$.trim(opopv.value)=="")){str_prmpt_tmp=promptMedDecCom(1);if(prompt_msg!=""){prompt_msg+="<br/>";}
prompt_msg+=str_prmpt_tmp;}}
if(prompt_msg!=""){var htm="<div id=\"dialog-Mdc-cum-new-pt\">"+"<div style=\"\">"+"<table class=\"table\"  height=\"30\"><tr class='purple_bar'><th>Assessed Service Level<span  class=\"glyphicon glyphicon-remove pull-right\" title=\"close\"></span></th></tr></table>"+
prompt_msg+"</div>"+"<div id=\"div_as_srv_lvl\"></div>"+"</div>";$("#dialog-Mdc-cum-new-pt").remove();$("body").append(htm);if($("#elem_practiceBillCode").val()=="920"){$("#dialog-Mdc-cum-new-pt").css({"width":"60%","left":"250px"});}
$("#dialog-Mdc-cum-new-pt").draggable({"handle":"th"});$("#dialog-Mdc-cum-new-pt th span[title=close]").bind("click",function(){$("#dialog-Mdc-cum-new-pt").remove();});$("#dialog-Mdc-cum-new-pt th").css({"cursor":"move"});return;}
var imgPath_tmp=(typeof(imgPath_remote)!="undefined")?imgPath_remote:imgPath;var url=imgPath_tmp+"/interface/chart_notes/requestHandler.php";var params=checkAssocPqri4All_getParam(cptcd);params+="&el_manual_insert_visitcode=1";if(typeof(setProcessImg)!='undefined')setProcessImg("1","superbill");$.post(url,params,function(data){if(typeof(setProcessImg)!='undefined')setProcessImg("0","superbill");var xmlDoc=data;var oAutoCode=xmlDoc.getElementsByTagName("autocode")[0];var oAutos=(oAutoCode!=null)?oAutoCode.childNodes:null;var lenAutos=(oAutos!=null)?oAutos.length:0;var ptcategory="";var practicebillcode="";var ptlevelhistory="";var ptlevelcomp="";var ptservicelevel="";var ptcategory_consult="";var pt_levelofservice_eye="";var pt_levelofservice_em="";var pt_strexamdone_eye="";var pt_strexamnotdone_eye="";var pt_strexamdone_em="";var pt_strexamnotdone_em="";var poe_visit_code="";var pls_sel_nq_em="",pls_sel_nq_eye="";for(var i=0;i<lenAutos;i++){var oData=oAutos[i];if(oData.firstChild){if(oData.nodeName=="ptcategory"){ptcategory=""+oData.firstChild.data;}else if(oData.nodeName=="practicebillcode"){practicebillcode=""+oData.firstChild.data;}else if(oData.nodeName=="ptlevelhistory"){ptlevelhistory=""+oData.firstChild.data;}else if(oData.nodeName=="ptlevelcomp"){ptlevelcomp=""+oData.firstChild.data;}else if(oData.nodeName=="ptservicelevel"){ptservicelevel=""+oData.firstChild.data;}else if(oData.nodeName=="pt_levelofservice_eye"){pt_levelofservice_eye=""+oData.firstChild.data;}else if(oData.nodeName=="pt_levelofservice_em"){pt_levelofservice_em=""+oData.firstChild.data;}else if(oData.nodeName=="pt_strexamdone_eye"){pt_strexamdone_eye=""+oData.firstChild.data;}else if(oData.nodeName=="pt_strexamnotdone_eye"){pt_strexamnotdone_eye=""+oData.firstChild.data;}else if(oData.nodeName=="pt_strexamdone_em"){pt_strexamdone_em=""+oData.firstChild.data;}else if(oData.nodeName=="pt_strexamnotdone_em"){pt_strexamnotdone_em=""+oData.firstChild.data;}else if(oData.nodeName=="poe_visit_code"){poe_visit_code=""+oData.firstChild.data;}else if(oData.nodeName=="ptcategory_consult"){ptcategory_consult=""+oData.firstChild.data;}else if(oData.nodeName=="pls_sel_nq_em"){pls_sel_nq_em=""+oData.firstChild.data;}else if(oData.nodeName=="pls_sel_nq_eye"){pls_sel_nq_eye=""+oData.firstChild.data;}}}
gebi("elem_category").value=ptcategory;gebi("elem_practiceBillCode").value=practicebillcode;gebi("elem_levelHistory").value=ptlevelhistory;gebi("elem_levelComplexity").value=ptlevelcomp;gebi("elem_levelOfService").value=ptservicelevel;gebi("elem_ptcategory_consult").value=ptcategory_consult;gebi("elem_levelOfServiceEye").value=pt_levelofservice_eye;gebi("elem_levelOfServiceEM").value=pt_levelofservice_em;gebi("elem_strExmDoneEye").value=pt_strexamdone_eye;gebi("elem_strExmNotDoneEye").value=pt_strexamnotdone_eye;gebi("elem_strExmDoneEM").value=pt_strexamdone_em;gebi("elem_strExmNotDoneEM").value=pt_strexamnotdone_em;gebi("elem_poe_visit_code").value=poe_visit_code;gebi("elem_pls_sel_nq_em").value=pls_sel_nq_em;gebi("elem_pls_sel_nq_eye").value=pls_sel_nq_eye;if(setVisitProcedure_nochk==0){}else{var los_t=cptcd.substr(-1,1);if(cptcd.indexOf("920")!=-1){if(gebi("elem_strExmNotDoneEye").value==""){$("#dialog-Mdc-cum-new-pt").remove();return;}}else if(cptcd.indexOf("992")!=-1){if(gebi("elem_strExmNotDoneEM").value==""){$("#dialog-Mdc-cum-new-pt").remove();return;}}}
var prompt_msg="";var oPrBillCd=gebi("elem_practiceBillCode");var oComp=gebi("elem_levelComplexity");var opov=gebi("elem_proc_only_visit");var opopv=gebi("elem_post_op_visit");if(oPrBillCd&&$.trim(oPrBillCd.value)=="992"){if(oComp||opov||opopv){str_prmpt_tmp=promptMedDecCom(1);if(prompt_msg!=""){prompt_msg+="<br/>";}
prompt_msg+=str_prmpt_tmp;}}
if(prompt_msg!=""){var htm="<div id=\"dialog-Mdc-cum-new-pt\">"+"<div style=\"\">"+"<table class=\"table\" height=\"30\"><tr class='purple_bar'><th>Assessed Service Level<span class=\"glyphicon glyphicon-remove pull-right\" title=\"close\"></span></th></tr></table>"+
prompt_msg+"</div>"+"<div id=\"div_as_srv_lvl\"></div>"+"</div>";if($("#dialog-Mdc-cum-new-pt").length>0){$("#dialog-Mdc-cum-new-pt").remove();}
$("body").append(htm);if($("#elem_practiceBillCode").val()=="920"&&oPrBillCd=="920"){$("#dialog-Mdc-cum-new-pt").css({"width":"60%","left":"250px"});}
$("#dialog-Mdc-cum-new-pt").draggable({"handle":"th"});$("#dialog-Mdc-cum-new-pt th span[title=close]").bind("click",function(){$("#dialog-Mdc-cum-new-pt").remove();});$("#dialog-Mdc-cum-new-pt th").css({"cursor":"move"});if((oComp&&oComp.value!="")||(opov&&opov.value!="")||(opopv&&opopv.value!="")){var tmp=(oComp.value=="")?"5":oComp.value;if(opov&&opov.value!=""){tmp=5;}
else if(opopv&&opopv.value!=""){tmp=6;}
$("input[id*=elem_chkMedComp_][value='"+tmp+"']").prop("checked",true);}}
confirmVisitCode_v3();},"xml");}
function setSBTodayCharges(){var oTodaysCharges=gebi("elem_todaysCharges");var oProcOrder=gebi("elem_procOrder");var oProcUnitOrder=gebi("elem_procUnitOrder");if(!oProcOrder||(typeof oProcOrder.value=="undefined")||($.trim(oProcOrder.value)=="")){if(oTodaysCharges){oTodaysCharges.value="";}
return;}
var mod_50="";$("#superbill .modcode").each(function(){if(typeof(this.value)!='undefined'&&$.trim(this.value)=="50"){var cid=this.id.replace(/elem_modCode/,'elem_cptCode');cid=cid.replace(/_\d$/,"");if($("#"+cid).length>0){var cpt=$("#"+cid).val();if(cpt!=""){if(mod_50.indexOf(cpt)==-1){mod_50+=""+cpt+",";}}}}});var imgPath_tmp=(typeof(imgPath_remote)!="undefined")?imgPath_remote:imgPath;var url=imgPath_tmp+"/interface/chart_notes/requestHandler.php";var insCaseId="";if(typeof gebi("elem_masterCaseId")!="undefined"){var insCaseId=gebi("elem_masterCaseId").value;}
var vDos="";if(typeof gebi("elem_dos")!="undefined"){var vDos=gebi("elem_dos").value;}
var vVIP=($("#vipSuperBill:checked").length>0)?1:0;params="elem_formAction=todayCharges";params+="&elem_insCaseId="+insCaseId;params+="&elem_strCptCodes="+oProcOrder.value;params+="&elem_dos="+vDos;params+="&elem_strCptUnits="+oProcUnitOrder.value;params+="&elem_vVIP="+vVIP;params+="&elem_mod50="+mod_50;if(typeof(setProcessImg)!='undefined')setProcessImg("1","superbill");$.post(url,params,function(data){if(typeof(setProcessImg)!='undefined')setProcessImg("0","superbill");str=""+data;if(oTodaysCharges){oTodaysCharges.value=""+str;}
$(".amount").html(""+str);});}
function getLSSHtml(obj,attr,type,asindx){var str_lss_tmp="";if(obj){var oLat=obj.attributes.getNamedItem(attr);vLat=(oLat)?""+oLat.nodeValue:"";var arrvLat=vLat.split(",");if(arrvLat.length>0){for(var vt in arrvLat){if(arrvLat[vt]!=""){var tmpLat=arrvLat[vt].split(" - ");str_lss_tmp+="<input type=\"checkbox\" id=\"elem_asDx"+type+"_"+vt+"\" name=\"elem_asDx"+type+"\" value=\""+tmpLat[1]+"\" onclick=\"icd10_restdxcodesinpopup(this)\" style=\"display:none;\" data-asindx=\""+asindx+"\" >"+"<label style=\"cursor:pointer;color:purple;margin-left:10px;padding:2px;border:2px solid transparent;\" for=\"elem_asDx"+type+"_"+vt+"\">"+tmpLat[0]+"</label>&nbsp;";}}}}
return str_lss_tmp;}
var sb_objRefraction={};function checkAssocPqri4All(){flg_checkAssocPqri4All_checkvisitcode=0;var prompt_msg="";if($("#elem_flgIsPtNew").val()=="New"){var ctop=top;var stop="top";if(top.fmain){ctop=top.fmain;stop="top.fmain";}
prompt_msg+="<label style=\"width:250px;display:inline-block;\"><b>Is this a New Patient?</b></label><div id=\"divisnwpt\">"+"<input type=\"checkbox\" name=\"el_sb_pt_type\" id=\"el_sb_pt_type_new\" value=\"Yes_confirmed\" onclick=\""+stop+".decideNewPatient(this)\"><label for=\"el_sb_pt_type_new\">Yes</label>"+"<input type=\"checkbox\" name=\"el_sb_pt_type\" id=\"el_sb_pt_type_estb\" value=\"No_confirmed\" onclick=\""+stop+".decideNewPatient(this)\"><label for=\"el_sb_pt_type_estb\">No</label></div>";}
if($("#poeModal").length<=0){var oPrBillCd=gebi("elem_practiceBillCode");if(oPrBillCd&&$.trim(oPrBillCd.value)=="992"){var oComp=gebi("elem_levelComplexity");var opov=gebi("elem_proc_only_visit");var opopv=gebi("elem_post_op_visit");if((oComp&&$.trim(oComp.value)=="")&&(opov&&$.trim(opov.value)=="")&&(opopv&&$.trim(opopv.value)=="")){str_prmpt_tmp=promptMedDecCom(1);if(prompt_msg!=""){prompt_msg+="<br/>";}
prompt_msg+=str_prmpt_tmp;}}}
if(prompt_msg!=""){var htm="<div id=\"dialog-Mdc-cum-new-pt\">"+"<div style=\"padding:0px;\">"+"<table class=\"table\" height=\"30\"><tr class='purple_bar'><th>Assessed Service Level<span class=\"glyphicon glyphicon-remove pull-right\" title=\"close\"></span></th></tr></table>"+
prompt_msg+"</div>"+"<div id=\"div_as_srv_lvl\" ></div>"+"</div>";$("#dialog-Mdc-cum-new-pt").remove();$("body").append(htm);if($("#elem_practiceBillCode").val()=="920"){$("#dialog-Mdc-cum-new-pt").css({"width":"60%","left":"250px"});}
$("#dialog-Mdc-cum-new-pt").draggable({"handle":"th"});$("#dialog-Mdc-cum-new-pt th span[title=close]").bind("click",function(){$("#dialog-Mdc-cum-new-pt").remove();});$("#dialog-Mdc-cum-new-pt th").css({"cursor":"move"});return;}
var imgPath_tmp=(typeof(imgPath_remote)!="undefined")?imgPath_remote:imgPath;var url=imgPath_tmp+"/interface/chart_notes/requestHandler.php";var params=checkAssocPqri4All_getParam();if(typeof(setProcessImg)!='undefined')setProcessImg("1","superbill");$.post(url,params,function(data){if($("textarea[name=commentsForPatient]").val()=="debug123"){console.log(data);}
if(typeof(setProcessImg)!='undefined')setProcessImg("0","superbill");var xmlDoc=data;var arrCptCodes=new Array();var arrDxCodes=new Array();var arrExamDone=new Array();var arrExamTesting=new Array();sb_objRefraction.isRef=0;var tsb_ids="";var oTestSbInfo=xmlDoc.getElementsByTagName("testing_sb");var oTSB=(oTestSbInfo!=null&&oTestSbInfo[0]&&oTestSbInfo[0].childNodes)?oTestSbInfo[0].childNodes:null;var lenTSB=(oTSB!=null)?oTSB.length:0;for(var a=0;a<lenTSB;a++){var oSBNode=oTSB[a];if(oSBNode==null)continue;var osb_id=oSBNode.attributes.getNamedItem("id");if(osb_id)tsb_ids+=""+osb_id.nodeValue+",";var oCpts=oSBNode.childNodes;var lenCpts=(oCpts)?oCpts.length:0;for(var b=0;b<lenCpts;b++){var arrTmp=new Array();var oCptNode=oCpts[b];var oCptData=oCptNode.childNodes;var lenCptData=oCptData.length;for(var c=0;c<lenCptData;c++){var oData=oCptData[c];var tmpCpt="";if(oData.firstChild){if(oData.nodeName=="code"){arrTmp["cpt"]=""+oData.firstChild.data;tmpCpt=""+oData.firstChild.data;var oCptDesc=oData.attributes.getNamedItem("desc");arrTmp["cptDesc"]=(typeof oCptDesc!="undefined")?oCptDesc.nodeValue:"";var oUnits=oData.attributes.getNamedItem("units");arrTmp["units"]=(typeof oUnits!="undefined")?oUnits.nodeValue:"";arrTmp["norepeat"]="1";var oIsRef=oData.attributes.getNamedItem("isRef");if(oIsRef&&typeof(oIsRef.nodeValue)!="undefined"){arrTmp["isRef"]=""+oIsRef.nodeValue;}
var o_valid_dx_code=oData.attributes.getNamedItem("valid_dxcodes");if(o_valid_dx_code&&typeof(o_valid_dx_code.nodeValue)!="undefined"){arrTmp["valid_dxcodes"]=""+o_valid_dx_code.nodeValue;}}else if(oData.nodeName=="dx"){var oDxNum=oData.attributes.getNamedItem("num");var oDxId=oData.attributes.getNamedItem("dxid");var dxId=(typeof oDxNum!="undefined"&&oDxNum)?oDxNum.nodeValue:"";var dxCdId=(typeof oDxId!="undefined"&&oDxId)?oDxId.nodeValue:"";if(dxId!=""){var idDx="dx"+dxId;arrTmp[idDx]=""+oData.firstChild.data;var oDxDesc=oData.attributes.getNamedItem("desc");arrTmp[idDx+"Desc"]=(typeof oDxDesc!="undefined")?oDxDesc.nodeValue:"";arrTmp[idDx+"Id"]=(typeof dxCdId!="undefined")?dxCdId:"";}}else if(oData.nodeName=="modifier"){var oModNum=oData.attributes.getNamedItem("num");var modId=(typeof oModNum!="undefined")?oModNum.nodeValue:"";if(modId!=""){var idMod="modifier"+modId;arrTmp[""+idMod]=""+oData.firstChild.data;}}}}
if((typeof arrTmp["cpt"]!="undefined")&&(arrTmp["cpt"]!="")){arrExamDone[arrExamDone.length]=arrTmp;if(arrTmp["isRef"]=="1"){sb_objRefraction.isRef=1;sb_objRefraction.dxCode=""+arrTmp["dx1"];}}}}
if(tsb_ids!=""){tsb_ids=tsb_ids.replace(/,\s*$/g,"");gebi("elem_sb_tsbIds").value=""+tsb_ids;}
var oCptInfo=xmlDoc.getElementsByTagName("allcptcode")[0];var oCpts=(oCptInfo!=null)?oCptInfo.childNodes:null;var lenCpts=(oCpts!=null)?oCpts.length:0;for(var i=0;i<lenCpts;i++){var arrTmp=new Array();var oCptNode=oCpts[i];var oCptData=oCptNode.childNodes;var lenCptData=oCptData.length;for(var j=0;j<lenCptData;j++){var oData=oCptData[j];var tmpCpt="";if(oData.firstChild){if(oData.nodeName=="cptcode"){arrTmp["cpt"]=""+oData.firstChild.data;tmpCpt=""+oData.firstChild.data;var oCptDesc=oData.attributes.getNamedItem("desc");arrTmp["cptDesc"]=(typeof oCptDesc!="undefined")?oCptDesc.nodeValue:"";arrTmp["norepeat"]="0";var oIsRef=oData.attributes.getNamedItem("isRef");if(oIsRef&&typeof(oIsRef.nodeValue)!="undefined"){arrTmp["isRef"]=""+oIsRef.nodeValue;}
var o_valid_dx_code=oData.attributes.getNamedItem("valid_dxcodes");if(o_valid_dx_code&&typeof(o_valid_dx_code.nodeValue)!="undefined"){arrTmp["valid_dxcodes"]=""+o_valid_dx_code.nodeValue;}}
else if(oData.nodeName=="units"){arrTmp["units"]=""+oData.firstChild.data;}
else if(oData.nodeName=="modifier1"){arrTmp["modifier1"]=""+oData.firstChild.data;}else if(oData.nodeName=="modifier2"){arrTmp["modifier2"]=""+oData.firstChild.data;}else if(oData.nodeName=="modifier3"){arrTmp["modifier3"]=""+oData.firstChild.data;}else if(oData.nodeName=="modifier4"){arrTmp["modifier4"]=""+oData.firstChild.data;}else if(oData.nodeName=="dx1"||oData.nodeName=="dx2"||oData.nodeName=="dx3"||oData.nodeName=="dx4"||oData.nodeName=="dx5"||oData.nodeName=="dx6"||oData.nodeName=="dx7"||oData.nodeName=="dx8"||oData.nodeName=="dx9"||oData.nodeName=="dx10"||oData.nodeName=="dx11"||oData.nodeName=="dx12"){var idDx=oData.nodeName;arrTmp[idDx]=""+oData.firstChild.data;var oDxDesc=oData.attributes.getNamedItem("desc");arrTmp[idDx+"Desc"]=""+(typeof oDxDesc!="undefined")?oDxDesc.nodeValue:"";}else if(oData.nodeName=="adx1"||oData.nodeName=="adx2"||oData.nodeName=="adx3"||oData.nodeName=="adx4"){var idDx=oData.nodeName;arrTmp[idDx]=""+oData.firstChild.data;var oDxDesc=oData.attributes.getNamedItem("desc");arrTmp[idDx+"Desc"]=""+(typeof oDxDesc!="undefined")?oDxDesc.nodeValue:"";}}}
if((typeof arrTmp["cpt"]!="undefined")&&(arrTmp["cpt"]!="")){arrExamDone[arrExamDone.length]=arrTmp;if(arrTmp["isRef"]=="1"){sb_objRefraction.isRef=1;sb_objRefraction.dxCode=""+arrTmp["dx1"];}}}
var arProcDxInfo=[];var oProcSbInfo=xmlDoc.getElementsByTagName("proc_sb");var oPSB=(oProcSbInfo!=null&&oProcSbInfo[0]&&oProcSbInfo[0].childNodes)?oProcSbInfo[0].childNodes:null;var lenPSB=(oPSB!=null)?oPSB.length:0;for(var a=0;a<lenPSB;a++){var oSBNode=oPSB[a];if(oSBNode==null)continue;if(oSBNode.tagName=="dx_info"){var oDxs=oSBNode.childNodes;var lenDxs=(oDxs)?oDxs.length:0;for(var b=0;b<lenDxs;b++){var oDxNode=oDxs[b];var tmpDx=""+oDxNode.firstChild.data;var tmpDxDesc=oDxNode.attributes.getNamedItem("desc");if(tmpDx!=""){arProcDxInfo[tmpDx]=""+(typeof tmpDxDesc!="undefined")?tmpDxDesc.nodeValue:"";}}}else{var oCpts=oSBNode.childNodes;var lenCpts=(oCpts)?oCpts.length:0;for(var b=0;b<lenCpts;b++){var arrTmp=new Array();var oCptNode=oCpts[b];var oCptData=oCptNode.childNodes;var lenCptData=oCptData.length;for(var c=0;c<lenCptData;c++){var oData=oCptData[c];var tmpCpt="";if(oData.firstChild){if(oData.nodeName=="code"){arrTmp["cpt"]=""+oData.firstChild.data;tmpCpt=""+oData.firstChild.data;var oCptDesc=oData.attributes.getNamedItem("desc");arrTmp["cptDesc"]=(typeof oCptDesc!="undefined")?oCptDesc.nodeValue:"";var oUnits=oData.attributes.getNamedItem("units");arrTmp["units"]=(typeof oUnits!="undefined")?oUnits.nodeValue:"";arrTmp["norepeat"]="1";var oIsRef=oData.attributes.getNamedItem("isRef");if(oIsRef&&typeof(oIsRef.nodeValue)!="undefined"){arrTmp["isRef"]=""+oIsRef.nodeValue;}
var o_valid_dx_code=oData.attributes.getNamedItem("valid_dxcodes");if(o_valid_dx_code&&typeof(o_valid_dx_code.nodeValue)!="undefined"){arrTmp["valid_dxcodes"]=""+o_valid_dx_code.nodeValue;}}else if(oData.nodeName=="dx"){var oDxNum=oData.attributes.getNamedItem("num");var oDxId=oData.attributes.getNamedItem("dxid");var dxId=(typeof oDxNum!="undefined"&&oDxNum)?""+oDxNum.nodeValue:"";var dxCdId=(typeof oDxId!="undefined"&&oDxId)?""+oDxId.nodeValue:"";if(dxId!=""){var idDx="dx"+dxId;arrTmp[idDx]=""+oData.firstChild.data;var oDxDesc=oData.attributes.getNamedItem("desc");arrTmp[idDx+"Desc"]=(typeof oDxDesc!="undefined")?""+oDxDesc.nodeValue:"";arrTmp[idDx+"Id"]=(typeof dxCdId!="undefined")?dxCdId:"";}}else if(oData.nodeName=="modifier"){var oModNum=oData.attributes.getNamedItem("num");var modId=""+(typeof oModNum!="undefined")?oModNum.nodeValue:"";if(modId!=""){var idMod="modifier"+modId;arrTmp[""+idMod]=""+oData.firstChild.data;}}}}
if((typeof arrTmp["cpt"]!="undefined")&&(arrTmp["cpt"]!="")){arrExamDone[arrExamDone.length]=arrTmp;if(arrTmp["isRef"]=="1"){sb_objRefraction.isRef=1;sb_objRefraction.dxCode=""+arrTmp["dx1"];}}}}}
var oAutoCode=xmlDoc.getElementsByTagName("autocode")[0];var oAutos=(oAutoCode!=null)?oAutoCode.childNodes:null;var lenAutos=(oAutos!=null)?oAutos.length:0;var ptcategory="";var practicebillcode="";var ptlevelhistory="";var ptlevelcomp="";var ptservicelevel="";var ptcategory_consult="";var pt_levelofservice_eye="";var pt_levelofservice_em="";var pt_strexamdone_eye="";var pt_strexamnotdone_eye="";var pt_strexamdone_em="";var pt_strexamnotdone_em="";var poe_visit_code="";var pls_sel_nq_em="",pls_sel_nq_eye="";for(var i=0;i<lenAutos;i++){var oData=oAutos[i];if(oData.firstChild){if(oData.nodeName=="ptcategory"){ptcategory=""+oData.firstChild.data;}else if(oData.nodeName=="practicebillcode"){practicebillcode=""+oData.firstChild.data;}else if(oData.nodeName=="ptlevelhistory"){ptlevelhistory=""+oData.firstChild.data;}else if(oData.nodeName=="ptlevelcomp"){ptlevelcomp=""+oData.firstChild.data;}else if(oData.nodeName=="ptservicelevel"){ptservicelevel=""+oData.firstChild.data;}else if(oData.nodeName=="pt_levelofservice_eye"){pt_levelofservice_eye=""+oData.firstChild.data;}else if(oData.nodeName=="pt_levelofservice_em"){pt_levelofservice_em=""+oData.firstChild.data;}else if(oData.nodeName=="pt_strexamdone_eye"){pt_strexamdone_eye=""+oData.firstChild.data;}else if(oData.nodeName=="pt_strexamnotdone_eye"){pt_strexamnotdone_eye=""+oData.firstChild.data;}else if(oData.nodeName=="pt_strexamdone_em"){pt_strexamdone_em=""+oData.firstChild.data;}else if(oData.nodeName=="pt_strexamnotdone_em"){pt_strexamnotdone_em=""+oData.firstChild.data;}else if(oData.nodeName=="poe_visit_code"){poe_visit_code=""+oData.firstChild.data;}else if(oData.nodeName=="ptcategory_consult"){ptcategory_consult=""+oData.firstChild.data;}else if(oData.nodeName=="pls_sel_nq_em"){pls_sel_nq_em=""+oData.firstChild.data;}else if(oData.nodeName=="pls_sel_nq_eye"){pls_sel_nq_eye=""+oData.firstChild.data;}}}
gebi("elem_category").value=ptcategory;gebi("elem_practiceBillCode").value=practicebillcode;gebi("elem_levelHistory").value=ptlevelhistory;gebi("elem_levelComplexity").value=ptlevelcomp;gebi("elem_levelOfService").value=ptservicelevel;gebi("elem_ptcategory_consult").value=ptcategory_consult;gebi("elem_levelOfServiceEye").value=pt_levelofservice_eye;gebi("elem_levelOfServiceEM").value=pt_levelofservice_em;gebi("elem_strExmDoneEye").value=pt_strexamdone_eye;gebi("elem_strExmNotDoneEye").value=pt_strexamnotdone_eye;gebi("elem_strExmDoneEM").value=pt_strexamdone_em;gebi("elem_strExmNotDoneEM").value=pt_strexamnotdone_em;gebi("elem_poe_visit_code").value=poe_visit_code;gebi("elem_pls_sel_nq_em").value=pls_sel_nq_em;gebi("elem_pls_sel_nq_eye").value=pls_sel_nq_eye;var oDxInfo=xmlDoc.getElementsByTagName("eleminfo")[0];var oElems=(oDxInfo!=null)?oDxInfo.childNodes:null;var lenElems=(oElems!=null)?oElems.length:0;var arrDxInfo=new Array();for(var i=0;i<lenElems;i++){var oPqri=oElems[i].childNodes;var lenPqri=oPqri.length;var thisDxCode="";var tmpCptCode=new Array();for(var j=0;j<lenPqri;j++){var node=oPqri[j];if(node.nodeName=="dxcode"){thisDxCode=(node.firstChild)?node.firstChild.data:"";var oDxDesc=node.attributes.getNamedItem("desc");arrDxInfo[thisDxCode]=(typeof oDxDesc!="undefined")?""+oDxDesc.nodeValue:"";}
else if(node.nodeName=="pqri"){var cptNodes=node.childNodes;var lencptNodes=cptNodes.length;for(var k=0;k<lencptNodes;k++){var tmpCpt=cptNodes[k].firstChild;if(tmpCpt){var tmpStr=(tmpCptCode.length>0)?tmpCptCode.join(","):"";if(tmpStr.indexOf(tmpCpt.data)==-1){tmpCptCode[tmpCptCode.length]=tmpCpt.data;}}}}}
if(tmpCptCode.length>0){arrCptCodes[thisDxCode]=tmpCptCode;}}
if($("#elem_proc_only_visit").val()=="1"){opRemAllCptRow(3);}
insertExamsDoneSB(arrExamDone);PqriSetter(arrCptCodes);var oAssist=gebi("elem_buttonAssist");if(oAssist){oAssist.style.visibility="visible";}
confirmVisitCode_v3();var ocstInfo=xmlDoc.getElementsByTagName("cl_supply_total")[0];if((ocstInfo!=null)&&(ocstInfo.firstChild)){var tmpCst=ocstInfo.firstChild.data;if(parseInt(tmpCst)>0){var oTd_cst=gebi("td_clsupplytotal");if(oTd_cst){oTd_cst.innerHTML="CL order: "+tmpCst;}}}
var strAllDx="";var flgEmptyDx=0;for(var i=1;i<=12;i++){var oDxElem=gebi("elem_dxCode_"+i);if(oDxElem){var tmp=$.trim(oDxElem.value);if((typeof tmp!="undefined")&&(tmp!="")){if(typeof arrDxInfo[tmp]!="undefined"){oDxElem.title=arrDxInfo[tmp];}
strAllDx+=tmp+", ";}else{oDxElem.title="";flgEmptyDx=1;}}}
if(flgEmptyDx==1){for(var x in arProcDxInfo){if(strAllDx.indexOf(x)==-1){for(var i=1;i<=12;i++){var oDxElem=gebi("elem_dxCode_"+i);if(oDxElem){var tmp=$.trim(oDxElem.value);if((typeof tmp!="undefined")&&(tmp!="")){}else{oDxElem.value=x;oDxElem.title=arProcDxInfo[x];break;}}}}}}
sb_crt_dx_dropdown();},"xml");}
function icd10_pre_restdxcodesinpopup(len){for(var h=0;h<=len;h++){for(var mg=0;mg<=10;mg++){var dx_code_id="elem_asDx"+h+"_"+mg;if($("#"+dx_code_id).length>0){if(typeof($("#"+dx_code_id).data("valbakdb"))!='undefined'&&$("#"+dx_code_id).data("valbakdb")!=null){var dx_code_db_val=$("#"+dx_code_id).data("valbakdb");var dx_code_cur_val=$("#"+dx_code_id).val();var dx_str_len=String(dx_code_db_val).length;var dx_sss_val="";for(var k=0;k<=dx_str_len;k++){var x=dx_code_cur_val[k];if(x=="-"){x='Y';}
if(dx_code_db_val[k]!=x){dx_sss_val+=dx_code_cur_val[k]+',';}}
var isDbtsCode=0;if(dx_str_len==8&&(dx_code_cur_val.indexOf("E10.")!=-1||dx_code_cur_val.indexOf("E11.")!=-1)){isDbtsCode=1;dx_sss_val="";for(var k=0;k<=dx_str_len;k++){var x=dx_code_cur_val[k];if(x=="-"){x='0';}
if(dx_code_db_val[k]!=x){dx_sss_val+=dx_code_cur_val[k]+',';}}
var arx=dx_sss_val.split(",");var arx_ln=arx.length;var dx_sss_val_tmp="";for(var t=0;t<arx_ln;t++){if(typeof(arx[t])!="undefined"&&arx[t]!=""){dx_sss_val_tmp=arx[t]+","+dx_sss_val_tmp;}}
if(dx_sss_val_tmp!=""){dx_sss_val=dx_sss_val_tmp;}}
var dx_sss_val_exp=dx_sss_val.split(',');if(dx_sss_val_exp.length>2){for(var g=0;g<=10;g++){var chk_lat_id='elem_asDxLat'+h+'_'+mg+'_'+g;var chk_stg_id='elem_asDxStg'+h+'_'+mg+'_'+g;var chk_svr_id='elem_asDxSvr'+h+'_'+mg+'_'+g;if($("#"+chk_lat_id)&&$("#"+chk_lat_id).val()==dx_sss_val_exp[0]){$("#"+chk_lat_id).prop("checked",true);$("label[for="+chk_lat_id+"]").css({"color":"Red","border":"2px solid blue","background-color":"white"});}else{if($("#"+chk_lat_id)&&typeof(js_icd10_bilateral_arr[dx_code_db_val.toLowerCase()])!='undefined'){if(js_icd10_bilateral_arr[dx_code_db_val.toLowerCase()]==1&&$("#"+chk_lat_id).val()==3){$("label[for="+chk_lat_id+"]").css("display",'none');}}}
if($("#"+chk_stg_id)&&$("#"+chk_stg_id).val()==dx_sss_val_exp[1]){$("#"+chk_stg_id).prop("checked",true);$("label[for="+chk_stg_id+"]").css({"color":"Red","border":"2px solid blue","background-color":"white"});}
if(typeof(dx_sss_val_exp[2])!="undefined"&&dx_sss_val_exp[2]!=""){if(isDbtsCode==1){if($("#"+chk_svr_id)&&$("#"+chk_svr_id).val()==dx_sss_val_exp[2]){$("#"+chk_svr_id).prop("checked",true);$("label[for="+chk_svr_id+"]").css({"color":"Red","border":"2px solid blue","background-color":"white"});}}}else{if($("#"+chk_svr_id)&&$("#"+chk_svr_id).val()==dx_sss_val_exp[1]){$("#"+chk_svr_id).prop("checked",true);$("label[for="+chk_svr_id+"]").css({"color":"Red","border":"2px solid blue","background-color":"white"});}}}}else{for(var g=0;g<=10;g++){var chk_lat_id='elem_asDxLat'+h+'_'+mg+'_'+g;var chk_stg_id='elem_asDxStg'+h+'_'+mg+'_'+g;var chk_svr_id='elem_asDxSvr'+h+'_'+mg+'_'+g;if($("#"+chk_lat_id)&&$("#"+chk_lat_id).val()==dx_sss_val_exp[0]){$("#"+chk_lat_id).prop("checked",true);$("label[for="+chk_lat_id+"]").css({"color":"Red","border":"2px solid blue","background-color":"white"});}else{if($("#"+chk_lat_id)&&typeof(js_icd10_bilateral_arr[dx_code_db_val.toLowerCase()])!='undefined'){if(js_icd10_bilateral_arr[dx_code_db_val.toLowerCase()]==1&&$("#"+chk_lat_id).val()==3){$("label[for="+chk_lat_id+"]").css("display",'none');}}}
if($("#"+chk_stg_id)&&$("#"+chk_stg_id).val()==dx_sss_val_exp[0]){$("#"+chk_stg_id).prop("checked",true);$("label[for="+chk_stg_id+"]").css({"color":"Red","border":"2px solid blue","background-color":"white"});}
if($("#"+chk_svr_id)&&$("#"+chk_svr_id).val()==dx_sss_val_exp[0]){$("#"+chk_svr_id).prop("checked",true);$("label[for="+chk_svr_id+"]").css({"color":"Red","border":"2px solid blue","background-color":"white"});}}}}}}}}
function disDbtsProlifOptions(){$("#dx_sel_tbl :checked[id*=elem_asDx][data-valbak]").each(function(){var x=$(this).val();if(typeof(x)!="undefined"&&(x.indexOf("E10.")!=-1||x.indexOf("E11.")!=-1)&&x.length==8){var id=$(this).attr("id");var ids=id.replace(/elem_asDx/,"elem_asDxSvr");var svr=0;$("#dx_sel_tbl input[id*="+ids+"]").each(function(){if(this.checked){svr=this.value;}});var flg=0;if(svr==0||svr==5){flg=1;}
ids=ids+"_3";if($("#"+ids).length>0){var idst=id.replace(/elem_asDx/,"elem_asDxStg");$("#dx_sel_tbl label[for*="+idst+"]").each(function(){var a=$(this).html();if(a==2||a==3||a==4||a==5){if(flg==0){$(this).hide();}else{$(this).show();}}});}}});}
function PqriSetter(arrPqriCodes){var strHtml="";for(var z in arrPqriCodes){var tmpDx=z;var tmpCpt=arrPqriCodes[tmpDx];var len=tmpCpt.length;var lim=4;var cntr=lim+1;strHtml+="<div class=\"bgColor_pupil\"><b>Dx Code: "+tmpDx+"</b></div>";strHtml+="<table>";for(var i=0;i<len;i++){if(cntr>lim){strHtml+="<tr>";cntr=1;}
if(cntr<=lim){strHtml+="<td><input type=\"checkbox\" dx=\""+tmpDx+"\" name=\"elem_selPqri"+i+"\" value=\""+tmpCpt[i]+"\" onmousedown=\"stopClickBubble();\" >"+tmpCpt[i]+"</td>";cntr+=1;}
if(cntr>lim){strHtml+="</tr>";}}
strHtml+="</table>";}
if(strHtml!=""){var oPromptDiv=gebi("divChoosePqriCodes");if(oPromptDiv){oPromptDiv.style.backgroundColor="#FFDDCC";oPromptDiv.style.width="300px";strHtml="<table >"+"<tr><th >PQRI Codes</th></tr>"+"<tr><td>Select PQRI codes to display in Super Bill:-</td></tr>"+"<tr><td>"+strHtml+"</td></tr>";strHtml+="<tr><td style='text-align:center;'>"+"<input name=\"button\" type=\"button\" id=\"elem_pqricBtn\" class=\"dff_button\" "+"value=\"Insert\" onmousedown=\"stopClickBubble();\" onclick=\"getSelPQRICodes()\"> "+"<input name=\"button\" type=\"button\" id=\"elem_pqrixBtn\" class=\"dff_button\" "+"value=\"Cancel\" onmousedown=\"stopClickBubble();\" onclick=\"getSelPQRICodes(0)\">"+"</td></tr>";strHtml+="</table>";oPromptDiv.innerHTML=""+strHtml;oPromptDiv.style.display="block";var thisScrollTop=gebi("divWorkView").scrollTop;if(thisScrollTop==0){}else{oPromptDiv.style.top=(thisScrollTop+100)+"px";}
oPromptDiv.focus();stopClickBubble();}}}
function get_dx_popup_lss(oAsInfo,funcname){funcname=(typeof(funcname)!="undefined"&&funcname!="")?funcname:"";var str="";var cck=0;var strUni="",strUniDesc="";var arrdxth=new Array();var len=oAsInfo.length;for(var i=0;i<len;i++){var tAss=oAsInfo[i];var name=tAss.getElementsByTagName("name")[0].firstChild.nodeValue;var asindx=tAss.getElementsByTagName("name")[0].attributes.getNamedItem("indx").nodeValue;var arrdx=tAss.getElementsByTagName("dx");var ln2=arrdx.length;var tmp="";var chk_str_lss_tmp="";if(typeof arrdx[0]!="undefined"){chk_str_lss_tmp=getLSSHtml(arrdx[0],"strLat","Lat"+i+"_0",asindx);}
var dup_dx_row=0;if(chk_str_lss_tmp.indexOf("RUL")!=-1&&ln2<2){ln2=2;dup_dx_row=1;}
if(ln2>0){for(var k=0;k<ln2;k++){if(dup_dx_row>0){kf=0;}else{kf=k;}
var tdx=arrdx[kf].firstChild.nodeValue;var odxcat=arrdx[kf].attributes.getNamedItem("cat");var vdxcat=(odxcat)?" - "+odxcat.nodeValue:"";var odxid=arrdx[kf].attributes.getNamedItem("dxid");var vdxid=(odxid)?""+odxid.nodeValue:"";flgDisable="";if(strUni.indexOf(tdx+name)==-1||dup_dx_row>0){strUni+=tdx+name+",";}else{continue;}
var ck="";if((cck<12)&&(flgDisable!="disabled")){ck="checked";cck+=1;}
var str_lss="";var str_as_nm="";var str_as_sr_nm="";var tdx_db="";if(""+$("#hid_icd10").val()=="1"){str_as_nm=name;var str_lss_tmp="";str_lss_tmp=getLSSHtml(arrdx[kf],"strLat","Lat"+i+"_"+k,asindx);str_lss+="<td title=\"Laterality\">"+str_lss_tmp+"</td>";str_lss_tmp=getLSSHtml(arrdx[kf],"strStg","Stg"+i+"_"+k,asindx);str_lss+="<td title=\"Staging\">"+str_lss_tmp+"</td>";str_lss_tmp=getLSSHtml(arrdx[kf],"strSvr","Svr"+i+"_"+k,asindx);str_lss+="<td title=\"Severity\">"+str_lss_tmp+"</td>";str_as_sr_nm="<td>"+(i+1)+".</td>";var odxicd10bak=arrdx[kf].attributes.getNamedItem("strICD10Dx");tdx_db=(odxicd10bak)?""+odxicd10bak.nodeValue:"";}
var dx_code_box="";dx_code_box="<span class=\"checkbox\"><input type=\"checkbox\" id=\"elem_asDx"+i+"_"+k+"\" name=\"elem_asDx"+i+"_"+k+"\" value=\""+tdx+"\"  data-valbak=\""+tdx+"\"  data-valbakdb=\""+tdx_db+"\" data-asindx=\""+asindx+"\" data-dxid=\""+vdxid+"\"   "+ck+" "+flgDisable+" > <label for=\"elem_asDx"+i+"_"+k+"\">"+tdx+"</label>"+vdxcat+"</span>";if(dup_dx_row>0&&k>0){tmp+="<tr style=\"display:none;\" id=\"elem_asDx"+i+"_"+k+"_tr\">";}else{tmp+="<tr id=\"elem_asDx"+i+"_"+k+"_tr\">";}
tmp+=str_as_sr_nm+"<td class=\"small\">"+str_as_nm+"</td>"+"<td>"+dx_code_box+"</td>"+
str_lss+"</tr>";}}else{var str_as_nm="Enter Dx Code:";str_lss="";var str_as_sr_nm="";if(""+$("#hid_icd10").val()=="1"){str_as_nm=""+name;str_lss="<td></td><td></td><td></td>";str_as_sr_nm="<td>"+(i+1)+".</td>";}
tmp+="<tr>"+str_as_sr_nm+"<td class=\"small\">"+str_as_nm+"</td>"+"<td>"+"<input type=\"text\" placeholder=\"Enter Dx Code:\" name=\"elem_asDx"+i+"_0\" id=\"elem_asDx"+i+"_0\" data-asindx=\""+asindx+"\" value=\"\" class=\"dxallcodes form-control\" size=\"15\" onmousedown=\"stopClickBubble();\" onblur=\"checkDXCodesChart(this);stopClickBubble();\">"+"</td>"+str_lss+"</tr>";arrdxth[arrdxth.length]="elem_asDx"+i+"_0";}
if($.trim(tmp)!=""){if($("#hid_icd10").val()==1){str+=""+tmp;}else{str+="<tr><td colspan=\"2\"><b>"+name+"</b></td></tr>";str+=""+tmp;}}}
if(str!=""){var oDivDxCode=document.getElementById("divChooseDxCodes");oDivDxCode.innerHTML="";oDivDxCode.style.display="block";oDivDxCode.style.width="300px";var clsstbl="";if(""+$("#hid_icd10").val()=="1"){str="<tr class=\"grythead\"><td>#</td><td>Assessment</td><td>ICD10</td><td>Site</td><td>Staging</td><td>Severity</td></tr>"+str;oDivDxCode.style.width="90%";oDivDxCode.style.left="80px";clsstbl=" class=\"icd10\" ";}
var strInnerHTML="<table id=\"dx_sel_tbl\" class=\"table table-bordered table-responsive\" >"+"<tr class=\"head\"><th class='section_header1' >Dx Codes : Display in Super Bill</th></tr>";if(""+$("#hid_icd10").val()!="1"){strInnerHTML+="<tr><td></td></tr>";}
strInnerHTML+="<tr ><td  valign=\"top\" >";strInnerHTML+="<div onmousedown=\"stopClickBubble();\"><table "+clsstbl+" onmousedown=\"stopClickBubble();\"  >"+str+"</table></div>";strInnerHTML+="</td></tr>";strInnerHTML+="<tr id=\"module_buttons\" class=\"ad_modal_footer\"><td align=\"center\"><input name=\"button\" class=\"btn btn-success\" type=\"button\" id=\"elem_dxcBtn\"  value=\"Done\" onclick=\"getWantedDxCodes('"+funcname+"')\" onmousedown=\"stopClickBubble();\">"+"&nbsp;&nbsp;&nbsp;&nbsp;<input name=\"button\" class=\"btn btn-danger\" type=\"button\" id=\"elem_dxcanBtn\"  value=\"Cancel\" onclick=\"$('#divChooseDxCodes').hide();\" >"+"</td></tr>";strInnerHTML+="</table>";oDivDxCode.innerHTML=""+strInnerHTML;if($("#superbill #dx_sel_tbl div").height()<$("#superbill #dx_sel_tbl div table").outerHeight()){var tmphgt=($("#superbill #dx_sel_tbl div table").outerHeight()<600)?$("#superbill #dx_sel_tbl div table").outerHeight():600;$("#superbill #dx_sel_tbl div").height(tmphgt+"px");}
$(oDivDxCode).draggable({handle:".section_header"});var t=arrdxth.length;if(t>0){sb_addTypeAhead();}
icd10_pre_restdxcodesinpopup(len);disDbtsProlifOptions();}
return str;}
var getDCFA_strApId;function getDxCodesFromAssess(strAses){strAses=$.trim(strAses);if(strAses==""){return;}
var imgPath_tmp=zPath;var url=imgPath_tmp+"/chart_notes/requestHandler.php";var params="elem_formAction=getDxFrmAses";if(typeof(document.getElementById('hid_icd10'))!="undefined"){params+="&ICD_type="+$("#hid_icd10").val();}
params+=strAses;if(typeof(setProcessImg)!='undefined')setProcessImg("1","superbill");$.post(url,params,function(data){if(typeof(setProcessImg)!='undefined')setProcessImg("0","superbill");var str="";var xmlDoc=data;var oShowPop=xmlDoc.getElementsByTagName("prompt_user")[0];var flagShowPop=(oShowPop)?oShowPop.firstChild.nodeValue:0;var oAsInfo=xmlDoc.getElementsByTagName("assess");var len=oAsInfo.length;var oApId=xmlDoc.getElementsByTagName("apid")[0];if(oApId&&oApId.firstChild){getDCFA_strApId=oApId.firstChild.nodeValue;}
if(typeof sb_pdiv=="undefined"){sb_pdiv="";}
if(flagShowPop==1){str=get_dx_popup_lss(oAsInfo);}else{var j=0;for(var i=0;(j<len)&&(i<12);i++){var vdx=vdxid="";var tAss=oAsInfo[j];vdx=tAss.getElementsByTagName("dx")[0].firstChild.nodeValue;vdx=(typeof vdx!="undefined")?vdx:"";if(vdx!=""){var odxid=tAss.getElementsByTagName("dx")[0].attributes.getNamedItem("dxid");vdxid=(odxid&&typeof odxid!="undefined"&&typeof odxid.nodeValue!="undefined")?odxid.nodeValue:"";}
flgD=true;if(vdx!=""){for(var k=1;k<=12;k++){var oC=gebi("elem_dxCode_"+(k));var cdxid=$(oC).data("dxid");if(typeof cdxid=="undefined"){cdxid="";}
cdxid=$.trim(cdxid);if(oC&&(oC.value!="")&&(oC.value==vdx)){if(cdxid!=""&&vdxid!=""&&vdxid!=cdxid){}else{flgD=false;j++;break;}}}}
if(flgD==true){var oT=gebi("elem_dxCode_"+(i+1));if(oT&&(($.trim(oT.value)=="")||(typeof oT.value=="undefined"))){oT.value=vdx;$(oT).data("dxid",vdxid);j++;}else{}}}
setTimeout(function(){set_dx_code_titles();},100);}
if(str==""){checkAssocPqri4All();}
if(typeof(setProcessImg)!='undefined')setProcessImg("0","superbill");},"xml");}
function set_dx_code_titles(){var ar_dx=[],tdx="",tdxid="",flg=0;$(".dxallcodes").each(function(indx){tdx=$.trim(this.value);tdxid=$(this).data("dxid");if(typeof(tdxid)!="undefined"){tdxid=$.trim(tdxid);}
if(tdx!=""){ar_dx[ar_dx.length]=""+tdx+","+tdxid+","+this.id;flg++;}});if(flg>0){$.post(zPath+"/chart_notes/requestHandler.php",{"elem_formAction":"get_dx_titles","req_ptwo":"1","ar_dx[]":ar_dx},function(d){if(typeof(d)!="undefined"){for(var x in d){if(typeof(d[x])!="undefined"){renew_title($("#"+x)[0],""+d[x]);}}}},"json");}}
function is_dxcode_row_exists(valbakdb,tdxid,objVal,objhtml,trId){if(typeof valbakdb=="undefined"||typeof objVal=="undefined"||objVal==""){return 0;}
if(typeof tdxid=="undefined"){tdxid="";}
var ret=0;var retObj="";var flgChk=1;if($("#"+trId).find("td[title='Laterality'] :checked").length<2){flgChk=0;}
$("#dx_sel_tbl tr span input[type=checkbox]").each(function(){if(ret==1){return false;}
var tvalbakdb=$(this).data("valbakdb");if(valbakdb!=""&&tvalbakdb==valbakdb){var ftt=1;if(tdxid!=""){ftt=0;var tmpdxid=$(this).data("dxid");if(tdxid==tmpdxid){ftt=1;}}
if(ftt==1){var objtr=$(this).parent().parent().parent();var tmptrid=objtr.attr("id");if(typeof(trId)!="undefined"&&trId!=""){if(trId==tmptrid||$("#"+tmptrid+":visible").length==0){return true;}}
var objchecked=objtr.find("td[title='Laterality'] :checked");if(objchecked.length>0){objchecked.each(function(){if(this.value==objVal){ret=1;return false;}});}else{retObj=objtr.attr("id");}}}});if(retObj!=""&&flgChk==0){ret=0;retObj="";}
return{'ret':ret,'retObj':retObj};}
function icd10_restdxcodesinpopup(obj){var objVal=$("label[for*="+obj.id+"]").html();if(objVal=='RUL'||objVal=='RLL'||objVal=='LUL'||objVal=='LLL'||objVal=='R'||objVal=='L'||objVal=='B'){if(obj.checked==true){var tmpres=0;var objCurRow=$(obj).parent().parent();var chk_dx_id=objCurRow.find("span input[type=checkbox]");if(chk_dx_id.length>0){var tdxid=chk_dx_id.data("dxid");var valbakdb=chk_dx_id.data("valbakdb");var tmpres=is_dxcode_row_exists(valbakdb,tdxid,obj.value,objVal,$(objCurRow).attr("id"));if(tmpres.ret==1){$("#"+obj.id).prop("checked",false);$("label[for*="+obj.id+"]").css({"color":"purple","border":"2px solid transparent","background-color":"transparent"});return;}
else if(tmpres.retObj!=""){$("#"+obj.id).prop("checked",false);$("label[for*="+obj.id+"]").css({"color":"purple","border":"2px solid transparent","background-color":"transparent"});$("#"+tmpres.retObj).find(":checkbox[value='"+obj.value+"']").prop("checked",true).triggerHandler("click");return;}}
var cont_lat_Sel=0;for(var i=0;i<4;i++){var ele_chk_id=(obj.id).substr(0,((obj.id).length-1));var final_ele_chk_id=ele_chk_id+i;if(document.getElementById(final_ele_chk_id)){if(document.getElementById(final_ele_chk_id).checked==true){cont_lat_Sel=parseInt(cont_lat_Sel)+1;}}}
if(cont_lat_Sel>1){var new_ele_obj_name=(obj.name).substr(0,((obj.name).length-1));var last_obj_id="";$("#"+obj.id).prop("checked",false);$("label[for*="+obj.id+"]").css({"color":"purple","border":"2px solid transparent","background-color":"transparent"});for(var i=0;i<20;i++){var current_trgtid=obj.name.replace(/(Lat|Svr|Stg)/g,"")+'_tr';var curr_tr_data=$("#"+current_trgtid).html();var chk_new_tr_id=new_ele_obj_name.replace(/(Lat|Svr|Stg)/g,"")+i+'_tr';if(typeof($("#"+chk_new_tr_id).html())=="undefined"){var old_obj_id_num=(obj.name).substr(((obj.name).length-3),((obj.name).length));var old_obj_id_num_exp=old_obj_id_num.split('_');var new_obj_id=old_obj_id_num_exp[0]+'_'+i;var final_data='<tr id="'+chk_new_tr_id+'">'+curr_tr_data+'</tr>';var obj_id_rep=new RegExp(old_obj_id_num,"g");final_data=final_data.replace(obj_id_rep,new_obj_id);$(final_data).insertAfter($("#"+last_obj_id));var new_tr_obj=obj.id.replace(old_obj_id_num,new_obj_id);obj=document.getElementById(new_tr_obj);$("label[for*="+obj.name+"]").css({"color":"purple","border":"2px solid transparent","background-color":"transparent"});$("#"+obj.id).prop("checked",true);$("label[for="+obj.id+"]").css({"color":"Red","border":"2px solid blue","background-color":"white"});break;}
last_obj_id=chk_new_tr_id;}}else{$("label[for="+obj.id+"]").css({"color":"Red","border":"2px solid blue","background-color":"white"});}}else{$("label[for*="+obj.id+"]").css({"color":"purple","border":"2px solid transparent","background-color":"transparent"});}}else{$("label[for*="+obj.name+"]").css({"color":"purple","border":"2px solid transparent","background-color":"transparent"});if(obj.checked){$("label[for="+obj.id+"]").css({"color":"Red","border":"2px solid blue","background-color":"white"});$(":checked[name="+obj.name+"][id!="+obj.id+"]").prop("checked",false);}}
var trgtid=obj.name.replace(/(Lat|Svr|Stg)/g,"");var trgtval=$("#"+trgtid).val();var valChk=$.trim($("#"+trgtid).data("valbak"));var valChkdb=$.trim($("#"+trgtid).data("valbakdb"));if(valChk.length==valChkdb.length){var valChkdb_tmp=""+valChkdb.replace(/-/g,"\\w");var rex=new RegExp(""+valChkdb_tmp,"gi");var rez=valChk.match(rex);if(rez){valChk=valChkdb;}}
$("#"+trgtid).prop("checked",true);var setVal=(obj.checked)?obj.value:"-";var isDbtsCode=0;if(valChkdb.length==8&&(valChkdb.indexOf("E10.")!=-1||valChkdb.indexOf("E11.")!=-1)){isDbtsCode=1;}
var trgtvalNew="";if(obj.id.indexOf("Lat")!=-1){if(isDbtsCode==1){if(valChkdb.charAt(7)=='-'){var tt=trgtval.substr(0,7);var tt1=trgtval.substr(8);trgtvalNew=tt+setVal;}}else{if(valChk.charAt(6)=='-'){var tt=trgtval.substr(0,6);var tt1=trgtval.substr(7);trgtvalNew=tt+setVal+tt1;}else{if(valChk.substr(-3,3)!='-X-'||valChk.substr(-3,3)!='-x-'){var tt=trgtval.substr(0,5);var tt1=trgtval.substr(6);trgtvalNew=tt+setVal+tt1;}}}}else{if(isDbtsCode==1){if(obj.id.indexOf("Stg")!=-1){if(valChkdb.charAt(6)=='-'){var tt=trgtval.substr(0,6);var tt1=trgtval.substr(7);trgtvalNew=tt+setVal+tt1;}}else if(obj.id.indexOf("Svr")!=-1){if(valChkdb.charAt(5)=='-'){var tt=trgtval.substr(0,5);var tt1=trgtval.substr(6);trgtvalNew=tt+setVal+tt1;}}}else{if(valChk.indexOf("-")!=-1&&valChk.indexOf("--")==-1&&valChk.indexOf("-X-")==-1&&valChk.indexOf("-x-")==-1){trgtvalNew=valChk.replace('-',setVal);}else{if(valChk.indexOf("--")!=-1){var tt=trgtval.substr(0,7);trgtvalNew=tt+setVal;}else if(valChk.indexOf("-X-")!=-1||valChk.indexOf("-x-")!=-1){var tt=trgtval.substr(0,7);trgtvalNew=tt+setVal;}}}}
if(trgtvalNew!=""){$("#"+trgtid).val(""+trgtvalNew);var asindx=$("#"+trgtid).data("asindx");$("label[for="+trgtid+"]").html(""+trgtvalNew);var tm=""+trgtid.replace("elem_asDx","").split("_");if(""+tm[0]!=""){var tmp_asindx=(asindx&&asindx!="")?asindx:parseInt(tm[0])+1;var tmid="elem_assessment_dxcode"+tmp_asindx;if($("#"+tmid).length>0&&""+$("#"+tmid).val()!=""){if(""+$("#"+tmid).val().indexOf(",")!=-1||""+$("#"+tmid).val().indexOf(";")!=-1){var arrtmp=($("#"+tmid).val().indexOf(",")!=-1)?$("#"+tmid).val().split(","):$("#"+tmid).val().split(";");if(arrtmp.length>0){var strdx="";var flgin=0;for(var t in arrtmp){arrtmp[t]=$.trim(arrtmp[t]);if(arrtmp[t]!=""){if($("#"+tmid).val().indexOf("-")!=-1){var inx=valChk.indexOf("-");var ck=valChk.substring(0,inx);if(arrtmp[t].indexOf(ck)!=-1){if(strdx!=""){strdx+=", ";}
strdx+=trgtvalNew;}else{if(strdx!=""){strdx+=", ";}
strdx+=arrtmp[t];}
flgin=1;}else{if(strdx!=""){strdx+=", ";}
if($.trim(arrtmp[t])!=$.trim(trgtvalNew)){strdx+=arrtmp[t];}else{flgin=1;}}}}
if(flgin==0){if(strdx!=""){strdx+=", ";}
strdx+=trgtvalNew;}}
$("#"+tmid).val(strdx).trigger("keyup");}else{var tdx=$("#"+tmid).val();var tdx_1=tdx.slice(0,-1);var tdx_2=trgtvalNew.slice(0,-1);if(tdx_1==tdx_2&&tdx.indexOf("-")!=-1){tdx=trgtvalNew;}else{tdx=tdx+", "+trgtvalNew;}
$("#"+tmid).val(tdx).trigger("keyup");}}else{$("#"+tmid).val(trgtvalNew).trigger("keyup");}}
var asdx="";var x=trgtid.match(/elem_asDx\d+/);$("#dx_sel_tbl :checked[id*="+x+"][data-valbak]").each(function(){if(typeof(this.value)!="undefined"&&this.value!=""&&asdx.indexOf(this.value)==-1){if(asdx!=""){asdx+=", ";}asdx+=this.value;}});$("#"+tmid).val(asdx).trigger("keyup");}
disDbtsProlifOptions();}
function replace_cid10_extra_string(val){val=val.replace('Right Eye','Right');val=val.replace('Left Eye','Left');val=val.replace('Both Eyes','Both');val=val.replace('Initial Encounter Closed Fracture','Closed');val=val.replace('Initial Encounter Open Fracture','Open');val=val.replace('Subsequent Encounter for Fracture with Routine Healing','Routine');val=val.replace('Subsequent Encounter for Fracture with Delayed Healing','Delayed');val=val.replace('Subsequent Encounter for Fracture with Non Union','Union');val=val.replace('Initial Encounter','Initial');val=val.replace('Subsequent Encounter','Subsequent');val=val.replace('Adv atrophic w/o subfoveal Involvement','w/osubfoveal');val=val.replace('Adv atrophic w subfoveal Involvement','wsubfoveal');val=val.replace('Active neovascularization','Active');val=val.replace('Inactive neovasculization','Inactive');val=val.replace('AdInactive scar','scar');val=val.replace('w/ macular edema','edema');val=val.replace('w/ret neovaculaization','neovaculaization');return val;}
function getRvsDoneLevel(str){var arrLoc=new Array("Right Eye","Left Eye","Both Eyes","Right Eyelids","Left Eyelids","RUL","RLL","LUL","LLL","Peripheral vision","Paraxial vision","Central vision","Head","left side of head","right side of head","left side of face","right side of face","fore head","scalp","selLocOpt","selLocOther");var arrQuality=new Array("Stabbing","Dull","Aching","Doing well","Feels improvement","Tolerating","Quality~Worsening","Quality~Stable","Resolved","No changes noted","New","Quality~Increased","Quality~Decreased","Initially improved then worsened","Quality~Burning","distorted","dry","foggy","ghosting","Quality~glare","hazy","Quality~itching","pressure","scratchy","sharp","throbbing","watery","Quality~patient unsure","since surgery","since birth","since childhood","since last visit","many years","otherQty");var arrSeverity=new Array("Mild","Moderate","Severe","None",'Severity~Intermittent','Severity~Constant',"Decreased","Increased","Worsening","scale1To10","rvs_other_svrity");var arrTimeOnset=new Array("selectNo-","selectDate-","elem_sp_surtype","elem_sp_surdate","other_onset","many years","Patient unsure","Since surgery","Since birth","Since childhood","Since last visit");var arrContext=new Array("Reading","driving","outside","inside","otherContext");var arrModFact=new Array("MF~inside","outdoors","night","distance vision than near","near vision than distance","when transition from dark to light","when transition from light to dark","in dim light","early in the day","late in the day","with intensive visual activity (readingcomma computer)","with daily activities","makesBetter-","makesWorse-","otherFactors","rvs_painrelievedby");var arrAssocSign=new Array("Pain","Itching","Burning","Headache","Redness","Light sensitivity","Irritation","Blurry Vision","Halos","Foreign body sensation","Sharp",'ASAS~Dull',"Ache","Headaches","Eye pain","double vision","flashes","floater","ocular redness","glare","dizziness or light-headedness","weakness","tearing","high ocular pressure","none","otherSymptoms");var arrDoe=new Array("DoE~Intermittent","DoE~Uncertain","selectDoE","Sudden","Gradual","Constant","otherDoe","onSetDate");var arrVis=new Array("Blurry","Improved","Worse","Stable","rvsdet_otherVision");var arrDip=new Array("Dip~None","Dip~Mild","Dip~Improved","Dip~Worse");var arrMed=new Array("is following medication instructions","is not taking medications","ran out of meds","has finished meds as instructed","needs med refill","rvs_ranoutmeds","rvs_needs_med_refill");var arrCI=new Array("otherFollowCareInstruct");var arrOther=new Array("rvs_followup_detail_other");var arrParNeg=["no eye Pain","no Itching","no Tearing","no Flashes","no floaters","no Glare","no Red Eye","no Headache","no Dryness","no Distortion","no Change in Amsler Grid","no Ocular Trauma","no Pain with Eye Movement","no Loss of Consciousness","no Visual Phenomenon","no Pain or Tearing","no ShadowcommaCurtain or Veil","no Flashescommafloatercommashadowcommacurtain or Veil","no FevercommaWeight LosscommaScalp TendernesscommaHeadache or Jaw Claudication","other_par_neg"];var arrAll=[arrLoc,arrQuality,arrSeverity,arrTimeOnset,arrContext,arrModFact,arrAssocSign,arrDoe,arrMed];var arr_txt_fields=["rvs_needs_med_refill","rvs_ranoutmeds","rvs_other_svrity","otherQty","other_onset","selLocOther","otherSymptoms","otherFactors","otherContext","scale1To10","otherDoe","selLocOther"];var ret=1;var cntr=0;if($.trim(str)!=""){var arrStr=str.split(",");if(arrStr.length>0){for(var x in arrStr){var t=(typeof(arrStr[x])!="undefined"&&arrStr[x]!="")?arrStr[x]:"";if(t!=""&&t.indexOf("-")!=-1){var art=t.split("-");if(arr_txt_fields.indexOf(art[0])!=-1){arrStr[x]=art[0];}else if(art[0]=="selectNo"||art[0]=="selectDate"){arrStr[x]=art[0]+"-";}}}}
var len=arrAll.length;for(var i=0;i<len;i++){var arin=arrAll[i];for(var x in arin){if(-1!=arrStr.indexOf(arin[x])){cntr+=1;break;}}
if(cntr>=4){break;}}}
ret=(cntr>=4)?3:2;return ret;}
function getRvsDoneSt(){var cntrRet=0;if((complaint1.toString()!="")||(complaint2.toString()!="")||(complaint3.toString()!="")){cntrRet=1;if(complaint1.toString()!=""){cntr=getRvsDoneLevel(""+complaint1);if(cntr>cntrRet){cntrRet=cntr;}}
if(complaint2.toString()!=""){cntr=getRvsDoneLevel(""+complaint2);if(cntr>cntrRet){cntrRet=cntr;}}
if(complaint3.toString()!=""){cntr=getRvsDoneLevel(""+complaint3);if(cntr>cntrRet){cntrRet=cntr;}}}else{var ar=["-Vision Problem: Difficulty in","\r\n-Glare Problem: ","\r\n-Other Vision Problem: ","\r\n-Patient Comments: ","\r\n-Irritation Lids: ","\r\n-Irritation Ocular: ","\r\n-Post Segment: ","\r\n-Flashing Lights: ","\r\n-Floaters: ","\r\n-Amsler Grid: ","\r\n-Double vision: ","\r\n-Temporal Arteritis symptoms: ","\r\n-Loss of vision: ","\r\n-Headaches: ","\r\n-Migraine Headaches: ","\r\n-Post Op: ","\r\n-Follow Up: "];var s=$("#elem_ccompliant").val();if(typeof(s)=="undefined"){s="";}
for(var x in ar){if(s.toLowerCase().indexOf(ar[x].toLowerCase())!=-1){cntrRet=1;}}
if(cntrRet==0){var arrElemNames=new Array("elem_vpDis[]","elem_vpMidDis[]","elem_vpNear[]","elem_vpGlare[]","elem_vpOther[]","elem_irrLidsExt[]","elem_irrOcu[]","elem_postSegSpots","elem_postSegFL[]","elem_postSegFloat[]","elem_postSegAmsler[]","elem_neuroDblVis[]","elem_neuroTAS[]","elem_neuroMigHead[]","elem_neuroMigHeadAura[]","elem_neuroVisLoss[]","elem_fuFollowUp[]","elem_fuPostOp[]","elem_neuroHeadaches[]");for(var x in arrElemNames){var elem=document.getElementsByName(arrElemNames[x]);var len=elem.length;for(var i=0;i<len;i++){if(elem[i].checked==true){cntrRet=1;break;}}}}
if(cntrRet==0){var arT=["elem_vpDisOther","elem_vpMidDisOther","elem_vpNearOther","elem_vpOtherOther","vpComment","elem_irrLidsExtOther","elem_irrOcuOther","elem_neuroTASOther","elem_neuroMigHeadAuraOther","elem_neuroVisLossOther","elem_fuPostOp_other","elem_fuFollowUp_other"];for(var x in arT){var t=$("#"+arT[x]).val();if(t!=""&&typeof(t)!="undefined"){cntrRet=1;}}}}
return(typeof cntrRet!="undefined")?cntrRet:0;return 0;}
var sb_chkDia_inx;var sb_dm_popup_old;var call_CHECK_DIABETES;function sb_checkDiabetes(dib_type,obj,num,hgl,com){if((finalize_flag!=0&&isReviewable!=1)||elem_per_vo=="1"||$("#hid_icd10").val()!="1"){if(z_flg_diab_sb=="1"){opSuperBill(1);}
return;}
if(z_flg_diab_sb=="1"){var flgDMCodeEntered=sb_clearDiabetesAssessments(1);if(flgDMCodeEntered==1){opSuperBill(1);return;}}
if(typeof(hgl)!="undefined"&&hgl=="1"){var chk=$(obj).hasClass("highlight");if(chk==true){$(obj).removeClass("highlight");return;}
var stg=$(obj).html();if(num=="1"){if(sb_dm_popup_old){$("#dialog-msg-diab td[onclick]").removeClass("highlight");}}else if(num=="t1"||num=="t2"){}else{if(stg=="Right"||stg=="Left"){if($("#tbl_dbts_2").length<=0){var x=0;if(x==0){var clone_htm=$("#tbl_dbts_1").html();clone_htm="<table id=\"tbl_dbts_2\" cellpadding=\"2\" style=\"width:100%;\">"+clone_htm+"</table>";$(clone_htm).insertAfter("#tbl_dbts_1");$("#tbl_dbts_2 td[onclick]").removeClass("highlight");}}else{var x=0;$("#dialog-msg-diab td.highlight").each(function(){if($(this).html()!=""&&$(this).html()==stg){x+=1;}});if(x>0){return;}}}else if(stg=="Both"){var both_tbl_id=$(obj).parents("table[id*=tbl_dbts_]").attr("id");if(both_tbl_id=="tbl_dbts_2"){$("#tbl_dbts_1").remove();$("#tbl_dbts_2").attr("id","tbl_dbts_1");}else{$("#tbl_dbts_2").remove();}}
$(obj).parent().parent().parent().parent().find("td[onclick]").removeClass("highlight");}
sb_chkDia_inx=num;$(obj).addClass("highlight");if(stg=="Proliferative"){$(obj).parents("table[id*=tbl_dbts_]").find("#tbl_trd").show();$(obj).parents("table[id*=tbl_dbts_]").find("#tbl_wo_me").show();}else if(stg=="Mild"||stg=="Mod"||stg=="Severe"){$(obj).parents("table[id*=tbl_dbts_]").find("#tbl_trd").hide();$(obj).parents("table[id*=tbl_dbts_]").find("#tbl_wo_me").show();}
return;}
if(typeof(obj)!="undefined"){var dx_org=$("#dialog-msg-diab").data("dxcode");var assess_org=$("#dialog-msg-diab").data("assess");var assess=[],dx=[],eye=[];var assess_take=[],dx_take=[],eye_take=[];$("#dialog-msg-diab td.highlight").each(function(){var a=$(this).data("md");var b=$(this).html();if(a=="t1"||a=="t2"){var assess_t=""+$(this).data("asmt");var dx_t=""+$(this).data("dx");assess_take[assess_take.length]=assess_t;dx_take[dx_take.length]=dx_t;return;}
var tbl_id=""+$(this).parents("table[id*=tbl_dbts_]").attr("id");if(typeof(assess[tbl_id])=="undefined"){assess[tbl_id]="";}
if(typeof(dx[tbl_id])=="undefined"){dx[tbl_id]="";}
if(typeof(eye[tbl_id])=="undefined"){eye[tbl_id]="";}
var assess_t=""+assess[tbl_id];var dx_t=""+dx[tbl_id];var eye_t=""+eye[tbl_id];if(sb_dm_popup_old!=1){if((b.indexOf("E1")!=-1&&b.indexOf(".9")!=-1)||(b.indexOf("Diabetes Type 1 No retinopathy")!=-1)||(b.indexOf("Diabetes Type 2 No retinopathy")!=-1)){dx_t=$("#dbts_icd10_dx_1").html();assess_t=b;}else{var w1="";var a1="";if(a.indexOf("s")!=-1){a1="s";w1="5";}else if(a.indexOf("e")!=-1){a1="e";w1="6";}else if(a.indexOf("l")!=-1){a1="l";w1="7";}else{a1="";w1="100";}
if(a1!=""){if(dx_t==""){dx_t=dx_org;}
a=a.replace(a1,"");var dx1=dx_t.substr(0,w1);var dx3=dx_t.substr(parseInt(w1)+1);dx_t=dx1+a+dx3;if(a1!="l"){assess_t=assess_t+" "+b;}else{if(b=="Right"){eye_t="OD";}
else if(b=="Left"){eye_t="OS";}
else if(b=="Both"){eye_t="OU";}}}}}else{assess_t=$("#dbts_icd10_"+num).html();dx_t=b;}
if(assess_t!=""){assess[tbl_id]=assess_t;}
if(dx_t!=""){dx[tbl_id]=dx_t;}
if(eye_t!=""){eye[tbl_id]=eye_t;}});var udx;var pl=sb_clearDiabetesAssessments(udx,1);var assess_t=assess_org;var eye_t="",dx_t="";com=$.trim(com);for(var x in assess){if(assess[x]&&typeof(assess[x])!="undefined"&&assess[x]!=""){var as=$.trim(assess[x]);as_cd=dx[x];if(typeof(eye[x])!="undefined"&&eye[x]!=""){if(eye_t==""){eye_t=eye[x];}else{if((eye[x]=="OD"&&eye_t=="OS")||(eye[x]=="OS"&&eye_t=="OD")){eye_t="OU";}}
if(eye[x]=="OD"){as="Right "+as;}
if(eye[x]=="OS"){as="Left "+as;}
if(eye[x]=="OU"){as="Both "+as;}}
if(sb_dm_popup_old!=1){if(as.indexOf("No retinopathy")==-1){if(assess_t.indexOf(";")==-1){assess_t=assess_t+"; ";}else{assess_t=assess_t+", ";}
assess_t=assess_t+""+as;}else{assess_t=as;}}else{assess_t=as;}
if(typeof(as_cd)!="undefined"&&as_cd!=""){if(dx_t!=""){dx_t=dx_t+", ";}
dx_t=dx_t+as_cd;}}}
if(typeof(eye_t)=="undefined"){eye_t="";}
if(typeof(com)!="undefined"&&com!=""){if(assess_t!=""){assess_t=assess_t+"; \n"+com;}}
if(typeof(pl)=="undefined"){pl="";}
if(typeof(dx_t)=="undefined"){dx_t="";}
if(typeof(assess_t)!="undefined"&&assess_t!=""){sb_addAssessOption(""+assess_t,""+pl,0,""+eye_t,"",""+dx_t,"");}
if(assess_take.length>0){for(var z in assess_take){if(typeof(assess_take[z])!="undefined"&&assess_take[z]!=""){sb_addAssessOption(""+assess_take[z],"",0,"","",""+dx_take[z],"");}}}
$("#dialog-msg-diab").dialog("destroy");$("#dialog-msg-diab").remove();if(z_flg_diab_sb=="1"){opSuperBill(1);}
return;}
var dib_type_qry="";if(typeof(dib_type)!="undefined"){$("#dialog-msg-diab").dialog("destroy");$("#dialog-msg-diab").remove();dib_type_qry="&set_diabetes_type="+dib_type;}
var dib_type_as="";var ass_nm="#assessplan textarea[name*='elem_assessment[]']";if(typeof(wpage)!="undefined"&&wpage=="accSB"){ass_nm=".assnm";}
var ass_nm_w_dm="";var ass_nm_w_dm_take="";$(""+ass_nm).each(function(){var as=$.trim(this.value).toLowerCase();var mtch=isDiabetesAssess(as,z_flg_diab_sb);if(mtch){dib_type_as="&get_diabetes_assess="+mtch+"&as="+as;ass_nm_w_dm=this.id;}
if(isDbTakeAssess(as)){if(as.indexOf("insulin")!=-1){ass_nm_w_dm_take+="t1";}
if(as.indexOf("hypoglycemic")!=-1){ass_nm_w_dm_take+="t2";}}});if(ass_nm_w_dm_take!=""){dib_type_as+="&dm_asmt_take="+ass_nm_w_dm_take;}
if(typeof(setProcessImg)!='undefined')setProcessImg(1,"assessplan");if($("#dialog-msg-diab").length>0){$("#dialog-msg-diab").remove();$("#dialog-msg-diab").dialog("destroy");}
if(typeof(call_CHECK_DIABETES)!="undefined"&&call_CHECK_DIABETES==1){return;}
call_CHECK_DIABETES=1;var turl=zPath+"/chart_notes/requestHandler.php?elem_formAction=CHECK_DIABETES&z_flg_diab_sb="+z_flg_diab_sb+dib_type_qry+dib_type_as;$.get(turl,function(data){call_CHECK_DIABETES=0;if(typeof(setProcessImg)!='undefined')setProcessImg(0,"assessplan");if(z_flg_diab_sb==""){}else{sb_dm_popup_old=data.flgShowOldPop
if(data.msg=="DIABETES TYPE POPUP"||data.msg=="DIABETES TYPE 1 POPUP"||data.msg=="DIABETES TYPE 2 POPUP"){$("body").append(data.html);if(data.show_pop_up_h_option){$("#dialog-msg-diab td[id]").each(function(){if($(this).html().toLowerCase().indexOf(data.show_pop_up_h_option.toLowerCase())!=-1){$(this).css({"background-color":"Yellow"});}});}
var obtns=[];if(data.msg!="DIABETES TYPE POPUP"){if(sb_dm_popup_old!=1){obtns[obtns.length]=sb_getSeverityScaleObj();}
obtns[obtns.length]={text:"Done",click:function(){var cm=$("#dialog-msg-diab #ta_dbts_icd10_cm").val();if($("#dialog-msg-diab td.highlight").length>0){sb_checkDiabetes('',$("#dialog-msg-diab td.highlight")[0],sb_chkDia_inx,'',cm);}else if(cm!=""){if(typeof(ass_nm_w_dm)!="undefined"&&ass_nm_w_dm!=""){var nm=ass_nm_w_dm.replace("elem_assessment","");var x=$("#elem_assessment"+nm+"").val();if(x!=""){var arx=x.split(";");x=arx[0];}x=(typeof(x)!="undefined"&&x!="")?x+";"+cm:cm;$("#elem_assessment"+nm+"").val(x).trigger("blur");$("#dialog-msg-diab").dialog("close");}else{$("#dialog-msg-diab").dialog("close");}}}};}
obtns[obtns.length]={text:"Cancel",click:function(){$("#dialog-msg-diab").dialog("close");$("#svrt_scl_info").remove();}}
if(data.msg!="DIABETES TYPE POPUP"){obtns[obtns.length]={id:"dmb_reset",text:"Reset",click:function(){$("#dialog-msg-diab textarea").val("");$("#dialog-msg-diab td[onclick]").removeClass("highlight");if(typeof(ass_nm_w_dm)!="undefined"&&ass_nm_w_dm!=""){var nm=ass_nm_w_dm.replace("elem_assessment","");$("#elem_assessment"+nm+",#elem_assessment_dxcode"+nm+",#elem_plan"+nm).val("").trigger("blur");$("#elem_apOu"+nm+",#elem_apOd"+nm+",#elem_apOs"+nm+",#elem_resolve"+nm+",#no_change_"+nm).prop("checked",false).triggerHandler("click");}sb_clearDbAsTaking();}};}
$("#dialog-msg-diab").dialog({modal:false,width:600,buttons:obtns,close:function(event,ui){$(this).dialog("destroy");$("#dialog-msg-diab").remove();if(z_flg_diab_sb=="1"&&z_flg_diab_sb!="2"){opSuperBill(1);};}});$("#dmb_reset").css({"float":"right"});$("#dmb_svrt_scl").css({"float":"left","background":"none","color":"purple","border":"none","font-weight":"bold"});return;}}
if(data.assess&&typeof(data.assess)!="undefined"&&data.assess!=""){var as_cd=(data.assess_code&&typeof(data.assess_code)!="undefined"&&data.assess_code!="")?""+data.assess_code:"";if(!sb_clearDiabetesAssessments(1)){sb_clearDiabetesAssessments();sb_addAssessOption(""+data.assess,"",0,"","",""+as_cd,"");}}
if(z_flg_diab_sb=="1"){opSuperBill(1);}},"json");}
function printPlanFun(ocu){var final_flag="",form_id="";if(document.getElementById('hidd_final_flag')){final_flag=document.getElementById('hidd_final_flag').value;}
if(document.getElementById('hidd_final_flag')){form_id=document.getElementById('hidd_formId').value;}
if(typeof(form_id)=="undefined"||form_id==""){form_id=$("#form_id").val();}
if(typeof(final_flag)=="undefined"||final_flag==""){final_flag=0;}
if(typeof(ocu)=="undefined"){ocu=0;}
medication=null;$.ajax({url:zPath+"/chart_notes/requestHandler.php?elem_formAction=chart_plan_print&final_flag="+final_flag+"&form_id="+form_id+"&medication="+medication+"&ocu="+ocu,success:function(resp){if(resp){if(top.fmain&&top.fmain.showOtherForms){top.fmain.showOtherForms(zPath+'/../library/html_to_pdf/createPdf.php?file_location='+resp,'print_plan_win','1000','400');}
else{window.open(zPath+'/../library/html_to_pdf/createPdf.php?file_location='+resp,'print_plan_win','toolbar=0,width=1000,height=400,resizable=1');}}else{top.fAlert('No Medication Exists');}}});}
function dx_assoc_cpt(o){var v_icd_10=$("#hid_icd10").val();if(v_icd_10!="1"&&v_icd_10!="10"){var arcurdx=""+fun_mselect(this,"val");if(arcurdx&&arcurdx!="null"&&arcurdx!=""){var tmp_arcurdx=arcurdx.split(",");var lm=4;if(tmp_arcurdx.length>lm){top.fAlert("You cannot select more than 4 Dx codes for a procedure.");return false;}}}
sb_checknwarn4WrongDxcode(o);fun_mselect('.selectpicker','width');}
function dx_assist(){var a=$("#superbill .dxallcodes").filter(function(){return $.trim(this.value)!=""?1:0;}).length;var b=$("#tblSuperbill .cptcode").filter(function(){return $.trim(this.value)!=""?1:0;}).length;if(a==0||b==0){top.fAlert("Please enter CPT and DX codes in superbill.");return;}
var ar=[];var str_cpt="";$("#tblSuperbill .cptcode").each(function(){if(typeof(this.value)!="undefined"&&$.trim(this.value)!=""){ar[this.id]=this.value;str_cpt+=""+this.id+"="+encodeURIComponent(this.value)+"&";}});var param="elem_formAction=get_valid_dx_codes&"+str_cpt;if(typeof(setProcessImg)!='undefined')setProcessImg("1","superbill");$.get(zPath+"/chart_notes/requestHandler.php",param,function(d){if(typeof(setProcessImg)!='undefined')setProcessImg("0","superbill");if(d){for(var a in d){if(a&&d[a]){var x=$.trim(d[a]);if(x!=""){var chk_all="";var ax=x.split(",");var l=ax.length;for(var i=0;i<l;i++){if(typeof(ax[i])!="undefined"&&ax[i]!=""){var chk=$.trim(ax[i]);$("#superbill .dxallcodes").each(function(){var t=$.trim(this.value);if(typeof(t)!="undefined"&&t!=""){var q1=""+t.slice(0,-1)+"-";var q2=""+t.slice(0,-2)+"--";var q3=""+t.slice(0,-3)+"-x-";if(t==chk||q1==chk||q2==chk||q3==chk){if(chk_all!=""){chk_all+=",";}chk_all+=t;return false;}}});}}
if(chk_all!=""){var cdx=a.replace("elem_cptCode_","elem_dxCodeAssoc_");fun_mselect("#"+cdx,"select",chk_all);$("#"+a).triggerHandler("blur");}}}}}},"json");}
function sb_add_menu(o,h,t){if(typeof(o)!="undefined"){if(!$(o).hasClass("dropdown-toggle")){if(typeof(h)=="undefined"){var g="";if($(o).parent().hasClass("menu_cpt")){g='menu_cpt';}else if($(o).parent().hasClass("menu_mod")){g='menu_mod';}
if(g!=""){if($("#superbill ."+g+"_ul").length<=0){if(typeof(setProcessImg)!='undefined')setProcessImg("1","superbill");$.get(zPath+"/chart_notes/requestHandler.php?elem_formAction=get_sb_menu&wh="+g+"&req_ptwo=1",function(d){if(typeof(setProcessImg)!='undefined')setProcessImg("0","superbill");if(typeof(d)!="undefined"&&d!=""){sb_add_menu(o,d,1);}});}else{var d=$("#superbill ."+g+"_ul").get(0).outerHTML;if(typeof(d)!="undefined"&&d!=""){sb_add_menu(o,d);}}
return;}}else{var trgtid=''+$(o).parent().parent().find(".form-control").attr("id");$(o).parent().append(h);if(($("#hid_save_section").length>0&&$("#hid_save_section").val()=="accounts")||1==1){$(o).parent().addClass("dropup");}
$(o).attr("data-toggle","dropdown");$(o).attr("data-trgt-id",trgtid);$(o).addClass("dropdown-toggle");$(o).unbind("click",'sb_add_menu');$(o).dropdown();$(o).parent().find("a").bind("click",function(e){if(!$(this).hasClass("cat")){var t=$(o).data("trgt-id");$("#"+t).val($(this).data("val")).trigger("blur");$(o).parent().find("ul.dropdown-menu-active").removeClass("dropdown-menu-active").toggle();$(o).dropdown("toggle");}else{$(this).next('ul').addClass("dropdown-menu-active").toggle();}
e.stopPropagation();e.preventDefault();});if(typeof(t)!="undefined"&&t=="1"){$(o).dropdown("toggle");}}}}else{for(var i=0;i<2;i++){var m=e=t="";if(i==0){m="menu_cpt";t="tr[id*=elem_trSB] .cpt_td .input-group";e=".cptcode";}else if(i==1){m="menu_mod";t="tr[id*=elem_trSB] .md .input-group";e=".modcode";}
var s='<div class="input-group-btn menu '+m+' "><button type="button" class="btn" onclick="sb_add_menu(this)" ><span class="caret"></span></button></div>';$(""+t+"").each(function(){if($(this).find("div").length==0){$(this).find(e).after(s);}});if(typeof(sb_testName)!="undefined"&&sb_testName!=""){$(""+e+"").parent().find(".btn").css({"height":"26px"});}}}}
var escapeRegExp=function(string){return string.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");}
function rgp(s,m){if(typeof(s)!="undefined"&&s!=""){if(typeof(m)=="undefined"){m="gi";}
return new RegExp(s,m);}
return s;}
function js_htmlentities(str){return String(str).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');}
function mk_var_nm(str,wh){str=str.replace(/[^0-9a-z]/gi,'');str=wh+str;return str;}
function regReplace(ptrn,repW,str){if($.trim(ptrn)!=""){var reg=new RegExp(ptrn,"g");var mtch=str.match(reg);if(mtch){str=str.replace(reg,"");}else{}}
return $.trim(str);}
function gebi(id,t){var o;if(t==1){o=document.getElementsByName(id);}else if(t==2){o=document.getElementsByTagName(id);}else{o=document.getElementById(id);if(o==null){o=document.getElementsByName(id)[0];}}
return o;}
function stopClickBubble(flg)
{var ev=window.event;if(ev){if(typeof(flg)!="undefined"&&flg==1){var chk=ev.srcElement.nodeName;var chktag=ev.srcElement.tagName;var eType=ev.srcElement.type;if(chk=="INPUT"||chk=="TEXTAREA"||((eType=="change"||eType=="keyup"||eType=="mousedown")&&chk=="SELECT")){return;}}
ev.cancelBubble=true;if(ev.stopPropagation)ev.stopPropagation();}}
function get_src_center(){var left=($(window).width()/2);var top=($(window).height()/2);return{'top':top,'left':left};}
function scroll_into_view(sele,hid){var offset=$(sele).offset();var diff=0;var scrollTop=$(window).scrollTop();var scrollBottom=scrollTop+$(window).height();var ofHgt=$(sele).height();var offsetBottom=offset.top+ofHgt;if(offsetBottom>scrollBottom){diff=scrollTop+(offsetBottom-scrollBottom);$('html, body').animate({scrollTop:diff},'slow','linear');}}
function get_js_dt_frmt(){var d=(typeof(top.jquery_date_format)!="undefined"&&top.jquery_date_format!="")?top.jquery_date_format:"mm-dd-yy";if(d=="m-d-Y"){d="mm-dd-yy";}
return d;}
function currenttime(){var Digital=new Date()
var hours=Digital.getHours()
var minutes=Digital.getMinutes()
var seconds=Digital.getSeconds()
var dn="PM"
if(hours<12)
dn="AM"
if(hours>12)
hours=hours-12
if(hours==0)
hours=12
if(minutes<=9)
minutes="0"+minutes
if(seconds<=9)
seconds="0"+seconds
var ctime=hours+":"+minutes+dn
return ctime;}
function insertDate(obj){var id=obj.name.replace(/Txt/g,"Dt");var tobj=gebi(id);if(tobj){tobj.value=$.datepicker.formatDate('mm-dd-yy',new Date());}}
function insertTime(obj){var id=obj.name.replace(/finding/g,"timeStamp");var tobj=gebi(id);if(tobj&&tobj.value==""){tobj.value=currenttime();if(typeof(tobj.onblur)=="function"){tobj.onblur();}}
if(obj.name.indexOf("schirmer")!=-1){var id=obj.name.replace(/finding/g,"date");var tobj=gebi(id);if(tobj&&tobj.value==""){tobj.value=$.datepicker.formatDate('mm-dd-yy',new Date());}}}
function fun_mselect(o,w,v,t,f){if(w=="val"){var x=$(o).selectpicker('val');if(!x){x="";}return x;}else if(w=="title"){return $(o).parent().find("button").attr("title");}else if(w=='render'||w=='refresh'){$(o).selectpicker(w);}else if(w=='select'){if(typeof(f)!="undefined"&&f!=""){if(typeof(v)!="undefined"&&v.length>0){var ar_chk=v.split(', ');}}
$(o).find('option[value]').each(function(){var art=this.value.split('\*\*');var tv=this.value;if(typeof(f)!="undefined"&&f!=""){if(typeof(ar_chk)!="undefined"&&ar_chk.length>0){this.selected=(ar_chk.indexOf(tv)!=-1)?true:false;}}else{this.selected=(typeof(v)!="undefined"&&v.length>0&&(v.indexOf(art[0])!=-1||v.indexOf(tv)!=-1))?true:false;}});fun_mselect(o,'render');if(typeof(t)!="undefined"&&t!=""){fun_mselect(o,'settitle',t);}}else if(w=="settitle"){var op=$(o).parent();var ob=op.find("button");ob.attr("title",v);if(v==""){ob.find("span.filter-option").html(v);op.find("ul li").removeClass("selected");}}else if(w=='unselect'){$(o).find('option[value]').each(function(){if(typeof(v)!="undefined"&&this.value==v){this.selected=false;}});fun_mselect(o,'render');}else if(w=='onchange'){$(o).on('changed.bs.select',v);}else if(w=='width'){var aw=0,w="";aw=$("#tblSuperbill").data("dx_width");if(typeof(aw)=="undefined"){$("#tblSuperbill").hide();var otd=$("#tblSuperbill").parent().find(".grythead th:nth-child(3)");aw=otd[0].offsetWidth;if(typeof(aw)=="undefined"){aw=otd.attr("width");}
$("#tblSuperbill").data("dx_width",aw);$("#tblSuperbill").show();}
if(typeof(aw)=="undefined"){aw=0;}
$(o).each(function(){if($(this).parents("#tblSuperbill").length==0){return true;}
if(aw!=0){$(this).parents("td.dx").attr("width",aw);var aw1=aw;$(this).parents(".bootstrap-select").css({"width":aw1+"px"});$(this).parents(".bootstrap-select").find("span.filter-option").css({"white-space":"normal"});}
var ttl=$(this).attr("title");if(typeof(ttl)!="undefined"&&$.trim(ttl)!=""){$(this).parents(".bootstrap-select").find("button").attr("title",ttl);}});}}
function setProcessImg(f,id,msg,t,lft,delay){var o=null;if(o==null){var ogsc=get_src_center();var left=ogsc.left-100;var top=ogsc.top-100;o={'top':top,'left':left};id="";}
if(f==0){if(typeof(id)!="undefined"&&$("#div_loading_image.prcsing"+id+"").length>0){$("#div_loading_image.prcsing"+id+"").hide().remove();}else{$("#div_loading_image").hide().remove();}
return;}else if(f==1){if(o!=null){if($("#div_loading_image.prcsing"+id+"").length<=0){if(typeof(msg)!="undefined"&&msg!=""){msg="<div id=\"div_loading_text\" class=\"text-info\">"+msg+"</div>";}else{msg="";}
var prsc="<div id=\"div_loading_image\" class=\"text-center prcsing"+id+"\">"+"<div class=\"loading_container\">"+"<div class=\"process_loader\"></div>"+""+msg+""+"</div>"+"</div>";$("body").append(prsc);$("#div_loading_image.prcsing"+id+"").css({"left":lft+"px","top":t+"px","position":"fixed","z-index":"1000000"});if(typeof(delay)!="undefined"&&delay!=""&&!isNaN(delay)){$("#div_loading_image.prcsing"+id+"").delay(delay).fadeOut(400);setTimeout(function(){$("#div_loading_image.prcsing"+id+"").hide().remove();},parseInt(delay)+400);}}}}}
function displayConfirmYesNo_v2(title,msg,btn1,btn2,func,showCancel,showImage,misc){if(typeof(func)=="undefined"){func="";}
if((typeof(showImage)=="undefined")||(showImage!=0)){showImage="<span class=\"ui-icon ui-icon-alert\" >";}else{showImage="";}
var htm=""+"<div id=\"dialog-confirm\" title=\""+title+"\">"+"<p>"+showImage+"</span>"+msg+"</p>"+"</div>";$("#dialog-confirm").remove();$("body").append(htm);var btn=[];if(typeof(btn1)!="undefined"&&btn1!=""&&btn1!="0"){btn[btn.length]={text:""+btn1,'class':"ui-btn-sucus",click:function(){if(func!=""){eval(""+func+"(1);");};$(this).dialog("close");$("#dialog-confirm").remove();}};}
if(typeof(btn2)!="undefined"&&btn2!=""&&btn2!="0"){btn[btn.length]={text:""+btn2,'class':"ui-btn-sucus",click:function(){if(func!=""){eval(""+func+"(0);");};$(this).dialog("close");$("#dialog-confirm").remove();}};}
if((typeof showCancel=="undefined")||(showCancel!=0)){btn[btn.length]={text:"Cancel",'class':"ui-btn-cncl",click:function(){if(func!=""){eval(""+func+"(-1);");};$(this).dialog("close");$("#dialog-confirm").remove();}};}
$("#dialog-confirm").dialog({resizable:false,height:"auto",width:400,modal:true,buttons:btn});}
function open_print_window(resp){var parWidth=595;var parHeight=841;var printOptionStyle;printOptionStyle='p';window.open(''+zPath+'/../library/html_to_pdf/createPdf.php?op='+printOptionStyle+'&file_location='+resp+'','_parent','scrollbars=1,resizable=1,width='+parWidth+'height='+parHeight+'');}
function hide_modal(id){$("#"+id).modal('hide');setTimeout(function(){$("#"+id+", .modal-backdrop").remove();},"500");}
function renew_title(o,s){if($.trim(s)==""){$(o).attr('title',"").tooltip('disable');}else{$(o).tooltip('enable');$(o).attr('title',""+s).tooltip('fixTitle').tooltip('setContent');}}
function single_chkbx(ob){var nm=ob.name;var o=document.getElementsByName(nm);var ln=o.length;for(i=0;i<ln;i++){if(o[i].id!=ob.id){o[i].checked=false;}}}
var flash_msg_c=0;function flash_msg(msg,type){if(typeof(msg)!="undefined"&&msg!=""){var tp=10+(10*flash_msg_c);var htm='<div id="flash_msg_c'+flash_msg_c+'" style="position:fixed;z-index:1000;top:'+tp+'%;right:0%;min-width:200px;min-height:20px;" class="flsh alert alert-'+type+'">'+''+msg+'</div>';$("body").append(htm);setTimeout(function(){$('.flsh').fadeOut('slow');if(flash_msg_c>0){flash_msg_c=flash_msg_c-1;}},1000);flash_msg_c=flash_msg_c+1;}}
var isiPad=(navigator.userAgent.match(/iPad/i)!=null)?1:0;var isSafari=(navigator.userAgent.match(/Safari/i)!=null&&navigator.userAgent.match(/Chrome/i)==null)?1:0;var oPUF=[];var oPP=[];var oPO=[];var oPF=[];var arrSchPop=[];var icd10_unique_obj_id='';function setSavedBtn(flg,txt){top.$("#save,#btnFinalize,#cancel").prop("disabled",function(){return(flg==1)?true:false;});var tmp=(typeof(txt)!="undefined"&&txt!="")?txt:"Saving chart notes. Please Wait! ";if(typeof(setProcessImg)!='undefined')setProcessImg(flg,"",tmp);}
function showOtherForms(u,n,w,h,scrl)
{scrl=(typeof scrl!="undefined")?scrl:1;if(u!=""){var features='location=0,status=1,resizable=1,left=0,top=0,scrollbars='+scrl+',width='+w+',height='+h;top.popup_win(u,features);}}
function setThisChangeStatus(obj){isFormChanged=1;}
function loadRVS(flag,wh){if($("#div_rvs").length==0){var url="onload_wv.php";var p="elem_action=loadRVS";p+="&finalize_flag="+$("#elem_isFormFinalized").val();p+="&form_id="+$("#elem_masterId").val();if(typeof(setProcessImg)!='undefined')setProcessImg("1","rvsBtn");$.post(url,p,function(data){if(data!=""){if(typeof(setProcessImg)!='undefined')setProcessImg("0","rvsBtn");$("#frmMain").append(""+data);$("#div_rvs").show();$("#div_rvs,#detailDesc1,#detailDesc2").draggable({handle:".handleDrag"});if(typeof(wh)!="undefined"&&wh!=""){$("#"+wh).triggerHandler("click");}}});}else{if($("#div_rvs").css("display")=="none"||(typeof(wh)!="undefined"&&wh!="")){$("#div_rvs").show();if(typeof(wh)!="undefined"&&wh!=""){$("#"+wh).triggerHandler("click");}}else{$("#div_rvs").hide();}}
stopClickBubble();}
function setUserName(str){var obj={"id":""+authUserID,"name":""+authUserNM};if(str=="elem_ccHx"){var otd=gebi("td_cosigner");var ocid=gebi("elem_cosigner_id");var ocname=gebi("elem_cosigner_name");}
if(str.indexOf("MR")!=-1){var ocid="elem_providerId";var ocname="elem_providerName";var mri=str.replace("MR","");if(mri>1){ocid+="Other";ocname+="Other";}
if(mri>2){ocid+="_"+mri;ocname+="_"+mri;}
ocid=gebi(ocid);ocname=gebi(ocname);}
if(ocid&&ocname){if(str=="elem_ccHx"){var oPrId=gebi("elem_pro_id");if(oPrId&&((oPrId.value!="")&&(oPrId.value==obj.id))){return false;}}
ocid.value=obj.id;if(typeof ocid.onchange=="function"){ocid.onchange();}
if(typeof ocid.onkeyup=="function"){ocid.onkeyup();}
if(typeof ocid.onkeydown=="function"){ocid.onkeydown();}
ocname.value=obj.name;if(str!="elem_ccHx"){changeVisionStatus(ocname,1,1);changeVisionStatus(ocid,1,1);if(str.indexOf("MR")!=-1){renew_title(ocname,ocname.value);}}
if(otd){otd.style.visibility="visible";}}}
function getTechMandatory(obj){var str=$.trim(obj.value);if(str==""||user_type!='3'){$("#tm_ocualr,#tm_general_health,#tm_medication,#tm_surgeries,#tm_allergies,#tm_immunizations,"+"#tm_social,#tm_cvf,#tm_visit,#tm_cc_history,#tm_vision,#tm_distance,#tm_near,"+"#tm_ar,#tm_pc,#tm_mr,#tm_cvf_c,"+"#tm_amsler_grid,#tm_icp_color_plates,#tm_steroopsis,#tm_diplopia,#tm_retinoscopy,"+"#tm_exophthalmometer,#tm_pupil,#tm_eom,#tm_external,#tm_iop").each(function(){$(this).val("");});return;}
if(typeof(setProcessImg)!='undefined')setProcessImg("1","techman");$.get('requestHandler.php?elem_formAction=getTechMandtory&elem_visitCode='+str,function(d){if(typeof(setProcessImg)!='undefined')setProcessImg("0","techman");if(d){for(var x in d){if(x!="tech_id"&&x!="ptVisit"){$("#tm_"+x).val(d[x]);}}}},'json');}
function tm_checkExmdone(exm){var os=gebi("elem_se_"+exm);var s=(os)?gebi("elem_se_"+exm).value:"";if(s!=""&&s.indexOf("=1")!=-1){if(gebi("elem_pos"+exm).value==1||gebi("elem_wnl"+exm+"").value==1){return true;}else if(exm!="Eom"&&(gebi("elem_wnl"+exm+"Od").value==1||gebi("elem_wnl"+exm+"Os").value==1)){return true;}}
return false;}
function mandatory_ovr(){}
function mandotry_chk(val){if(val==1){return;}
if(user_type=='3'){var ocualr=$("#tm_ocualr").val();var general_health=$("#tm_general_health").val();var medication=$("#tm_medication").val();var surgeries=$("#tm_surgeries").val();var allergies=$("#tm_allergies").val();var immunizations=$("#tm_immunizations").val();var social=$("#tm_social").val();var cvf=$("#tm_cvf").val();var visit=$("#tm_visit").val();var cc_history=$("#tm_cc_history").val();var vision=$("#tm_vision").val();var distance=$("#tm_distance").val();var near=$("#tm_near").val();var ar=$("#tm_ar").val();var pc=$("#tm_pc").val();var mr=$("#tm_mr").val();var cvf_c=$("#tm_cvf_c").val();var amsler_grid=$("#tm_amsler_grid").val();var icp_color_plates=$("#tm_icp_color_plates").val();var steroopsis=$("#tm_steroopsis").val();var diplopia=$("#tm_diplopia").val();var retinoscopy=$("#tm_retinoscopy").val();var exophthalmometer=$("#tm_exophthalmometer").val();var pupil=$("#tm_pupil").val();var eom=$("#tm_eom").val();var external=$("#tm_external").val();var iop=$("#tm_iop").val();var show_name="Please fill in the following:- <br>\n";var flag_chk=0;var tmp,tmp1;if(visit=='yes'){tmp=top.fmain.gebi('elem_ptVisit_chk');tmp1=1;if(tmp&&tmp.value==''){tmp1=0;show_name+='-Visit<br>\n';flag_chk+=1;}}
if(cc_history=='yes'){tmp=gebi("elem_chk");tmp=ccHxDefStr(tmp.value,1);tmp1=1;if(tmp==''){tmp1=0;show_name+='-CC & History<br>\n';flag_chk+=1;}}
if(vision=='yes'){var show_name1='';if(distance=='yes'){tmp=isVisElemDone(["elem_visDisOdSel1","elem_visDisOsSel1"]);tmp1=1;if(tmp==false){tmp1=0;show_name1+='-Distance<br>\n';flag_chk+=1;}}
if(near=='yes'){tmp=isVisElemDone(["elem_visNearOdSel1","elem_visNearOsSel1"]);tmp1=1;if(tmp==false){tmp1=0;show_name1+='-Near<br>\n';flag_chk+=1;}}
if(ar=='yes'){tmp=isVisElemDone(["elem_visArOdS","elem_visArOsS"]);tmp1=1;if(tmp==false){tmp1=0;show_name1+='-AR<br>\n';flag_chk+=1;}}
if(pc=='yes'){tmp=isVisElemDone(["elem_visPcOdSel1","elem_visPcOsSel1"]);tmp1=1;if(tmp==false){tmp1=0;show_name1+='-PC<br>\n';}}
if(mr=='yes'){tmp=isVisElemDone(["elem_visMrOdS","elem_visMrOsS"]);tmp1=1;if(tmp==false){tmp1=0;show_name1+='-MR<br>\n';flag_chk+=1;}}
if(show_name1){show_name+='-Vision<br>\n';show_name+=show_name1;}}
if(icp_color_plates=='yes'){tmp=isVisElemDone(["elem_color_sign_od","elem_color_od_1","elem_color_od_2","elem_color_sign_os","elem_color_os_1","elem_color_os_2"]);tmp1=1;if(tmp==false){vis_show_sec('r4',1);tmp1=0;show_name+='-ICP Color Plate<br>\n';flag_chk+=1;}}
if(steroopsis=='yes'){tmp=isVisElemDone(["elem_stereo_SecondsArc"]);tmp1=1;if(tmp==false){vis_show_sec('r4',1);tmp1=0;show_name+='-Stereopsis<br>\n';flag_chk+=1;}}
if(retinoscopy=='yes'){tmp=isVisElemDone(["elem_visExoOdS","elem_visExoOsS"]);tmp1=1;if(tmp==false){vis_show_sec('r4',1);tmp1=0;show_name+='-Retinoscopy<br>\n';flag_chk+=1;}}
if(exophthalmometer=='yes'){tmp=isVisElemDone(["elem_visRetPD","elem_visRetOd","elem_visRetOs"]);tmp1=1;if(tmp==false){vis_show_sec('r4',1);tmp1=0;show_name+='-Exophthalmometer<br>\n';flag_chk+=1;}}
if(pupil=='yes'){tmp=tm_checkExmdone("Pupil");tmp1=1;if(tmp==false){tmp1=0;show_name+='-Pupil<br>\n';flag_chk+=1;}}
if(eom=='yes'){tmp=tm_checkExmdone("Eom");tmp1=1;if(tmp==false){tmp1=0;show_name+='-EOM<br>\n';flag_chk+=1;}}
if(external=='yes'){tmp=tm_checkExmdone("Ee");tmp1=1;if(tmp==false){tmp1=0;show_name+='-External<br>\n';flag_chk+=1;}}
if(iop=='yes'){tmp1=1;var sid=gebi('elem_sumOdIOP');var sis=gebi('elem_sumOsIOP');var sad=gebi('elem_sumOdAnesthetic');var sas=gebi('elem_sumOsAnesthetic');var sdd=gebi('elem_sumOdDilation');var sds=gebi('elem_sumOsDilation');if(sid&&sis&&sad&&sas&&sdd&&sds&&($.trim(sid.innerHTML)=='')&&($.trim(sis.innerHTML)=='')&&($.trim(sad.innerHTML)=='')&&($.trim(sas.innerHTML)=='')&&($.trim(sdd.innerHTML)=='')&&($.trim(sds.innerHTML)=='')){tmp1=0;show_name+='-IOP<br>';flag_chk+=1;}}
if(amsler_grid=="yes"){if($("#amsgrid .positive").length<=0&&$("#amsgrid .wnl_lbl").length<=0){show_name+='-Amsler Grid<br>';flag_chk+=1;}}
if(cvf_c=="yes"){if($("#cvf .positive").length<=0&&$("#cvf .wnl_lbl").length<=0){show_name+='-CVF<br>';flag_chk+=1;}}
if(diplopia=="yes"){if($("#dv_w4dot .active").length<=0){show_name+='-Diplopia/Worth for dot<br>';flag_chk+=1;}}
if(val==2){if(flag_chk>0){var title="Tech Warning";var msg=""+show_name+"<BR>";var btn1="Continue & Save";var func="top.fmain.decideTechWarning";top.fmain.displayConfirmYesNo_v2(title,msg,btn1,0,func,1);}else{return true;}}}else{return true;}}
function decideTechWarning(val){if(val=="1"){top.fmain.saveMainPage(1);}}
function utElem_capture(e){if(!e){return;}
var clr=(typeof(ProClr[logged_user_type])!="undefined")?ProClr[logged_user_type]:"";var clr1,clr2;if(typeof(clr)=="string"){clr1=clr2=clr;}else if(typeof(clr)=="object"){clr1=clr[0];clr2=clr[1];}
if(e.target){var eo=e.target;var enm=eo.name;var eid=eo.id;}else{var eo=e;var enm=e.name;var eid=e.id;}
var wc=(typeof(examName)!="undefined"&&examName!=""&&typeof(getWcId)!="undefined"&&(examName=="LA"||examName=="Fundus"||examName=="SLE"))?getWcId():{nm:""};var elue="#elem_utElems"+wc.nm;var elue_cr=elue+"_cur";if(typeof(enm)!="undefined"&&(enm.indexOf("_peri")!=-1||enm.indexOf("elem_rvcd")!=-1)&&wc.nm==""){return;}
var tmp=$(elue_cr).val();if(typeof(tmp)=="undefined")tmp="";var str=""+$(elue).val();if(typeof(eid)=="undefined"||eid==""){eid=""+enm;}
var n="[^a-zA-Z0-9_\-]";var rs=eid.match(n);if(rs){return;}
str=str.replace(eid+",","");$(elue).val(str);if(tmp.indexOf(eid+",")==-1){tmp=tmp+eid+",";}
$(elue_cr).val(tmp);if(typeof(enm)!="undefined"&&enm.indexOf("elem_ocMeds")==-1){if((eo.type=="checkbox"&&eo.checked==false)||((eo.type=="text"||eo.type=="textarea"||eo.type=="select-one")&&(eo.value==""||eo.value=="20/"))){if(eo.type=="checkbox"){clr2="transparent";}else{clr1="white";}
tmp=""+tmp.replace(eid+",","");$(elue_cr).val(tmp);}
if(eo.type=="checkbox"){$(eo).css("background-color",clr2);$("label[for="+eid+"]").css({"border-color":""+clr2})}
else if(eo.type=="select-one"&&(typeof(examName)!="undefined"&&examName=="Fundus")&&typeof(eo.onclick)!="function"){$(eo).css("background-color",clr1).trigger("click");}
else{$(eo).css("background-color",clr1);}}}
function utElem_setBgColor(dvSmartC){if(typeof(dvSmartC)!="undefined"&&dvSmartC!=""){var str=$("#elem_utElems_smartchart").val();var maincontainer=" #"+dvSmartC+" ";}else{var str=$("#elem_utElems").val();var maincontainer=" body ";}
if(typeof(str)!="undefined"&&str!=""){var rep,clr,clr1,clr2;var ar=str.split("|");var ln=ar.length;for(i=0;i<ln;i++){var t=ar[i].split("@");clr=ProClr[t[0]];if(typeof(clr)=="string"){clr1=clr2=clr;}else if(typeof(clr)=="object"){clr1=clr[0];clr2=clr[1];}
var a=(t[1]&&typeof(t[1])!="undefined")?t[1].split(","):[];var l=a.length;for(var j=0;j<l;j++){if(a[j]!=""){if(a[j].indexOf("[]")!=-1||a[j].indexOf("[")!=-1||a[j].indexOf("elem_ocMeds")!=-1||a[j].indexOf("%")!=-1){continue;}
$(""+maincontainer+" *[name="+a[j]+"], "+maincontainer+" #"+a[j]+"").css("background-color",function(){if(this.type=="checkbox"){if(this.checked!=false){var tmpfor=(typeof(this.id)!="undefined"&&this.id!="")?this.id:a[j];if($("label[for="+tmpfor+"]").length==0){if($(":input[name='"+tmpfor+"']").length>0&&$(":input[name='"+tmpfor+"']").attr("id")!=""){tmpfor=""+$(":input[name='"+tmpfor+"']").attr("id");}}
$("label[for="+tmpfor+"]").css({"border-color":""+clr2});}
return(this.checked==false)?"transparent":clr2;}else{return(this.value=='')?"":clr1;}});}}}}}
function set_refer_phy_tbar(flgdb){if(typeof(flgdb)!="undefined"&&flgdb=="1"){$.get(zPath+'/chart_notes/requestHandler.php?elem_formAction=get_refer_phy',function(d){if(typeof(d)!="undefined"){$("#strPtRefPhy").val(d);set_refer_phy_tbar();}});return;}
var d=$("#strPtRefPhy").val();if(d&&d!=""){var arrTemp=new Array();arrTemp=d.split("!@!");var ref_phy_name=arrTemp[0]
if(arrTemp[0].search(",")>0){ref_phy_name=arrTemp[0];}
var pcp_name=arrTemp[1]
if(arrTemp[1].search(",")>0){pcp_name=arrTemp[1];}
var cm_name=arrTemp[2]
if(arrTemp[2].search(",")>0){cm_name=arrTemp[2];}
if(typeof(ref_phy_name)!='undefined'){top.$("#spanDetailRefPhy").html(""+ref_phy_name);}
if(typeof(pcp_name)!='undefined'){top.$("#spanDetailPCP").html(""+pcp_name);}
if(typeof(cm_name)!='undefined'){top.$("#spanDetailCoMangPhy").html(""+cm_name);}
if(ref_phy_name){top.$("#spanDetailRefPhy").attr('data-original-title',"<span class='text-nowrap'>"+arrTemp[6]+"</span>");}
if(pcp_name){top.$("#spanDetailPCP").attr('data-original-title',"<span class='text-nowrap'>"+arrTemp[7]+"</span>");}
if(cm_name){top.$("#spanDetailCoMangPhy").attr('data-original-title',"<span class='text-nowrap'>"+arrTemp[8]+"</span>");}
top.$('#spanMoreRefPhy').removeClass("hidden");top.$("#spanMoreRefPhy").html(""+arrTemp[3]);top.$('#spanMorePCP').removeClass("hidden");top.$("#spanMorePCP").html(""+arrTemp[4]);top.$('#spanMoreCoMangPhy').css({"position":'absolute'}).removeClass("hidden");top.$("#spanMoreCoMangPhy").html(""+arrTemp[5]);}}
function chrt_showChartInfo(h){top.$("#li_rc").hide();top.$('#chart_phy_note').attr('title',"");top.$("#icoPtLock").addClass("hidden").unbind("click");top.$("#ddmenu_p3 li").removeClass("active");top.$("#chartdos, #infoIns").html("");top.$("#el_charttemp").val("").unbind("change");top.$("#btnPtForms").unbind("click");top.$("#chart_status").html("");window.top.$("#chartdos").unbind("change");window.top.$("#lichartp3dd ul a").unbind("click");if(typeof(h)!='undefined'&&h=="1"){top.$(".elchart").css("display","none");return;}
top.$("#chartdos").html($("#elem_dos").val());top.$("#el_charttemp").val($("#elem_ptTemplate").val());$("#el_visit").bind("change",function(){var x=$.trim($(this).val());if(x==""){$("#elem_ptVisit_chk,#elem_ptTesting,#elem_masterPtVisit,#elem_masterTesting").val('').triggerHandler("change");}
else{var v="",t="";if(x.indexOf("-")!=-1){var ar=x.split("-");ar[0]=$.trim(ar[0]);if(ar[0]&&ar[0]!=""){v=ar[0];}if(ar[1]&&ar[1]!=""){t=ar[1];}}else{if($("#el_visit_ig .mega-dropdown-menu li.col-sm-6").eq(1).find("a:contains('"+x+"')").length){t=x}else{v=x;}}
$("#elem_ptVisit_chk").val(""+v);$("#elem_masterPtVisit").val(""+v).triggerHandler("change");$("#elem_ptTesting").val(""+t);$("#elem_masterTesting").val(""+t).triggerHandler("change");}});top.$("#el_charttemp").bind("change",function(){var t=$(this).val();var o=top.fmain.$("#elem_ptTemplate");var pv=o.val();o.val(t).data("prv",pv).trigger("change");top.$(this).val("");});var tmp=$("#divMenuTemplate").html();top.$("#el_charttemp_ig ul, #lichart_status ul").replaceWith(tmp);top.$("#el_charttemp_ig ul a, #lichart_status ul a").bind("click",function(){var h=top.$(this).data("id");top.$("#el_charttemp").val(h).trigger("change");});if(hasActChart=="0"){top.$("#btn_new_chart").removeClass("hidden");}else{top.$("#btn_new_chart").addClass("hidden");}
if($("#divLockPassPrompt").length>0){top.$("#icoPtLock").removeClass("hidden").bind("click",function(){top.fmain.lock_showPassPrompt();});}
top.$("#btnPtForms").bind("click",function(){top.fmain.showChartNotesTree();});highlight_pt_form_btn();var s="Active";var clbl="label-info";if($("#elem_isFormFinalized").val()=="1"||$("#elem_masterpurge_status").val()=="1"){s=$("#elem_masterpurge_status").val()==1?"Purged":"Final";clbl="label-danger";}
top.$("#chart_status").html(s).show().removeClass("label-info label-danger").addClass(clbl);var t=$("#infoIns_hidden").html()||"";top.$("#infoIns").html(t);set_refer_phy_tbar();var sep=" - ";var p3=$("#phth_pros").val()||"";var p3_i=$("#is_od_os").val()||"";if(p3!=""){window.top.$("#lichartp3dd ul a:contains('"+p3+"')").parent().addClass("active");p3+=sep;}
if(p3_i!=""){window.top.$("#lichartp3dd ul a:contains('"+p3_i+"')").parent().addClass("active");}
window.top.$("#el_chartp3").val(p3+p3_i);window.top.$("#lichartp3dd ul a").bind("click",function(){var h=$(this).text()||"";if(h.indexOf("Eye")!=-1){return;}
$(this).parent().siblings().removeClass("active");$(this).parent().addClass("active");var tmp=window.top.$("#el_chartp3").val()||"";var ar_tmp=tmp.split(sep);ar_tmp[0]=$.trim(ar_tmp[0]);if(typeof(ar_tmp[1])!="undefined"){ar_tmp[1]=$.trim(ar_tmp[1]);}else{ar_tmp[1]="";}
if(ar_tmp[0]=="OU"||ar_tmp[0]=="OD"||ar_tmp[0]=="OS"){ar_tmp[0]="";}
if(h!=""){if(h=="OU"||h=="OD"||h=="OS"){ar_tmp[1]=h;}else if(h=="No Defect"){ar_tmp[0]="";ar_tmp[1]="";$(this).parent().parent().find("li").removeClass("active");}else{ar_tmp[0]=h;}}
var curset=(ar_tmp[0]!="")?"1":"0";window.top.fmain.$("#elem_curset_phth_pros").val(curset);window.top.fmain.$("#phth_pros").val(""+ar_tmp[0]);window.top.fmain.$("#is_od_os").val(""+ar_tmp[1]);window.top.fmain.loadExamsSummaryAll();if(ar_tmp[0]!=""&&ar_tmp[1]!=""){h=ar_tmp[0]+sep+ar_tmp[1];window.top.$("#el_chartp3").val(h);}else if(ar_tmp[0]!=""){h=ar_tmp[0]+"";window.top.$("#el_chartp3").val(h);}else{window.top.$("#el_chartp3").val("");}
return false;});$("#el_chartneuro_ig ul a").bind("click",function(){$("#el_chartneuro_ig ul li").removeClass("active");var h=$(this).text()||"";$(this).parent().addClass("active");$("#elem_neuroPsych").val(""+h);});var m=$("#elem_get_memo").val();var mo=window.top.$("#el_chartp3_ig");if(m==1){mo.hide();}else{mo.show();}
var t=(top.$("#ins_pro")[0])?top.$("#ins_pro")[0].title:"";if(typeof(t)=="undefined"){t="";}else if(t!=""){t=" ( "+t+" )";}
var t1=top.$("#vis_ins").html();if(typeof(t1)=="undefined"){t1="";}
var t2=$.trim(t1+" "+t+"");top.$("#infoIns").attr("title",t2);window.top.$("#chartdos").val($("#elem_dos").val()).datepicker({dateFormat:top.jQueryIntDateFormat}).bind("change",function(){window.top.fmain.$("#elem_dos").val(this.value).trigger("change");});if(phy_note_exists=='1'){window.top.$("#chart_phy_note").removeClass("hidden");}else{window.top.$("#chart_phy_note").addClass("hidden");}}
function highlight_pt_form_btn(){if(is_test_uninterpreted=='1'){top.$("#btnPtForms").addClass("highlight");}else{top.$("#btnPtForms").removeClass("highlight");}}
function open_medgrid(){$("#divMedGridMain").remove();var str="<div id=\"divMedGridMain\"  class=\"section\">"+"<div id=\"load_med_save\" style=\"position:absolute; display:none; background-color:red; color:white; margin:200px 400px; font-size:14px; height:50px;\" >Please wait saving is in process..</div>"+"<div id=\"divHeader\" class=\"section_header\" style=\"width:1200px;cursor:move;\"><span class=\"closeBtn\" onclick=\"$('#divMedGridMain').hide()\"></span>Ocular Medication Grid</div>"+"<iframe src=\"\" width=\"1200px\"  height=\"100%\" scrolling=\"yes\" border=\"0\" style=\"border:0px\" id=\"frmMedGrid\">"+"</iframe>"+"</div>";$("body").append(str);$("#load_med_save").hide();$("#divMedGridMain").css({"display":"none","position":"absolute","height":"400px","top":"20px","left":"20px","width":"1200px","z-index":"100","background-color":"white"}).show();$("#divMedGridMain").draggable({"handle":"#divHeader"});}
function showUnFinalize(u,n,w,h)
{var oPUF=(typeof(top.oPUF)!="undefined")?top.oPUF:top.fmain.oPUF;if(elem_per_vo=="1"){if(n=='Amendments'){return;}}
if(u!=""){if(n=="VF-GL"){n="VFGL";}
if(n=="OCT-RNFL"){n="OCTRNFL";}
if(!oPUF[n]||!(oPUF[n].open)||(oPUF[n].closed==true)){oPUF[n]=window.open(u,n,'location=0,status=1,resizable=1,left=1,top=1,scrollbars=1,width='+w+',height='+h);oPUF[n].focus();}else{oPUF[n].focus();}}}
function makeMemoChart(){makeNewChart('',1);}
function makeNewChart(val,memo)
{if(typeof(elem_per_vo)!="undefined"&&elem_per_vo=="1"){return;}
if(typeof(zPath)=="undefined")zPath="";var u=(typeof(zPath_remote)!="undefined")?zPath_remote:zPath;if(typeof val=="undefined"){val="GETFORMSETTINGS";}
if(typeof(memo)=="undefined"){memo="";}
top.show_loading_image('show','','Loading...');tmp=encodeURIComponent("Make New Chart Notes");top.fmain.window.location.replace(u+"/chart_notes/saveCharts.php?elem_saveForm="+tmp+"&elem_make=1&elem_tempId="+val+"&memo="+memo);}
function setPtTemplate(obj){if((obj.value!="")){var sep="-[_]-";var arr=obj.value.split(sep);if((arr[0]!="")&&(arr[1]!="")){if((typeof(hasActChart)!="undefined"&&hasActChart=="0")||obj.value=="Default"||obj.value=="Memo"||obj.value=="Amendment"){if(arr[0]=="Memo"&&arr[1]=="0"){makeMemoChart();}
else if(arr[0]=="Amendment"&&arr[1]=="0"){var t=$(obj).data("prv");obj.value=(typeof(t)!="undefined")?t:"";showUnFinalize(zPath+'/chart_notes/onload_wv.php?elem_action=Amendments','Amendments','800','400');}
else{makeNewChart(arr[1]);}
return;}
obj.value=""+arr[0];var oiFrm=top.fmain;var oF2=(oiFrm)?oiFrm.document.frmMain:null;if(oF2){var oMid=oF2.elem_masterId;var oMFz=oF2.elem_masterFinalize;var oMRvw=oF2.elem_isFormReviewable
var oPer=oF2.elem_per_vo;var oPrgd=oF2.elem_masterpurge_status;var msg="";if(oPer&&oPer.value=="1"){msg+="\nYou do not have permission to make changes.";}
if(oMFz&&oMFz.value=="1"){msg+="\nFinalized chart cannot be changed.";}
if(oPrgd&&oPrgd.value=="1"){msg+="\nPurged chart cannot be changed.";}
if(msg!=""){top.fAlert(""+msg);obj.value=obj.defaultValue;return;}
if(isFormChanged==1){oF2.elem_ptGo2.value="ChangeTemplate";oF2.elem_ptSrchFindBy.value=arr[1];oF2.submit();}else{tmp="Change Chart Notes Template";top.fmain.window.location.replace(zPath+"/chart_notes/saveCharts.php?elem_saveForm="+tmp+"&elem_templateId="+arr[1]+"&elem_tempFormId="+oMid.value);}}}}}
function hideButtons(f,id,r,e,cvu,prg)
{var ar=[];ar["elem_per_vo"]=elem_per_vo;ar["userTypeCn"]=user_type;ar["f"]=f;ar["r"]=r;ar["prg"]=prg;ar["e"]=e;ar["cvu"]=cvu;ar["fpv"]=flg_phy_view;ar["fz"]=show_finalize_btn;ar["prgdel"]=per_prgdel;top.btn_show("WV",ar);}
function showPrevCharts(val){if(val=="+1"){if(typeof varNxtFId.id!="undefined"){top.fmain.showFinalize(varNxtFId.typeChart,varNxtFId.id,varNxtFId.chartStatus,varNxtFId.releaseNum);}else{top.fAlert("No next chart exits.");}}else if(val=="-1"){if(typeof varPrevFId.id!="undefined"){top.fmain.showFinalize(varPrevFId.typeChart,varPrevFId.id,varPrevFId.chartStatus,varPrevFId.releaseNum);}else{top.fAlert("No previous chart exits.");}}}
function showPrevChartsImags(n,id){if(typeof(setProcessImg)!='undefined')setProcessImg(1,"");$.get(zPath+"/chart_notes/requestHandler.php?elem_formAction=ChartPrevImage&id="+id,function(data){if(typeof(setProcessImg)!='undefined')setProcessImg(0,"");if(data){if(data=="No File Found."){top.fAlert(data);return;}top.$("#chart_img_modal").remove();top.$("body").append(data);top.$("#chart_img_modal .close").bind("click",function(){top.$("#chart_img_modal").remove();});}});}
function one_eye_valid(w){var ret=true;if(w=='drawingpane'||w=='Pupil'||w=='External'||w=='Ee'||w=='L&A'||w=='LA'||w=='IOP/Gonio'||w=='Gonio'||w=='IOP'||w=='SLE'||w=='Opt.Nev/Disc'||w=='Fundus Exam'||w=='Dilation'||w=='Fundus Exam Drawing'||w=='RV'||w=='Ref_Surg'||w=='Refractive Surgery'){var op=oneEye_isOpAllwd("OU");if(!op.alwd||((w=='drawingpane')&&op.iss!="")){flash_msg('Prosthesis/Phthisis is set. This operation is not allowed!','danger');ret=false;}}
return ret;}
function openPW(w,s,ainf)
{var clWidth=document.body.clientWidth;var clHeight=window.screen.availHeight;if(clHeight==null){clHeight=675;}
if(!one_eye_valid(w)){return;}
if(typeof s!="undefined"){s=s.toLowerCase();}
var u="",v="",ag="";switch(w){case"drawingpane":v="drawingpane.php";n="drawingpane";w=clWidth;h=parseInt(clHeight)-125;u="?elem_action=Drawingpane";if(typeof(s)!="undefined"&&s!=""){u+="&id="+s;}
break;case"AG":v="amsler_grid.php";n="amsler";w="825";h="340";u="?elem_action=AmslerGrid";ag="agModal";break;case"CVF":v="cvf.php";n="cvf";w="1000";h="340";u="?elem_action=CVF";ag="cvfModal";break;case"Pupil":v="pupil_2.php";n="pupil";w=clWidth;h=parseInt(clHeight)-125;u="?elem_action=PupilExam";break;case"EOM":v="eom_2.php";n="eom";w=clWidth;h=parseInt(clHeight)-125;u="?elem_action=EOM";if(s=="draw"){u+="&pg_tab=drw_tab&pg=draw";}
break;case"External":case"Ee":case"Ex":v="external_2.php";n="external";w=clWidth;h=parseInt(clHeight)-125;u="?elem_action=External";if(s=="draw"){u+="&pg_tab=drw_tab&pg=draw";}
break;case"L&A":case"LA":v="l_and_a_2.php";n="l_a";w=clWidth;h=parseInt(clHeight)-125;u="?elem_action=LA";if(s=="lids"){u+="&pg_tab=lid_tab&pg=Lid";}else if(s=="lesion"){u+="&pg_tab=lesion_tab&pg=Lesion";}else if(s=="lidpos"){u+="&pg_tab=lidposition_tab&pg=LidPosition";}else if(s=="lacsys"){u+="&pg_tab=lacrimal_tab&pg=Lacrimal_System";}else if(s=="drawla"||s=="draw"){u+="&pg_tab=drw_tab&pg=draw";}else{u+="&pg_tab=lid_tab&pg=Lid";}
break;case"IOP/Gonio":case"Gonio":case"IOP":v="iop_gon_2.php";n="iop";w=clWidth;h="695";u="?elem_action=IOP_Gonio";if(s=="iop"){u+="&pg_tab=IOP_tab&pg=IOP";}else if(s=="gonio"){u+="&pg_tab=Gonio_tab&pg=Gonio";}else if(s=="drawgonio"||s=="draw"){u+="&pg_tab=Drawing_tab&pg=Drawing";}
break;case"SLE":v="sle_2.php";n="sle";w=clWidth;h=parseInt(clHeight)-125;u="?elem_action=SLE";if(s=="conj"){u+="&pg_tab=Conj_tab&pg=Conj";}else if(s=="corn"){u+="&pg_tab=Cornea_tab&pg=Cornea";}else if(s=="ant"){u+="&pg_tab=AntChamber_tab&pg=AntChamber";}else if(s=="iris"){u+="&pg_tab=Iris_tab&pg=Iris";}else if(s=="lens"){u+="&pg_tab=lens_tab&pg=lens";}else if(s=="drawsle"||s=="draw"){u+="&pg_tab=drw_tab&pg=Drawing";}
break;case"Fundus Exam":case"RV":v="retina_vitreous_2.php";n="r_v";w=clWidth;h=parseInt(clHeight)-125;u="?elem_action=FundusExam";if(s=="vit"){u+="&pg_tab=Vitreous_tab&pg=Vitreous";}else if(s=="mac"){u+="&pg_tab=Macula_tab&pg=Macula";}else if(s=="drawrv"||s=="draw"||s=="drawrvma"||s=="drawrvon"){pg=(s=="drawrvma"||s=="drawrvon")?s:"Drawing";u+="&pg_tab=drw_tab&pg="+pg;}else if(s=="peri"){u+="&pg_tab=Periphery_tab&pg=Periphery";}else if(s=="bv"){u+="&pg_tab=bv_tab&pg=bv";}else if(s=="optic"){u+="&pg_tab=optic_tab&pg=Optic";}else if(s=="ret"){u+="&pg_tab=ret&pg=ret";}
break;case"Ref_Surg":case"Refractive Surgery":u="?elem_action=RefractiveSurgery";var ar=getMRinfo_SC();v="refractive_surgery.php";u+="&sod="+ar["sod"]+"&sos="+ar["sos"]+"&cod="+ar["cod"]+"&cos="+ar["cos"]+"&aod="+ar["aod"]+"&aos="+ar["aos"];n="ref_surg";w=clWidth;h=parseInt(clHeight)-125;break;case"VF-GL":u='../tests/test_vf_gl.php?pop=1';if(typeof(s)!="undefined"&&s!=""){u+="&tId="+s;}
showUnFinalize(u,'VF-GL',clWidth,clHeight);return;break;case"OCT - RNFL":u='../tests/test_oct_rnfl.php?pop=1';if(typeof(s)!="undefined"&&s!=""){u+="&tId="+s;}
showUnFinalize(u,'OCT-RNFL',clWidth,clHeight);return;break;default:return;break;}
if(u!=""){var t=top.fmain.oPUF;u=zPath+"/chart_notes/onload_wv.php"+u;if(typeof(ainf)!="undefined"&&ainf!=""){u+=(u.indexOf("?")==-1)?"?":"";u+="&"+ainf;}
if(ag!=""){if(typeof(setProcessImg)!='undefined')setProcessImg(1,"");$.get(u,function(data){if(typeof(setProcessImg)!='undefined')setProcessImg(0,"");if($("#"+ag).length<=0){$("body").append(data);}
else{$("#"+ag).replaceWith(data);}
$(".modal-backdrop").remove();var xhgt=top.$(window).height();var xwdth=top.$(window).width();$("#"+ag).on('shown.bs.modal',function(){top.$(this).find('.modal-dialog').css({width:'auto',height:'auto','max-height':'100%'});xhgt=(parseInt(xhgt)-(parseInt(top.$(this).find('.modal-header').css("height"))+parseInt(top.$(this).find('.modal-footer').css("height"))+100));top.$(this).find('.modal-body').css({height:xhgt+"px","padding":"2px"});$("#app_ams_od, #app_ams_os, #app_cvf_od_drawing, #app_cvf_os_drawing ").each(function(){oSimpDrw[this.id]=new SimpleDrawing(this.id);oSimpDrw[this.id].init();});if($('#elem_examDate_amsler').length>0){$('#elem_examDate_amsler').datepicker({changeMonth:true,changeYear:true,dateFormat:z_js_dt_frmt});ag_setWnlEyeFlag("0");}
if($("#"+ag+" .bggrey").length>0){$(":input").bind("click",function(){$("#"+ag+" .bggrey").each(function(){$(this).removeClass("bggrey");});});}});$("#"+ag).css({'z-index':'1041'});$("#"+ag).modal("show");cn_ta_cvf_ag("#"+ag+" textarea");});return;}
if(!t[n]||!(t[n].open)||(t[n].closed==true)||t[n].document==null){t[n]=window.open(u,n,'location=0,status=1,resizable=1,left=1,top=1,scrollbars=1,width='+w+',height='+h);t[n].focus();}else{t[n].focus();}}}
function showFinalize(str,id,st,rel,opn,tstId){var clWidth=document.body.clientWidth;var clHeight=window.screen.availHeight;if(clHeight==null){clHeight=675;}
if(!one_eye_valid(str)){return;}
rel=(rel=="1")?"1":"0";opn=((rel=="0")||(opn=="1"))?"1":"0";tstId=(typeof tstId!="undefined")?tstId:"0";var path="";if(typeof(zPath_remote)!="undefined"){path=""+zPath_remote;}
else if(typeof(zPath)!="undefined"){path=""+zPath;}
var url="",w,h,n;var memoVal='';switch(str)
{case"Amsler Grid":return;break;case"A/Scan":case"Ascan":url="ascan.php?pop=1";n="docAS";str="Ascan";break;case"IOL Master":case"IOL_Master":url="iol_master.php?pop=1";n="docIOL_Master";str="IOL_Master";break;case"CVF":return;break;case"EOM":url="onload_wv.php?elem_action=EOM";w=clWidth;h="675",n="docEOM";break;case"External":url="onload_wv.php?elem_action=External";w=clWidth;h=clHeight,n="docEx";break;case"Dilation":case"Gonio":case"IOP/Gonio":url="onload_wv.php?elem_action=IOP_Gonio";w=clWidth;h="695",n="docIOP";if(str=="Gonio"){url+="&pg_tab=Gonio_tab&pg=Gonio";}
break;case"L&A":url="onload_wv.php?elem_action=LA";w=clWidth;h=clHeight,n="docLA";break;case"Pupil":url="onload_wv.php?elem_action=PupilExam";w=clWidth;h=clHeight,n="docPupil";break;case"Opt.Nev/Disc":case"Fundus Exam":case"Fundus Exam Drawing":url="onload_wv.php?elem_action=FundusExam";w=clWidth;h=parseInt(clHeight)-125,n="docRV";if(str=="Fundus Exam Drawing"){url+="&pg_tab=drw_tab&pg=Drawing";}
break;case"SLE":url="onload_wv.php?elem_action=SLE";w=clWidth;h=parseInt(clHeight)-125,n="docSLE";break;case"Fundus":case"Disc":url="test_disc.php?pop=1";n="docDisc";break;case"Topography":url="test_topography.php?pop=1";n="docTopo";break;case"External/Anterior":url="test_external.php?pop=1";n="docExAnt";str="External_Anterior";break;case"IVFA":url="test_ivfa.php?pop=1";n="docIvfa";break;case"ICG":url="test_icg.php?pop=1";n="docIcg";break;case"HRT":case"NFA":url="test_nfa.php?pop=1";n="docNfa";break;case"Pachy":url="test_pacchy.php?pop=1";n="docPachy";break;case"VF":url="test_vf.php?pop=1";n="docVF";break;case"VF-GL":url="test_vf_gl.php?pop=1";n="docVFGL";str=n="VFGL";break;case"OCT":url="test_oct.php?pop=1";n="docOCT";break;case"OCT-RNFL":url="test_oct_rnfl.php?pop=1";n="docOCTRNFL";str=n="OCTRNFL";break;case"GDX":url="test_gdx.php?pop=1";n="docGDX";break;case"Amendment":url="onload_wv.php?elem_action=Amendments";w="800";h="400",n="docAmendment";break;case"Other":url="test_other.php?pop=1";n="docOthr";break;case"TemplateTests":url="test_template.php?pop=1";n="docOthr";break;case"CustomTests":case"Customtests":case"customtests":url="test_template_custom_patient.php?pop=1";n="docOthr";break;case"Labs":url="test_labs.php?pop=1";n="docLabs";break;case"B-Scan":url="test_bscan.php?pop=1";n="docbscan";str=n="BScan";break;case"Cell Count":url="test_cellcount.php?pop=1";n="doccellcnt";str=n="CellCount";break;case"Assessment & Plan":case"Vision":case"Memo Chart Note":var memoVal='true';case"Chart Note":url="";if(id!=""){if(rel!=0){var z;for(z in oPF){if((oPF[z])&&(oPF[z].closed==false))oPF[z].close();}
for(z in oPUF){if((oPUF[z])&&(oPUF[z].closed==false))oPUF[z].close();}}
var strQS="";if(st=="Final"){strQS+="&elem_saveForm=Show Prev Chart Notes";strQS+="&hd_finalize_id="+id;strQS+="&elem_openForm="+opn;if(rel!=1){var url;url=path+"/common/print_function.php?print_form_id="+id;window.open(url,'imedic_print','location=0,status=1,resizable=1,left=1,top=1,scrollbars=1,width=700,height=680');return;}}else{strQS+="&elem_saveForm=Make New Chart Notes";}
if(rel!=0){strQS+="&memo="+memoVal;var frmObj;if(top.fmain){frmObj=top.fmain;}
else{if(window.opener&&window.opener.top.fmain){frmObj=window.opener.top.fmain;}}
if(frmObj&&typeof(frmObj)!="undefined"){if(typeof(zPath)=="undefined"){if(typeof(frmObj.JS_SCHEDULER_VERSION)!=""){zPath=window.opener.top.JS_WEB_ROOT_PATH+"/interface";}
if(window.opener&&window.opener.top.$('#appt_scheduler_status').length>0){window.opener.top.$('#appt_scheduler_status').val('unloaded');}}
frmObj.window.location.replace(zPath+"/chart_notes/saveCharts.php?a=1"+strQS);}
return;}}else{}
break;}
if(url!=""){if(tstId!=0){url="/tests/"+url;if(url.indexOf("?")==-1)url+="?";url+="&tId="+tstId;n+="_"+str+"_"+tstId;w=clWidth;h=parseInt(clHeight)-70;}else{url="/chart_notes/"+url;if(url.indexOf("?")==-1)url+="?";url+=(st=="Final")?"&finalize_id="+id:"";n+=(typeof id!="undefined")?"_"+id:"";}
var z;for(z in oPF){if((oPF[z])&&(oPF[z].closed==false))oPF[z].close();}
if(((typeof(oPF)=="undefined"))||(!oPF[n])||(!(oPF[n].open))||(oPF[n].closed==true)){oPF[n]=window.open(path+url,n,'location=0,status=1,resizable=1,left=1,top=1,scrollbars=1,width='+w+',height='+h);oPF[n].focus();}else{oPF[n].focus();}}}
function saveMainPage(flgSkip,btn_final_pressed){if(elem_per_vo=="1"){return;}
if(typeof flgSkip=="undefined"||flgSkip==""){flgSkip="0";}
var ophpr=$("#phth_pros");var oisOdOs=$("#is_od_os");if(ophpr.val()!=""&&oisOdOs.val()==""){top.fAlert(ophpr.val()+" is selected, please select an Eye to save the Information.");return false;}
if(gebi("closeWorkView").value!='true'){var flag=chckMainSaveReqFlds();if(flag==false){return false;}}else{flgSkip="1";}
var flg=true;if(user_type=="3"&&flgSkip=="0"){var flg=mandotry_chk('2');}
if(flg==true){if(zSaveWithoutPopupSave=="0"){var all_warn="";if(str_warn_finalize!=""){all_warn+=str_warn_finalize;}
var n=$("#elem_neuroPsych").val();var m=$("#elem_get_memo").val();if($.trim(n)==""&&m!="1"){all_warn+="Warning! Neuro/Psych is not completed.<br/>";}
if($.trim(all_warn)!=""){if(typeof(zStopSaveWarning)=="undefined"||zStopSaveWarning==""){top.fAlert(all_warn);}}}
$("#otherSaveVal").val($("#otherSave").val());saveMainPageExe(btn_final_pressed);}}
function chckMainSaveReqFlds(){var memoPage=gebi('elem_get_memo').value;var oCCPro=gebi('elem_pro_id');if(oCCPro){var getCCvalue=gebi('elem_pro_id').value;getCCvalue=((typeof getCCvalue!="undefined")&&(getCCvalue!=""))?getCCvalue:0;}else{getCCvalue=0;}
var flag=flag2=0;var Mr1Val=Mr2Val=0;var isMr1Done=isMr2Done=changeMr1Done=changeMr2Done=false;var getMROperator=getMR2Operator=0;var isObjNote=(gebi("elem_objNotes"))?1:0;if(isObjNote==0){var oProId=gebi('elem_providerId');if(oProId){var getMROperator=oProId.value;var ar=new Array("elem_visMrOdS","elem_visMrOdC","elem_visMrOdA","elem_visMrOdAdd","elem_visMrOsS","elem_visMrOsC","elem_visMrOsA","elem_visMrOsAdd");var isMr1Done=false;isMr1Done=isCurMRDone(ar);}
var oProId_2=gebi('elem_providerIdOther');if(oProId_2){var getMR2Operator=oProId_2.value;var ar2=new Array("elem_visMrOtherOdS","elem_visMrOtherOdC","elem_visMrOtherOdA","elem_visMrOtherOdAdd","elem_visMrOtherOsS","elem_visMrOtherOsC","elem_visMrOtherOsA","elem_visMrOtherOsAdd");var isMr2Done=false;isMr2Done=isCurMRDone(ar2);}}
var msg="<b>Please address the following:-</b><div class='m10'>";var fFalse=0;if(memoPage==''){var cchisCount=gebi("elem_ccHx").value;var ccHisLength=cchisCount.length;if(getCCvalue==0&&ccHisLength>0&&memoPage==''){msg+='<li>Operator not authorized for CC & History.</li>';fFalse+=1;}}
if(((getMROperator==0)&&(isMr1Done==true))||((getMR2Operator==0)&&(isMr2Done==true))){msg+='<li>Provider for MR</li>';fFalse+=1;}
var oSB=isSuperBillMade();var sb_dxids="";if(oSB.SBill==true){if((oSB.DXCodeOK==false)||(oSB.DXCodeAssocOK==false)){msg+='<li>Dx code in Super bill for CPT Codes:- '+oSB.CptNotAssoc+'</li>';fFalse+=1;}
if(oSB.DXCodeComplete==false){msg+='<li>Incomplete ICD-10 DX code(s) in Super bill</li>';fFalse+=1;}
if(oSB.mul_ophth_cd==true){msg+='<li>Multiple Ophthalmoscopy Code exists in this superbill!</li>';fFalse+=1;}
sb_dxids=oSB.dxids;}
$("#sb_dxids").val(sb_dxids);if(fFalse>0){if(msg!='')msg+='</div>';top.fAlert(""+msg);return false;}
return true;}
function isCurMRDone(te){return isVisElemDone(te);}
function isVisElemDone(te,isObjArr){isObjArr=(typeof isObjArr!="undefined")?isObjArr:0;if(typeof te!="undefined"){tl=te.length;for(var j=0;j<tl;j++){le=(isObjArr==1)?te[j]:gebi(te[j]);if(le){if((le.type=="text")||(le.type=="select-one")||(le.type=="textarea")){if((le.value!="")&&(le.value!="20\\")){if($(le).hasClass("active")){return true;}}}}}}
return false;}
var psm_actAfSave="";function postSaveMainPageFunctions(data){isFormChanged=0;if(typeof(data.chartFinalized)!="undefined"&&data.chartFinalized==1){top.fAlert("This Chart is Finalized. \nso this chart will be reloaded with new permissions.","Close chart","top.clean_patient_session(undefined,undefined, 1);");return;}
if(typeof(data.as_msg)!="undefined"&&data.as_msg!=''){top.fAlert("<br />"+data.as_msg);}
if(typeof(data.closePtChart)!="undefined"&&data.closePtChart==1){top.clean_patient_session(undefined,undefined,1);return;}
finalize_flag=data.finalize_flag;isReviewable=data.isReviewable;$("#elem_masterFinalize").val(data.finalize_flag);$("#elem_masterRecordValidity").val(1);$("#elem_isFormFinalized").val(data.finalize_flag);$("#elem_isFormReviewable").val(data.isReviewable);$("#elem_masterIsSuperBilled").val(data.elem_masterIsSuperBilled);$("#elem_masterFinalizerId").val(data.elem_masterFinalizerId);$("#elem_masterpurge_status").val(data.purge_status);$("#elem_masterFinalDate").val(data.elem_masterFinalDate);$("#elem_masterProvIds").val(data.elem_masterProvIds);$("#elem_activeFormId").val(data.elem_activeFormId);$("#clws_id").val(data.clws_id);$("#trial_no_old").val(data.cl_trialno);$("#clws_type_old").val(data.clws_type);$("#cl_label").text(data.clws_type_label);$("#clws_type").css('width','100px');$("#clws_type").text(data.clws_type_dd);if(data.elem_procIds){var b=data.elem_procIds;for(var a in b){$("#elem_procedureId_"+a).val(b[a]);}}
if(data.finalize_flag==1){hasActChart=data.elem_activeFormId;if(data.isReviewable==1){setReviewableFunction('frmMain');}else{setfinalizedFunction('frmMain');}
chrt_showChartInfo();if(hasActChart==0){top.$("#el_charttemp_ig ul .def_opts, #lichart_status ul .def_opts").removeClass("hidden");}}
if(sc_userPress_newchart_save==1){sc_userPress_newchart_save=0;sc_userPress(1);}
top.fmain.hideButtons(''+data.finalize_flag,''+data.form_id,''+data.isReviewable,''+data.isEditable,''+data.iscur_user_vphy,''+data.purge_status);$("#sliderRight").attr("attrFilled",0);$("#sliderLeft").attr("attrFilled",0);loadAsPlanTBar();upAsPlanProbid(data.apid);if(psm_actAfSave.indexOf("Print_MR")!=-1){var w=psm_actAfSave.replace(/Print_MR/,"");psm_actAfSave="";zSaveWithoutPopupSave=0;printMr("show",w);}
if(send_to_ibra==1){cnct_ibra(1);}
send_to_ibra=0;str_warn_finalize="";}
function get_asmt_dx_code_id(){var elem_asmt_dxcode_id="";$("#assessplan textarea[id*=elem_assessment_dxcode]").each(function(){var t=$(this).data("dxid");if(typeof(t)=="undefined"||t==""){t="";}elem_asmt_dxcode_id+=""+t+"@@";});$("#elem_asmt_dxcode_id").val(elem_asmt_dxcode_id);}
var submitStart=false;var zSaveWithoutPopupSave=0;function saveMainPageExe(el_btfinalize_pressed){if(elem_per_vo=="1"||submitStart==true){return;}
if(zSaveWithoutPopupSave==0){top.fmain.funClosePopUpExe(1);}
if((user_type!=1)&&(user_type!=3)){disable13Elems(0);}
emptyArcRedStrikeB4Save();var svtxt="";if(typeof(el_btfinalize_pressed)!="undefined"&&el_btfinalize_pressed=="1"){svtxt="Finalize in Progress. Please wait!";}
top.fmain.setSavedBtn("1",svtxt);var objMainFrm=document.frmMain;submitStart=true;get_asmt_dx_code_id();var strsave=$("#frmMain").serialize();strsave+="&savedby=ajax";if(typeof(el_btfinalize_pressed)!="undefined"&&el_btfinalize_pressed=="1"){strsave+="&el_btfinalize_pressed=1";}
$.post("saveCharts.php",strsave,function(data){if(typeof(top.get_pt_edu_alert)!="undefined"){top.get_pt_edu_alert();}
submitStart=false;zSaveWithoutPopupSave=0;postSaveMainPageFunctions(data);top.fmain.setSavedBtn("0");$.ajax({url:"cl_block.php",success:function(resp){if(resp){if($('#ContactLens').length){var clParent=$('#ContactLens').parent();$('#ContactLens').remove();clParent.append(resp);}
applyTypeAhead();utElem_setBgColor();var arrElems=[];var elem=elemString='';var curVals=document.getElementById('elem_utElems_cur').value;arrElems=curVals.split(',');for(x in arrElems){elem=arrElems[x];if(elem!=""){utElem_capture(document.getElementById(elem));}}}}});},'json').fail(function(data){if(data.responseText.indexOf("Current session experiencing a change")!=-1){top.fancyConfirm(""+data.responseText,"Session error","window.top.fmain.wv_reload(1)","window.top.fmain.wv_reload(0)",'','','Refresh','Close Application');}
else{top.fmain.setSavedBtn("0");var ermsg="Error Occurred, Please close this window and try later!  \ncode:"+data.status+", \nstatusText:"+data.statusText+", \n"+data.responseText;if(typeof(isDssEnable)!='undefined'&&isDssEnable){ermsg=ermsg.replace(/(?:\n)/g,"<br />");top.fAlert(ermsg);}else{alert(ermsg);}
$.post(zPath+'/chart_notes/requestHandler.php',{'elem_formAction':'LogError','req_ptwo':'1','msg':''+ermsg},function(){});console.log(data);}});}
function wv_reload(flg){if(flg==0){top.window.close();}else if(flg==1){top.window.location.reload();}}
function funClose(flg)
{if(typeof(flg)=="undefined"||flg!=1){funClosePopUpExe();}
tmp=encodeURIComponent("Close this patient work view");var u=(typeof(zPath_remote)!="undefined")?zPath_remote:zPath;top.fmain.window.location.replace(u+"/chart_notes/saveCharts.php?elem_saveForm="+tmp);}
var str_warn_finalize="";function FinalizeMainPage(flgPrmpt,confrmed){if(elem_per_vo=="1"){return;}
var objMainFrm=document.frmMain;var chartsign_1=chartsign_2=true;if((flgPrmpt=="1")){}else{if(typeof(confrmed)=='undefined'&&1==2){top.fancyConfirm('Finalize: Are you sure?','Finalize Chart',"top.fmain.FinalizeMainPage("+flgPrmpt+",true)","flgPrmpt=false;");flgPrmpt=false;}else{flgPrmpt=true;}
if(flgPrmpt){var str_num="";var tmp=$("div.divsign :input[name*=elem_physicianId][value='"+objMainFrm.elem_chartOprtrId.value+"']").parents(".divsign");if(tmp.find(":input[name*=elem_signCoords][value!=''][value!='0-0-0:;']").length<=0&&tmp.find(":input[name*=elem_sign_path][value!='']").length<=0){if(tmp.find("label.clickable[id*=lbl_phy_sig]").length>0){var cid=""+tmp.attr("id");var num=""+cid.replace("sign_phy","");if(typeof(num)!="undefined"&&num!=""){str_num+=num+",";}}}
var tmp_arScribe="";$("div.divsign :input[name*=elem_physicianIdName][value*='(Scribe)']").each(function(data){var tmp=$(this).parents(".divsign");if(tmp.find(":input[name*=elem_signCoords][value!=''][value!='0-0-0:;']").length<=0&&tmp.find(":input[name*=elem_sign_path][value!='']").length<=0){var num=tmp.attr("id").replace("sign_phy","");if(typeof(num)!="undefined"&&num!=""){str_num+=num+",";}}});if(str_num!=""){getPhySign_db(str_num,1);return;}}}
if(flgPrmpt){var flag=chckMainSaveReqFlds();if(flag==false){return false;}
var err=false;var msg="<b>Please Fill the following:</b><div class='m10'>";var tmp=$("div.divsign :input[name*=elem_physicianId][value='"+objMainFrm.elem_chartOprtrId.value+"']");if(tmp.length>0){var t=tmp.parents(".divsign").find(":input[name*=elem_signCoords][value!='0-0-0:;']");var t2=tmp.parents(".divsign").find(":input[name*=elem_sign_path][value!='']");if((t.length<=0||t.val().length<=0)&&t2.length<=0){err=true;msg+="<li>Signature</li>";}}else{err=true;msg+="<li>Physician Name</li>";}
if(err==false){var ispov=$("#elem_proc_only_visit").val();var m=$("#elem_get_memo").val();str_warn_finalize="";var t=isVisitCodeExits();if(typeof(sb_warnVisCd)=="undefined"){sb_warnVisCd="";}
if(sb_warnVisCd=="1"&&t==0&&ispov!="1"){str_warn_finalize+="Warning! Super Bill does not include any visit code.<br/>";}
else if(t==-1&&m!="1"){str_warn_finalize+="Warning! No superbill created for this visit.<br/>";}
if($("#btn_attest_scribe").length>0){var t=$("#btn_attest_scribe").data("attested");if(typeof(t)=="undefined"||t==""){str_warn_finalize+="Warning! Scribe Attestation not complete.<br/>";}}
if($("#btn_attest_attend_scribe").length>0){var t=$("#btn_attest_attend_scribe").data("attested");if(typeof(t)=="undefined"||t==""){str_warn_finalize+="Warning! Attending scribe attestation not complete.<br/>";}}
if($("#btn_attest_teach").length>0){var t=$("#btn_attest_teach").data("attested");if(typeof(t)=="undefined"||t==""){str_warn_finalize+="Warning! Teaching attestation not complete.<br/>";}}
objMainFrm.elem_masterFinalize.value="1";objMainFrm.elem_masterFinalizerId.value=objMainFrm.elem_chartOprtrId.value;if(isDssEnable==1){var tiuTitle=top.fmain.document.getElementById('dssTiuTitle').value;if(typeof(tiuTitle)!='undefined'&&tiuTitle!=''){top.dssValidateElectronicSignature('show','','','saveChartNote');}else{top.fAlert('Please select TIU Title from the DSS TIU Title Dropdown.','DSS Required Field');return false;}}else{saveMainPage(0,1);}}else{if(msg!='')msg+='</div>';top.fAlert(msg);}}}
function chartNoteUnfinalize(){var title="Unfinalize Chart";var msg="Are you sure you want to unfinalize chart note?<BR>"+"You will need to re-finalize it.";var func="top.fmain.decideChartNoteUnfinalize(1)";top.fancyConfirm(msg,title,func);return;}
function chartNoteEdit(){var title="Edit Chart";var msg="Are you sure you want to edit chart notes?<br>"+"You will need to re-finalize it.";var func="top.fmain.decideChartNoteEdit(1)";top.fancyConfirm(msg,title,func);return;}
function decideChartNoteEdit(val,flg_fnlz){if(val==1){var oFid=top.fmain.document.getElementById("elem_masterId");if(oFid&&(oFid.value!="")){var memo=$("#elem_get_memo").val();var tmp="ChartNoteEdit";if(typeof(flg_fnlz)!="undefined"&&flg_fnlz=="1"){tmp="ChartNoteUnfinalize";}
top.fmain.window.location.replace(zPath+"/chart_notes/saveCharts.php?elem_saveForm="+tmp+"&hd_finalize_id="+oFid.value+"&elem_openForm=0&memo="+memo);}}}
function decideChartNoteUnfinalize(val){decideChartNoteEdit(val,1);}
function getconfirmationPurgeRequest(){if(elem_per_vo=="1"&&per_prgdel!="1"){top.fAlert('You don\'t have permissions.');return;}
var vBtnPrge=top.$("#buttonPurge").val();if(vBtnPrge=="Undo Purge"){var title="Undo Purge Chart Note";var msg="Do you want to undo purge this chart note?";}else{var title="Purge Chart Note";var msg="Do you want to purge this chart note?";}
var func="top.fmain.confirmPurgeRequest(1);";top.fancyConfirm(msg,title,func);}
function confirmPurgeRequest(strVal){if(strVal==1){var vBtnPrge=top.$("#buttonPurge").val();if(vBtnPrge=="Undo Purge"){var status="0",msg="Un-Purging ";}else{var status="1",msg="Purging ";}
top.fmain.setSavedBtn("1",msg+"Chart Note. Please wait! ");$.post("saveCharts.php",{"elem_saveForm":"PurgeCN","elem_status":status},function(data){top.fmain.setSavedBtn("0");if(top.$("#lblFinalized").get(0)){var htmlStr=(data.purge_status==1)?'<b>Purged</b>':'<b>Finalized</b>';top.$("#lblFinalized").html(htmlStr);}
if(data.purge_status==1){$("body").append("<div id=\"dvPrgdSgn\" title=\"Purged chart note\">X</div>");}else{$("#dvPrgdSgn").remove();}
postSaveMainPageFunctions(data);},'json');}}
function deleteChart(flg){if(elem_per_vo=="1"&&per_prgdel!="1"){top.fAlert('You don\'t have permissions.');return;}
if(typeof(flg)!="undefined"&&flg==1){top.fmain.setSavedBtn("1","Deleting Chart Note. Please wait! ");$.post("saveCharts.php",{"elem_saveForm":"DeleteCN"},function(data){if(typeof varNxtFId.id!="undefined"){top.fmain.showFinalize(varNxtFId.typeChart,varNxtFId.id,varNxtFId.chartStatus,varNxtFId.releaseNum);}
else if(typeof varPrevFId.id!="undefined"){top.fmain.showFinalize(varPrevFId.typeChart,varPrevFId.id,varPrevFId.chartStatus,varPrevFId.releaseNum);}
else{wv_reload(1);}},'json');}else{var msg="Do you want to remove this chart note? This operation cannot be reversed.";var func="top.fmain.deleteChart(1);";var title="Delete Chart Note";top.fancyConfirm(msg,title,func);}}
function chkWVB4Close(){if(typeof(elem_per_vo)=="undefined"||(typeof(elem_per_vo)!="undefined"&&elem_per_vo=="1")){if(typeof(funClosePopUpExe)=="function")funClosePopUpExe(0);return false;}
if(typeof(isTestFormsOpen)=="undefined"||(typeof(isTestFormsOpen)!="undefined"&&isTestFormsOpen())){return true;}
funClosePopUpExe(1);if(top.fmain&&top.fmain.isFormChanged&&typeof(top.fmain.isFormChanged)!="undefined"&&top.fmain.isFormChanged==1&&top.fmain.$("#elem_closePtChart").length>0&&top.$("#save").length>0){top.fmain.$("#elem_closePtChart").val(1);top.fmain.zSaveWithoutPopupSave=1;top.$("#save").trigger("click");return true;}else{return false;}}
function chkWVB4Move(ptGo2,ptSrch,ptSrchFB,callFrom){if(typeof(elem_per_vo)=="undefined"||(typeof(elem_per_vo)!="undefined"&&elem_per_vo=="1")){if(typeof(funClosePopUpExe)=="function")funClosePopUpExe(0);return false;}
if(typeof(isTestFormsOpen)=="undefined"||(typeof(isTestFormsOpen)!="undefined"&&isTestFormsOpen())){return true;}
if(callFrom!='CL'){if(typeof(funClosePopUpExe)!="undefined"){funClosePopUpExe(1);}}
var flgDel_EId=1;var CLSavedCheck='';if(callFrom=='CL'){CLSavedCheck=1;}
var o1=(top.fmain&&top.fmain.document.frmMain)?top.fmain.document.frmMain:null;if(o1){var flag=(isFormChanged==1)?true:false;if(callFrom=='CL'){flag=true;}
if(flag==false){return false;}
var fnl=o1.elem_isFormFinalized;var rel=o1.elem_isFormReviewable;var purge=o1.elem_masterpurge_status;if(purge.value>0){return false;}
if((fnl.value=="0")||(rel.value=="1")){top.fmain.get_asmt_dx_code_id();top.fmain.setSavedBtn("1");if(top.fmain.disable13Elems){top.fmain.disable13Elems(0);}
o1.elem_ptGo2.value=ptGo2;o1.elem_ptSrchPatient.value=ptSrch;o1.elem_ptSrchFindBy.value=ptSrchFB;o1.elem_clPopUpSaved.value=CLSavedCheck;o1.submit();o1.elem_clPopUpSaved.value='';flgDel_EId=0;return true;}}
if(flgDel_EId==1){$.get(zPath+'/chart_notes/requestHandler.php?elem_formAction=EmptyEncounterID',function(){});}
return false;}
function getPhyViewWV(val){var res=chkWVB4Move("ShowPhyView");if(res==true){}else{var tmp=encodeURIComponent(val);top.fmain.window.location.replace(zPath+"/chart_notes/requestHandler.php?elem_formAction=ShowPhyView&op="+tmp);}}
function funClosePopUpExe(sv){if(typeof(elem_per_vo)!="undefined"&&elem_per_vo=="1"){sv='0';}
try{var arr=[top.fmain.oPP,top.fmain.oPO,top.fmain.oPF,top.fmain.oPUF,top.fmain.arrSchPop,top.tb_oPU,top.arr_opened_popups];for(var zx in arr){var tmpoP=arr[zx];if(tmpoP){for(var z in tmpoP){if(tmpoP[z]&&tmpoP[z].closed==false&&z!="day_charges_list"){var savebtn=tmpoP[z].document.getElementById("save");if(!savebtn&&tmpoP[z].jQuery){savebtn=tmpoP[z].$("button:contains('Done')").filter(function(){return $(this).text()==='Done';});}
var oSaveClose=tmpoP[z].document.getElementById("elem_saveClose");if(oSaveClose){oSaveClose.value="1";}
if(savebtn&&savebtn.length>0&&(sv=="1")&&(tmpoP[z].name!="winChangePassword")&&(tmpoP[z].name!="alerts")&&(tmpoP[z].name!="contact_lens_worksheet_popup")){savebtn.click();}else{tmpoP[z].close();}}}}}}catch(ignored){console.log("ERROR: "+ignored.name+" - "+ignored.description);}}
function funReset()
{if(elem_per_vo=="1"){return;}
var o=top.fmain.document.frmMain.elements;var l=o.length;for(var i=0;i<l;i++)
{if((o[i].type=="text")||(o[i].type=="textarea")){o[i].value="";}else if(o[i].type=="checkbox"){if(o[i].checked==true){o[i].checked=false;}}}}
function setSmartApEye(name1,iter,elem){var name=name1+iter+"[]";key=0;$("input[name='"+name+"']").each(function(index,element){if($(element).attr("id")!=$(elem).attr("id"))
$(element).prop("checked",false);id=name1+iter+key;$("label[for="+id+"]").css({"border-color":"transparent"});key++;});$("input[name='elem_ap_assess[]'][value='"+iter+"']").prop("checked",true);}
function setSmartAssessEye(name1,iter,elem){if($(elem).is(":checked")==false){name=name1+iter+"[]";key=0;$("input[name='"+name+"']").each(function(index,element){$(element).prop("checked",false);id=name1+iter+key;$("label[for="+id+"]").css({"border-color":"transparent"});key++;});}}
function disable13Elems(v){if((user_type!=1)&&(user_type!=3))return;var strElm="#divMR :input[type!=hidden][type!=button][type!=submit], "+"#div_rvs :input[type!=hidden][type!=button][type!=submit], "+"#div_rvs :input[type!=hidden][type!=button][type!=submit], "+"#elem_chk, "+"#elem_mrPrism1,#elem_mrNoneGiven1,#elem_mrGLPH1, "+"#elem_mrPrism2,#elem_mrList2,#elem_mrGLPH2,#elem_mrCL2, "+"#elem_mrBat2";$(strElm).each(function(){if(v){$(this).attr("disabled","disabled").bind("click change",setElem2Default);}else{$(this).removeAttr("disabled");}});strElm="#imgClearMr1,#imgCopyMr1_Pc,#imgCopyMr1_Ar,#imgClearMr2,#imgClearMr3";$(strElm).unbind("click");}
function setElem2Default(){if((user_type!=1)&&(user_type!=3))return;if((this.type=="checkbox")||(this.type=="radio")){this.checked=this.defaultChecked;}else{this.value=this.defaultValue;}
return false;}
var to_showdivArc="";var oDivNames=new Array();function hideAlldivArc(mn){for(var i in oDivNames){var od=gebi("divArcCmn"+i);if(od){od.style.display="none";}
oDivNames[i]=0;}}
function postionDivArc(id,mn){var idO=id;if(id=="FundusExam"){id="RV";}
var str="";if($(":input[name='"+id+"']").length>0){str=":input[name='"+id+"']";}else if($("#lblHx"+id+"").length>0){str="#lblHx"+id+"";}
if(str!=""){var opos=$(str).offset();var hgt=$(str).parents(".esum").height();var sTop=$("#divWorkView").scrollTop();var hgtD=$("#divArcCmn"+idO).height();var top=parseInt(opos.top)+parseInt(sTop)-parseInt(hgtD)-30;if(top<sTop){top=sTop;if(sTop>(opos.top+hgtD)){top+=opos.top+hgt-30;}else{}}
$("#divArcCmn"+idO).css({"display":"block","left":opos.left+"px"});}}
function showdivArc(divId,flg,mn){var oDiv=gebi("divArcCmn"+divId);if(oDiv){if(flg=="1"){oDivNames[divId]=1;hideAlldivArc(mn);postionDivArc(divId,mn);if(to_showdivArc){to_showdivArc=clearTimeout(to_showdivArc);}}else{to_showdivArc=setTimeout(function(){if(to_showdivArc){oDiv.style.display="none";}},500);}}}
function remRedStyleArc(obj){obj.className=obj.className.replace(/red_strike/g,"");if(obj.select)obj.select();}
function emptyArcRedStrikeB4Save(){$(".arcvDeleted").val("");var arr=new Array("commentsForPatient");var len=arr.length;for(var i=0;i<len;i++){var to=gebi(arr[i]);if(to&&(to.className.indexOf("bgSmoke")!=-1)){to.value="";}}}
function isTestFormsOpen(){var arrOpenPU=new Array();var arrObj=new Array(top.fmain.oPF,top.fmain.oPUF,top.fmain.oPO,top.tb_oPU);try{for(var i in arrObj){for(var j in arrObj[i]){if(arrObj[i][j]&&arrObj[i][j].open&&arrObj[i][j].closed!=true){if(j.indexOf("docAG")!=-1||j.indexOf("amsler")!=-1){arrOpenPU[arrOpenPU.length]="Amsler Grid";}else if(j.indexOf("docDisc")!=-1||j.indexOf("Disc")!=-1){arrOpenPU[arrOpenPU.length]="Fundus";}else if(j.indexOf("docTopo")!=-1||j.indexOf("Topography")!=-1){arrOpenPU[arrOpenPU.length]="Topography";}else if(j.indexOf("docExAnt")!=-1||j.indexOf("External")!=-1){arrOpenPU[arrOpenPU.length]="External/Anterior";}else if(j.indexOf("docIvfa")!=-1||j.indexOf("IVFA")!=-1){arrOpenPU[arrOpenPU.length]="IVFA";}else if(j.indexOf("docNfa")!=-1||j.indexOf("HRT")!=-1){arrOpenPU[arrOpenPU.length]="HRT";}else if(j.indexOf("docOptha")!=-1||j.indexOf("Optha")!=-1){arrOpenPU[arrOpenPU.length]="Ophtha";}else if(j.indexOf("docPachy")!=-1||j.indexOf("Pachy")!=-1){arrOpenPU[arrOpenPU.length]="Pachy";}else if(j.indexOf("docVF")!=-1||j.indexOf("VF")!=-1){arrOpenPU[arrOpenPU.length]="VF";}else if(j.indexOf("docOCT")!=-1||j.indexOf("OCT")!=-1){arrOpenPU[arrOpenPU.length]="OCT";}else if(j.indexOf("docIcg")!=-1||j.indexOf("ICG")!=-1){arrOpenPU[arrOpenPU.length]="ICG";}else if(j.indexOf("doccellcnt")!=-1||j.indexOf("CellCount")!=-1){arrOpenPU[arrOpenPU.length]="Cell Count";}else if(j.indexOf("docAscan")!=-1||j.indexOf("Ascan")!=-1){arrOpenPU[arrOpenPU.length]="A/Scan";}else if(j.indexOf("docIOL_Master")!=-1||j.indexOf("IOL_Master")!=-1){arrOpenPU[arrOpenPU.length]="IOL Master";}else if(j.indexOf("docbscan")!=-1||j.indexOf("BScan")!=-1){arrOpenPU[arrOpenPU.length]="B-Scan";}else if(j.indexOf("docOthr")!=-1||j.indexOf("Other")!=-1){arrOpenPU[arrOpenPU.length]="Other-Tests";}else if(j.indexOf("docLabs")!=-1||j.indexOf("Labs")!=-1){arrOpenPU[arrOpenPU.length]="Laboratories";}else if(j.indexOf("winSuperBill")!=-1){arrOpenPU[arrOpenPU.length]="Super Bill";}else if(j.indexOf("GDX")!=-1){arrOpenPU[arrOpenPU.length]="GDX";}}}}}catch(err){console.log("first: "+err);}
if(arrOpenPU.length>0){top.fAlert("Please save and close test forms<br/>"+"<br/>     -"+arrOpenPU.join("<br/>     -"));return true;}else{return false;}}
function setReviewableFunction(id){if((typeof(id)=="undefined"||id=="")&&$("form[id]").length>0){id=$("form[id]").get(0).id;}
if(typeof(id)!="undefined"&&id!=""){var strElm="#"+id+" :input[type!=button][type!=submit][value!=Save][value!=Done][value!=Cancel]";$(strElm).bind("focus",checkAlert);var strElm="#"+id+" label[for]";$(strElm).bind("mousedown",function(event){var f=$(this).attr("for");if(typeof(f)!="undefined"&&f!=""){$("#"+f).triggerHandler("focus");$(strElm).unbind("mousedown");}});}}
function checkAlert()
{if(typeof(window.flgCheckAlert)=="undefined"&&(typeof(event)!="undefined"&&event.target.id!='sl_paging'&&event.target.id!='el_pt_crry_frwd_dos'))
{top.fAlert("You are modifying a finalized patient chart note");window.flgCheckAlert=1;}}
function openNewChart(o,flgmsg)
{if(top.$(".messi").length<=0||top.$("#wv_old_chart_alert").length<=0){var msg=flgmsg?"You don't have permission to edit chart notes.":"Please Open New Chart Note!";top.fAlert(msg);top.$(".messi")[0].id="wv_old_chart_alert";if(o.type!="checkbox"){o.value=o.defaultValue;}
return false;}}
function setfinalizedFunction(id,flgmsg){if((typeof(id)=="undefined"||id=="")&&$("form[id]").length>0){id=$("form[id]").get(0).id;}
if(typeof(id)!="undefined"&&id!=""){var strElm="#"+id+" :input[type!=button][type!=submit][value!=Save][value!=Done][value!=Cancel]"+"[id!=to_do][name!=patient_task][id!=dr_to_do][name!=dr_task][name!=phy_name_drop][id!=elem_mrBat2][name!=pamOrBat][id!=elem_sur_ocu_hx]"+"[type!=hidden][id!=drawing-line-width][id!=text-font-size][id!=elem_lockAdminPass][name!=btn_act_done]";var tgNm="";$(strElm).each(function(){if($(this).parents("#genHealthDiv_wv").length>0){return false;}
var typee=this.type;tgNm=this.tagName.toLowerCase();if(typee=="text"||tgNm=="textarea"){$(this).attr("readonly","readonly");}else{$(this).attr("disabled","disabled");}
$(this).bind("click change",function(){openNewChart(this,flgmsg);});});}}
var sc_userPress_newchart_save=0;function sc_userPress(val){if(val==1){if($(":checked[name*=elem_ap_assess]").length>0){if($("#elem_masterRecordValidity").val()=="0"){sc_userPress_newchart_save=1;saveMainPage();return;}else{if(typeof(setProcessImg)!='undefined')setProcessImg("1","bodyMP","",300,600);var icd10=($("#hid_icd10").length>0)?$("#hid_icd10").val():$("#enc_icd10").val();document.frmsc.elem_sc_icd10.value=icd10;var param="elem_saveForm="+document.frmsc.elem_saveForm.value;param+="&elem_sc_icd10="+icd10;$(":checked[name*=elem_ap_assess]").each(function(){var v=this.value;param+="&elem_ap_assess[]="+v;param+="&elem_symptom_"+v+"="+$("#accordion_smart_chart :hidden[name=elem_symptom_"+v+"]").val();param+="&elem_site_"+v+"[]="+$(":checked[name*=elem_site_"+v+"]").val();param+="&elem_todoid_"+v+"="+$("#accordion_smart_chart  :hidden[name=elem_todoid_"+v+"]").val();});if(typeof(setProcessImg)!='undefined')setProcessImg("1");$.post("saveCharts.php",param,function(d){window.location.reload();});}}
$("#div_sc_con").hide();}else{$("#div_sc_con").hide();$("#div_sc_con_detail").modal('hide');$("#div_sc_con_detail1").modal('hide');}}
function loadAsPlanTBar(){$.post('onload_wv.php',{'elem_action':"GetListExamDone"},function(data){$('#imp_ex_done').html(data);},"");}
function upAsPlanProbid(arr){if(!arr||!arr[0]||arr[0].length<=0)return;var arr0=arr[0],arr1=arr[1];arr2=arr[2];$("input[name*=el_pt_ap_id]").each(function(indx){var tasid=this.id.replace(/el_pt_ap_id/,"elem_assessment");var tasv=$.trim($("#"+tasid).val());var tpl=this.id.replace(/el_pt_ap_id/,"elem_problist_id_assess");var tplv=$.trim($("#"+tpl).val());var re=null;if(tasv!=""){tasv=escapeRegExp(tasv);re=new RegExp("^"+tasv,"g");}
if(this.value==""||this.value=="0"){if(tasv!=""){for(var z in arr0){if(arr0[z].indexOf(tasv)!=-1&&re.test($.trim(arr0[z]))&&arr2&&arr2[z]&&arr2[z]!=""&&arr2[z]!="0"){this.value=arr2[z];}}}}else if(tasv==""){this.value='';}
if(tplv==""||tplv=="0"){if(tasv!=""){for(var z in arr0){if(arr0[z].indexOf(tasv)!=-1&&arr1[z]!=""&&arr1[z]!="0"){$("#"+tpl).val(arr1[z]);}}}}});}
function printPC(){var parWidth=parent.document.body.clientWidth;var parHeight=parent.document.body.clientHeight;top.popup_win(zPath+'/chart_notes/requestHandler.php?printType=1&elem_formAction=print_pc','printPatientPC','scrollbars=1,resizable=1,width='+parWidth+'height='+parHeight+',top=0,left=0');}
function printMr(value,w){if(elem_per_vo=="1"||(finalize_flag=="1"&&isReviewable!="1")){value="show";}
if(value=="show"){var givenMrValue="";$(":checked[name*=elem_mrNoneGiven]").each(function(){var a=this.name.replace(/elem_mrNoneGiven/,"");if(a!=""&&typeof(a)!="undefined"){if(givenMrValue!=""){givenMrValue+=",";}givenMrValue+="MR "+a+"";}});var pr=flg_printMr;pr=(pr=="")?"0":"1";var printone="";if(typeof(w)!="undefined"&&w!=""){printone="&printone="+w;}
var parWidth=parent.document.body.clientWidth;var parHeight=parent.document.body.clientHeight;top.popup_win(zPath+'/chart_notes/requestHandler.php?printType=1&elem_formAction=print_mr&givenMr='+givenMrValue+printone,'printPatientMr','scrollbars=1,resizable=1,width='+parWidth+'height='+parHeight+',top=0,left=0');}else{if(typeof(w)=="undefined"){w="";}
psm_actAfSave="Print_MR"+w;zSaveWithoutPopupSave=1;saveMainPage();}}
function getPhySign_db(num,flgSave,coId){var phyId_value="";var num0="";if(typeof(num)=="undefined"||num==""){num=1;}
num=""+num;var ar_num=(""+num.indexOf(",")!=-1)?""+num.split(","):[num];if(ar_num.length>0){for(var t in ar_num){var tnum=ar_num[t];if(typeof(tnum)!="undefined"&&tnum!=""){if(num0==""){num0=tnum;}
var phyId=gebi("elem_physicianId"+tnum);if(phyId&&typeof(phyId.value)!="undefined"&&phyId.value!=""){phyId_value+=phyId.value+",";}}}}
window.status="";if((phyId_value=="")){var em="Please select any signer.";window.status=em;return;}
flgSave=(typeof flgSave=="undefined")?"0":flgSave;var url="requestHandler.php";params="elem_formAction=CaptureSign";params+="&elem_flgApplet="+flgSave;params+="&elem_form_id="+$("#elem_masterId").val();params+="&elem_physicianId="+phyId_value;params+="&num="+num;if(typeof(setProcessImg)!='undefined')setProcessImg("1","td_signature_applet"+num0);$.post(url,params,function(dt){if(typeof(setProcessImg)!='undefined')setProcessImg("0","td_signature_applet"+num0);if(dt){var flgSave1=(typeof(dt.flgSaveDef)!="undefined")?dt.flgSaveDef:0;var data=dt.data;for(var x in data){var odata=data[x];if(odata&&((odata.strpixls&&odata.strpixls!="")||(odata.strsignpath&&odata.strsignpath!=""))){var num=odata.num;var oT=gebi("td_signature_applet"+num);var oE=gebi("elem_signCoords"+num);var oE1=gebi("hdSignCoordsOriginal"+num);var oSP=gebi("elem_sign_path"+num);if(oT){if(oE){oE.value=""+odata.strpixls;}
if(oE1){oE1.value=""+odata.strpixls;}
if(oSP){oSP.value=""+odata.strsignpath;}
oT.innerHTML=""+odata.str;flgSave1=1;}}else{window.status="Physician signature do not exists.";}}
if(flgSave=="1"&&flgSave1==1){FinalizeMainPage("1");}}},'json');}
var wnlOptTimer;var wnlOptExm="";var wnlOptW="";function showWnlOpts(flg,w,val){var o2=$("#div_wnlOpts"+w);if(o2.length<=0){var funcl="javascript:void";if(w==1){funcl="setWnlStart";}
else if(w==2){funcl="setNcStart";}
else if(w==3){funcl="setResetStart";}
var ss=""+"<div id=\"div_wnlOpts"+w+"\" class=\"wnlOpts\" onmouseover=\"clearWnlOpts();\" onmouseout=\"showWnlOpts(0,"+w+")\" >"+"<a href=\"javascript:void(0);\" class=\"ou\" onclick=\""+funcl+"('OU')\">OU</a><br/>"+"<a href=\"javascript:void(0);\" class=\"od\" onclick=\""+funcl+"('OD')\">OD</a><br/>"+"<a href=\"javascript:void(0);\" class=\"os\" onclick=\""+funcl+"('OS')\">OS</a>"+"</div>";$("#summarysheet").append(ss);showWnlOpts(flg,w,val);return;}
if(flg==1){var o;if(typeof val!="undefined"){if(wnlOptExm!=""&&val!=wnlOptExm){o2.hide();clearWnlOpts();}
if(wnlOptW!=""&&w!=wnlOptW){$("#div_wnlOpts"+wnlOptW).hide();}
var id="";if(w==1){id="elem_btnWnl";}
else if(w==2){id="elem_btnNoChange";}
else if(w==3){id="btn_reset_chart";}
o=$("#"+id+val);if(o.val()=="Prv"||o.val()=="UNDO")return;}
var pos=o.offset();var pos_ss=$("#summarysheet").offset();var dwv_scrolltop=$("#divWorkView").scrollTop();if(o2&&o2.is(':hidden')){var left=(w==1)?pos.left+40:pos.left+30;var top=pos.top;top+=dwv_scrolltop;top=top-25;var objcss={"left":""+left+"px","top":""+top+"px"};o2.css(objcss).show();wnlOptExm=""+val;wnlOptW=w;}
clearWnlOpts();}else{if(wnlOptTimer==null){wnlOptTimer=setTimeout(function(){showWnlOpts(0,w);},1000);}else{o2.hide();clearWnlOpts();wnlOptExm="";wnlOptW="";}}}
function clearWnlOpts(){wnlOptTimer=clearTimeout(wnlOptTimer);}
function setWnlStart(val){if(wnlOptExm!=""){showWnlOpts(0,1);if(wnlOptExm=="Mas"){setWnlValues_all(val);}else{setWnlValues(wnlOptExm,val);}}}
function setNcStart(val){if(wnlOptExm!=""){showWnlOpts(0,2);if(wnlOptExm=="Mas"){autoSaveNoChange_all(val);}else{autoSaveNoChange(wnlOptExm,val);}}}
function setWnlValues_all(iv){iv=(typeof iv!="undefined")?""+iv:"OU";var arr=new Array("pupil","eom","External","La","Sle","Rv");$("#summarysheet .btn[id*=elem_btnWnl]").each(function(){if(this.id=='elem_btnWnlMas'){return true;}
var t=this.id.replace(/elem_btnWnl/,'');t=t.charAt(0).toUpperCase()+t.slice(1).toLowerCase();if(t=="Pupil"||t=="Eom"){t=t.toLowerCase();}
var tmp=iv;if(t=="eom"||t=="External"||t=="Gonio"){if(tmp!="OU")return true;}
setWnlValues(t,tmp);});}
function autoSaveWnl(w,eye)
{if(w.length==0)
{return;}
var url="saveCharts.php";var params={};params.elem_saveForm="WNL";var f=document.getElementById("elem_masterId");params.elem_formId=f.value;params.w=w;var p=document.getElementById("elem_patientId");params.elem_patientId=p.value;params.elem_exmEye=eye;params.artemp=arrTempProc_js;params.cryfwd_form_id=$("#cryfwd_form_id").val();if(typeof(setProcessImg)!='undefined')setProcessImg(1,"");$.post(url,params,function(data){if(typeof(setProcessImg)!='undefined')setProcessImg(0,"");if(data=="1"){top.window.status="wnl is saved.";w=w.toLowerCase();if(w=="rv"){w="fundus_exam";}else if(w=="ag"){w="amsgrid";}
loadExamsSummary(w);if(w=="Pupil"||w=="Eom"||w=="Ee"){mandotry_chk(1);}}else{top.window.status="Error: wnl is not saved.\nPlease Try again.";}},"");}
function setWnlValues(s,eye){if((elem_per_vo=="1")||((finalize_flag=="1")&&(isReviewable!="1"))){return;}
eye=(typeof eye!="undefined")?eye:"OU";if(s.toUpperCase()!="EOM"){var op=oneEye_isOpAllwd(eye);if(!op.alwd){flash_msg('Prosthesis/Phthisis is set. This operation is not allowed!','danger');return;}
eye=op.eye;}
autoSaveWnl(s,eye);}
function autoSaveNoChange(w,eye)
{eye=(typeof eye!="undefined")?eye:"OU";if((elem_per_vo=="1")||((finalize_flag=="1")&&(isReviewable!="1"))){return;}
if(w.length==0)
{return;}
if(w.toUpperCase()!="EOM"){var op=oneEye_isOpAllwd(eye);if(!op.alwd){flash_msg('Prosthesis/Phthisis is set. This operation is not allowed!','danger');return;}
eye=op.eye;}
var url="saveCharts.php";var params="elem_saveForm=NoChange";var f=$("#elem_masterId");params+="&elem_formId="+f.val();params+="&w="+w;var p=$("#elem_patientId");params+="&elem_patientId="+p.val();params+="&elem_exmEye="+eye;params+="&cryfwd_form_id="+$("#cryfwd_form_id").val();var eId="elem_btnNoChange"+w;var eObj=$(":input[id='"+eId+"']");if(eObj.length){var r="1";params+="&"+eId+"="+r;}else{return;}
if(typeof(setProcessImg)!='undefined')setProcessImg(1,eId);$.post(url,params,function(data){if(typeof(setProcessImg)!='undefined')setProcessImg(0,eId);if(data=="1"){w=w.toLowerCase();if(w=="rv"){w="fundus_exam";}else if(w=="gonio"){w="iop_gon";}else if(w=="ag"){w="amsgrid";}
loadExamsSummary(w);if(w=="Pupil"||w=="Eom"||w=="Ee"){mandotry_chk(1);}}else{top.window.status="Error: \'no change\' is not saved.\nPlease Try again.";console.log(data);}},"");}
function autoSaveNoChange_all(v){v=(typeof v!="undefined")?""+v:"OU";var arr=new Array("Pupil","EOM","External","LA","Gonio","SLE","RV","Ref_Surg");var j=0;for(var i=0;i<8;i++){var o=$("#elem_btnNoChange"+arr[i]);if(o.length>0){if(o.val()=="NC"){autoSaveNoChange(arr[i],v);j+=1;}else{}}}
if(j==0){var cfrm=confirm("Do you want to set all exams to previous visit?");if(cfrm!=false){for(var i=0;i<7;i++){var o=$("#elem_btnNoChange"+arr[i]);if(o.length>0){if(o.val()=="Prv"||o.val()=="UNDO"){o.triggerHandler("click");}}}}}}
function addMoreSigns(v){var len=$("#elem_signatureNum").val();if(len==""){len=1;}
var num=parseInt(len)+1;$("#elem_signatureNum").val(num);if(typeof(setProcessImg)!='undefined')setProcessImg(1,"signatures");$.get("requestHandler.php",{"elem_formAction":"addMoreSigns","num":num},function(data){if(typeof(setProcessImg)!='undefined')setProcessImg(0,"signatures");if(data!=""){var wh=(v==2)?".phy_right":".phy_left";$("#signatures").append(data);$(document).scrollTop($(document).height());}});}
function checkDupPhy(obj){if(obj&&obj.value!=""){if($(".divsign :hidden[name*=elem_physicianId][value="+obj.value+"]").length>0||$(":hidden[name=elem_cosignerId][value="+obj.value+"]").length>0||$(":hidden[name=elem_physicianId][value="+obj.value+"]").length>0){top.fAlert("Physician already exists.");obj.value="";obj.focus();}else{var num=obj.name.replace("elem_physicianId","");$(":input[name=elem_physicianIdName"+num+"]").val(obj[obj.selectedIndex].text);}}}
function getAssessmentSign(num,n,coords,sdata,simg,cnfrm)
{if(elem_per_vo=="1"){return;}
if(typeof(num)=="undefined"){num=1;}
var v1="td_signature_applet"+num;var v2="dv_ShowSign"+num;var v3="elem_signCoords"+num;var v4="hdSignCoordsOriginal"+num;var v5="elem_sign_path"+num;if(typeof(n)=="undefined"){var w=parseInt(225*2.5);var h=parseInt(45*2.5);var opd=0;var tmp=$('#'+v1).position();if($("#"+v2).length<=0){var final_flg=$("#elem_isFormFinalized").val();var strpixls="";var img="<iframe id=\"ifrm_signApp"+num+"\" src=\"signApplet.php?final_flg="+final_flg+"&signType="+num+"\" border=\"0\" height=\"100%\" width=\"100%\" scrolling=\"0\"></iframe>";var str="<div id=\""+v2+"\" >"+
img+"</div>";$('#'+v1).append(str);$('#'+v2).css({'position':'absolute','width':''+w+"px",'height':''+h+"px",'background-color':'white','border':'1px solid black','z-Index':2,'overflow':'hidden'});}else{$("#"+v2).show();}
$("#"+v2).css({"left":tmp.left+"px","top":(opd+tmp.top-h)+"px"});}else if(n==1){var fid=$("#elem_masterId").val();$('#'+v1+' img').remove();$("#"+v2).hide();var final_flg=$("#elem_isFormFinalized").val();var proId=(final_flg==1)?$('#'+v1).parents("div.divsign").find(":input[name*=elem_physicianId][type!=text]").val():"";if(typeof(setProcessImg)!='undefined')setProcessImg(1,""+v1);var p={'elem_formAction':'GetSign','strpixls':''+coords+'','fid':''+fid,'signType':num,'final_flg':final_flg,'proId':proId,'sData':sdata,'sImg':simg};$.post('requestHandler.php',p,function(data){if(typeof(setProcessImg)!='undefined')setProcessImg(0,""+v1);if(data&&data.src&&data.src!=''){var u=zPath;$('#'+v1).append("<img src=\""+data.src+"\" alt=\"sign\" width=\"150\" height=\"30\" >");$('input[name='+v5+']').val(data.sign_path);}},"json");}else if(n==2){$("#"+v2).hide();}else if(n==3){if($('#'+v1+' img').length>0){$('#'+v1+' img').remove();$('input[name='+v5+']').val("");$("#"+v3).val("");}else{if($('#'+v1+'').parents("div.divsign").children("select[value='']").length>0){$('#'+v1+'').parents("div.divsign").remove();}else{if(typeof(cnfrm)=="undefined"){top.fancyConfirm("Are you sure to delete this physician?","",'top.fmain.getAssessmentSign("'+num+'","'+n+'","'+coords+'","'+sdata+'","'+simg+'",true)');return}
else if(cnfrm==true){var fid=$("#elem_masterId").val();if($('#'+v1+'').parents("div.divsign").find(":hidden[name*=elem_physicianId]").length>0){var proid=$('#'+v1+'').parents("div.divsign").find(":hidden[name*=elem_physicianId]").val();}else if($('#'+v1+'').parents("div.divsign").find("select[name*=elem_physicianId]").length>0){var proid=$('#'+v1+'').parents("div.divsign").find("select[name*=elem_physicianId]").val();}
if($.isNumeric(proid)){$.get("saveCharts.php",{"elem_saveForm":"DelSignature","proid":proid,"fid":fid},function(data){if(data==0){$('#'+v1+'').parents("div.divsign").remove();}else{window.status="Error: "+data;}});}else{$('#'+v1+'').parents("div.divsign").remove();}
return;}}}}}
function setPrPh(o)
{if(o.checked==true){$("#phth_pros").val(""+o.value);$("#elem_curset_phth_pros").val("1");$("#p3s input[name!='"+o.name+"']").attr("checked",false).each(function(){utElem_capture(this);});$("#is_od_os").css("visibility","visible");}else{$("#is_od_os").val("").css("visibility","hidden");$("#phth_pros").val("");$("#elem_curset_phth_pros").val("0");}
loadExamsSummaryAll();}
function setPhPrEye(o)
{var prph=$("#phth_pros").val();if(prph==""||o.value==""){$("#elem_curset_phth_pros").val("0");}else{$("#elem_curset_phth_pros").val("1");}
loadExamsSummaryAll();}
function loadExamsSummary(enm){if(enm=="")return;var url="onload_wv.php";var params={};params.elem_action="GetExamSummary";params.enm=enm;var oe_issue=$("#phth_pros").val();var oe_eye=$("#is_od_os").val();var oe_curr=$("#elem_curset_phth_pros").val();if(oe_issue!=""&&oe_eye!=""){params.oe=""+oe_issue+"~!~"+oe_eye+"~!~"+oe_curr;}
if(enm=="sle"||enm=="fundus_exam"){params.artemp=arrTempProc_js;}
setProcessImg(1,"summarysheet");$.get(url,params,function(data){setProcessImg(0,"summarysheet");if(data[enm]!=""&&enm!="drawingpane"){$("#"+enm).html(data[enm]);}else if(enm=="vf_oct_gl"){$("#"+enm).html(data[enm]);}
if(enm!="dv_cpctrl"&&enm!="dv_stereopsis"&&enm!="dv_w4dot"){setExamsLoaded(enm);}
if(data["drawingpane"]!=""){if($.trim(data["drawingpane"])=="No Drawing exits."){data["drawingpane"]="";}
$("#drawingpane").html(data["drawingpane"]);}
if(data["imp_ex_done"]!=""){$("#imp_ex_done").html(data["imp_ex_done"]);}},"json");}
function loadExamsSummaryAll(){$('#summarysheet>div').each(function(indx){var eid=$(this).prop("id");if(typeof(eid)!="undefined"&&eid!=""){if(eid!="sec_wv_sum"&&eid.indexOf("div_wnlOpts")==-1){if($(this).html()!=""){loadExamsSummary(eid);}}}});}
function setExamsLoaded(enm){setFindingsLinks();}
function setFindingsLinks(){if(elem_per_vo=="1"||(finalize_flag==1&&isReviewable==0)){return;}
$("#summarysheet b.finding").each(function(){var ea=$(this).data("ev_atch");if(typeof(ea)=="undefined"){$(this).data("ev_atch",1);$(this).bind("click",function(){var cs=$(this).data("sen");var cfind=$(this).html();if(cfind=="Comments:"){cfind=cfind+cs;}
var cfind_f=$(this).data("symp-full");if(typeof(cfind_f)!="undefined"&&cfind_f!=""){cfind=cfind_f;}
if(typeof(cfind)!="undefined"&&cfind!=""){checkSympTyped(this,cfind,'',cs);}});}});}
var checkSympTyped_qry="";function checkSympTyped(ob,symp,fromas,exm){var searchVal=symp;var searchVal=searchVal.split(";");searchVal=$.trim(searchVal[0]);searchVal=encodeURI(searchVal);var oid=(typeof(ob.id)!="undefined"&&ob.id!="")?ob.id:"summarysheet";var ct=""+$("#elem_ptTemplate").val();ct=encodeURI(ct);if(typeof(fromas)=="undefined"){fromas="";}
if(typeof(exm)=="undefined"){exm="";}
var vicd10=$("#hid_icd10").val();if(typeof(vicd10)=="undefined"){if(window.opener&&window.opener.top.fmain){vicd10=window.opener.top.fmain.$("#hid_icd10").val();}}
var url="requestHandler.php";var params="elem_formAction=SmartChartDetail&symp="+searchVal+"&mode=NoAP&ctemp="+ct+"&fromas="+fromas+"&icd10="+vicd10+"&sen="+exm;if(checkSympTyped_qry!=params){checkSympTyped_qry=params;}else if($("#div_sc_con_detail").length>0){return;}
$("#div_sc_con_detail").modal('hide');$("#div_sc_con_detail, .modal-backdrop").remove();if(typeof(setProcessImg)!='undefined')setProcessImg("1",""+oid);$.get(url,params,function(data){if(typeof(setProcessImg)!='undefined')setProcessImg("0",""+oid);if(data!=""){$("#div_sc_con_detail").modal('hide');$("#div_sc_con_detail, .modal-backdrop").remove();$("body").append(data);$("#div_sc_con_detail").modal({backdrop:false});$("#div_sc_con_detail").modal('show');$(".dacry input[type=text], .lacsci input[type=text], .ctmri input[type=text]").datepicker({dateFormat:"mm-dd-yy",showOn:"button"});utElem_setBgColor("div_sc_con_detail");$("#div_sc_con_detail textarea, #div_sc_con_detail input[type=text]").bind("focus",function(){if(!$(this).hasClass("ui-autocomplete-input")){cn_ta1_no_assess(this,'');};});newET_setGray_v3();}});}
function clearAssessRow(id){var a=["elem_assessment_dxcode","elem_assessment","elem_plan","elem_apOu","elem_apOd","elem_apOs","no_change_","elem_resolve"];var rx=rgp(a.join("|"));var asdxid=id.replace(rx,"");for(var x in a){var t="#"+a[x]+asdxid;if($(t).is(":checkbox")){$(t).prop("checked",false);if(t.indexOf("no_change_")!=-1||t.indexOf("elem_resolve")!=-1){$(t).triggerHandler("click");}}else{$(t).val("");}}}
function chkSelection(s,obj){if(obj.tagName=="SMALL"){var lna=$("#assessplan :checkbox[name='elem_apnc[]']").length-1;var lnb=$("#assessplan :checked[name='elem_apnc[]']").length;$("#assessplan :checkbox[name='elem_apnc[]']").each(function(){if(lnb>=lna){if(this.checked){$(this).prop("checked",false).triggerHandler("click");}}else{if(!this.checked){$(this).prop("checked",true).triggerHandler("click");}}});return;}
if(obj.id.indexOf("no_change_")!=-1){if(obj.checked==true){gebi("elem_resolve"+s).checked=false;}}else if(obj.id.indexOf("elem_resolve")!=-1){if(obj.checked==true){var o=gebi("no_change_"+s);if(o){o.checked=false;}}}
setAPClr(s,obj);}
function setAPClr(w,o){var w1=w-1;var clr="";if($("#no_change_"+w+":checked").length>0){clr="apClr";}else if($("#elem_resolve"+w+":checked").length>0){clr="apClrRes";}
$("#assessplan .planbox:eq("+w1+") textarea").removeClass("apClr apClrRes");if(clr!=""){$("#assessplan .planbox:eq("+w1+") textarea").addClass(clr);}
restorePlan_2(w,o);}
function restorePlan_2(val,obj){if(finalize_flag==1&&isReviewable==0)return;if(obj.checked==true){var oAssess=gebi("elem_assessment"+val);var targetPlan,cfPlan=null;targetPlan=$("#assessplan .planbox:eq("+(val-1)+" textarea)");cfPlan=targetPlan.attr("data-elem_CFPlan");if(typeof(cfPlan)!="undefined"&&(($.trim(oAssess.value)!="")&&($.trim(targetPlan.val())==""))){targetPlan.val(cfPlan);}}}
function ap_rowAdj(mf,m2){if(((typeof mf!="undefined")&&(mf!=0))&&((typeof m2!="undefined")&&(m2!=0))&&(mf!=m2)){var arr=["elem_assessment","elem_plan","elem_resolve","no_change_","elem_apOu","elem_apOd","elem_apOs","elem_assessment_dxcode","elem_problist_id_assess","el_pt_ap_id","el_amst_site"];for(var x in arr){var elm=arr[x];var t2,t,cft="";if($("#"+elm+m2).attr("type")=="checkbox"){t=$("#"+elm+m2).is(":checked");t2=$("#"+elm+mf).is(":checked");if(typeof(t2)=="undefined"){t2=false;}
$("#"+elm+m2).prop("checked",t2).each(function(){if(elm=="no_change_"||elm=="elem_resolve"){setAPClr(m2,this);}});}else{t=$("#"+elm+m2).val();if(typeof(t)=="undefined"){t="";}
$("#"+elm+m2).val(""+$("#"+elm+mf).val()).triggerHandler("keyup");if(elm=="elem_plan"){cft=$("#"+elm+m2).attr("data-elem_CFPlan");$("#"+elm+m2).attr("data-elem_CFPlan",$("#"+elm+mf).attr("data-elem_CFPlan"));}else if(elm=="el_amst_site"){cft=$("#"+elm+m2).parent().hasClass("hidden");if($("#"+elm+mf).parent().hasClass("hidden")){$("#"+elm+m2).parent().addClass("hidden");$("#elem_assessment"+m2).parent().removeClass("col-sm-11").addClass("col-sm-12");}else{$("#"+elm+m2).parent().removeClass("hidden");$("#elem_assessment"+m2).parent().removeClass("col-sm-12").addClass("col-sm-11");}}else if(elm=="elem_assessment_dxcode"){cft=$("#"+elm+m2).attr("data-dxid");$("#"+elm+m2).attr("data-dxid",$("#"+elm+mf).attr("data-dxid"));}}
if(mf<m2){for(var i=m2-1;i>=mf;i--){if($("#"+elm+i).parents(".planbox").css("display")=="none"){continue;}
var cft1="";if($("#"+elm+i).attr("type")=="checkbox"){var t1=$("#"+elm+i).is(":checked");if(typeof(t)=="undefined"){t=false;}
$("#"+elm+i).prop("checked",t).each(function(){if(elm=="no_change_"||elm=="elem_resolve"){setAPClr(i,this);}});}else{var t1=$("#"+elm+i).val();if(typeof(t1)=="undefined"){t1="";}
$("#"+elm+i).val(""+t).triggerHandler("keyup");if(elm=="elem_plan"){cft1=$("#"+elm+i).attr("data-elem_CFPlan");$("#"+elm+i).attr("data-elem_CFPlan",cft);}else if(elm=="el_amst_site"){cft1=$("#"+elm+i).parent().hasClass("hidden");if(cft){$("#"+elm+i).parent().addClass("hidden");$("#elem_assessment"+i).parent().removeClass("col-sm-11").addClass("col-sm-12");}else{$("#"+elm+i).parent().removeClass("hidden");$("#elem_assessment"+i).parent().removeClass("col-sm-12").addClass("col-sm-11");}}else if(elm=="elem_assessment_dxcode"){cft1=$("#"+elm+i).attr("data-dxid");$("#"+elm+i).attr("data-dxid",cft);}}
t=t1;cft=cft1;}}else if(mf>m2){for(var i=m2+1;i<=mf;i++){if($("#"+elm+i).parents(".planbox").css("display")=="none"){continue;}
if($("#"+elm+i).attr("type")=="checkbox"){var t1=$("#"+elm+i).is(":checked");if(typeof(t)=="undefined"){t=false;}
$("#"+elm+i).prop("checked",t).each(function(){if(elm=="no_change_"||elm=="elem_resolve"){setAPClr(i,this);}});}else{var t1=$("#"+elm+i).val();if(typeof(t1)=="undefined"){t1="";}
$("#"+elm+i).val(""+t).triggerHandler("keyup");if(elm=="elem_plan"){cft1=$("#"+elm+i).attr("data-elem_CFPlan");$("#"+elm+i).attr("data-elem_CFPlan",cft);}else if(elm=="el_amst_site"){cft1=$("#"+elm+i).parent().hasClass("hidden");if(cft){$("#"+elm+i).parent().addClass("hidden");$("#elem_assessment"+i).parent().removeClass("col-sm-11").addClass("col-sm-12");}else{$("#"+elm+i).parent().removeClass("hidden");$("#elem_assessment"+i).parent().removeClass("col-sm-12").addClass("col-sm-11");}}else if(elm=="elem_assessment_dxcode"){cft1=$("#"+elm+i).attr("data-dxid");$("#"+elm+i).attr("data-dxid",cft);}}
t=t1;cft=cft1;}}}}}
var st_ap_adjt=ed_ap_adjt=0;function ap_adjt(num,obj){var tmp_u_t=(user_type=="1"||(ssFollowPhy!=""&&ssFollowPhy!="0"))?"1":"0";if((elem_per_vo=="1")||((finalize_flag=="1")&&(isReviewable!="1"))||(tmp_u_t!="1")){return;}
if(st_ap_adjt==0){st_ap_adjt=num;obj.style.color="red";return;}else{ed_ap_adjt=num;}
if((st_ap_adjt!=0)&&(ed_ap_adjt!=0)){$("#assessplan .ap_num").css("color","white");ap_rowAdj(st_ap_adjt,ed_ap_adjt);isFormChanged=1;st_ap_adjt=ed_ap_adjt=0;}}
function showICD10CodeModifier(obj){if($.trim(obj.value)==""){return;}
var icd10=$("#hid_icd10").val();if(icd10!=1){return false;}
if(isDiabetesAssess(obj.value)){if(typeof(obj.onchange)=="function"){obj.onchange();}
if(typeof(obj.onblur)=="function"){obj.onblur();}
return;}
var dxid=obj.id.replace("elem_assessment","elem_assessment_dxcode");if(""+$("#"+dxid).val().length<=0){return;}
$("#"+dxid).data("checkfullcode",1);$("#"+dxid).autocomplete("search");}
function isDiabetesAssess(str,fstp){str=$.trim(str);if(fstp=="2"){var ar_str=str.split(";");if(ar_str.length>0){str=$.trim(ar_str[0]);}}
var ret=str.match(/^((diabetes|diabetes\s+mellitus|dm)\s+type\s+[1|2])/gi);str=str.toLowerCase();if(str=="diabetes 1"||str=="diabetes 2"||str=="dm 1"||str=="dm 2"||str=="diabetes type 1 no retinopathy"||str=="diabetes type 2 no retinopathy"){ret=str;}return ret;}
var arrScrlHgt_setTaPlanHgt=[];function setTaPlanHgt(num,obj){if(!isiPad&&navigator.userAgent.indexOf("Safari")>-1&&navigator.userAgent.indexOf("Chrome")==-1){return;}
var num2=""+num;if(num=="elem_consult_reason"||num=="commentsForPatient"||num=="elem_notes"||num=="elem_transition_reason"||num=="elem_transition_notes"||num2.indexOf("elem_visMrDesc")!=-1||num2.indexOf("elem_visPcDesc")!=-1){var x=$("#"+num)[0].scrollHeight;var y=(typeof(x)!="undefined"&&x>20)?x:20;$("#"+num).attr("style","height: "+y+"px !important");return;}
if((num==0)&&(typeof obj!="undefined")){num=obj.id.replace("elem_plan","");}
var objAsses=gebi("elem_assessment"+num);var objAssesDxCode=gebi("elem_assessment_dxcode"+num);var objPlan=gebi("elem_plan"+num);var tdA=gebi("td_assessment"+num);var tdP=gebi("td_plan"+num);if(typeof(arrScrlHgt_setTaPlanHgt[num])=="undefined"){arrScrlHgt_setTaPlanHgt[num]=[];}
if(objAsses){var tmp1=(typeof(arrScrlHgt_setTaPlanHgt[num][0])!="undefined"&&arrScrlHgt_setTaPlanHgt[num][0]>18)?arrScrlHgt_setTaPlanHgt[num][0]:18;var tmp=(typeof(objAsses.scrollHeight)!="undefined"&&objAsses.scrollHeight>18)?(objAsses.scrollHeight):tmp1;if(tmp){if(tmp1<tmp&&tmp-tmp1>=8)
{objAsses.style.maxHeight=objAsses.style.minHeight=objAsses.style.height=tmp+"px";arrScrlHgt_setTaPlanHgt[num][0]=tmp1=tmp;$(objAsses).prop("style","height: "+tmp+"px !important");}}}
if(objAssesDxCode){objAssesDxCode.value=$.trim(""+objAssesDxCode.value.replace(/\s*/g,""));objAssesDxCode.value=""+objAssesDxCode.value.replace(",",", ");var tmp1=(typeof(arrScrlHgt_setTaPlanHgt[num][1])!="undefined"&&arrScrlHgt_setTaPlanHgt[num][1]>18)?arrScrlHgt_setTaPlanHgt[num][1]:18;var tmp=(typeof(objAssesDxCode.scrollHeight)!="undefined"&&objAssesDxCode.scrollHeight>18)?(objAssesDxCode.scrollHeight):tmp1;if(tmp){if(tmp1<tmp&&tmp-tmp1>=8)
{objAssesDxCode.style.maxHeight=objAssesDxCode.style.minHeight=objAssesDxCode.style.height=tmp+"px";arrScrlHgt_setTaPlanHgt[num][1]=tmp;$(objAssesDxCode).prop("style","height: "+tmp+"px !important");}}}
if(objPlan){var tmp1=(typeof(arrScrlHgt_setTaPlanHgt[num][2])!="undefined"&&arrScrlHgt_setTaPlanHgt[num][2]>18)?arrScrlHgt_setTaPlanHgt[num][2]:18;var tmp=(typeof(objPlan.scrollHeight)!="undefined"&&objPlan.scrollHeight>18)?(objPlan.scrollHeight):tmp1;if(tmp){if(tmp1<tmp&&tmp-tmp1>=8)
{objPlan.style.maxHeight=objPlan.style.minHeight=objPlan.style.height=tmp+"px";arrScrlHgt_setTaPlanHgt[num][2]=parseInt(tmp);$(objPlan).prop("style","height: "+tmp+"px !important");}}}
if(tdA&&tdP){tdA.style.height=(tmp1+5)+"px";tdP.style.height=(tmp1+5)+"px";}}
var strCalledMAses="";function checkConsolePlan(obj,num,flgDx){var str=$.trim(obj.value);if($("#hid_icd10").val()=="1"){if(isDiabetesAssess(str,2)){if($("#no_change_"+num).prop("checked")==false){z_flg_diab_sb="2";sb_checkDiabetes();return;}}else if(str.match(/esotropia/gi)||str.match(/esotropia>>/gi)||str.match(/exotropia/gi)||str.match(/exotropia>>/gi)||str.match(/congenital/gi)||str.match(/congenital>>/gi)){icd10_charts_popup(1,'',str,obj.id);return;}}
var strdx=$("#elem_assessment_dxcode"+num).val();var flagAs=isAssessAlreadyAdded(str,num,strdx);if(flagAs.Flag){top.fAlert('Assessment already exists.');obj.value="";$("#elem_assessment_dxcode"+num).val("");$("#elem_apOu"+num).prop("checked",false);$("#elem_apOd"+num).prop("checked",false);$("#elem_apOs"+num).prop("checked",false);return;}
if((flgDx!=1)&&isDxCorrectCode(str)){check4DxDesc(obj,num);}else{var str=str.split(";");str=$.trim(str[0]);var symp=as=pln="";var oPlan=gebi("elem_plan"+num);var addstr=num+":"+str+",";var url="requestHandler.php";var params="elem_formAction=GetAPDataofAsmt";params+="&srch="+str;$.get(url,params,function(data){var chk_as=""+data[0];var chk_plan=$.trim(""+data[1]);var chk_symp=$.trim(""+data[2]);if(chk_as=="false"&&chk_plan=="false"&&chk_symp=="false"){return;}
var obj2=isApPlansMulti(chk_plan,1);var lenk=obj2.lenk;if(typeof(cn_rem_escp_char)!="undefined"){chk_plan=cn_rem_escp_char(chk_plan);}
if((strCalledMAses.indexOf(addstr)==-1)&&(lenk==false)){var strPlan=$.trim(oPlan.value);if(strPlan!=""){if(strPlan.indexOf(chk_plan)==-1){strPlan=strPlan+"; "+chk_plan;}}else{strPlan=""+chk_plan;}
oPlan.value=strPlan;}else{strCalledMAses+=addstr;}
setApPolFU(chk_symp,chk_as,chk_plan);if(chk_symp!=""){checkSympTyped(obj,chk_symp,1);}},"json");}}
function setCursorAtEnd(){var obj=arguments[0];var st2=arguments[1];var e=window.event;if(e&&(typeof arguments[1]=="undefined")){obj=e.srcElement;}
if(obj){var st=st2||0;if(st==0){if(obj.value.indexOf("20/")!=-1){st=3;}
if(obj.name.indexOf("_dxcode")!=-1&&$.trim(obj.value)!=""){st=obj.value.length;}}
if(obj.setSelectionRange){obj.setSelectionRange(st,st);}else if(obj.createTextRange)
{var FieldRange=obj.createTextRange();FieldRange.moveStart('character',st);FieldRange.select();}}}
function restorePlan_all(){if(finalize_flag==1&&isReviewable==0)return;if($("#divPPlans").length<=0){showPrevPlan();return;}
$("#divPPlans table tr").each(function(){var indx=$(this).find("td:nth-child(1)").html();if(typeof(indx)!="undefined"&&indx!=""){indx=indx.replace(/\./,"");indx=$.trim(indx);}
if(typeof(indx)!="undefined"&&indx!=""){var td=gebi("elem_plan"+indx);if(td){var t=$.trim(td.value);t=t.replace(/[\n\r\u00AD]/g,'');var pln=$(this).find("td:nth-child(2)").text();pln=$.trim(pln);if(typeof(pln)!="undefined"&&pln!=""&&t==""){td.value=pln;if(typeof(td.onkeyup)=="function"){td.onkeyup();}}}}});$('#divPPlans').hide();}
function remPrevPlan(i){if(typeof(i)!="undefined"){var td2=gebi("tdprevplan"+i);if(td2){td2.innerHTML="";}}
showPrevPlan();stopClickBubble();}
var showPrevPlan_flg;function showPrevPlan(flg){if(typeof(flg)!="undefined"){if(flg==1){showPrevPlan_flg=setTimeout(function(){showPrevPlan();},700);}
else if(flg==2){clearTimeout(showPrevPlan_flg);}
return;}
if($("#divPPlans").length>0){$('#divPPlans').show();return;}
var i=1;var str="";while(true){var td=gebi("elem_plan"+i);if(!td||i>50)break;var cfPlan=td.getAttribute("data-elem_CFPlan");var cfPlan_rem=td.getAttribute("data-elem_CFPlan_rem");if(typeof(cfPlan_rem)=="string"&&cfPlan_rem=="1"){cfPlan="";}
if(cfPlan!=null&&cfPlan!=""&&typeof(cfPlan)!="undefined"){str+="<tr valign=\"top\"><td>"+i+".</td><td id=\"tdprevplan"+i+"\" >"+cfPlan+"</td><td align=\"center\"  title=\"Remove\" onclick=\"remPrevPlan('"+i+"')\"><span class=\"glyphicon glyphicon-remove\"></span></td></tr>";}
i++;}
if(str!=""){str="<table border=\"0\" class=\"table table-bordered table-hover table-striped\">"+str+"</table>";}else{str="<span>No Previous Plan</span>";}
str="<div class=\"header\">"+"<span id=\"spn_dd_dos\" class=\"pull-left primary form-inline\" ><label for=\"sl_prv_dd_dos\">DOS:</label><select id=\"sl_prv_dd_dos\" class=\"form-control\" onchange=\"load_visit_plans(this)\"><option value=\"\"> -Select- </option></select></span>"+"<span class=\"glyphicon glyphicon-remove\" onclick=\"$('#divPPlans').remove();\"></span></div>"+str;$("#divPPlans").remove();var oP=$("#linkPrevPlan").position();var tmp=parseInt(oP.top)+25;$("#assessplan").append("<div id='divPPlans'>"+str+"</div>");$("#assessplan #divPPlans").css('top',tmp+'px');$("#divPPlans").draggable({handle:"div"});$.get(zPath+"/chart_notes/requestHandler.php?elem_formAction=load_dd_dos",function(d){if(d){$.each(d,function(k,itm){var sl=(k==0)?"selected":"";$("#sl_prv_dd_dos").append($('<option '+sl+'></option>').val(itm[0]).html(itm[1]));});}},"json");}
function load_visit_plans(o){var i=$(o).val();if(i==""){return;}
if((elem_per_vo=="1")||((finalize_flag=="1")&&(isReviewable!="1"))){return;}
top.show_loading_image('show');$.get(zPath+"/chart_notes/requestHandler.php?elem_formAction=load_dos_plans&fid="+i,function(d){top.show_loading_image('hide');if(typeof(d)!="undefined"&&d!=""){$("#divPPlans .header").nextAll().remove();if(d=="No Previous Plan"){d="<span>"+d+"</span>";}
$(""+d).insertAfter("#divPPlans .header");}});}
function reset_assessment(fldid){if(fldid.indexOf("elem_assessment_dxcode")!=-1){var ass_dx_id=fldid;var ass_id=fldid.replace("elem_assessment_dxcode","elem_assessment");var ass_ou_id=fldid.replace("elem_assessment_dxcode","elem_apOu");var ass_od_id=fldid.replace("elem_assessment_dxcode","elem_apOd");var ass_os_id=fldid.replace("elem_assessment_dxcode","elem_apOs");var pop_ass_id=fldid.replace("elem_assessment_dxcode","pop_elem_assessment");var ass_plan_pt_id=fldid.replace("elem_assessment_dxcode","el_pt_ap_id");var ass_plan_id=fldid.replace("elem_assessment_dxcode","elem_plan");if($("#"+ass_plan_id).val()==""){$("#"+ass_plan_pt_id).val('');}
$("#"+ass_id).val('');$("#"+ass_ou_id).attr("checked",false);$("#"+ass_od_id).attr("checked",false);$("#"+ass_os_id).attr("checked",false);$("#elem_ass_comm").val('');$("#"+pop_ass_id).val('');$("#"+ass_dx_id).val('').removeData("dxid").attr("data-dxid","");}else if(fldid.indexOf("ap_elem_assessment")!=-1){var ass_id=fldid.replace("ap_elem_assessment","elem_assessment");var ass_dx_id=fldid.replace("ap_elem_assessment","elem_assessment_dxcode");var ass_ou_id=fldid.replace("ap_elem_assessment","elem_apOu");var ass_od_id=fldid.replace("ap_elem_assessment","elem_apOd");var ass_os_id=fldid.replace("ap_elem_assessment","elem_apOs");var pop_ass_id=fldid.replace("ap_elem_assessment","pop_elem_assessment");var ass_plan_id=fldid.replace("ap_elem_assessment","elem_plan");var ass_plan_pt_id=fldid.replace("ap_elem_assessment","el_pt_ap_id");$("#"+ass_id).val('');$("#"+ass_plan_id).val('');$("#"+ass_ou_id).attr("checked",false);$("#"+ass_od_id).attr("checked",false);$("#"+ass_os_id).attr("checked",false);$("#elem_ass_comm").val('');$("#"+pop_ass_id).val('');$("#"+ass_dx_id).val('').removeData("dxid").attr("data-dxid","");$("#"+ass_plan_pt_id).val('');$("#"+ass_id).parents(".planbox").hide();}else if(fldid.indexOf("elem_assessment")!=-1){var ass_id=fldid;var ass_dx_id=fldid.replace("elem_assessment","elem_assessment_dxcode");var ass_ou_id=fldid.replace("elem_assessment","elem_apOu");var ass_od_id=fldid.replace("elem_assessment","elem_apOd");var ass_os_id=fldid.replace("elem_assessment","elem_apOs");var pop_ass_id=fldid.replace("elem_assessment","pop_elem_assessment");var ass_plan_pt_id=fldid.replace("elem_assessment","el_pt_ap_id");var ass_plan_id=fldid.replace("elem_assessment","elem_plan");if($("#"+ass_plan_id).val()==""){$("#"+ass_plan_pt_id).val('');}
$("#"+ass_id).val('');$("#"+ass_ou_id).attr("checked",false);$("#"+ass_od_id).attr("checked",false);$("#"+ass_os_id).attr("checked",false);$("#elem_ass_comm").val('');$("#"+pop_ass_id).val('');$("#"+ass_dx_id).val('').removeData("dxid").attr("data-dxid","");}else if(fldid.indexOf("elem_dxCode")!=-1){$("#"+fldid).val('');$("#elem_ass_comm").val('');$("#"+fldid).removeData("dxid");renew_title($("#"+fldid)[0],"");}
$("#dialogLSS td.highlight").removeClass('highlight');$("#dialogLSS").dialog("close");}
function getForthAssess(flg)
{var objTbl=$("#assessplan .planbox");var lastRow=objTbl.length;var tmp=lastRow;var objAssess=gebi("elem_assessment"+tmp);var objAssessDx=gebi("elem_assessment_dxcode"+tmp);var objPlan=gebi("elem_plan"+tmp);if(((objAssess.value!="")||(objAssessDx.value!="")||(objPlan.value!=""))||(typeof(flg)!="undefined"&&flg=="1")){addAssessPlanRow("","","");}}
function makeAssessmentPure(assess){var retDx="";assess=$.trim(assess);if(assess!=""){var indx=assess.indexOf(";");if(indx!=-1){assess=assess.substring(0,indx);}
indx=-1;var chkEye="";indx=assess.lastIndexOf("-");if(indx!=-1){var ptrn="\\-\\s*(OD|OS|OU)\\s*";var reg=new RegExp(ptrn,"g");if(assess.match(reg)){chkEye=assess.match(new RegExp("(OD|OS|OU)","g"));assess=assess.replace(reg,"");}}
indx=-1;indx=assess.lastIndexOf("(");if(indx!=-1){var tmp=$.trim(assess.substring(indx));tmp=$.trim(tmp.replace(/[\\(\\)]/g,""));if(tmp.indexOf(",")!=-1){var arr=tmp.split(",");}else{var arr=new Array(tmp);}
var flag=true;var len=arr.length;for(var i=0;i<len;i++)
{if((typeof arr[i]!="undefined")){if(!isDxCorrectCode(arr[i])){flag=false;break;}}}
if(flag==true){assess=$.trim(assess.substring(0,indx));retDx=tmp;}}}
return{"assess":assess,"dx":retDx,"eye":chkEye};}
function isDxAlreadyAdded(dx,dxid){dx=$.trim(dx);dxid=$.trim(dxid);if(typeof(dx)=="undefined"||dx==""){return 1;}
var ret=0;var lastRow=$("#assessplan .planbox").length;for(var i=1;i<=lastRow;i++){var oDx=gebi("elem_assessment_dxcode"+i);if((oDx!=null)){var chk=$.trim(oDx.value);if(chk!=""){var chkid=$(oDx).data("dxid");if(typeof(chkid)=="undefined"){chkid="";}
var chk2=chk.substring(0,chk.length-1)+"-";var chk3=chk.substring(0,chk.length-2)+"--";var chk4=chk.substring(0,chk.length-3)+"-x-";if(chk==dx||chk.indexOf(dx)!=-1||dx==chk2||dx==chk3||dx==chk4){if(dxid!=""&&dxid!=chkid){}else{ret=1;break;}}}}}
return ret;}
function isAssessAlreadyAdded(assessment,asnum,asdx,asdxid){var curNum=(typeof asnum!="undefined"&&asnum!="")?asnum:null;var curDx=(typeof asdx!="undefined"&&asdx!="")?asdx:"";curDx=$.trim(curDx.replace(/\s/g,""));asdxid=(typeof asdxid!="undefined"&&asdxid!="")?$.trim(asdxid):"";var oAssessment=makeAssessmentPure(assessment);var assessment=oAssessment.assess;assessment=$.trim(assessment);var lastRow=$("#assessplan .planbox").length;var flag=false;var emptyIndx=0;var addedIndx=0;for(var i=1;i<=lastRow;i++){var oAssess=gebi("elem_assessment"+i);if((oAssess!=null)){var oDx=gebi("elem_assessment_dxcode"+i);if($.trim(oAssess.value)!=""){var otemp=makeAssessmentPure(oAssess.value);var temp=$.trim(otemp.assess);var tmpdx=oDx.value;tmpdx=$.trim(tmpdx.replace(/\s/g,""));var tmpdxid=$(oDx).data("dxid");if(typeof(tmpdxid)=="undefined"){tmpdxid="";}
tmpdxid=$.trim(tmpdxid);if((temp.toUpperCase()==assessment.toUpperCase())&&((curNum==null)||(curNum!=i))){var flg=(curNum!=null&&(curDx!=tmpdx||(tmpdxid!=asdxid)))?false:true;if(flg){flag=true;addedIndx=i;break;}}else{}}else{var oPlan=gebi("elem_plan"+i);if(emptyIndx==0&&$.trim(oPlan.value)==""&&$.trim(oDx.value)==""){emptyIndx=i;}}}}
return{"Flag":flag,"EmptyIndx":emptyIndx,"AddedIndx":addedIndx};}
function isDxCorrectCode(elemVal)
{if($.trim(elemVal)!="")
{var ptrn="^[0-9a-zA-Z]{3}((\\.[0-9a-zA-Z\\-]{1,4}))?$";var reg=new RegExp(ptrn,"g");if($.trim(elemVal).match(reg)==null||$.trim(elemVal).match(/[0-9]/)==null)
{return false;}}
return true;}
function isApPlansMulti(plan,flg){var ptrn="(^\\n|\\n$)";plan=regReplace(ptrn,"",plan);if(typeof(flg)!="undefined"&&flg==1){var arrPlans=plan.split("\\n");}else{var arrPlans=plan.split("\n");}
var lenk=arrPlans.length;return(lenk>1)?{"lenk":true,"arr":arrPlans}:{"lenk":false};}
function setApPolFU(symp,as,pln,a_n,idOdr,idOdrset,site,sig,fInsrtOrdr){if(typeof(symp)=="undefined")symp="";if(typeof(as)=="undefined")as="";if(typeof(pln)=="undefined")pln="";if(typeof(idOdr)=="undefined")idOdr="";if(typeof(idOdrset)=="undefined")idOdrset="";if(typeof(a_n)=="undefined")a_n="";if(typeof(site)=="undefined")site="";if(typeof(sig)=="undefined")sig="";if(typeof(fInsrtOrdr)=="undefined")fInsrtOrdr="";if(typeof(cn_rem_escp_char)!="undefined"){if(as!=""){as=""+as;as=cn_rem_escp_char(as);}
if(pln!=""){pln=""+pln;pln=cn_rem_escp_char(pln);}}
if(symp==""&&as==""&&pln=="")return;var url="requestHandler.php";var p={"elem_formAction":"setApPolFU","symp":symp,"as":as,"pln":pln,"idOdrset":idOdrset,"idOdr":idOdr,"a_n":a_n,"site":site,"sig":sig,"fInsrtOrdr":fInsrtOrdr};if(typeof(setProcessImg)!='undefined')setProcessImg("1","follow_up");$.post(url,p,function(data){if(typeof(setProcessImg)!='undefined')setProcessImg("0","follow_up");if(data){var a,b,c;for(var z in data){a=$.trim(data[z]['number']);b=$.trim(data[z]['time']);c=$.trim(data[z]['visit_type']);d=$.trim(data[z]['provider']);if(typeof(a)=="undefined"||a=="undefined"){a="";}
if(typeof(b)=="undefined"||b=="undefined"){b="";}
if(typeof(c)=="undefined"||c=="undefined"){c="";}
if(a!=""||b!=""||c!=""){fu_addOpts(""+a,""+b,""+c,""+d);}}}},"json");}
function addAssessPlanRow(assessment,plan,eye,dx,ordrids,afill){assessment=((typeof assessment!="undefined")&&($.trim(assessment)!=""))?""+assessment:"";plan=((typeof plan!="undefined")&&($.trim(plan)!=""))?""+plan+"":"";dx=((typeof dx!="undefined")&&($.trim(dx)!=""))?""+dx+"":"";var oAssessTbl=$("#assessplan");var lastRow=$("#assessplan .planbox").length;var currRowId=lastRow+1;lenAssess=currRowId;var tOu=tOd=tOs="";if(eye=="OU"){tOu=" checked=\"checked\" ";}else if(eye=="OD"){tOd=" checked=\"checked\" ";}else if(eye=="OS"){tOs=" checked=\"checked\" ";}
var str=""+"<div class=\"planbox\">"+" <div class=\"row planchoose ap_eye_removed\" >"+"  <div class=\"col-lg-3 col-md-3 col-sm-5 \">"+"   <ul>"+"   <li class=\"ouc\"><input name=\"elem_apOu[]\" id=\"elem_apOu"+currRowId+"\" type=\"checkbox\" value=\""+currRowId+"\" onclick=\"setApEye(this,0)\"  onfocus=\"setApEye(this,1)\"  /><label for=\"elem_apOu"+currRowId+"\"></label></li>"+"   <li class=\"odc\"><input name=\"elem_apOd[]\" id=\"elem_apOd"+currRowId+"\" type=\"checkbox\" value=\""+currRowId+"\" onclick=\"setApEye(this,0)\"  onfocus=\"setApEye(this,1)\"  /><label for=\"elem_apOd"+currRowId+"\"></label></li>"+"   <li class=\"osc\"><input name=\"elem_apOs[]\" id=\"elem_apOs"+currRowId+"\" type=\"checkbox\" value=\""+currRowId+"\" onclick=\"setApEye(this,0)\"  onfocus=\"setApEye(this,1)\"   /> <label for=\"elem_apOs"+currRowId+"\"></label></li>"+"   </ul>"+"  </div>"+" </div>"+" <div class=\"clearfix ap_eye_removed\"></div>"+" <div class=\"row planform\" >"+"  <div class=\"col-lg-1 col-md-1 col-sm-1 col-lg-1-sn col-md-1-sn col-sm-1-sn\" >"+"   <div class=\"planchoose\">"+"   <div class=\"counter ap_num\" onClick=\"ap_adjt("+currRowId+", this);\" >"+currRowId+"</div>"+"   </div>"+"  </div>"+"  <div class=\"col-lg-1 col-md-1 col-sm-1 col-lg-1-opt col-md-1-opt col-sm-1-opt\" > "+"   <div class=\"planchoose\">"+"   <ul class=\"ul_ne\"> "+"   <li class=\"ne\"><div class=\"checkboxO\"><input type=\"checkbox\" name=\"elem_apnc[]\" id=\"no_change_"+currRowId+"\" value=\""+currRowId+"\" onClick=\"chkSelection('"+currRowId+"', this);\"  /><label for=\"no_change_"+currRowId+"\">NE</label></div></li>   "+"   <li class=\"res\"><div class=\"checkboxO\"><input name=\"elem_apres[]\" id=\"elem_resolve"+currRowId+"\" type=\"checkbox\" value=\""+currRowId+"\" onClick=\"chkSelection('"+currRowId+"', this);\"  /><label for=\"elem_resolve"+currRowId+"\">RES</label></div></li> "+"   </ul>"+"   </div>"+"  </div>"+"  <div class=\"col-lg-4 col-md-4 col-sm-7 col-lg-4-as col-md-4-as col-sm-7-as \">"+"  <div class=\"row\">"+"  <div class=\"col-sm-12\">"+"  <textarea name=\"elem_assessment[]\" rows=\"3\" id=\"elem_assessment"+currRowId+"\" onkeyup=\"setTaPlanHgt("+currRowId+");\"  onchange=\"checkConsolePlan(this,'"+currRowId+"');getForthAssess();\" class=\"form-control  \" onclick=\"showICD10CodeModifier(this)\" tabindex=\"1\"   >"+assessment+"</textarea> "+"  </div>"+"  <div class=\"col-sm-1 hidden \">"+"  <select name=\"el_amst_site[]\" id=\"el_amst_site"+currRowId+"\" class=\"form-control \" onchange=\"setApEye(this,2)\"><option></option>"+"   <option value=\"OU\"  >OU</option>"+"   <option value=\"OD\"  >OD</option>"+"   <option value=\"OS\"  >OS</option>"+"  </select>"+"  </div>"+"  </div>"+"  </div>"+"  <div class=\"col-lg-1 col-md-1 col-sm-2 col-lg-1-dx col-md-1-dx col-sm-2-dx\">"+"  <textarea  class=\" form-control dx \" rows=\"3\"  onkeyup=\"setTaPlanHgt("+currRowId+");\" name=\"elem_assessment_dxcode[]\" id=\"elem_assessment_dxcode"+currRowId+"\" tabindex=\"5\" onblur=\"checkDXCodesChart(this);setTaPlanHgt("+currRowId+");getForthAssess();\" onfocus=\"setCursorAtEnd(this);\"    >"+dx+"</textarea> "+"  </div>"+"  <div class=\"col-lg-4 col-md-4 col-sm-12 col-lg-4-pl col-md-4-pl col-sm-12-pl\">"+"  <textarea  name=\"elem_plan[]\" rows=\"3\" id=\"elem_plan"+currRowId+"\" onkeyup=\"setTaPlanHgt("+currRowId+");\" onchange=\"setTaPlanHgt("+currRowId+");\"  data-elem_CFPlan=\"\" class=\"  form-control plantext\" tabindex=\"5\"   >"+plan+"</textarea>"+"  </div>"+"  <div class=\"col-lg-1 col-md-1 col-sm-1 col-lg-1-x col-md-1-x col-sm-1-x\"> "+"   <span class=\"glyphicon glyphicon-remove\" alt=\"Delete\" onclick=\"reset_assessment('ap_elem_assessment"+currRowId+"');\"></span>"+"  </div>"+" </div>"+"<input name=\"elem_apConMeds[]\" id=\"elem_apConMeds"+currRowId+"\" type=\"hidden\" value=\"\" /> "+"<input name=\"elem_problist_id_assess[]\" id=\"elem_problist_id_assess"+currRowId+"\" type=\"hidden\" value=\"\" /> "+"<input name=\"elem_assessment_typeAhead"+currRowId+"\" id=\"elem_assessment_typeAhead"+currRowId+"\"  type=\"hidden\" value=\"\" /> "+"<input name=\"el_pt_ap_id[]\" id=\"el_pt_ap_id"+currRowId+"\" type=\"hidden\" value=\"\" />"+"</div>"+"<div class=\"clearfix\"></div>";$(str).insertBefore("#assessplan .addbut");sb_addTypeAhead();cn_typeahead();if(typeof(ordrids)!="undefined"&&ordrids!=""){attachOrder2Chart(currRowId,ordrids);}
if(typeof(afill)!="undefined"&&afill==1&&dx!=""){fill_dx_ases(currRowId,dx);}}
function fill_dx_ases(currRowId,dx,dxid){var o=$("#elem_assessment"+currRowId);var c=o.val();if(dx==""||o.length<=0||(typeof(c)!="undefined"&&$.trim(c)!="")){return;}
$.get(zPath+"/chart_notes/requestHandler.php?elem_formAction=getDxAses&dx="+encodeURIComponent(dx)+"&dxid="+dxid,function(d){if(typeof(d)!="undefined"&&$.trim(d)!=""){$("#elem_assessment"+currRowId).val(d);}});}
function addAssessOption(assessment,plan,fRem,eye,fRemPlan,dx,ordrids,apnum,dxid){if(typeof(asmt_sep_multi_dx_code)=="undefined"){asmt_sep_multi_dx_code=0;}
if(asmt_sep_multi_dx_code==1&&typeof(dx)!="undefined"&&dx!=""&&(dx.indexOf(",")!=-1||dx.indexOf(";")!=-1)){if(dx.indexOf(",")!=-1){var ardx=dx.split(",");}else if(dx.indexOf(";")!=-1){var ardx=dx.split(";");}
if(ardx.length>1){var ardxId=(typeof(dxid)!="undefined"&&dxid!="")?dxid.split(","):[];for(var x=0;x<ardx.length;x++){dxid=(typeof ardxId[x]!="undefined"&&$.trim(ardxId[x])!="")?ardxId[x]:"";if(x==0){addAssessOptionExe(assessment,plan,fRem,eye,fRemPlan,ardx[x],ordrids,apnum,0,dxid);}
else{if($.trim(ardx[x])!=""){addAssessOptionExe("",plan,fRem,eye,fRemPlan,ardx[x],'',apnum,1,dxid);}}}}}else{addAssessOptionExe(assessment,plan,fRem,eye,fRemPlan,dx,ordrids,apnum,0,dxid);}}
function addAssessOptionExe(assessment,plan,fRem,eye,fRemPlan,dx,ordrids,apnum,afill,dxid){var flg_auto_fill=0;if(typeof(dx)!="undefined"&&$.trim(dx)!=""&&typeof(afill)!="undefined"&&afill==1){flg_auto_fill=1;if(isDxAlreadyAdded(dx,dxid)){return;}}
if(($.trim(assessment)=="undefined"||$.trim(assessment)==""||typeof(assessment)=="undefined")&&($.trim(plan)=="undefined"||$.trim(plan)==""||typeof(plan)=="undefined")&&(flg_auto_fill==0)){return;}
var ar=["Ou","Od","Os"];if(typeof apnum!='undefined'&&apnum!=''){var obj={"Flag":true,"AddedIndx":apnum};}
else{var obj=isAssessAlreadyAdded(assessment,'',dx,dxid);}
if(obj.Flag)
{var oAssess=gebi("elem_assessment"+obj.AddedIndx);var oPlan=gebi("elem_plan"+obj.AddedIndx);var oDx=gebi("elem_assessment_dxcode"+obj.AddedIndx);if((typeof fRem!="undefined")&&(fRem==true)){if(oAssess&&oPlan){oAssess.value="";oPlan.value="";oDx.value="";$(oDx).data("dxid","");$("#elem_apOu"+obj.AddedIndx).prop("checked",false);$("#elem_apOd"+obj.AddedIndx).prop("checked",false);$("#elem_apOs"+obj.AddedIndx).prop("checked",false);if(typeof oPlan.onkeyup=="function"){oPlan.onkeyup();}}}else{if(oAssess&&oPlan){var indx=assessment.indexOf(";");if(indx!=-1){var chk_as=oAssess.value;indx=parseInt(indx)+1;var as_com=assessment.substr(indx);var ar_as_com=as_com.split(",");var ar_lids_as=["Right Lower Lid","Left Upper Lid","Left Lower Lid","Right Upper Lid","Left Eye","Right Eye","Both Eyes"];var l=ar_lids_as.length;for(var x=0;x<l;x++){var t_ad=""+ar_lids_as[x];if(typeof(t_ad)!="undefined"&&t_ad!="undefined"&&t_ad!=""){if(as_com.indexOf(t_ad)!=-1){if(chk_as.indexOf(t_ad)==-1){if(chk_as.indexOf(";")==-1){chk_as=chk_as+"; ";}else{chk_as=chk_as+", ";}
chk_as=chk_as+t_ad;}}else{if(chk_as.indexOf(t_ad)!=-1){chk_as=chk_as.replace(t_ad+", ","");chk_as=chk_as.replace(t_ad,"");chk_as=$.trim(chk_as);}}}}
chk_as=chk_as.replace(";,",";");oAssess.value=chk_as;}
if((typeof plan!="undefined")&&($.trim(plan)!="")){if(typeof(fRemPlan)!="undefined"&&fRemPlan==1){if($.trim(oPlan.value)!=""){var plan_old=plan.replace("\u00AD","");var del_from_start=plan.indexOf("\u00AD")!=-1?1:0;if(""+oPlan.value.toLowerCase().indexOf(""+plan.toLowerCase()+"\n")!=-1){oPlan.value=oPlan.value.replace(""+plan+"\n","");}else if(""+oPlan.value.toLowerCase().indexOf(""+plan_old.toLowerCase()+"\n")!=-1){oPlan.value=oPlan.value.replace(""+plan_old+"\n","");}else if(""+oPlan.value.toLowerCase().indexOf(""+plan.toLowerCase())!=-1){oPlan.value=oPlan.value.replace(""+plan,"");}else if(""+oPlan.value.toLowerCase().indexOf(""+plan_old.toLowerCase()+"")!=-1){if(del_from_start==1){if(""+oPlan.value.toLowerCase().indexOf("\n"+plan.toLowerCase()+"")!=-1){oPlan.value=oPlan.value.replace(""+plan+"","");}else{var reg_pln=rgp("^"+plan_old+"\n",'i');var mtch=oPlan.value.toLowerCase().match(reg_pln);if(mtch){oPlan.value=oPlan.value.replace(reg_pln,"");}else{if(oPlan.value.toLowerCase()==plan_old.toLowerCase()){oPlan.value=oPlan.value.replace(plan_old,"");}}}}
else{oPlan.value=oPlan.value.replace(""+plan_old+"","");}}}}else{plan=plan.replace("\u00AD","");if(oPlan.value.indexOf(plan)==-1){if(typeof(oPlan.value)!="undefined"&&oPlan.value!=""){oPlan.value+="\n";}
oPlan.value+=""+plan+"\u00AD";}}}else{oPlan.value+="";}
oPlan.value=$.trim(oPlan.value);oPlan.value=oPlan.value.replace(/^\n+|\n+$|^\u00AD+|^\r+|\r+$/g,"");if(typeof dx!="undefined"&&$.trim(dx)!=""){oDx.value=""+dx;$(oDx).data("dxid",dxid);if(dx.indexOf("-")!=-1){$(oDx).addClass("mandatory");show_asmt_site($(oDx),dx);}else{$(oDx).triggerHandler("blur");}}
if(typeof oPlan.onkeyup=="function"){oPlan.onkeyup();}
if(typeof(ordrids)!="undefined"&&ordrids!=""){attachOrder2Chart(obj.AddedIndx,ordrids);}}}
var teye="";if(eye.indexOf("RLL")!=-1||eye.indexOf("RUL")!=-1){teye="OD";}
if(eye.indexOf("LLL")!=-1||eye.indexOf("LUL")!=-1){if(eye.indexOf("RLL")!=-1||eye.indexOf("RUL")!=-1){teye="OU";}
else{teye="OS";}}
if(teye!=""){eye=teye;}
for(var x in ar){if(eye=="def")continue;var oEye=gebi("elem_ap"+ar[x]+obj.AddedIndx);if(oEye){if(oAssess.value!=""&&ar[x].toUpperCase()==eye.toUpperCase()){oEye.checked=true;}else{oEye.checked=false;}}}
getForthAssess();return;}
if(obj.EmptyIndx!=0){var oAssess=gebi("elem_assessment"+obj.EmptyIndx);var oPlan=gebi("elem_plan"+obj.EmptyIndx);var oDx=gebi("elem_assessment_dxcode"+obj.EmptyIndx);if(oAssess&&oPlan){oAssess.value=assessment;oPlan.value=((typeof plan!="undefined")&&($.trim(plan)!=""))?plan+"":"";if(typeof oPlan.onkeyup=="function"){oPlan.onkeyup();}
var teye="";if(eye.indexOf("RLL")!=-1||eye.indexOf("RUL")!=-1){teye="OD";}
if(eye.indexOf("LLL")!=-1||eye.indexOf("LUL")!=-1){if(eye.indexOf("RLL")!=-1||eye.indexOf("RUL")!=-1){teye="OU";}
else{teye="OS";}}
if(teye!=""){eye=teye;}
for(var x in ar){var oEye=gebi("elem_ap"+ar[x]+obj.EmptyIndx);if(oEye){if(ar[x].toUpperCase()==eye.toUpperCase()){oEye.checked=true;}else{oEye.checked=false;}}}
if((typeof dx!="undefined")&&($.trim(dx)!="")){dx=dx+"";dxid=((typeof dxid!="undefined")&&($.trim(dxid)!=""))?dxid:"";}else{dx="";dxid="";}
oDx.value=dx;$(oDx).data("dxid",dxid);if(typeof oDx.onblur=="function"){if(dx.indexOf("-")!=-1){$(oDx).addClass("mandatory");show_asmt_site($(oDx),dx);}else{$(oDx).triggerHandler("blur");}}
if(typeof(ordrids)!="undefined"&&ordrids!=""){attachOrder2Chart(obj.EmptyIndx,ordrids);}
if(typeof(afill)!="undefined"&&afill==1&&dx!=""){fill_dx_ases(obj.EmptyIndx,dx,dxid);}
$(oAssess).parents(".planbox").show();}}else{addAssessPlanRow(assessment,plan,eye,dx,ordrids,afill);}
getForthAssess();}
function showMultiAp_exe(val,num){if(!num){return;}
var oDiv=document.getElementById("div_plan_ap_show_2");if(oDiv){if(val==1){var oIfrm=top.fmain;var flagNum=false;var strAPExist="";var oAps=document.getElementsByName("elem_apAs[]");var lenAps=(oAps!=null)?oAps.length:0;for(var i=0;i<lenAps;i++){if(oAps[i].checked==true){var strAssess=""+oAps[i].value;var strPlan="";var oPlans=document.getElementsByName("elem_apPlan_"+i+"[]");var lenPlans=(oPlans!=null)?oPlans.length:0;for(var j=0;j<lenPlans;j++){if(oPlans[j].checked){strPlan+=(strPlan!="")?"\n":"";strPlan+=""+oPlans[j].value;}}
var oChkAses=isAssessAlreadyAdded(strAssess);if(oChkAses.Flag==false){if(flagNum==false){flagNum=true;var oTmpAsses=oIfrm.document.getElementById("elem_assessment"+num);var oTmpPlan=oIfrm.document.getElementById("elem_plan"+num);if(oTmpAsses){oTmpAsses.value=""+strAssess;}
if(oTmpPlan){oTmpPlan.value=""+strPlan;if(typeof oTmpPlan.onchange=="function"){oTmpPlan.onchange();}
if(typeof oTmpPlan.onkeyup=="function"){oTmpPlan.onkeyup();}}}else{oIfrm.addAssessOption(strAssess,strPlan);}}else{strAPExist+="<br/>  -"+strAssess+"";}}}
if(strAPExist!=""){top.fAlert("Following assessments are already exits:--<br/>"+strAPExist);}
var orderSetObj=document.getElementsByName("elem_order_set[]");var order_set_val_arr=Array();for(o=0,oi=0;o<orderSetObj.length;o++){if(orderSetObj[o].checked==true){var order_set_id=orderSetObj[o].value;var orderString=order_set_id;var ordersObj=document.getElementsByName("elem_orders["+order_set_id+"][]");var order_id_arr=Array();for(or=0;or<ordersObj.length;or++){if(ordersObj[or].checked==true){order_id_arr[or]=ordersObj[or].value;}
else{order_id_arr[or]='';}}
var order_id_str=order_id_arr.join(', ');if(order_id_str!=''){orderString+='__'+order_id_str;}
var orders_options_obj=document.getElementsByName("elem_orders_options["+order_set_id+"][]");var orders_options_arr=Array();for(or=0;or<orders_options_obj.length;or++){if(orders_options_obj[or].checked==true){orders_options_arr[or]=orders_options_obj[or].value;}
else{orders_options_arr[or]='';}}
var orders_options_str=orders_options_arr.join(', ');if(orders_options_arr!=''){orderString+='__'+orders_options_arr;}
order_set_val_arr[oi]=orderString;oi++;}}
var order_set_val_str=order_set_val_arr.join('---');}
oDiv.style.display="none";}}
function showMultiAp(str,num){$("#div_plan_ap_show_2").remove();var str1="<div id=\"div_plan_ap_show_2\">"+"<div>"+str+"</div>"+"<input type=\"button\" class=\"dff_button\" id=\"btnSMP_ok\" onClick=\"showMultiAp_exe('1',"+num+")\" value=\"OK\"/> "+"<input type=\"button\" class=\"dff_button\" id=\"btnSMP_close\" onClick=\"showMultiAp_exe('0',"+num+")\" value=\"Close\"/>"+"</div>";$("body").append(""+str1);$("#div_plan_ap_show_2").show();}
function check4DxDesc(obj,num){var str="";if(obj&&(typeof obj.value!="undefined")){str=obj.value;}
if(str==""||num==""){return;}
var oElemPlan=gebi("elem_plan"+num);if(oElemPlan==null){return;}
var url=zPath+"/chart_notes/requestHandler.php";var params="elem_formAction=getDxAP";params+="&elem_dxCode="+str;if(typeof(setProcessImg)!='undefined')setProcessImg("1",""+obj.id);$.post(url,params,function(data){if(typeof(setProcessImg)!='undefined')setProcessImg("0",""+obj.id);var xmlDoc=data;var str="";var cPlans=0;var tmpAssess="";var tmpPlan="";var oAllAp=xmlDoc.getElementsByTagName("allap")[0];var oAps=(oAllAp!=null)?oAllAp.childNodes:null;var lenAps=(oAps!=null)?oAps.length:0;var chk=false;for(var i=0;i<lenAps;i++){var oData=oAps[i];if(oData.firstChild){if(oData.nodeName=="ap"){str+="<tr valign=\"top\" align=\"left\" >";var oApCn=oData.childNodes;var lenApcn=(oApCn!=null)?oApCn.length:0;for(var k=0;k<lenApcn;k++){var ofData=oApCn[k];if(ofData.firstChild){if(ofData.nodeName=="ases"){str+="<td colspan='2'><input type=\"checkbox\" name=\"elem_apAs[]\" value=\""+ofData.firstChild.data+"\">"+ofData.firstChild.data+"</td>";tmpAssess=""+ofData.firstChild.data;}else if(ofData.nodeName=="plans"){var strPlan="<table>";var oPlans=(ofData!=null)?ofData.childNodes:null;var lenPlans=(oPlans!=null)?oPlans.length:0;for(var j=0;j<lenPlans;j++){var oPlan=oPlans[j];if(oPlan.firstChild){strPlan+="<tr><td><input type=\"checkbox\" name=\"elem_apPlan_"+i+"[]\" value=\""+oPlan.firstChild.data+"\">"+oPlan.firstChild.data+"</td></tr>";tmpPlan=""+oPlan.firstChild.data;cPlans++;}}
strPlan+="</table>";str+="<td>"+strPlan+"</td>";}}}
str+="</tr>";}
if(oData.nodeName=="order_dx"){if(chk==false){chk=true;str+="<tr class=\"txt_10b\"><td colspan=\"3\">Order set associate with Assessment</td></tr>";str+="<tr class=\"txt_10b\">";str+="<td width='100'>Order set</td>";str+="<td width='100'>Orders</td>";str+="<td width='100'>Order set options</td>";str+="</tr>";}
str+="<tr valign=\"top\">";var oApCn=oData.childNodes;var lenApcn=(oApCn!=null)?oApCn.length:0;for(var k=0;k<lenApcn;k++){var ofData=oApCn[k];if(ofData.firstChild){if(ofData.nodeName=="order_set_id"){var order_set_id=ofData.firstChild.data;}
else if(ofData.nodeName=="order_set"){str+="<td width='100'><input type=\"checkbox\" name=\"elem_order_set[]\" value=\""+order_set_id+"\" checked=\"checked\">"+ofData.firstChild.data+"</td>";tmpAssess=""+ofData.firstChild.data;}
else if(ofData.nodeName=="order"){var strPlan="<table>";var oPlans=(ofData!=null)?ofData.childNodes:null;var lenPlans=(oPlans!=null)?oPlans.length:0;for(var j=0;j<lenPlans;j++){var oPlan=oPlans[j];if(oPlan.firstChild){if(oPlan.nodeName=="orders_id"){var order_id=oPlan.firstChild.data;}
else{strPlan+="<tr><td><input type=\"checkbox\" name=\"elem_orders["+order_set_id+"][]\" value=\""+order_id+"\" checked=\"checked\">"+oPlan.firstChild.data+"</td></tr>";tmpPlan=""+oPlan.firstChild.data;cPlans++;}}}
strPlan+="</table>";str+="<td width='100'>"+strPlan+"</td>";}
else if(ofData.nodeName=="set_options"){var strPlan="<table width='100'>";var oPlans=(ofData!=null)?ofData.childNodes:null;var lenPlans=(oPlans!=null)?oPlans.length:0;for(var j=0;j<lenPlans;j++){var oPlan=oPlans[j];if(oPlan.firstChild){if(oPlan.nodeName=="order_set_options"){strPlan+="<tr><td><input type=\"checkbox\" name=\"elem_orders_options["+order_set_id+"][]\" value=\""+oPlan.firstChild.data+"\" checked=\"checked\">"+oPlan.firstChild.data+"</td></tr>";cPlans++;}}}
strPlan+="</table>";str+="<td width='100'>"+strPlan+"</td>";}}}
str+="</tr>";}}}
if(tmpAssess!=""){if(cPlans>1){str="<table width=\"100%\" border=\"0\">"+"<tr><td colspan='2'><b>Assessment</b></td><td><b>Plan</b></td></tr>"+
str+"</table>";var ctop=top;if(top.fmain){ctop=top.fmain;}
ctop.showMultiAp(str,num);}else{obj.value=""+tmpAssess;oElemPlan.value=""+tmpPlan;}}},"xml");}
function setAssessOption_v2(indx,fRem){if(indx=="1"){if($(":checked[id*=el_chk_as_]").length>0){$(":checked[id*=el_chk_as_]").each(function(indx){var x=this.id;var y=x.replace(/el_chk_as_/,"el_chk_pl_");var as=""+this.value;var pln="";$(":checked[id*="+y+"]").each(function(indx2){pln+=""+this.value+"\n";});var z=x.replace(/el_chk_as_/,"el_td_dx_");var dx=$.trim(""+$("#"+z).html());var dxid=$("#"+z).data("dxid");var z1=x.replace(/el_chk_as_/,"el_chk_site_");var site=$.trim(""+$("#"+z1).val());site=site||"";var to_do_id=$(this).data("to_do_id");if(as!=""||pln!=""){addAssessOption(as,""+pln,fRem,site,"",dx,'','',dxid);if(typeof(to_do_id)!="undefined"&&to_do_id!=""){setApPolFU("to_do_id",to_do_id);}}});}else{top.fAlert("Please select any assessment!");return;}}
hide_modal("div_sel_assess_for_symp");}
var setAssessOption_c=0;function setAssessOption(symp,fRem,sEye,flgPop,cnslid){if(typeof(symp)=="undefined"){symp="";}
if(typeof(cnslid)=="undefined"){cnslid="";}
if((symp&&symp!="")||(cnslid&&cnslid!="")){var symp1=""+symp;var icd_code_10=(""+$("#hid_icd10").val()=="1")?"1":"0";var dos=$("#elem_dos").val();var url=zPath+"/chart_notes/requestHandler.php?elem_formAction=GetAssessOption&symp="+encodeURIComponent(symp)+"&icd_code_10="+icd_code_10+"&eye="+sEye+"&cnslid="+cnslid+"&dos="+dos;$.get(url,function(data){if(data&&data.length>0){if(data.length>1){var symp_var=symp.replace(/\W+/g,"");var str_sel_htm="";for(var ww in data){if(data[ww].assess||data[ww].plan){var tAssess="",tPlan="",tDx="",tDxId="",tpu="",tapsite="",tto_do_id="",tdxas="";tAssess=""+$.trim(data[ww].assess);tPlan=""+$.trim(data[ww].plan);obj2=isApPlansMulti(tPlan);tDx=""+$.trim(data[ww].dxcode);tDxId=""+$.trim(data[ww].dxId);tpu=data[ww].pu||"";tapsite=""+$.trim(data[ww].ap_site);if(tapsite==""){tapsite=""+sEye;}
tto_do_id=""+$.trim(data[ww].to_do_id);tdxas=$.trim(data[ww].asmt_com);if(typeof(tdxas)!="undefined"&&tdxas!=""){tAssess=tAssess+"; "+tdxas;}
if(tpu!=""){symp_var=symp_var+setAssessOption_c;setAssessOption_c++;if(obj2.lenk==true){tPlan="";for(var zx in obj2.arr){var t=$.trim(obj2.arr[zx]);if(t!=""){tPlan+="<input type=\"checkbox\" id=\"el_chk_pl_"+setAssessOption_c+"_"+zx+"\" value=\""+t+"\" ><label for=\"el_chk_pl_"+setAssessOption_c+"_"+zx+"\" >"+t+"</label><br/>";}}}else if(tPlan!=""){var t=tPlan;tPlan="";tPlan="<input type=\"checkbox\" id=\"el_chk_pl_"+setAssessOption_c+"_0\" value=\""+t+"\" ><label for=\"el_chk_pl_"+setAssessOption_c+"_0\" >"+t+"</label><br/>";}
str_sel_htm+="<tr valign=\"top\">"+"<td><input type=\"checkbox\" id=\"el_chk_as_"+setAssessOption_c+"\" value=\""+tAssess+"\" data-to_do_id=\""+tto_do_id+"\" >"+"<label for=\"el_chk_as_"+setAssessOption_c+"\">"+tAssess+"</label>"+"<input type=\"hidden\" id=\"el_chk_site_"+setAssessOption_c+"\" value=\""+tapsite+"\" ></td>"+"<td id=\"el_td_pl_"+setAssessOption_c+"\">"+tPlan+"</td>"+"<td id=\"el_td_dx_"+setAssessOption_c+"\" data-dxid=\""+tDxId+"\">"+tDx+"</td></tr>";}else{var obj2=isApPlansMulti(tPlan);if(obj2.lenk==true||flgPop>1){addAssessOption(tAssess,"",fRem,tapsite,"",tDx,'','',tDxId);}else{addAssessOption(tAssess,tPlan,fRem,tapsite,"",tDx,'','',tDxId);}
if(typeof(tto_do_id)!="undefined"){setApPolFU("to_do_id",tto_do_id);}}}}
if(str_sel_htm!=""){var ar_clr_symp=symp.split("!~!");var clr_symp=ar_clr_symp[0];str_sel_htm="<div>"+"<table class=\"table table-responsive table-striped\" ><tr><td>Assessment</td><td>Plan</td><td>Dx code</td>"+"</tr>"+str_sel_htm+"</table>"+"</div>";if($("#div_sel_assess_for_symp").length<=0){str_sel_htm=" <div id=\"div_sel_assess_for_symp\" class=\"modal fade\" role=\"dialog\">"+"<div class=\"modal-dialog\">"+"<div class=\"modal-content\">"+"<div class=\"modal-header\">"+"<button type=\"button\" class=\"close\" data-dismiss=\"modal\" onclick=\"setAssessOption_v2(0)\"></button>"+"<h4 class=\"modal-title\">Select assessments and plans for symptom: "+clr_symp+"</h4>"+"</div>"+"<div class=\"modal-body con frcb\">"+
str_sel_htm+"</div>"+"<div class=\"modal-footer text-center\">"+"<button type=\"button\" class=\"btn btn-success\"  name=\"el_dsafs_btn_done\" onclick=\"setAssessOption_v2(1,'"+fRem+"')\">Done</button>"+"<button type=\"button\" class=\"btn btn-danger\" data-dismiss=\"modal\" name=\"el_dsafs_btn_cancel\" onclick=\"setAssessOption_v2(0)\">Cancel</button>"+"</div>"+"</div>"+"</div>"+"</div>";$("body").append(str_sel_htm);$("#div_sel_assess_for_symp").draggable({handle:".modal-header"});$("#div_sel_assess_for_symp").modal({show:true,backdrop:false});}else{$("#div_sel_assess_for_symp .con").children("div").last().after(str_sel_htm);$("#div_sel_assess_for_symp").draggable({handle:".modal-header"});$("#div_sel_assess_for_symp").modal({show:true,backdrop:false});}
$("input[id*=el_chk_pl_]").bind("click",function(){$(this).parents("tr").find("input[id*=el_chk_as]").prop("checked",true);});}}else{if(data[0].assess||data[0].plan){var tAssess=$.trim(data[0].assess);var tPlan=$.trim(data[0].plan);var tDx=""+$.trim(data[0].dxcode);var tDxId=""+$.trim(data[0].dxId);tapsite=""+$.trim(data[0].ap_site);if(tapsite==""){tapsite=""+sEye;}
var tto_do_id=""+$.trim(data[0].to_do_id);var tdxas=$.trim(data[0].asmt_com);if(typeof(tdxas)!="undefined"&&tdxas!=""){if(tAssess.indexOf(";")==-1){tAssess=tAssess+"; ";}else{tAssess=tAssess+", ";}
tAssess=tAssess+""+tdxas;}
var obj2=isApPlansMulti(tPlan);if(obj2.lenk==true||flgPop>1){addAssessOption(tAssess,"",fRem,tapsite,"",tDx,'','',tDxId);}else{addAssessOption(tAssess,tPlan,fRem,tapsite,"",tDx,'','',tDxId);}
if(typeof(tto_do_id)!="undefined"){setApPolFU("to_do_id",tto_do_id);}}}}},"json");}}
function setApEye(o,focs){if(focs==2){var ind=$(o)[0].id.replace(/el_amst_site/,"");var v=$(o).val();$("#elem_apOu"+ind+", #elem_apOd"+ind+", #elem_apOs"+ind).prop("checked",false);if(v=="OU"){$("#elem_apOu"+ind).prop("checked",true);}else if(v=="OD"){$("#elem_apOd"+ind).prop("checked",true);}else if(v=="OS"){$("#elem_apOs"+ind).prop("checked",true);}}}
function setExamDescChange(obj,v2){if(v2==1){obj.className=obj.className.replace("bgSmoke","");}else{var oCIn=gebi(obj.name+"_changed");if(oCIn){oCIn.value="1";$(obj).unbind("change",setExamDescChange);if($(obj).val()!=""&&$(obj).parent().hasClass("bgWhite")==false){$(obj).parent().addClass("bgWhite");}}}}
function add_future_sch_tests_appoints(flg,eid,cnfrm){if(typeof(flg)!="undefined"&&flg!=""){if(flg==1){if(finalize_flag==1&&isReviewable!=1){top.fAlert("Please open a new chart note");return;}
var msg="";var test_check_flag=$.trim($(":checked[name=elem_fsta_test_appoint]").val());if($.trim(test_check_flag)==""){msg+="<li>Test or Appointment</li>";}
if(test_check_flag=="Test"){if($.trim($(":input[name=elem_fsta_test_name]").val())==""){msg+="<li>Test Name</li>";}
var tmp_testtype=$.trim($(":checked[name=elem_fsta_test_type]").val());if(tmp_testtype==""){msg+="<li>Test Type</li>";}}else if(test_check_flag=="Appointment"||test_check_flag=="Referral"){if($.trim($(":input[name=elem_fsta_phy_name]").val())==""){msg+="<li>Physician Name</li>";}}
if(msg!=""){top.fAlert("<b>Please fill in the following:</b><div class='m10'>"+msg+"</div>");return;}
var param=$("#frm_future_tests_extr").serialize();param+="&elem_dos="+$("#elem_dos").val();if(typeof(setProcessImg)!='undefined')setProcessImg(1,"frm_future_tests_extr");$.post("requestHandler.php",param,function(data){if(typeof(setProcessImg)!='undefined')setProcessImg(0,"frm_future_tests_extr");add_future_sch_tests_appoints_processing(data);});}else if(flg==3){if(finalize_flag==1&&isReviewable!=1){top.fAlert("Please open a new chart note");return;}
var divtype=(eid=="2")?"div_saved_future_appoint_ref":"div_saved_future_tests";var delid="";$("#"+divtype+" :checked[name*=elem_FSTA_delid]").each(function(){delid+=this.value+",";})
if(delid==""){top.fAlert("Please check any record to delete.");}else{if(typeof(cnfrm)=="undefined"){top.fancyConfirm("Are you sure you want to delete?","","top.fmain.add_future_sch_tests_appoints('"+flg+"', '"+eid+"',true);");return;}
var strEdit="&elem_delid="+encodeURI(delid);if(typeof(setProcessImg)!='undefined')setProcessImg(1,"ft_appnt");$.get("requestHandler.php?elem_formAction=add_future_sch_tests_appoints"+strEdit,function(data){if(typeof(setProcessImg)!='undefined')setProcessImg(0,"ft_appnt");add_future_sch_tests_appoints_processing(data);});}}else if(flg==0){hide_modal("div_add_future_tests");return;}}else{var strEdit="";if(typeof(eid)!="undefined"&&eid!=""){strEdit="&elem_showId="+eid;}
if(typeof(setProcessImg)!='undefined')setProcessImg(1,"ft_appnt");if($("#div_add_future_tests").length>0){hide_modal("div_add_future_tests");}
$.get("requestHandler.php?elem_formAction=add_future_sch_tests_appoints"+strEdit,function(data){if(typeof(setProcessImg)!='undefined')setProcessImg(0,"ft_appnt");add_future_sch_tests_appoints_processing(data);});}}
function add_future_sch_tests_appoints_processing(data,idpimg){if($("#div_add_future_tests").length>0){hide_modal("div_add_future_tests");setTimeout(function(){add_future_sch_tests_appoints_processing(data,idpimg);},500);return;}
$("body").append(""+data);$("#div_add_future_tests").modal("show");var dt=$("input[name=elem_fsta_sch_date]").val();if($.trim(dt)==""){dt=new Date();}
var dt_format=top.jQueryIntDateFormat;$("input[name=elem_fsta_sch_date]").datepicker().datepicker("option","dateFormat",dt_format).datepicker("setDate",dt);multiphy_typeahead(6);}
function set_future_sch_tests_options(val){var tmp="#dvFSTA_test";if(val=="Test"){$(tmp).show();}else{$(tmp).hide();}
tmp="#dvFSTA_loinc, #dvFSTA_cpt, #dvFSTA_snomed";if(val=="Referral"){$(tmp).hide();}else{set_future_sch_testsType_options();}}
function set_future_sch_testsType_options(){var tmp=$.trim($(":checked[name=elem_fsta_test_type]").val());var test_check_flag=$.trim($(":checked[name=elem_fsta_test_appoint]").val());$("#dvFSTA_loinc, #dvFSTA_cpt, #dvFSTA_snomed").hide();if(test_check_flag=="Test"){if(tmp=="Lab"||tmp==""){$("#dvFSTA_loinc").show();}
if(tmp=="Procedure"||tmp==""){$("#dvFSTA_cpt").show();}
if(tmp=="Imaging"||tmp==""){$("#dvFSTA_snomed").show();}}}
function lock_checkPass(mtd){var oIn=$("#elem_lockAdminPass");if(oIn.length&&($.trim(oIn.val())=="")){top.fAlert("Enter password.");return;}
oIn=$("#elem_lockAdminPass");var cTab=$("#elem_tab").val();if(mtd=="MD5"){oIn.val(md5($.trim(oIn.val())));}
else{oIn.val(Sha256.hash($.trim(oIn.val())));}
if(typeof(zPath)=="undefined"){zPath="";}
var u=(typeof(zPath_remote)!="undefined")?zPath_remote:zPath;var url=u+"/chart_notes/requestHandler.php";var params={"elem_formAction":"checkAdminPass4Lock","elem_lockAdminPass":""+oIn.val(),"elem_tab":""+cTab};$.post(url,params,function(data){if(data==1){if(typeof(funClosePopUpExe)!='undefined'){funClosePopUpExe();}
top.window.location.reload();}else{top.fAlert("Please enter correct password.");oIn.val("");oIn.focus();}});}
function lock_showPassPrompt(){var odiv=document.getElementById("divLockPassPrompt");var oIn=document.getElementById("elem_lockAdminPass");if(odiv){odiv.style.display="block";}
if(oIn){oIn.value="";oIn.focus();}
stopClickBubble();}
function showChartNotesTree(flg){if(flg!="2"&&flg!="1"&&flg!="srch"){if($("#sliderRight").length>0&&$("#sliderRight").attr("attrFilled")=="1"){$("body").trigger("click");return;}}
if(flg=="1"){update_toolbar_icon();}
var response="json";var url=zPath+"/chart_notes/requestHandler.php";var params="elem_formAction=chartNoteTree";if(flg=="srch"){var srchVal=gebi('elem_findSearch').value;var fndStatus='';if(gebi('elem_findStatus')){fndStatus=gebi('elem_findStatus').value;}
var fndPhy='';if(gebi('elem_findPhy')){fndPhy=gebi('elem_findPhy').value;}
params+="&elem_formAction_ptforms=Search";params+="&srchVal="+srchVal;params+="&fndStatus="+fndStatus;params+="&fndPhy="+fndPhy;$("#sec_exams,#sec_tests").html("Loading..");}else{params+="&elem_formAction_ptforms=chartNoteTree";}
$("#sliderRight").remove();$("body").append("<div id=\"sliderRight\">Loading...</div>");if(typeof(setProcessImg)=="function")setProcessImg("1","sliderRight");$.post(url,params,function(data){if(typeof(setProcessImg)=="function")setProcessImg("0","sliderRight");if(response=="text"){console.log(data);}
var tmp=""+data.innerHtml;if($("#sliderRight").length<=0){$("body").append("<div id=\"sliderRight\">Loading...</div>");}
$("#sliderRight").html(tmp).attr("attrFilled","1").bind("click",function(){stopClickBubble();});$('[data-toggle="tooltip"]').tooltip();if(typeof(data.is_test_uninterpreted)!="undefined"){is_test_uninterpreted=data.is_test_uninterpreted;highlight_pt_form_btn();}},response);}
function sl_showopts(obj){var tmp=$(obj).parent().parent().find("ul");if(tmp.css("display")=="none")tmp.show();else tmp.hide();stopClickBubble();}
var flgHMPE1=0;function handlerMainPageEvents(e){var etar=e.target;var chk=etar.nodeName;var chktag=etar.tagName;var eType=e.type;if(chk=="INPUT"||chk=="TEXTAREA"||((eType=="change"||eType=="keyup"||eType=="mousedown")&&chk=="SELECT")){var enm=e.target.name;var eid=e.target.id;if(e.target.type=="button")return;if(elem_per_vo=="1"){if(enm!="elem_lockAdminPass"&&enm!="elem_btnLock"){if($("#icoPtLock").length>0){$("#icoPtLock").triggerHandler('click');}else if(flgHMPE1==0){if($(etar).parents("#genHealthDiv_wv").length<=0){var t="You don't have permission to edit chart notes. ";top.fAlert(""+t);flgHMPE1=1;window.status="Note: "+t;setfinalizedFunction('',1);}}}
return;}
if(finalize_flag=='1'&&isReviewable=='1'){if(eid!="elem_ptTemplate"){checkAlert();}}
isFormChanged=1;if($(etar).parents("#Vision").length>0){if(enm!="clws_charges[]"){if($(etar).hasClass("active")==false){set_vis_el_active(etar);if($(etar).parents("#MR").length>0||$(etar).parents("#PC").length>0){if($(etar).parents(".prism,#pc3_prism,#mr3_prism").length>0){var eye=(enm.indexOf("Od")!=-1)?"Od":"Os";$(etar).parents(".prism,#pc3_prism,#mr3_prism").children(":input[name*="+eye+"]").each(function(){$(this).trigger("keyup");});}
if($(etar).parents("#MR").length>0){var vissectch=""+$("#elem_vis_section_touched").val();if(vissectch.indexOf("MR")==-1){$("#elem_vis_section_touched").val(vissectch+",MR");}}
if(enm.indexOf("OsAdd")!=-1&&$(etar).val()==""){var t=enm.replace("OsAdd","OdAdd");$(etar).val($("#"+t).val());}}}
if(enm.indexOf("elem_visMrO")!=-1||enm.indexOf("elem_mrNoneGiven")!=-1){add_opyia_assessment(enm,etar.value);}
if($(etar).parents("#div_lasik_common").length>0){$("#el_lasik_userid").val(authUserID);if(enm.indexOf("el_visLasikTrgtTime")!=-1){$("#"+enm).val(""+currenttime());}}}}
if($(etar).parents("#CVF").length>0){$("#CVF div.bggrey").removeClass("bggrey");}
if($(etar).parents("#AmslerGrid").length>0){ag_clear_grey_bg();}
if($(etar).parents("#dv_cn_progess_notes").length>0){if($(etar).hasClass("active")==false){$(etar).addClass("active");}}
if($(etar).prop("checked")&&$(etar).parents("#ft_strd_of_cr").length>0){var eid=$(etar).attr("id");if(eid.indexOf("el_soc")!=-1){$('#ft_strd_of_cr :checked').not("#"+eid).prop('checked',false);}}
if($(etar).parents("#assessplan,#detailDesc1,#detailDesc2,#divApPlan,.OrderDetail, #dialog-Mdc-cum-new-pt, #dv_cn_progess_notes").length>0){return;}
utElem_capture(e);if(eid=="elem_chk"||eid=="elem_ccompliant"){setTimeout(function(){if($(etar).is(":focus")){$(etar).addClass("mk_bigger_el").bind("blur",function(){$(etar).removeClass("mk_bigger_el");});}},2000);}
top.$("body").click();}else if(eType=="click"||eType=="touchstart"){if($(etar).parents("#ft_strd_of_cr").length>0){var eid=$(etar).attr("for");if(eid.indexOf("el_soc")!=-1){$('#ft_strd_of_cr :checked').not("#"+eid).prop('checked',false);}}
if(isiPad){if(($(etar).parents('#sliderRight').length>0)){setTimeout(function(){closePopUps();},500);}else if($(etar).parents('#div_rvs').length>0){}else{closePopUps();}}
else{closePopUps();}}}
function ag_clear_grey_bg(){$("#AmslerGrid div.bggrey").removeClass("bggrey");}
function clearMr(w,rem){if(typeof(rem)!="undefined"&&rem==1){$("#row_mr_"+w+", #row_mr_"+(w-1)).hide();return;}
var ar=new Array("elem_visMrOdP","elem_visMrOdPrism","elem_visMrOdSlash","elem_visMrOdSel1","elem_visMrOsP","elem_visMrOsPrism","elem_visMrOsSlash","elem_visMrOsSel1","elem_visMrOdS","elem_visMrOdC","elem_visMrOdA","elem_visMrOdAdd","elem_visMrOdTxt1","elem_visMrOdSel2","elem_visMrOdTxt2","elem_visMrOsS","elem_visMrOsC","elem_visMrOsA","elem_visMrOsAdd","elem_visMrOsTxt1","elem_visMrOsSel2","elem_visMrOsTxt2","elem_visMrDesc","elem_visMrOdSel2Vision","elem_visMrOsSel2Vision","elem_providerName","elem_providerId","elem_visMrPrismDesc_","elem_visMrOuTxt1","elem_mr_pres_dt_","elem_mrNoneGiven","elem_mr_type");var l=ar.length;for(var i=0;i<l;i++){var n=ar[i];if(((w>"1"))&&(n!="elem_visMrDesc")){n=(n.indexOf("Od")!=-1)?n.replace(/Od/,"OtherOd"):n;n=(n.indexOf("Os")!=-1)?n.replace(/Os/,"OtherOs"):n;n=(n.indexOf("Ou")!=-1)?n.replace(/Ou/,"OtherOu"):n;}
if((w>"1")&&(n=="elem_providerName"||n=="elem_providerId")){n+="Other";}
if((w>"2")&&(n!="elem_visMrDesc")){n=n+"_"+w;}
if((w>="2")&&(n=="elem_visMrDesc")){n="elem_visMrDescOther";}
if((w>"2")&&(n=="elem_visMrDescOther")){n="elem_visMrDescOther_"+w;}
if(n.indexOf("elem_visMrPrismDesc_")!=-1){n="elem_visMrPrismDesc_"+w;}
if(n.indexOf("elem_mr_pres_dt_")!=-1){n="elem_mr_pres_dt_"+w;}
if(n.indexOf("elem_mrNoneGiven")!=-1){n="elem_mrNoneGiven"+w;}
if(n.indexOf("elem_mr_type")!=-1){n="elem_mr_type"+w;}
var o=gebi(n);if(o){if(o.type=="checkbox"){o.checked=false;}else{if(o.value.indexOf("20/")<0){o.value="";}else{o.value="20/";}}}}}
function changeVisionStatus(){var obj=arguments[0];var e=window.event;if(e&&(typeof arguments[1]=="undefined")){obj=e.srcElement;}
var flg_frc=(typeof arguments[2]!="undefined"&&arguments[2]==1)?1:0;if(obj){var ev="click";if(typeof obj.type!="undefined"&&obj.type=="select-one"){ev="keyup";}
if(!$(obj).hasClass("active")||flg_frc==1){$(obj).trigger(ev);}}}
function setGivenMr(o,str){}
function showTranspose(indx,wh){var arreye=["Od","Os"];for(var x in arreye){var eye=arreye[x];if(typeof(wh)!="undefined"&&wh=="PC"){var sufx="";if(indx>"1"){sufx=""+indx;}
var vs="elem_visPc"+eye+"S"+sufx;var vc="elem_visPc"+eye+"C"+sufx;var va="elem_visPc"+eye+"A"+sufx;}else{var othr="";if(indx>"1"){othr="Other";}
var sufx="";if(indx>"2"){sufx="_"+indx;}
var vs="elem_visMr"+othr+eye+"S"+sufx;var vc="elem_visMr"+othr+eye+"C"+sufx;var va="elem_visMr"+othr+eye+"A"+sufx;}
var s=$("input[name="+vs+"]").val();s=$.trim(s);var c=$("input[name="+vc+"]").val();c=$.trim(c);var a=$("input[name="+va+"]").val();a=$.trim(a);if(s.toUpperCase()=="PLANO"){s="0";}
if(typeof(s)=="undefined"||s==""||isNaN(s)){continue;}
if(typeof(c)=="undefined"||c.toUpperCase()=="SPHERE"||c==""||isNaN(c)){continue;}
var sig_sc=parseFloat(s)+parseFloat(c);sig_sc=sig_sc.toFixed(2);if(""+sig_sc.indexOf("+")==-1&&""+sig_sc.indexOf("-")==-1){sig_sc="+"+sig_sc;}
var op_sign_c=(-1)*parseFloat(c);op_sign_c=""+op_sign_c.toFixed(2);if(""+op_sign_c.indexOf("+")==-1&&""+op_sign_c.indexOf("-")==-1){op_sign_c="+"+op_sign_c;}
if(typeof(a)!="undefined"&&a!=""&&!isNaN(a)){var new_axis=parseFloat(a)+90;if(new_axis<1||new_axis>180){new_axis=a-90;}}
if(isNaN(sig_sc)){sig_sc="";}
if(isNaN(op_sign_c)){op_sign_c="";}
if(isNaN(new_axis)){new_axis="";}
else if(new_axis!=""&&!isNaN(new_axis)){var t=""+new_axis;if(t.length<3){new_axis=(t.length==1)?"00"+new_axis:"0"+new_axis;}}
$("input[name="+vs+"]").val(sig_sc).triggerHandler("blur");$("input[name="+vc+"]").val(op_sign_c);$("input[name="+va+"]").val(new_axis);}
stopClickBubble();}
function checkValue(num,val){var c=$("input[type=checkbox][name*=elem_mrNoneGiven"+num+"]");if(c.prop("checked")==true&&c.hasClass("inact")){c.prop("checked",false);c.trigger('click');}
if(val!=""){if(val=="cycloplegic"){val="CR "+num;}
else if(val=="Over Refraction"){val="OR "+num;}
else if(val=="trial frame"){val="TF "+num;}
else if(val=="Final"){val="FR "+num;}
else if(val=="Outside Rx"){val="ORx "+num;}
$("#h2_mr_id"+num).html(val);}else{$("#h2_mr_id"+num).html("MR "+num);}}
function showPrescDtBox(indx,op){}
function mrOtherExe(objDiv,flag)
{if(typeof objDiv!="undefined")
{if(flag==true)
{objDiv.style.display="block";}
else
{objDiv.style.display="none";emptyPcValues(objDiv);}}}
function emptyPcValues(objDiv){var objElems=new Array();var objElemsInput=objDiv.getElementsByTagName("INPUT");var objElemsSelect=objDiv.getElementsByTagName("SELECT");if(objElemsInput.length>0){objElems=objElems.concat(objElemsInput);}
if(objElemsSelect.length>0){objElems=objElems.concat(objElemsSelect);}
var len=objElems[0].length;for(var i=0;i<len;i++)
{if((objElems[0][i].name.indexOf("elemHoriPosition")==-1)&&(objElems[0][i].name.indexOf("elemTargetName")==-1)){objElems[0][i].value="";}}}
function copyPcMr(ob){var v=$(ob).val();if(v==""){return;}
var ti=$(ob).data("mr"),t="MR",tdv="row_mr_",tprsmdv="";if(typeof(ti)=="undefined"){ti=$(ob).data("pc");t="PC";tdv="pc";tprsmdv="pc_ovr_ref_prism";}
if(v.indexOf(t)!=-1){var si=$.trim(v.replace(t,"")),sid,flgOpPrsm=0;$("#"+tdv+ti+" :input").each(function(){if(this.type=="text"||this.type=="select-one"||this.type=="textarea"||this.type=="checkbox"){sid="";if(t=="PC"){if(ti>1||this.type=="checkbox"){tsi=(si>1||this.id.indexOf("elem_visPcPrismDesc_")!=-1)?si:"";sid=this.id.replace(ti,tsi);}else{if(this.id.indexOf("elem_visPcPrismDesc_")!=-1){this.id="elem_visPcPrismDesc_";}
sid=this.id+si;}}else if(t=="MR"){if(ti>2){if(si>2){sid=this.id.replace(ti,si);}else if(si>1){if(this.id.indexOf("PrismDesc")!=-1||this.id.indexOf("elem_mr_pres_dt")!=-1||this.id.indexOf("elem_mr_type")!=-1||(this.id.indexOf("Other")==-1&&this.type=="checkbox")){sid=this.id.replace(ti,si);}
else{sid=this.id.replace("_"+ti,"");}}else{if(this.id.indexOf("PrismDesc")!=-1||this.id.indexOf("elem_mr_pres_dt")!=-1||this.id.indexOf("elem_mr_type")!=-1||(this.id.indexOf("Other")==-1&&this.type=="checkbox")){sid=this.id.replace(ti,si);}
else{sid=this.id.replace("_"+ti,"").replace("Other","");}}}else if(ti>1){if(si>2){sid=this.id+"_"+si;}else{sid=this.id.replace("Other","");}}else if(ti<=1){if(this.id.indexOf("PrismDesc")!=-1||this.id.indexOf("elem_mr_pres_dt")!=-1||this.id.indexOf("elem_mr_type")!=-1||this.id.indexOf("mrNoneGiven")!=-1){sid=this.id.replace(ti,si);}
else{sid=(this.id.indexOf("elem_visMrDesc")!=-1)?this.id+"Other":this.id.replace("elem_visMr","elem_visMrOther");if(si>2){sid=(this.type=="checkbox")?sid.replace("Sel2_","Sel2_"+si+"_"):sid+"_"+si;}}}}
if(sid!=""){if(this.type=="checkbox"){if($("#"+this.id).prop("checked")!=$("#"+sid).prop("checked")){$("#"+this.id).parent().find("label[for='"+this.id+"']").trigger("click");}}else{var tmp=$("#"+sid).val();if(typeof(tmp)=="undefined"){tmp="";}
tmp=$.trim(tmp);$("#"+this.id).val(tmp);utElem_capture(this);set_vis_el_active(this);}
if(t=="PC"){if($(this).parents("#"+tprsmdv+ti).length>0&&tmp!=""&&tmp!="20/"){flgOpPrsm=1;}}else if(t=="MR"){if($(this).parents("#mr_gl_ph"+ti+",#mr_prism"+ti).length>0&&tmp!=""&&tmp!="20/"){flgOpPrsm=1;}}}}});}else{var ar=['S','C','A','Add','Sel1','P','Slash','Prism'];var fmr="elem_visMr",fpc="elem_visPc";var sod,sos,tod,tos,oth="",otht="",sfx="",sfxt,tmp;var si="";if(v.indexOf("PC")!=-1||v.indexOf("MR")!=-1){si=parseInt($.trim(v.replace(/PC|MR/g,"")));}
if(v.indexOf("PC")!=-1){var fs=fpc;sfx=(si<2)?"":si;}else if(v.indexOf("MR")!=-1){var fs=fmr;oth=(si>1)?"Other":"";sfx=(si>2)?"_"+si:"";}else if(v.indexOf("ARC")!=-1){var fs="elem_visCycAr";}else if(v.indexOf("AR")!=-1){var fs="elem_visAr";}
if(t=="MR"){var ft=fmr;otht=(ti>1)?"Other":"";sfxt=(ti>2)?"_"+ti:"";}else if(t=="PC"){var ft=fpc;sfxt=(ti<2)?"":ti;}
for(var z in ar){if(v.indexOf("AR")!=-1&&ar[z]!="S"&&ar[z]!="C"&&ar[z]!="A"){continue;}
sod=sos=tod=tos=null;if(v.indexOf("PC")!=-1){tmp=(ar[z]=="Sel1")?"Sel2":ar[z];sod=$("#"+fs+"Od"+tmp+sfx);sos=$("#"+fs+"Os"+tmp+sfx);}else{sod=$("#"+fs+oth+"Od"+ar[z]+sfx);sos=$("#"+fs+oth+"Os"+ar[z]+sfx);}
if(t=="MR"){tod=$("#"+ft+otht+"Od"+ar[z]+sfxt);tos=$("#"+ft+otht+"Os"+ar[z]+sfxt);}else if(t=="PC"){tmp=(ar[z]=="Sel1")?"Sel2":ar[z];tod=$("#"+ft+"Od"+tmp+sfxt);tos=$("#"+ft+"Os"+tmp+sfxt);}
if(sod&&tod){tod.val(sod.val());utElem_capture(tod[0]);set_vis_el_active(tod[0]);}
if(sos&&tos){tos.val(sos.val());utElem_capture(tos[0]);set_vis_el_active(tos[0]);}
if(t=="PC"){if($(tod,tos).parents("#"+tprsmdv+ti).length>0&&tmp!=""&&tmp!="20/"){flgOpPrsm=1;}}else if(t=="MR"){if($(tod,tos).parents("#mr_gl_ph"+ti+",#mr_prism"+ti).length>0&&tmp!=""&&tmp!="20/"){flgOpPrsm=1;}}}
sod=$("#"+fs+"Desc"+oth+sfx);tod=$("#"+ft+"Desc"+otht+sfxt);if(sod&&tod){tod.val(sod.val());utElem_capture(tod[0]);set_vis_el_active(tod[0]);}
if(v.indexOf("PC")!=-1||v.indexOf("MR")!=-1){sod=$("#"+fs+"PrismDesc_"+si);tod=$("#"+ft+"PrismDesc_"+ti);if(sod&&tod){tod.val(sod.val());utElem_capture(tod[0]);set_vis_el_active(tod[0]);}}}
if(flgOpPrsm==1){if(t=="PC"){$("#"+tprsmdv+ti).addClass("in");}
else if(t=="MR"){$("#mr_gl_ph"+ti+",#mr_prism"+ti).addClass("in");}}
if(t=="MR"){if(ti>=1){setUserName("MR"+ti);}}}
function changePc(n){if(typeof(n)=="object"){if(n.name.indexOf("S")!=-1&&(n.value=='0'||n.value=='0.0'||n.value=='0.00')){$("input[name='"+n.name+"']").val("PLANO");}}}
function justify2Decimal(objElem,nosign){var valElem=$.trim(objElem.value);if(valElem!=""&&!isNaN(valElem)&&nosign!=1){var tmp=def_clindr_sign;if(typeof(tmp)=="undefined"||tmp==""||objElem.name.indexOf("S")!=-1){tmp="+"}
var ptrn="^[\+|\-]";var reg=new RegExp(ptrn,'g');var sign=valElem.match(reg);var unJustNumber=(sign==null)?valElem:valElem.substr(1);var justNumber=(unJustNumber=="")?"":parseFloat(unJustNumber).toFixed(2);if(justNumber==0.00)tmp=sign="";objElem.value=(sign==null)?tmp+justNumber:sign+justNumber;}else{objElem.value=valElem;}}
function ak_sel(obj){$("input[name='elem_kType']").each(function(){if(obj.checked&&this.id!=obj.id){this.checked=false;utElem_capture(this);}});}
function check2Blur(obj,wh,wh2){var e=window.event;var kCode=e.keyCode
if(((kCode>=48)&&(kCode<=57))||((kCode>=65)&&(kCode<=90))||((kCode>=96)&&(kCode<=111))||((kCode>=186)&&(kCode<=191))||((kCode>=219)&&(kCode<=222))){var oWh2=gebi(wh2,1)[0];var val=(typeof obj.value=="undefined")?"":$.trim(obj.value);if(((wh=="I")||(wh=="A")||(wh=="X"))&&(val.length>=3)){oWh2.focus();if(oWh2.type!="select-one")oWh2.select();}else if((wh=="K")&&(wh=="slash")){var ptrn="^\\w\\w\.\\w\\w$";var reg=new RegExp(ptrn,"g");var mtch=val.match(reg);if(mtch){oWh2.focus();if(oWh2.type!="select-one")oWh2.select();}}else{var dInx=val.indexOf(".");if((dInx!=-1)){var sbStr=val.substr(dInx+1);if(sbStr.length>=2){oWh2.focus();if(oWh2.type!="select-one")oWh2.select();}}}}}
function changeMr(n){if((finalize_flag==1&&isReviewable==0)||elem_per_vo=="1")return;var ar=null;var e="OU";if(typeof(n)=="object"){if(n.name.indexOf("Od")!=-1){e="OD";}else if(n.name.indexOf("Os")!=-1){e="OS";}
if(n.name.indexOf("S")!=-1&&(n.value=='0'||n.value=='0.0'||n.value=='0.00')){$("input[name='"+n.name+"']").val("PLANO");}
var c=0,vn="";if(n.name.indexOf("Add")==-1&&(n.name.indexOf("S")!=-1||n.name.indexOf("C")!=-1||n.name.indexOf("A")!=-1||n.name.indexOf("Txt1")!=-1)){c=1;vn=n.name;}
if(n.name.indexOf("Other")!=-1){var mri=n.name.match(/_\d+/);if(mri){mri=mri[0];mri=""+mri.replace(/_/,'');n=parseInt(mri);}else{n=2;}}else{n=1;}}
if(n>=1){setUserName("MR"+n);if(e=="OS"&&c==1){if(vn&&typeof(vn)!="undefined"&&vn!=""){var a1=vn.replace(/(S|C|A|Txt1)/,"Add");a1=a1.replace(/(Od|Os)/,"Od");var a2=a1.replace(/(Od)/,"Os");if($("#vision input[name="+a1+"]").length>0&&$("#vision input[name="+a2+"]").length>0){var t=$("#vision input[name="+a2+"]");var s=""+$("#vision input[name="+a1+"]").val();if(s!=""&&s!="+"){t.val(""+$("#vision input[name="+a1+"]").val());utElem_capture(t[0]);}}}}}}
function set_vis_el_active(oenm){var enm="";if(oenm!=null){enm=oenm.name;}
$(oenm).addClass("active");var str=$("#elem_statusElements").val();if(typeof(str)=="undefined")str="";if(str.indexOf(enm+"=1,")==-1){str=str.replace(""+enm+"=0,","");str=str+""+enm+"=1,";}
$("#elem_statusElements").val(str);}
function chkOther(o){if(o.value.toLowerCase()=='other')o.value='';}
function wv_activate_menu_click(obj_el,flg_top){var slctr=" .menu a";if(typeof(obj_el)!="undefined"&&obj_el!=""){slctr=obj_el;}
var obj=$(""+slctr).not("#ContactLens ul.dropdown-menu a");if(typeof(flg_top)!="undefined"&&flg_top=="1"){obj=top.$(""+slctr);}
obj.bind("click",function(){var me=$(this);if(typeof(flg_top)!="undefined"&&flg_top=="1"){me=top.$(this);}
var tid=me.parents(".menu").find("button").data("trgt-id");var otid=(typeof(flg_top)!="undefined"&&flg_top=="1")?top.$("#"+tid):$("#"+tid);var v=me.data("val");if(tid.indexOf("elem_followUpNumber_")!=-1){var pv=otid.val();if(typeof(pv)!="undefined"&&pv!=""){v=v+","+pv;}}
otid.val(v).triggerHandler("change");otid.triggerHandler("blur");otid.triggerHandler("keyup");otid.trigger("click");});}
function wv_activate_mr(){$(":checkbox[id*=elem_mrNoneGiven]").bind("click",function(){var x=this.name.replace("elem_mrNoneGiven","elem_mr_pres_dt_");var d="";if(this.checked){d=$("#elem_examDate").val();}$("#"+x).val(d).trigger("click");});$("input[id*=elem_mr_pres_dt]").datepicker({dateFormat:"mm-dd-yy"});}
var reset_vis_nav_ept;function reset_vis_nav(){if(typeof(reset_vis_nav_ept)=="undefined"){reset_vis_nav_ept=$('.examleftpan').position().top;}
var wt=$(window).scrollTop();var th=$(".workvision")[0].offsetHeight;var sh=$(".examleftpan")[0].offsetHeight;var sp=$('.examleftpan').position().top;var wp=$(".workvision").position().top;var ct=reset_vis_nav_ept+wt+sh;var dt=wp+th;if(ct>=dt){wt=dt-sh;}
if(wt>=wp){var d=wt-wp;var t=reset_vis_nav_ept+d;}else{t=0;}
$('.examleftpan').css({"top":t+"px"});}
function vision_event_handler(){wv_activate_menu_click();$("#Vision .menu button").attr("tabindex","-1");$(".reloadpos").bind("click",function(){setResetValues('vis');});wv_activate_mr();$('#Vision .nav-pills a').bind("click",function(){var t=$(this).attr('href');var v='';if(t=='#pill_ar'){$("#elem_visArOdSel1").removeClass("hidden");$("#elem_visCycArOdSel1").addClass("hidden");if($('#pill_ar').hasClass("in")){v='popAR';}}else if(t=='#pill_cyc_ar'){$("#elem_visArOdSel1").addClass("hidden");$("#elem_visCycArOdSel1").removeClass("hidden");if($('#pill_cyc_ar').hasClass("in")){v='popCycAR';}}else if(t=='#pill_bat'){$("#bat .hdr div").addClass("hidden");if($('#pill_bat').hasClass("in")){v='popBAT';}}else if(t=='#pill_pam'){$("#bat .hdr div").removeClass("hidden");if($('#pill_pam').hasClass("in")){v='popPAM';}}
if(v!=''){callPopup('',v,'1250','760');}
else{$(this).tab('show');}
return false;});var menu=function(o){var c=$(o).hasClass("in")?"up":"down";$(".examleftpan a[href='#"+o.id+"'] span").removeClass("glyphicon-menu-up glyphicon-menu-down").addClass("glyphicon-menu-"+c);};var menu_el='#Distance, #PC, #MR, #LASIK, #OtherVisionExams, #ContactLens';$(menu_el).each(function(){menu(this);});$(menu_el).on('shown.bs.collapse',function(){var t=$(this).attr('id');if($("#"+t).hasClass("in")){scroll_into_view("#"+t);};menu(this);});$(menu_el).on('hidden.bs.collapse',function(){var t=$(this).attr('id');$(window).triggerHandler("scroll");menu(this);});$(window).scroll(function(){reset_vis_nav();});$("#MR .dv_glph_hdr .header :checkbox").bind("click",function(){if($(this).prop("checked")){$(this).parents(".header").find(":checkbox[id!='"+$(this).attr("id")+"']").prop("checked",false);}});$("#Vision .examsectbox .header .glyphicon-ok-circle").bind("click",function(){var w=$(this).parents(".examsectbox").parent().attr("id");var c,c1="",flg_blur=0;if(w=="ar"||w=="bat"){var x=$("#"+w+" table.in").attr("id");if(x=="pill_ar"){c1+="#elem_visArOdSel1, #elem_visArRefPlace";}else if(x=="pill_cyc_ar"){c1+="#elem_visCycArOdSel1, #elem_visArRefPlace";}else if(x=="pill_pam"){c1+="#elem_visPam, #elem_visPamOdSel2";}
c=$("#"+x);}else{w=$(this).parents("div[id*=pc]").attr("id")||"";if(w!=""&&w.indexOf("pc")!=-1){c=$("#"+w);}else{w=$(this).parents("div[id*='row_mr_']").attr("id")||"";if(w!=""&&w.indexOf("row_mr_")!=-1){c=$("#"+w);flg_blur=1;}else{c=$(this).parents(".examsectbox");}}}
if(c){c.find(":input").each(function(){var v=$(this).val();if(v!=""&&v!="20/"){var thid=$(this).attr("id");if(typeof(thid)!="undefined"&&thid.indexOf("elem_addvisDisOdSel")!=-1){return true;}$(this).trigger("change");if(flg_blur==1&&typeof(this.id)!='undefined'&&this.id.indexOf("OdS")!=-1){$(this).triggerHandler("blur");c.find(":checked[name*=elem_mrNoneGiven]").each(function(){$(this).prop("checked",false).trigger("click");});flg_blur=0;}}});}
if(c1!=""){$(""+c1).each(function(){var v=$(this).val();if(v!=""&&v!="20/"){$(this).trigger("change");}});}});}
function add_opyia_assessment(enm,val){if(typeof(flgRefDig)=="undefined"){flgRefDig=1;}
if(flgRefDig==0){return;}
if(typeof(flgRefGivenOnly)=="undefined"){flgRefGivenOnly=0;}
if(typeof(flgPhyRefSet)=="undefined"){flgPhyRefSet=0;}
var etar_v=$.trim(val);if(etar_v!=""){var v_icd_10=$("#hid_icd10").val();var t_as="",t_dx="",site="",t_as_2="",t_dx_2="",site_2="";var s_od,s_os,ad_od,ad_os,mr_givn;if(enm.indexOf("_3")!=-1){s_od=$(":input[name=elem_visMrOtherOdS_3]").val(),s_os=$(":input[name=elem_visMrOtherOsS_3]").val(),ad_od=$(":input[name=elem_visMrOtherOdAdd_3]").val(),ad_os=$(":input[name=elem_visMrOtherOsAdd_3]").val();mr_givn=$(":checked[name=elem_mrNoneGiven3]").length;}else if(enm.indexOf("Other")!=-1){s_od=$(":input[name=elem_visMrOtherOdS]").val(),s_os=$(":input[name=elem_visMrOsS]").val(),ad_od=$(":input[name=elem_visMrOtherOdAdd]").val(),ad_os=$(":input[name=elem_visMrOsAdd]").val();mr_givn=$(":checked[name=elem_mrNoneGiven2]").length;}else{s_od=$(":input[name=elem_visMrOdS]").val(),s_os=$(":input[name=elem_visMrOsS]").val(),ad_od=$(":input[name=elem_visMrOdAdd]").val(),ad_os=$(":input[name=elem_visMrOsAdd]").val();mr_givn=$(":checked[name=elem_mrNoneGiven1]").length;}
s_od=(typeof(s_od)=="undefined")?"":$.trim(s_od);if(""+s_od.toLowerCase()=="plano"){s_od="";}
s_os=(typeof(s_os)=="undefined")?"":$.trim(s_os);if(""+s_os.toLowerCase()=="plano"){s_os="";}
ad_od=(typeof(ad_od)=="undefined"||parseFloat(ad_od)<=0)?"":$.trim(ad_od);ad_os=(typeof(ad_os)=="undefined"||parseFloat(ad_os)<=0)?"":$.trim(ad_os);mr_givn=(typeof(mr_givn)=="undefined")?0:$.trim(mr_givn);if(flgRefGivenOnly=="1"&&mr_givn<=0){return;}
if((ad_od!=""&&ad_od!="+")||(ad_os!=""&&ad_os!="+")){t_as_2="Presbyopia";t_dx_2=(v_icd_10=="9")?"367.4":"H52.4";if(ad_od!=""){site_2="OD";}
if(ad_os!=""){site_2=(ad_od!="")?"OU":"OS";}}
if((s_od!=""&&s_od!="-"&&s_od!="+")||(s_os!=""&&s_os!="-"&&s_os!="+")){if(s_od.indexOf("-")!=-1||s_os.indexOf("-")!=-1){t_as="Myopia";t_dx=(v_icd_10=="9")?"367.1":"H52.1-";}
else{t_as="Hyperopia";t_dx=(v_icd_10=="9")?"367.0":"H52.0-";}
if(t_dx=="H52.1-"){if(s_od!=""&&s_od.indexOf("-")!=-1){site="OD";}
if(s_os!=""&&s_os.indexOf("-")!=-1){site=(site!="")?"OU":"OS";}}else{if(s_od!=""){site="OD";}
if(s_os!=""){site=(s_od!="")?"OU":"OS";}}
var r="";if(site=="OD"){r=1;}else if(site=="OU"){r=3;}else if(site=="OS"){r=2;}
t_dx=t_dx.replace("-",r);}
if(t_as!=""||t_as_2!=""){cn_clearOpiaAssessments(t_as,t_as_2);if(t_as!=""){addAssessOption(t_as,"","",site,"",t_dx);}
if(t_as_2!=""){addAssessOption(t_as_2,"","",site_2,"",t_dx_2);}}}}
function cn_clearOpiaAssessments(a1,a2){var ass_nm="textarea[id*=elem_assessment]";$(ass_nm).each(function(indx){if(this.id.indexOf("elem_assessment_dxcode")!=-1){return true;}
var tmp=$.trim(this.value);if($.trim(tmp)!=""){tmp=tmp.toLowerCase();var ar_tmp=tmp.split(";");tmp=$.trim(ar_tmp[0]);if(tmp=="presbyopia"||tmp=="myopia"||tmp=="hyperopia"){var flgdo=1;if(typeof(a1)!="undefined"&&a1!=""){a1=a1.toLowerCase();if(tmp==a1){flgdo=0;a1="";}}
if(typeof(a2)!="undefined"&&a2!=""){a2=a2.toLowerCase();if(tmp==a2){flgdo=0;a2="";}}
if(flgdo==1){clearAssessRow(this.id);}}}});}
function vis_show_sec(wh,flgshow){}
function setActuity(obj){}
function addArthSign(obj){var valElem=$.trim(obj.value);obj.value="";var ptrn="^[\+|\-]";var reg=new RegExp(ptrn,'g');var sign=valElem.match(reg);if(valElem!=""&&!isNaN(valElem)){if(sign!=null){valElem=valElem.replace(reg,"");}else{sign="+";}
if(valElem!=""){valElem=parseFloat(valElem).toFixed(2);obj.value=sign+valElem;}}}
function setOs(obj){var n=obj.name;var valElem=$.trim(obj.value);if((n.indexOf("Add")!=-1)&&(valElem!="")){addArthSign(obj);}}
function scrollDropDowns(obj){var parentModal=$(obj);if(parentModal.length){var mainContainer=parentModal.find('.modal-body');var inputElem=mainContainer.find("input[type=text]");$.each(inputElem,function(id,val){var inputTxt=this.id;mainContainer.find('input[id$='+inputTxt+']:visible').each(function(id,elem){var inputID=$(elem).attr('id');var selectID=inputID.replace('text_','');var inputVal=$(elem).val();inputVal=$.trim(inputVal);if(inputTxt==selectID){return true;}
var selectElem=mainContainer.find('#'+selectID);if(selectElem){var scrollHeight=0;if(inputVal!=''&&inputVal!="None"){var flgc=0;selectElem.find('option').each(function(id,optElement){if(inputID.indexOf("S_text_input")!=-1||inputID.indexOf("C_text_input")!=-1||inputID.indexOf("A_text_input")!=-1){if(parseFloat(this.value)<parseFloat(inputVal)){scrollHeight+=15;}
flgc=1;}else{if(this.value==inputVal){flgc=1;}
if(flgc==0){scrollHeight+=15;}}});if(flgc==0){scrollHeight=0;}}
selectElem.animate({scrollTop:scrollHeight},5);}});});}}
function callPopup(fileName,popName,width,height,section){if(section!="PRS"){if((elem_per_vo=="1")||((finalize_flag=="1")&&(isReviewable!="1"))){return;}}
var popmodal="";popmodal=popName+"Modal";if(popmodal!=""){var indx=""+popName.replace(/popMR/,"");var indx2=""+popName.replace(/popExtMR/,"");var ext_mr_lbl=$("#h2_mr_id"+indx).html();var mr_lbl=$("#h2_mr_id"+indx).html();if(top.$("#"+popmodal).length>0){top.$("#"+popmodal).modal('hide');top.$("#"+popmodal+", .modal-backdrop").remove();}
if(typeof(setProcessImg)!='undefined')setProcessImg(1,"");var url=zPath+"/chart_notes/requestHandler.php?elem_formAction=VisPopUp&popName="+popName+"&mr_lbl="+mr_lbl+"&ext_mr_lbl="+ext_mr_lbl;$.get(url,function(d){if(typeof(setProcessImg)!='undefined')setProcessImg(0,"");top.$("body").append(d);top.$("#"+popmodal).modal("show");top.$('#'+popmodal).on('shown.bs.modal',function(){if(popName.indexOf("popPC")!=-1||popName.indexOf("popMR")!=-1||popName.indexOf("popBAT")!=-1||popName.indexOf("popExtMR")!=-1){top.$("#"+popmodal).find('.modal-dialog').css({width:'auto'});}
top.$("#"+popmodal).find('.modal-dialog').css({height:'auto','max-height':'100%'});top.$("#"+popmodal).find('.modal-body').css({padding:'2px'});var xhgt=top.$(window).height();var xwdth=top.$(window).width();if(section=="PRS"){xhgt=parent.document.body.clientHeight-120;}
xhgt=parseInt(xhgt)-(parseInt(top.$(this).find('.modal-footer').css("height"))+150);var fun=function(){var x=$(this).val();$(this).find("option").prop("selected",false);$(this).find("option[value='"+x+"']").prop("selected",true);var v=$(this).val()||"";var tid=$(this).attr("id").replace("_input","_text_input");top.$("#"+tid).val(v);};if(isiPad==1){top.$("#"+popmodal+" .modal-body select[data-size]").attr("data-size",1).prop('multiple',false).bind("blur",fun);}else{top.$("#"+popmodal+" .modal-body select[data-size]").css({"min-height":xhgt+"px"}).bind("change",fun);}
if(popName.indexOf("popPC")!=-1||popName.indexOf("popMR")!=-1||popName.indexOf("popExtMR")!=-1){top.$("#"+popmodal+" .modal-body").css({"overflow-x":"hidden","height":xhgt+150});top.$("#"+popmodal+" .panel-body").css({"padding":"2px"});}
if(popName.indexOf("popMR")!=-1){top.$("#"+popmodal+" .table").css({"margin-bottom":"2px"});top.$("#"+popmodal+" .table td").prop("style","padding: 2px !important");}
if(popName.indexOf("popExtMR")!=-1){top.$("#"+popmodal+" .table").css({"margin-bottom":"2px"});top.$("#"+popmodal+" .table td").prop("style","padding: 2px !important");}
top.$("#"+popmodal+" .modal-footer").css({"text-align":"center"});if(typeof(top.getValuesFromParent)!="undefined"&&popName.indexOf("popExtMR")==-1){top.getValuesFromParent(popmodal);}
if(typeof(top.bl_exe)!="undefined"){top.$("#"+popmodal+" .bl ").each(function(){$(this).bind("click",function(){top.bl_exe(this);});});}
setTimeout(function(){scrollDropDowns(top.$("#"+popmodal));},500);});if(popName.indexOf("popPC")==-1&&popName.indexOf("popMR")==-1){wv_activate_menu_click("#"+popmodal+" .menu a",1);}});}}
function opArUp(op){if(typeof op=="undefined")op="";var url=zPath+"/chart_notes/onload_wv.php?elem_action=ScarAR&op="+op;var n="childWinArScan";top.fmain.showOtherForms(url,n,810,600,0);}
var flg_add_more_vision=0;function add_more_vision(w){var indx=0;var wh=(w=="pc")?"#PC":"#MR";$(wh+">.row>div[id]").each(function(){if($(this).css("display")=="none"){return false;}var id=$(this).attr("id");id=id.replace(/pc|row_mr_/g,"");id=parseInt(id);if(id>indx){indx=id;}});indx+=1;if(w=="pc"){if($("#pc"+indx).length>0){$("#pc"+indx+", #pc"+(indx+1)+", #pc"+(indx+2)).show();return;}}
else{if($("#row_mr_"+indx).length>0){$("#row_mr_"+indx+", #row_mr_"+(indx+1)).show();return;}}
if(flg_add_more_vision==1){return;}
flg_add_more_vision=1;var pcln=$("#PC").find(".row>div[id*=pc]").length;var mrln=$("#MR").find("div[id*=row_mr_]").length;var url=zPath+"/chart_notes/requestHandler.php?elem_formAction=addVisionPCMR&indx="+indx+"&w="+w+"&ctmpMr3="+$("#ctmpMr3").val()+"&pcln="+pcln+"&mrln="+mrln;if(typeof(setProcessImg)=="function"){setProcessImg("1","vision");}
$.get(url,function(data){flg_add_more_vision=0;if(typeof(setProcessImg)=="function"){setProcessImg("0","vision");}if(data!=""){$(wh+">.row").append(data);}wv_activate_menu_click();wv_activate_mr();});}
function clearPc(w,rem){if(typeof(rem)!="undefined"&&rem==1){$("#pc"+w+", #pc"+(w-1)+", #pc"+(w-2)).hide();}}
function chk_mr_given(o){if($(o).val()!=""){var tmpdt=$(o).val();var a=o.id.replace(/elem_mr_pres_dt_/,"elem_mrNoneGiven");if($("#"+a).prop("checked")==false){$("#"+a).trigger("click");$(o).val(tmpdt);}}}
function vis_add_menu(o,mid,eid,h,t){if(typeof(o)!="undefined"){if(!$(o).hasClass("dropdown-toggle")){if(typeof(h)=="undefined"){var g=""+mid;if(g!=""){if($("#Vision ."+g+"_ul").length<=0){if(typeof(setProcessImg)!='undefined')setProcessImg("1","Vision");$.get(zPath+"/chart_notes/requestHandler.php?elem_formAction=get_sb_menu&wh="+g+"&req_ptwo=1&mid="+mid+"&eid="+eid,function(d){if(typeof(setProcessImg)!='undefined')setProcessImg("0","Vision");if(typeof(d)!="undefined"&&d!=""){vis_add_menu(o,mid,eid,d,1);}});}else{var d=$("#Vision ."+g+"_ul").get(0).outerHTML;if(typeof(d)!="undefined"&&d!=""){vis_add_menu(o,mid,eid,d);}}
return;}}else{var trgtid=''+$(o).parent().parent().find(".form-control").attr("id");$(o).parent().append(h);$(o).attr("data-toggle","dropdown");$(o).attr("data-trgt-id",trgtid);$(o).addClass("dropdown-toggle");$(o).unbind("click",'vis_add_menu');$(o).dropdown();if(mid=="menu_visit_type"){$("#el_visit_ig ul").bind("click",function(){stopClickBubble();});$("#el_visit_ig ul a").bind("click",function(){var x="elem_ptVisit_chk";var y="elem_ptTesting";var h=top.$(this).html();var c=$(this).parent().parent().find(".dropdown-header").html();var w="";if(c=="VISIT"){w=x;}else if(c=="TESTING"){w=y;}
if(w!=""){var a=$("#"+w).val();if(h=="Other"){h="";a="";}
if(typeof(a)!="undefined"&&a!=""){if(c=="VISIT"){if(a.indexOf(h)==-1&&a.indexOf(h+",")==-1){h=h+", "+a;}else{return;}}
else if(c=="TESTING"){if(a!=h){a=h;}else{return;}}}
$("#"+w).val(h);var a=$("#"+x).val()||"";var b=$("#"+y).val()||"";var w="";if(a!=""){w+=a;if(b!=""){w+=" - ";}}
if(b!=""){w+=b;}
$("#el_visit").val(w);$("#elem_masterPtVisit").val(a).triggerHandler("change");$("#elem_masterTesting").val(b).triggerHandler("change");}
stopClickBubble();});}else{wv_activate_menu_click("."+mid+" a");}
if(typeof(t)!="undefined"&&t=="1"){$(o).dropdown("toggle");}}}}}
function add_more_actuity(hh){indx="4";var iddv="div_pop_acuity"+indx;var sel_val=$("#elem_addvisDisOdSel").val();if(typeof(hh)!="undefined"){if(hh==1){$("#"+iddv+"").addClass("hidden");if(sel_val!=""){$("#flg_addvisDisOdSel").removeClass("hidden");}else{$("#flg_addvisDisOdSel").addClass("hidden");}}else if(hh==2){$("#"+iddv+" input[id]").val('');}
return;}
if($("#elem_visDisOdSel"+indx+"").length>0){if(sel_val!=""){$("#"+iddv).removeClass("hidden");var wh=$("#elem_addvisDisOdSel").offset();$("#"+iddv).css({"top":wh.top+"px","left":wh.left+"px"});$("#elem_visDisOdSel"+indx).val(sel_val);$("#"+iddv).draggable({'handle':'.header'});}else{$("#"+iddv).addClass("hidden");$("#"+iddv+" input[id]").val('');$("#flg_addvisDisOdSel").addClass("hidden");}}else{}}
function closePopUps()
{$("#sliderRight").remove();$("#btn_attest_scribe, #btn_attest_attend_scribe, #btn_attest_teach").popover("destroy");top.$('#spanMoreCoMangPhy, #spanMoreRefPhy, #spanMorePCP').popover("destroy");top.$("body").click();}
function close_modal_js(obj){$(obj).parent().parent().remove();}
var flg_saveCDRV="";function saveCDRV(){if(finalize_flag==1&&isReviewable!=1){return;}
var fid=$("#elem_masterId").val();var cd_od=$.trim($("input[name=elem_rvcd_od]").val());var cd_os=$.trim($("input[name=elem_rvcd_os]").val());if(cd_od==""&&cd_os==""){return;}
if(typeof(flg_saveCDRV)=="undefined"||flg_saveCDRV==""){flg_saveCDRV=setTimeout(function(){saveCDRV();},5000);return;}
flg_saveCDRV=clearTimeout(flg_saveCDRV);var params={"elem_saveForm":"saveCDRV","fid":fid,"elem_cdValOd":cd_od,"elem_cdValOs":cd_os};if(typeof(setProcessImg)=="function")setProcessImg("1","fundus_exam");$.post("saveCharts.php",params,function(data){if(typeof(setProcessImg)=="function")setProcessImg("0","fundus_exam");if(data!=0){window.status="Error: C:D values are not saved.";}else{loadExamsSummary("fundus_exam");}});}
function checkPneEye(x){var vchk="elem_periNotExamined";var veye="elem_peri_ne_eye";if(x.id!=vchk&&x.id!=veye){vchk="elem_periNotExamined_peri";veye="elem_peri_ne_eye_peri";}
if(x.type=="checkbox"){var o=$("#"+veye);if($("#"+vchk).prop("checked")&&o.val()==""){o.val("OU");}else if(!$("#"+vchk).prop("checked")){o.val("");}}else if(x.type=="select-one"){var o=$("#"+vchk);if($("#"+veye).val()!=""&&o.prop("checked")==false){o.prop("checked",true).triggerHandler("click");}else if($("#"+veye).val()==""){o.prop("checked",false);}}
utElem_capture(o[0]);if(typeof(examName)!="undefined"&&examName=="Fundus"){if($("#"+vchk).prop("checked")){if($("#"+veye).val()=="OD"||$("#"+veye).val()=="OU"){$("#"+vchk).parents(".tab-pane").find("textarea[id*=AdOptionsOd]").trigger("click");}
if($("#"+veye).val()=="OS"||$("#"+veye).val()=="OU"){$("#"+vchk).parents(".tab-pane").find("textarea[id*=AdOptionsOs]").trigger("click");}}}}
function savePNE(o){if(finalize_flag==1&&isReviewable!=1){return;}
var vchk="elem_periNotExamined";var veye="elem_peri_ne_eye";var ex="Ret";if(o.id!=vchk&&o.id!=veye){vchk="elem_periNotExamined_peri";veye="elem_peri_ne_eye_peri";ex="Peri";}
var fid=$("#elem_masterId").val();var pne=$(":checked[name="+vchk+"]").length>0?1:0;var pne_i=$(":input[name="+veye+"]").val();var params={"elem_saveForm":"SavePeriphery","fid":fid,"pne":pne,"pne_i":pne_i,"ex":ex};if(typeof(setProcessImg)=="function")setProcessImg("1","fundus_exam");$.get("saveCharts.php",params,function(data){if(typeof(setProcessImg)=="function")setProcessImg("0","fundus_exam");if(data!=0){window.status="Error: periphery Not exam is not saved.";}else{loadExamsSummary("fundus_exam");}});}
function setResetValues(val,site,confrmed){if((elem_per_vo=="1")||((finalize_flag=="1")&&(isReviewable!="1"))){return;}
if(val=="vis")val="Vision";if(typeof(confrmed)=='undefined'){top.fancyConfirm("Do you want to reset "+val+" exam(s)?",'',"top.fmain.setResetValues(\'"+val+"\', \'"+site+"\',true)");c=false;}else{c=true;}
if(c){if(val=="Vision"){var a="#Vision :input[type=text], "+"#Vision textarea,#Vision select, "+"#elem_statusElements ";$(a).val("").removeClass("active").addClass("inact");$("#Vision .acuity").val("20/");$("#Vision :input[type=checkbox]").attr("checked",false);$("#a_pcPrism1,#a_pcPrism2,#linkpc3,#a_mrPrism1,#a_mrPrism2,#indBat,#indMR3,#sptitle_w4dot").removeClass("positive");$("#Vision #el_lasik_userid").val(authUserID);}else{if(typeof(site)=="undefined"){site="";}
var url="saveCharts.php";var params="elem_saveForm=setResetValues";params+="&elem_section="+val;params+="&elem_fid="+$("#elem_masterId").val();params+="&site="+site;params+="&cryfwd_form_id="+$("#cryfwd_form_id").val();if(typeof(setProcessImg)=="function")setProcessImg("1","");$.post(url,params,function(data){if(typeof(setProcessImg)=="function")setProcessImg(0,"");if(data=="1"){loadExamsSummaryAll();}},"");}}
stopClickBubble();}
function setResetStart(s){setResetValues('All',s);}
function cn_progess_notes(op){if(user_type!=1&&logged_user_type!=6){return;}
var sv_per=((elem_per_vo=="1")||((finalize_flag=="1")&&(isReviewable!="1")))?0:1;if(op==2){$("#dv_cn_progess_notes").remove();return;}
if(typeof(setProcessImg)!='undefined')setProcessImg(1,"btnPrgs");var params="";var f=$("#elem_masterId");params+="&elem_formId="+f.val();var p=$("#elem_patientId");params+="&elem_patientId="+p.val();var d=$("#elem_dos");params+="&elem_dos="+d.val();params+="&sv_per="+sv_per;if(op==3){var prv_frm_id=$("#el_all_prg_note").val();params+="&load_prev_prog="+prv_frm_id;}
var url="requestHandler.php?elem_formAction=get_cn_progess_notes";if(op==4){params+="&op=print";$.get(url+params,function(d){if(typeof(setProcessImg)!='undefined')setProcessImg(0,"btnPrgs");if(d){top.fmain.showOtherForms(zPath+'/../library/html_to_pdf/createPdf.php?file_location='+d,'print_plan_win','1000','400');}else{top.fAlert('No progress note exists');}});return;}
if(op==1){params+="&op=save";params+="&txt="+$("#el_cpn_txt").val();$.post(url,params,function(d){if(typeof(setProcessImg)!='undefined')setProcessImg(0,"btnPrgs");cn_progess_notes(2);});return;}
$.get(url+params,function(d){if(typeof(setProcessImg)!='undefined')setProcessImg(0,"btnPrgs");cn_progess_notes(2);$("body").append("<div id=\"dv_cn_progess_notes\" class=\"modal-dialog modal-lg\"><div class=\"modal-content\"><div class=\"modal-header bg-primary\"><button type=\"button\" class=\"close\" onclick=\"cn_progess_notes(2)\"></button><h4 class=\"modal-title\">Progress Note</h4></div><div class=\"modal-body\">"+d+"</div></div></div>");});}
function AfterSave(obj){var exm=obj.Exam.toLowerCase();if(exm=="ee"){exm="external";}else if(exm=="iop"||exm=="gonio"){exm="iop_gon";}else if(exm=="rv"){exm="fundus_exam";}else if(exm=="vf-gl"||exm=="oct-rnfl"){exm="vf_oct_gl";if($("#vf_oct_gl").length<=0){return;}}
loadExamsSummary(exm);if(exm=="eom"){loadExamsSummary("dv_cpctrl");loadExamsSummary("dv_stereopsis");loadExamsSummary("dv_w4dot");}
if(exm=="fundus_exam"){z_flg_diab_sb="3";sb_checkDiabetes();var ir_as=obj.arDrawInter[0],ir_dx=obj.arDrawInter[1],ir_pln=obj.arDrawInter[2],ir_dxid=obj.arDrawInter[3];addAssessOption(ir_as,ir_pln,0,"OU","",ir_dx,'','',ir_dxid);}
var arrMain=[];if(obj.arExamDone!=null&&obj.arExamDone.length>0){var arED=obj.arExamDone;var len=arED.length;var valEye,chkExm_org,tmp;for(var i=0;i<len;i++){tmp=arED[i].split("~*~");chkExm_org=$.trim(tmp[0])||"";valEye=$.trim(tmp[1])||"";if(chkExm_org!=""){arrMain[arrMain.length]=[chkExm_org,valEye];}}}
len=arrMain.length;for(var i=0;i<len;i++){chkExm=arrMain[i][0];valEye=arrMain[i][1];setAssessOption(chkExm,false,valEye,len);}
mandotry_chk('1');}
function get_MedList(num)
{if(typeof(setProcessImg)!='undefined')setProcessImg("1","elem_ptVisit_chk");$.get(top.JS_WEB_ROOT_PATH+"/interface/chart_notes/requestHandler.php?elem_formAction=show_med_list"+num,function(data){if(typeof(setProcessImg)!='undefined')setProcessImg("0","elem_ptVisit_chk");$("body").append(data);if(num==1){$("#medicationDiv").show();}
if(num==6){$("#surgeryDiv").show();}});}
function getMedHx()
{if(typeof(setProcessImg)!='undefined')setProcessImg("1","divOcMeds");$.get(top.JS_WEB_ROOT_PATH+"/interface/chart_notes/onload_wv.php?elem_action=GetMedHx",function(data){if(typeof(setProcessImg)!='undefined')setProcessImg("0","divOcMeds");$("#divOcMeds").html(data);});}
var SxWinObj=false;function openMedHX(op,winH)
{if(op=="medication"||op=="medication_grid"){var ec=$("#tbl_ocu_grid").data("edit_chart"),prv_frmid="0";if(op=="medication_grid"&&typeof(ec)!="undefined"&&ec==1){if(elem_per_vo=='1'||((finalize_flag=="1")&&(isReviewable!="1"))){}else{prv_frmid=$("#elem_masterId").val();}}
divH=winH-130;winH=winH-100;window.open(top.JS_WEB_ROOT_PATH+"/interface/Medical_history/index.php?showpage=medication&callFrom=WV"+(op=='medication_grid'?'&subcall=grid':'')+"&divH="+divH+"&prv_frmid="+prv_frmid+"",'Medications','height='+winH+',width=1400,top=10,left=20,status=1');}
else if(op=="sxPro"||op=="sxPro2"){divH=winH-230;winH=winH-150;flgSxIco=(op=="sxPro2")?"1":"0";var w=document.body.clientWidth;SxWinObj=window.open(top.JS_WEB_ROOT_PATH+"/interface/Medical_history/index.php?showpage=sx_procedures&callFrom=WV&divH="+divH+"&flgSxIco="+flgSxIco,'Sx Procedures','height='+winH+',width='+w+',top=10,left=20,status=1');}
else if(op=="allergies"){divH=winH-230;winH=winH-150;window.open(top.JS_WEB_ROOT_PATH+"/interface/Medical_history/index.php?showpage=allergies&callFrom=WV&divH="+divH+"",'Allergies','height='+winH+',width=1060,top=10,left=20,status=1');}}
function gebi(id,t)
{var o;if(t==1){o=document.getElementsByName(id);}else if(t==2){o=document.getElementsByTagName(id);}else{o=document.getElementById(id);if(o==null){o=document.getElementsByName(id)[0];}}
return o;}
var tkGenHlth;function showMedList(id,frld)
{if(typeof(gebi)=="undefined")return;if(id==1){var o=gebi('medicationDiv');if(o){o.style.display='block';}else{get_MedList(1);}}
if(id==6){if(gebi('surgeryDiv')){gebi('surgeryDiv').style.display='inline';}else{get_MedList(6);}}
if(id=="PMH"){if(gebi('genHealthDiv_wv')){if(gebi('genHealthDiv_wv').innerHTML==""||frld==1){if(typeof(setProcessImg)!='undefined')setProcessImg("1","genHealthDiv_wv");$('#genHealthDiv_wv').load('onload_wv.php',{'elem_action':'GetGenHealth'},function(){if(gebi('genHealthDiv_wv').innerHTML!=""){if(typeof(setProcessImg)!='undefined')setProcessImg("0","genHealthDiv_wv");$('#genHealthDiv_wv').modal("show");set_modal_height($('#genHealthDiv_wv'));$('#genHealthDiv_wv').find('select.selectpicker').selectpicker();$('#genHealthDiv_wv').find("input.datepicker").datepicker({dateFormat:z_js_dt_frmt});clearTimeout(tkGenHlth);if(isERPPortalEnabled&&!postpone_pghd){setTimeout(function(){load_pghd_chart_reqs();},1000);}}});}
else{if(gebi('genHealthDiv_wv').innerHTML!=""){$('#genHealthDiv_wv').modal("show");clearTimeout(tkGenHlth);if(isERPPortalEnabled&&!postpone_pghd){setTimeout(function(){load_pghd_chart_reqs();},1000);}}}}}}
function load_pghd_chart_reqs(){var oPUF=(typeof(top.oPUF)!="undefined")?top.oPUF:top.fmain.oPUF;var n="pghd_reqs";if(!oPUF[n]||!(oPUF[n].open)||(oPUF[n].closed==true)){oPUF[n]=window.open(top.JS_WEB_ROOT_PATH+"/interface/Medical_history/get_pghd_req_med_hx.php?callFrom=WV",n,'location=1,status=1,resizable=1,left=10,top=1,scrollbars=1,width=1000,height=500');oPUF[n].focus();}else{oPUF[n].focus();}}
function hideMedListExe(id,frc)
{if(id==1){var o=gebi('medicationDiv');if(o)o.style.display='none';}
if(id==6){$('#surgeryDiv').fadeOut('fast');}
if(id=="PMH"){if((tkGenHlth)||(frc==1)){if(document.getElementById('genHealthDiv_wv')){$('#genHealthDiv_wv').modal('hide');}
clearTimeout(tkGenHlth);}}}
function hideMedList(id)
{if(id==1){if(typeof(gebi)=="undefined")return;var o=gebi('medicationDiv');if(o)o.style.display='none';}
if(id==6){$('#surgeryDiv').fadeOut('fast');}
if(id=="PMH"){tkGenHlth=setTimeout("hideMedListExe('"+id+"')",500);}}
function showAllergy(val)
{$("#allergies_patient").remove();if(val==1){var url=top.JS_WEB_ROOT_PATH+"/interface/chart_notes/requestHandler.php";var params="elem_formAction=PtAllergy";if(typeof(setProcessImg)=="function")setProcessImg("1","btn_allergy");$.post(url,params,function(data){if(typeof(setProcessImg)=="function")setProcessImg(0,"btn_allergy");if(data!=""){$("body").append(""+data);$('#allergies_patient').show();}},"");}}
function sc_showExamDetails(inx,mval){var symp=todoId=searchVal="";if(inx=="menu"){if(typeof(mval)=="undefined"||mval==""){return;}
searchVal=symp=encodeURI(mval);}else{var symp=$(":hidden[name=elem_symptom_"+inx+"]").val();searchVal=symp=encodeURI(symp);var todoId=$(":hidden[name=elem_todoid_"+inx+"]").val();if(typeof(todoId)=="undefined"||todoId==""){todoId="";}}
var vicd10=$("#hid_icd10").val();if(typeof(vicd10)=="undefined"){if(window.opener&&window.opener.top.fmain){vicd10=window.opener.top.fmain.$("#hid_icd10").val();}}
var dos=$("#elem_dos").val();if(typeof(dos)=="undefined"){if(window.opener&&window.opener.top.fmain){dos=window.opener.top.fmain.$("#elem_dos").val();}}
var url=top.JS_WEB_ROOT_PATH+'/interface/chart_notes/requestHandler.php';var params="elem_formAction=SmartChartDetail&symp="+symp+"&todoId="+todoId+"&searchVal="+searchVal+"&empty_symp_allow=1&icd10="+vicd10+"&dos="+dos;$("#div_sc_con_detail").modal('hide');if(typeof(setProcessImg)!='undefined')setProcessImg("1","div_sc_con");$.get(url,params,function(data){if(typeof(setProcessImg)!='undefined')setProcessImg("0","div_sc_con");if(data!=""){if($('#div_sc_con_detail').length>0){$("#div_sc_con_detail").modal('hide');$('#div_sc_con_detail, .modal-backdrop').remove();}
$("body").append(data);$("#div_sc_con_detail").modal('show');$(".dacry input[type=text], .lacsci input[type=text], .ctmri input[type=text]").datepicker();utElem_setBgColor("div_sc_con_detail");$("#div_sc_con_detail textarea, #div_sc_con_detail input[type=text]").bind("focus",function(){if(!$(this).hasClass("ui-autocomplete-input")){cn_ta1_no_assess(this,'');};});newET_setGray_v3();}else{top.fAlert("No Assessment policy defined.");}});}
function sc_check_bl(obj){var flg=0;var nm_2="";$("#d_"+obj+"_od :input").each(function(i){if(this.type=="button"){return;}
nm_2=this.name.replace(/Od/g,"Os");if($("#d_"+obj+"_os :input[name="+nm_2+"]").length==0){if(this.value=="RUL"){nm_2=nm_2.replace(/rul/g,"lul");}
else if(this.value=="RLL"){nm_2=nm_2.replace(/rll/g,"lll");}}
if(this.type=="checkbox"){$("#d_"+obj+"_os :input[name="+nm_2+"]").prop("checked",this.checked).each(function(){utElem_capture(this);});if(this.checked&&flg==0){$("#d_"+obj+"_os :input[name="+nm_2+"]").triggerHandler("click");flg=1;}}else{$("#d_"+obj+"_os :input[name="+nm_2+"]").val(this.value).each(function(){utElem_capture(this);});if($.trim(this.value)!=""&&flg==0){$("#d_"+obj+"_os :input[name="+nm_2+"]").triggerHandler("click");flg=1;}}});}
function sc_insertMultiPlan1(indx){var strOrderId='';var str='';if($("#sc_elem_assess"+indx).length>0&&$("#sc_elem_assess"+indx).prop("checked")==false){if($('form[name=frmSC_Exam]  :checked[name*=elem_multiPlanSCPop'+indx+'][type=checkbox]').length>0){$("label[for=sc_elem_assess"+indx+"]").trigger("click");}}
$('form[name=frmSC_Exam]  :checked[name*=elem_multiPlanSCPop'+indx+']').each(function(){if(""+this.name.indexOf("_eye")==-1){var val=""+this.value;if(this.id.indexOf("elem_multiPlanSCPop"+indx+"_OrdrS")!=-1){var tmpsep="~!~||~!~";if(val.indexOf(tmpsep)!=-1){var arrVal=val.split(tmpsep);val=''+arrVal[0]+'';if(typeof(arrVal[1])&&arrVal[1]!=""){var tmpid=this.id;var tmpidsig=tmpid+"_sig";var tmpsig=$('select[name='+tmpidsig+']').val();if(typeof(tmpsig)=="undefined"){tmpsig="";}
tmpsig=$.trim(tmpsig);if(tmpsig!=""){var oOdrNm=$(this).attr("data-ordernm");if(typeof(oOdrNm)=="undefined"){oOdrNm="";}
if(oOdrNm!=""){val=val.replace(oOdrNm,oOdrNm+" "+tmpsig+"");}
arrVal[1]+="~!~|sig|~!~"+tmpsig;}
var tmpideye=tmpid+"_eye";var tmpeye=$(':checked[name='+tmpideye+']').val();if(typeof(tmpeye)=="undefined"){tmpeye="";}
if(tmpeye!=""){var oOdrNm=$(this).attr("data-ordernm");if(typeof(oOdrNm)=="undefined"){oOdrNm="";}
if(oOdrNm!=""){val=val.replace(oOdrNm,oOdrNm+" ("+tmpeye+")");}
arrVal[1]+="~!~|eye|~!~"+tmpeye;}
strOrderId+=""+arrVal[1]+",";}}}
if(val!=''){str+=''+val+'\n';}}});str=$.trim(str);$('form[name=frmSC_Exam] #sc_elem_plan_ap'+indx+'').val(str);$('form[name=frmSC_Exam] :input[name="elem_sc_orderids'+indx+'"]').val(strOrderId);}
function sc_searchExam(ob){var v=ob.innerHTML;if(typeof(v)!="undefined"){sc_showExamDetails('menu',v);$(".selector").menu("blur");$(".selector").menu("collapseAll",null,true);$('#div_sc_con #sc_menu_exams').hide();}}
function getSmartChartPopUp(){if(top.fmain==null)return;var vIsFin=top.fmain.$(":input[name='elem_isFormFinalized']").val();var vIsRev=top.fmain.$(":input[name='elem_isFormReviewable']").val();if(vIsFin==1&&vIsRev==0){top.fAlert("Chart note is finalized and is not reviewable.");return;}
if((elem_per_vo=="1")||((finalize_flag=="1")&&(isReviewable!="1"))){return;}
var url=top.JS_WEB_ROOT_PATH+"/interface/chart_notes/smart_charting.php";var params="elem_formAction=SmartChartPopUp";var dos=$("#elem_dos").val();params+="&dos="+dos;if(typeof(setProcessImg)!='undefined'){setProcessImg("1","bodyMP",0,0);}
$.post(url,params,function(data){top.$("#tl_smc .icon24").attr("disabled",false);if(typeof(setProcessImg)!='undefined')setProcessImg("0","bodyMP");var armenu=data.armenu;data=data.str;if(data!=""){if($('#div_sc_con_detail1').length>0){if($('#div_sc_con_detail1').next('style').length>0){$('#div_sc_con_detail1').next('style').remove();}
$('#div_sc_con_detail1').remove();}
$("body").append(data);$('#div_sc_con_detail1').modal('show');var typeahead_search=$("#elem_search_symptopms").typeahead();typeahead_search.data('typeahead').source=armenu;typeahead_search.data('typeahead').updater=function(item){var v=item;sc_showExamDetails('menu',v)
return item;};$('body').on('click','.dropdown-submenu a',function(e){var window_attr={};window_attr.width=$(window).width();window_attr.height=$(window).height();var current_elem=$(this);var next_ul=$(this).next('ul');$(this).next('ul').toggle();e.stopPropagation();e.preventDefault();});}else{top.fAlert("No Assessment policy defined.");}},"json");}
function sc_saveExamDetail(ob){var val=ob.value;if(val=="Reset"){$("#div_sc_con_detail input[type=text], #div_sc_con_detail select, #div_sc_con_detail textarea").val("");$("#div_sc_con_detail :checked").each(function(){$(this).trigger("click");});$("#div_sc_con_detail form").append("<input type=\"hidden\" id=\"elem_exm_find_pop_reset\" name=\"elem_exm_find_pop_reset\" value=\"1\">");return;}else if(val=="Done"){var url="saveCharts.php";if(typeof(setProcessImg)!='undefined')setProcessImg("1","div_sc_con_detail");var drw_symp=$("form[name=frmSC_Exam] :hidden[name=elem_drawingSymp]").val();if(typeof(drw_symp)!="undefined"&&drw_symp==""){drw_symp=0;}
var vicd10=$("#hid_icd10").val();if(typeof(vicd10)=="undefined"){if(window.opener&&window.opener.top.fmain){vicd10=window.opener.top.fmain.$("#hid_icd10").val();}}
var flgDoNotSave=0;if(drw_symp==1){var examNameCalled=""+$("form[name=frmSC_Exam] input[name=elem_examNameCalled]").val();var temp_check_exam_name=""+$("form[name=frmSC_Exam] input[name=elem_temp_check_exam_name]").val();if(examNameCalled==temp_check_exam_name){if(typeof(setProcessImg)!='undefined')setProcessImg("0","div_sc_con_detail");var tmp_eye_od=0,tmp_eye_os=0,subExamDivId="";$("form[name=frmSC_Exam] .symOpt1 :input").each(function(indx){var tmpid=""+this.id;if(typeof(tmpid)=="undefined"||tmpid==""){tmpid=""+this.name;}
tmpid=tmpid.replace(/_drwpusx/g,'');tmpid_target=tmpid.replace("_duplicate","");if(this.type=="checkbox"||this.type=="radio"){if(this.checked==true){if(this.name.toLowerCase().indexOf("od_")!=-1||this.name.indexOf("Od")!=-1){tmp_eye_od=1;}
if(this.name.toLowerCase().indexOf("os_")!=-1||this.name.indexOf("Os")!=-1){tmp_eye_os=1;}
if($("#"+tmpid_target).length>0){$("#"+tmpid_target).each(function(){if(!this.checked){this.click();utElem_capture(this);checkwnls(this);}if(this.checked){checkwnls(this);}});if(subExamDivId==""){subExamDivId=$("#"+tmpid_target).parents(".subExam").attr("id");}}else if($(":input[name="+tmpid_target+"]").length>0){$(":input[name="+tmpid_target+"]").each(function(){if(!this.checked){this.click();utElem_capture(this);}if(this.checked){checkwnls(this);}});if(subExamDivId==""){subExamDivId=$(":input[name="+tmpid_target+"]").parents(".subExam").attr("id");}}}}else{if($.trim(this.value)!=""){if(this.name.toLowerCase().indexOf("od_")!=-1||this.name.indexOf("Od")!=-1){tmp_eye_od=1;}
if(this.name.toLowerCase().indexOf("os_")!=-1||this.name.indexOf("Os")!=-1){tmp_eye_os=1;}
if($("#"+tmpid_target).length>0){$("#"+tmpid_target).val(""+this.value).each(function(){this.click();utElem_capture(this);checkwnls(this);});if(subExamDivId==""){subExamDivId=$("#"+tmpid_target).parents(".subExam").attr("id");}}else if($(":input[name="+tmpid_target+"]").length>0){$(":input[name="+tmpid_target+"]").val(""+this.value).each(function(){this.click();utElem_capture(this);checkwnls(this);});if(subExamDivId==""){subExamDivId=$(":input[name="+tmpid_target+"]").parents(".subExam").attr("id");}}}}});if(subExamDivId!=""){top.window.status="Please save changes from Done button!";}
var tmp_comm=""+$("form[name=frmSC_Exam] :input[name=sc_elem_comments]").val();tmp_comm=$.trim(tmp_comm);if(tmp_comm!=""&&subExamDivId!=""){$("#"+subExamDivId+" textarea[name*=AdOptions]").each(function(idx){if(this.value!=""){this.value+=", ";}
this.value+=""+tmp_comm;if(typeof(this.onblur)=="function"){this.onblur();}});}
var f_clck=0;var ln=$("form[name=frmSC_Exam] :input[name*=sc_elem_assess]").length;for(var i=1;i<=ln;i++){var tmp_assmt="",tmp_plan="",tmp_eye="",tmp_dx="";var o_assmt=$("form[name=frmSC_Exam] :input[name=sc_elem_assess"+i+"]");if(o_assmt.prop("type")=="checkbox"&&o_assmt.prop("checked")==true){}
else if(o_assmt.prop("type")=="textarea"&&o_assmt.val()!=""){}
else{continue;}
tmp_assmt=""+$("form[name=frmSC_Exam] :input[name=sc_elem_assess"+i+"]").val();tmp_plan=""+$("form[name=frmSC_Exam] textarea[name=sc_elem_plan"+i+"]").val();tmp_plan_ap=""+$("form[name=frmSC_Exam] #sc_elem_plan_ap"+i+"").val();if(tmp_plan_ap!=""&&tmp_plan_ap!="undefined"){if(tmp_plan!=""&&tmp_plan!="undefined"){tmp_plan=tmp_plan+"\n";}tmp_plan=tmp_plan+tmp_plan_ap;}
tmp_dx=""+$("form[name=frmSC_Exam] :input[name=sc_elem_dxcode"+i+"]").val();if(typeof(tmp_dx)=="undefined"||tmp_dx=="undefined"){tmp_dx="";}
if(tmp_eye_od==1&&tmp_eye_os==1){tmp_eye="OU";}else if(tmp_eye_od==1){tmp_eye="OD";}else if(tmp_eye_os==1){tmp_eye="OS";}
if(tmp_assmt!=""||tmp_plan!=""){window.opener.top.fmain.zSaveWithoutPopupSave=1;window.opener.top.fmain.addAssessOption(""+tmp_assmt,""+tmp_plan,0,""+tmp_eye,0,""+tmp_dx);f_clck=1;}}
if(f_clck==1){window.opener.top.$("#save").trigger("click");}
flgDoNotSave=1;}}
if(flgDoNotSave==0){$("#div_sc_con_detail .greyAll_v2").each(function(){if(this.type=="checkbox"&&this.checked){this.checked=false;}else if(this.type=="text"||this.type=="textarea"||this.type=="select-one"){this.value="";}});var params=$("form[name=frmSC_Exam]").serialize();params+="&elem_saveForm=Smart Charting_v6";params+="&hid_icd10="+vicd10;$("#div_sc_con_detail input:checkbox").not(":checked").each(function(){params+="&"+this.name+"=";});params=params.replace(/_drwpusx/g,'');$.post(url,params,function(data){if(typeof(setProcessImg)!='undefined')setProcessImg("0","div_sc_con_detail");if(data.AP){var ln=data.AP["A"].length;for(var i=0;i<ln;i++){if(data.AP["A"][i]&&typeof(data.AP["A"][i])!="undefined"&&data.AP["A"][i]!=""){if(drw_symp==0){addAssessOption(""+data.AP["A"][i],""+data.AP["P"][i],0,""+data.AP["EYE"][i],"",data.AP["DX"][i],data.AP["ORDERIDS"][i],'',data.AP["DXID"][i]);}else{window.opener.top.fmain.addAssessOption(""+data.AP["A"][i],""+data.AP["P"][i],0,""+data.AP["EYE"][i],"",data.AP["DX"][i],data.AP["ORDERIDS"][i],'',data.AP["DXID"][i]);}}}}
if(data.FU){var ln=data.FU.length;for(var i=0;i<ln;i++){if(""+$.trim(data.FU[i]["number"])!=""||""+$.trim(data.FU[i]["time"])!=""||""+$.trim(data.FU[i]["visit_type"])!=""){if(drw_symp==0){fu_addOpts(""+data.FU[i]["number"],""+data.FU[i]["time"],""+data.FU[i]["visit_type"]);}else{window.opener.top.fmain.fu_addOpts(""+data.FU[i]["number"],""+data.FU[i]["time"],""+data.FU[i]["visit_type"]);}}}}
if(drw_symp==0){top.fmain.zSaveWithoutPopupSave=1;top.$("#save").trigger("click");loadExamsSummaryAll();}else{window.opener.top.fmain.zSaveWithoutPopupSave=1;window.opener.top.$("#save").trigger("click");window.opener.top.fmain.loadExamsSummaryAll();}
hide_modal("div_sc_con_detail");},"json");}else{hide_modal("div_sc_con_detail");}}else{hide_modal("div_sc_con_detail");}}
function showPhyNotes(val,evnt){$('[id^=physician_notes_div]').each(function(id,elem){$(elem).remove();});if(val==1){$.ajax({type:'POST',url:top.JS_WEB_ROOT_PATH+'/interface/chart_notes/physician_notes.php?ajax_request=yes&get_modal=yes',success:function(response){$("body").append(""+response);$('#physician_notes_div').show();}});}}
function donePtLExam(str){$("#tdPtLExam").html("L. Exm. "+str);}
function close_gh_window(){$('#genHealthDiv_wv').modal("hide");}
function ptInfoReviewed()
{if((finalize_flag==1&&isReviewable==0)||elem_per_vo=="1"){return;}
hideMedListExe("PMH",1);var o=top.fmain;var oFrmRewSt=o.gebi("elem_isFormReviewable");var oFrmFinz=o.gebi("elem_isFormFinalized");var oMasterId=o.gebi("elem_masterId");var mId="";var prm="elem_formAction=genHealthReviewd";if((oFrmFinz.value!="1")||(oFrmRewSt.value=="1")){if(typeof oMasterId.value!="undefined")mId=oMasterId.value;var msg_ownr=$("#tr_ownership_msg").data("msg");if(typeof(msg_ownr)!="undefined"&&msg_ownr!=""){prm+="&elem_owner_msg="+msg_ownr;}}
prm+="&elem_mId="+mId;$.post(top.JS_WEB_ROOT_PATH+'/interface/chart_notes/requestHandler.php',""+prm,function(data){if(data){if(data.noti_genhealth){$(".okayNav #general_health").removeClass();$(".okayNav #general_health").addClass(""+data.noti_genhealth);}
donePtLExam(data.tmp);close_gh_window();if(typeof(msg_ownr)!="undefined"&&msg_ownr!=""){var cc=$("#elem_ccompliant").val();cc=$.trim(cc);var ptrn="HPI was performed by([\\w ]+)\.";cc=regReplace(ptrn,"",cc);if(cc!=""){cc=cc+"\n";}
if(msg_ownr){cc=cc+msg_ownr;}
$("#elem_ccompliant").val(cc);if(data.proid){$("#elem_pro_id").val(data.proid);}
if(data.pro_nm){$("#elem_pro_name").val(data.pro_nm);}
if(data.cosignid){$("#elem_cosigner_id").val(data.cosignid);}
if(data.cosign_nm){$("#elem_cosigner_name").val(data.cosign_nm);}
$("#elem_ccompliant, #elem_chk").trigger("click");$("#elem_painCc").trigger("change");$("#elem_neuroPsych").trigger("click");}
top.$("#save").trigger("click");}},"json");}
function bind_datepicker()
{$("input.datepicker").datepicker({timepicker:false,format:top.jquery_date_format,maxDate:new Date(),autoclose:true,scrollInput:false});}
function getMRinfo_SC(){var sod="",sos="",cod="",cos="",aod="",aos="",tm="";var a=0;b=0;tm=0;$("#Vision input[name*=elem_mrNoneGiven").each(function(){var x=this.name.replace(/elem_mrNoneGiven/,"");var othr="";sfx="";if(x>1){othr="Other";if(x>2){sfx="_"+x;}}
var y=$("#Vision input[name=elem_providerName"+othr+sfx+"][class*=active]").length;if(this.checked&&y>0){if(a<x){a=x;}}else if(y>0){if(b<x){b=x;}}});if(a>0){tm=a;}
else if(b>0){tm=b;}
if(tm>0){var othr="";sfx="";if(tm>1){othr="Other";if(tm>2){sfx="_"+tm;}}
if($("#Vision input[name=elem_visMr"+othr+"OdS"+sfx+"]").length>0){sod=$("#Vision input[name=elem_visMr"+othr+"OdS"+sfx+"]").val();}
if($("#Vision input[name=elem_visMr"+othr+"OdC"+sfx+"]").length>0){cod=$("#Vision input[name=elem_visMr"+othr+"OdC"+sfx+"]").val();}
if($("#Vision input[name=elem_visMr"+othr+"OdA"+sfx+"]").length>0){aod=$("#Vision input[name=elem_visMr"+othr+"OdA"+sfx+"]").val();}
if($("#Vision input[name=elem_visMr"+othr+"OsS"+sfx+"]").length>0){sos=$("#Vision input[name=elem_visMr"+othr+"OsS"+sfx+"]").val();}
if($("#Vision input[name=elem_visMr"+othr+"OsC"+sfx+"]").length>0){cos=$("#Vision input[name=elem_visMr"+othr+"OsC"+sfx+"]").val();}
if($("#Vision input[name=elem_visMr"+othr+"OsA"+sfx+"]").length>0){aos=$("#Vision input[name=elem_visMr"+othr+"OsA"+sfx+"]").val();}}
return{"sod":sod,"sos":sos,"cod":cod,"cos":cos,"aod":aod,"aos":aos};}
function updateADTime(w){var saveForm="";w=$.trim(w);if(w==""||elem_per_vo=='1'||((finalize_flag=="1")&&(isReviewable!="1"))){return;}
if(w=="Anes"){saveForm="updateAnesTime";}else if(w=="Dial"){saveForm="updateDialTime";}else if(w=="OOD"){saveForm="updateOODTime";}
if(saveForm==""){return;}
var wP="tdTitleIop";var Digital=new Date();var hours=Digital.getHours();var minutes=Digital.getMinutes();var seconds=Digital.getSeconds();var dt=Digital.getDate();if(dt<9){dt="0"+dt;}
var mnth=Digital.getMonth();mnth+=1;if(mnth<9){mnth="0"+mnth;}
var year=Digital.getFullYear();var dn="PM"
if(hours<12)
dn="AM"
if(hours>12)
hours=hours-12
if(hours==0)
hours=12
if(minutes<=9)
minutes="0"+minutes
if(seconds<=9)
seconds="0"+seconds
var ctime=hours+":"+minutes+dn
var cdt=mnth+"-"+dt+"-"+year;var url="saveCharts.php";var params="elem_saveForm=updateIOPTime";var f=gebi("elem_masterId");params+="&elem_formId="+f.value;params+="&w="+w;var p=gebi("elem_patientId");params+="&elem_patientId="+p.value;params+="&elem_newTime="+ctime;params+="&elem_newdt="+cdt;if(typeof(setProcessImg)!='undefined')setProcessImg("1",wP);$.post(url,params,function(data){if(typeof(setProcessImg)!='undefined')setProcessImg("0",wP);loadExamsSummary("iop_gon");});}
function showPrvSynthesis(tst,tid,intrprt){if(tst=="x"){return;}else if(tst=="VF-GL"){var divid="dv_vf_gl";var divsyn="dv_syn_vf_gl";}else if(tst=="OCT-RNFL"){var divid="dv_oct_rnfl";var divsyn="dv_syn_oct_rnfl";}
var op="";if(typeof(intrprt)!="undefined"&&intrprt==1){op="Interpret";}
if(typeof(setProcessImg)!='undefined')setProcessImg(1,divid);$.get("saveCharts.php?elem_saveForm=showPrvSynthesis&tst="+tst+"&tid="+tid+"&op="+op,function(data){if(typeof(setProcessImg)!='undefined')setProcessImg(0,divid);if(op=="Interpret"){if(data==1){if(typeof(setProcessImg)!='undefined'){setProcessImg(1,"","Test is interpreted.","","",1800);}$("input[type=button][name='elem_btn"+tst+"Rwd']").hide();}else{top.fAlert("Error: Test is NOT interpreted.");}}else{if(data!=""){$("body").append(data);$('#modal_prev_synth').modal('show');}}});}
function tests_interpret(tst,tid){showPrvSynthesis(tst,tid,1);}
function go_test_tab(){top.$("#Tests").click();}
function getMemoTable(arrVal,addIndx,dfdt){var oTblCntr=gebi("elem_cntrTableMemo");var currRowId=((typeof oTblCntr.value!="undefined")&&(oTblCntr.value!=""))?parseInt(oTblCntr.value)+1:1;var url=zPath+"/chart_notes/requestHandler.php";var params="elem_formAction=add_memo&elem_cntrTableMemo="+currRowId;$.get(url,params,function(data){oTblCntr.value=currRowId;$("#memo_panel_grp").append(data);$(".date-pick").datepicker({dateFormat:z_js_dt_frmt});cn_typeahead();});}
function remMemoTable(remIndx){if(confirm("Are you sure you want to delete it?")){if(remIndx>1){$("#memo"+remIndx).remove();}else{$("#memo"+remIndx+" :input").val("");}}}
function openPatientProblemsList(){var url=zPath+"/Medical_history/problem_list/patient_problems_list_popup.php";var n="childWinArScan";top.fmain.showOtherForms(url,n,810,600,0);}
function showcCChxpop(){var chk=$('#cchx_link').attr('title');if(typeof(chk)=="undefined"){if(typeof(setProcessImg)!='undefined')setProcessImg(1,"cchx_link");$.get(zPath+"/chart_notes/requestHandler.php?elem_formAction=showcCChxpop",function(data){if(typeof(setProcessImg)!='undefined')setProcessImg(0,"cchx_link");$('#cchx_link').popover({container:'body',title:"<strong>CC & History</strong>",content:""+data,html:true,placement:"bottom",animation:false});$("#cchx_link").on('shown.bs.popover',function(o){var hgt=window.innerHeight;var popover_id=$(this).attr('aria-describedby');var ptop=$("#"+popover_id+"").css("top")||0;hgt=parseInt(hgt)-parseInt(ptop)-50;$("#"+popover_id+"").css({'max-width':'90%','z-index':'99999999'});$("#"+popover_id+" .popover-content").css({'height':hgt+"px","overflow":"auto"});});$('#cchx_link').popover('show');$('#cchx_link').popover('hide');$('#cchx_link').popover('show');});}else{$('#cchx_link').popover('toggle');}}
function ccHxDefStr(str,op){var ptrn="\\s*(A|An)?((\\s*[0-9]{1,3}\\s*(Yr\\.|Yrs\\.|Year|Years|Months|Days|Mon\\.))?(\\s*old)?)?\\s*(Male|Female|male|female)?\\s*(with\\s*history\\s*of|patient|with\\s*chief\\s*complaint\\s*of)?\\s*";var reg=new RegExp(ptrn,"gi");if(op==1){return str.replace(reg,"");}else{return reg;}}
function get_reff_address_v2(obj){obj.title="";var str=$.trim(obj.value);if(str!=""){$.get(top.JS_WEB_ROOT_PATH+"/interface/chart_notes/requestHandler.php?elem_formAction=get_reff_address_v2&refnm="+str,function(d){if(d!=""){obj.title=""+d;}else{obj.title="";}});}}
function ptProbList_fillInDxDesc(obj,pth){var str="";if(obj&&(typeof obj.value!="undefined")){str=obj.value;}
if(typeof pth=="undefined"||pth==""){if(typeof(zPath)=="undefined"){zPath="";}
pth=""+zPath;}
if(str==""||!isDxCorrectCode(str)){return;}
var url=pth+"/chart_notes/requestHandler.php";params="elem_formAction=Dx";params+="&elem_desc="+encodeURI(str);if(typeof(setProcessImg)!='undefined')setProcessImg("1",""+obj.name);$.post(url,params,function(data){if(typeof(setProcessImg)!='undefined')setProcessImg("0",""+obj.name);var xmlDoc=data;var arrDxCode=xmlDoc.getElementsByTagName("dxcode");var arrDxCodeDesc=xmlDoc.getElementsByTagName("dxcodedesc");var arrPqriCode=xmlDoc.getElementsByTagName("pqri");var oDxCode=(arrDxCode.length>0)?xmlDoc.getElementsByTagName("dxcode")[0]:null;var oDxCodeDesc=(arrDxCodeDesc.length>0)?xmlDoc.getElementsByTagName("dxcodedesc")[0]:null;if((oDxCodeDesc)&&(oDxCodeDesc.firstChild)){var tDx=oDxCodeDesc.firstChild.data;tDx+=' - '+oDxCode.firstChild.data;obj.value=""+tDx;}},"xml");}
function pt_g_hc(obj){$.ajax({url:top.JS_WEB_ROOT_PATH+'/interface/chart_notes/requestHandler.php',type:'post',data:{elem_formAction:'show_goals_hc'},beforeSend:function(r){top.show_loading_image('show','','Please wait, loading data...');},complete:function(){top.show_loading_image('hide');},success:function(res){if($("#pt_goal_health_modal",top.fmain.document).length>0){$("#pt_goal_health_modal",top.fmain.document).remove();}
$("body",top.fmain.document).append(res);$("#pt_goal_health_modal",top.fmain.document).find('select').selectpicker();$(".date-pick").datepicker({dateFormat:z_js_dt_frmt});$("#pt_goal_health_modal",top.fmain.document).modal('show');}});}
function pt_health(obj){$.ajax({url:top.JS_WEB_ROOT_PATH+'/interface/chart_notes/requestHandler.php',type:'post',data:{elem_formAction:'show_health_status'},beforeSend:function(r){top.show_loading_image('show','','Please wait, loading data...');},complete:function(){top.show_loading_image('hide');},success:function(res){if($("#pt_health_status_modal",top.fmain.document).length>0){$("#pt_health_status_modal",top.fmain.document).remove();}
$("body",top.fmain.document).append(res);$("#pt_health_status_modal",top.fmain.document).find('select').selectpicker();$(".date-pick").datepicker({dateFormat:z_js_dt_frmt});$("#pt_health_status_modal",top.fmain.document).modal('show');}});}
function delete_goal(id,index)
{if(id)
{$.ajax({url:top.JS_WEB_ROOT_PATH+'/interface/chart_notes/requestHandler.php',type:'post',data:{elem_formAction:'del_goal',record_id:id},beforeSend:function(r){top.show_loading_image('show','','Please wait, Deleting Record(s)...');},complete:function(){top.show_loading_image('hide');},success:function(res){var r=res.split('_');if(r[0]==1)
$("#goal_row_"+index).remove();top.fAlert(r[1]);}});}
else
{$("#goal_row_"+index).remove();}}
function add_goals(_this)
{var html='';var addBtnObj=$("#add_goal_btn");var p_index=addBtnObj.data('rows');var c_index=p_index+1;var delBtn='<span class="glyphicon glyphicon-remove pointer" onclick="delete_goal(\'\',\''+p_index+'\');"></span>';html+='<tr id="goal_row_'+c_index+'">';html+='<td class="col-xs-3">';html+='<input type="hidden" name="goal_id['+c_index+']" id="goal_id_'+c_index+'" value="" />';html+='<input type="text" class="form-control" name="goal_set['+c_index+']" id="goal_set_'+c_index+'" value="" />';html+='</td>';html+='<td class="col-xs-1">';html+='<input type="text" class="form-control" name="goal_code['+c_index+']" id="goal_code_'+c_index+'" value="" />';html+='</td>';html+='<td class="col-xs-1">';html+='<input type="text" class="form-control" name="goal_data_type['+c_index+']" id="goal_data_type_'+c_index+'" value="" maxlength="5" />';html+='</td>';html+='<td class="col-xs-3">';html+='<input type="text" class="form-control" name="goal_data['+c_index+']" id="goal_data_'+c_index+'" value="" />';html+='</td>';html+='<td class="col-xs-1">';html+='<input type="text" class="form-control" name="goal_unit['+c_index+']" id="goal_unit_'+c_index+'" value="" />';html+='</td>';html+='<td class="col-xs-1">';html+='<input type="hidden" class="form-control" name="goal_opr_id['+c_index+']" id="goal_opr_id_'+c_index+'" value="'+authUserID+'" />';html+='<input type="text" class="form-control" name="goal_opr_name['+c_index+']" id="goal_opr_name_'+c_index+'" value="'+authUserNM+'" readonly />';html+='</td>';html+='<td class="col-xs-1">';html+='<div class="input-group">';html+='<input type="text" class="form-control date-pick" name="goal_date['+c_index+']" id="goal_date_'+c_index+'" value="" />';html+='<label class="input-group-addon" for="goal_date_'+c_index+'"><i class="glyphicon glyphicon-calendar"></i></label>';html+='</div>';html+='</td>';html+='<td >&nbsp;</td>';html+='</tr>';$("#goal_row_"+p_index).find('td:last').html(delBtn);$("#goal_row_"+p_index).after(html);$("#goal_row_"+c_index).find('select.selectpicker').selectpicker();addBtnObj.data('rows',c_index);$(".date-pick").datepicker({dateFormat:z_js_dt_frmt});}
function save_goals()
{var formObj=$("#goalDataDiv",top.fmain.document).find('input, select');var formData=formObj.serialize()+'&elem_formAction=save_goal';$.ajax({url:top.JS_WEB_ROOT_PATH+'/interface/chart_notes/requestHandler.php',type:'post',data:formData,beforeSend:function(r){top.show_loading_image('show','','Please wait, Saving Record(s)...');},complete:function(){top.show_loading_image('hide');},success:function(res){$("#goalDataDiv",top.fmain.document).html(res).find('select').selectpicker();$(".date-pick").datepicker({dateFormat:z_js_dt_frmt});}});}
function add_health_status(type)
{var html='';var addBtnObj=$("#add_hs_btn_"+type);var p_index=addBtnObj.data('rows');var c_index=p_index+1;var delBtn='<span class="glyphicon glyphicon-remove pointer" onclick="del_pt_health_status(\'\',\''+p_index+'\',\''+type+'\');"></span>';html+='<tr id="hs_row_'+type+c_index+'">';html+='<td class="col-xs-3">';html+='<input type="hidden" name="'+type+'_id['+c_index+']" id="'+type+'_id_'+c_index+'" value="" />';html+='<input type="text" class="form-control" name="'+type+'_status_text['+c_index+']" id="'+type+'_status_text_'+c_index+'" value="" />';html+='</td>';html+='<td class="col-xs-1">';html+='<input type="text" class="form-control" name="'+type+'_ccd_code['+c_index+']" id="'+type+'_ccd_code_'+c_index+'" value="" />';html+='</td>';html+='<td width="10%">';html+='<div class="input-group">';html+='<input type="text" class="form-control date-pick" name="'+type+'_status_date['+c_index+']" id="'+type+'_status_date_'+c_index+'" value="" />';html+='<label class="input-group-addon" for="'+type+'_status_date_'+c_index+'"><i class="glyphicon glyphicon-calendar"></i></label>';html+='</div>';html+='</td>';html+='<td width="3%" >&nbsp;</td>';html+='</tr>';$("#hs_row_"+type+p_index).find('td:last').html(delBtn);$("#hs_row_"+type+p_index).after(html);$("#hs_row_"+type+c_index).find('select.selectpicker').selectpicker();addBtnObj.data('rows',c_index);$(".date-pick").datepicker({dateFormat:z_js_dt_frmt});}
function save_health_status()
{var formObj=$("#pt_health_status_data_div",top.fmain.document).find('input, select');var formData=formObj.serialize()+'&elem_formAction=save_health_status';$.ajax({url:top.JS_WEB_ROOT_PATH+'/interface/chart_notes/requestHandler.php',type:'post',data:formData,beforeSend:function(r){top.show_loading_image('show','','Please wait, Saving Record(s)...');},complete:function(){top.show_loading_image('hide');},success:function(res){$("#pt_health_status_data_div",top.fmain.document).html(res).find('select').selectpicker();$(".date-pick").datepicker({dateFormat:z_js_dt_frmt});}});}
function del_pt_health_status(id,index,type)
{if(id)
{$.ajax({url:top.JS_WEB_ROOT_PATH+'/interface/chart_notes/requestHandler.php',type:'post',data:{elem_formAction:'del_pt_health_status',record_id:id},beforeSend:function(r){top.show_loading_image('show','','Please wait, Deleting Record(s)...');},complete:function(){top.show_loading_image('hide');},success:function(res){var r=res.split('_');if(r[0]==1)
$("#hs_row_"+type+index).remove();top.fAlert(r[1]);}});}
else
{$("#hs_row_"+type+index).remove();}}
function enableField(_this)
{var obj=$("#goal_unit_"+$(_this).data('index'));if($(_this).val()=='range')
obj.prop('disable',false);else obj.prop('disable',true);}
function save_hc()
{var formObj=$("#hcDataDiv",top.fmain.document).find('input, select');var formData=formObj.serialize()+'&elem_formAction=save_hc';$.ajax({url:top.JS_WEB_ROOT_PATH+'/interface/chart_notes/requestHandler.php',type:'post',data:formData,beforeSend:function(r){top.show_loading_image('show','','Please wait, Saving Record(s)...');},complete:function(){top.show_loading_image('hide');},success:function(res){$("#hcDataDiv",top.fmain.document).html(res);$(".date-pick").datepicker({dateFormat:z_js_dt_frmt});}});}
function delete_hc(type,id,index,parent_index)
{type=type||'';parent_index=parent_index||'';index=index|'';var p_index=parent_index?parent_index+'_':'';var row='';if(type=='obs')row='hc_row_'+index;else if(type=='con')row='con_'+p_index+index;else if(type=='rel')row='rel_'+p_index+index;if(id)
{$.ajax({url:top.JS_WEB_ROOT_PATH+'/interface/chart_notes/requestHandler.php',type:'post',data:{'elem_formAction':'del_hc','type':type,'record_id':id},beforeSend:function(r){top.show_loading_image('show','','Please wait, Deleting Record(s)...');},complete:function(){top.show_loading_image('hide');},success:function(res){var r=res.split('_');if(r[0]==1&&index&&row)
$("#"+row).remove();top.fAlert(r[1]);}});}
else
{if(index&&row)
$("#"+row).remove();}}
function chart_set_attestation(indx){var btn="";if(indx==1){btn="btn_attest_scribe";}else if(indx==2){btn="btn_attest_attend_scribe";}else if(indx==3){btn="btn_attest_teach";}
if(btn!=""){var msg=$("#"+btn).data("msg");var attested=$("#"+btn).data("attested");var proId=authUserID;var formId=$("#elem_masterId").val();if((attested==""||typeof(attested)=="undefined")&&typeof(msg)!="undefined"&&msg!=""){if((finalize_flag!=1||isReviewable!=0)&&elem_per_vo!="1"){var url="saveCharts.php";param="elem_saveForm=setAttestation&proId="+proId+"&msg="+msg+"&formId="+formId+"&indx="+indx;$.post(url,param,function(data){$("#"+btn).removeClass("btn-warning").addClass("btn-success");$("#"+btn).data("attested","1");$("#"+btn).data("msg",""+msg);if(indx==3){$("input[name=elem_resiHxReviewd]").val(1);$("#assessplan #spnRxHxRvd").addClass("active");}});}}
if(msg!=""){$('#'+btn).popover('destroy');$('#'+btn).popover({'title':"",'content':""+msg,'html':true});$('#'+btn).popover('toggle');}}}
function change_attending_phy(o){var id=o.value;if(id!=""){if((finalize_flag!=1||isReviewable!=0)&&elem_per_vo!="1"){var formId=$("#elem_masterId").val();var url="saveCharts.php";param="elem_saveForm=setAttestation&new_pro_Id="+id+"&formId="+formId;if(typeof(setProcessImg)!='undefined')setProcessImg(1,"el_change_attending");$.post(url,param,function(data){if(typeof(setProcessImg)!='undefined')setProcessImg(0,"el_change_attending");if(data){if(data.btn_attest_scribe&&typeof(data.btn_attest_scribe)!="undefined"&&data.btn_attest_scribe!=""){$("#btn_attest_scribe").data("msg",""+data.btn_attest_scribe);}
if(data.btn_attest_attend_scribe&&typeof(data.btn_attest_attend_scribe)!="undefined"&&data.btn_attest_attend_scribe!=""){$("#btn_attest_attend_scribe").data("msg",""+data.btn_attest_attend_scribe);}}},"json");}}}
function rvs_sep_usr_coments(){var x1="",x2="";var x=$.trim($('#elem_ccompliant').val());var DBLCIRCLE=String.fromCharCode(9678);var w=x.indexOf(DBLCIRCLE);if(w!=-1){x1=x.substring(w);x1=$.trim(x1.replace(DBLCIRCLE,""));x2=$.trim(x.substring(0,w));}else if(x!=""){x2=x;}
return{'COM':x1,'CCHX':x2};}
function rvs_mk_cchx_readonly(){$('#elem_ccompliant').prop('readonly',true).bind('click',function(){var o_cchx_com=rvs_sep_usr_coments();var str_modal='<!-- Modal -->'+'<div id=\'cchxModal\' class=\'modal fade\' role=\'dialog\'>'+'<div class=\'modal-dialog modal-lg\'>'+'<!-- Modal content-->'+'<div class=\'modal-content\'>'+'<div class=\'modal-header\'>'+'<button type=\'button\' class=\'close\' data-dismiss=\'modal\'></button>'+'<h4 class=\'modal-title\'>Enter comments into chief complaint </h4>'+'</div>'+'<div class=\'modal-body\'>'+'<p>'+o_cchx_com.CCHX+'</p>'+'<p><textarea id=\'ta_ccHX_com_modal\' class=\'form-control\' rows=\'5\'>'+o_cchx_com.COM+'</textarea></p>'+'</div>'+'<div class=\'modal-footer\'>'+'<button type=\'button\' class=\'btn btn-success\' >Done</button>'+'<button type=\'button\' class=\'btn btn-danger\' data-dismiss=\'modal\'>Close</button>'+'</div>'+'</div>'+'</div>'+'</div>';$('body').append(str_modal);$('#cchxModal .btn-success').bind('click',function(){var x=$.trim($('#ta_ccHX_com_modal').val());var y=$.trim(o_cchx_com.CCHX);if(x!=""){if(y!=""){y+='\n';}
var DBLCIRCLE=String.fromCharCode(9678);y+=DBLCIRCLE+' '+x;}
$('#elem_ccompliant').val(y).triggerHandler('click');$('#cchxModal').modal('hide');});$('#cchxModal').modal({backdrop:false});$('#ta_ccHX_com_modal').focus();});}
function save_inpatient()
{var formObj=$("#inpatientDataDiv",top.fmain.document).find('input, select');var formData=formObj.serialize()+'&elem_formAction=save_inpatient';$.ajax({url:top.JS_WEB_ROOT_PATH+'/interface/chart_notes/requestHandler.php',type:'post',data:formData,beforeSend:function(r){top.show_loading_image('show','','Please wait, Saving Record(s)...');},complete:function(){top.show_loading_image('hide');},success:function(res){$("#inpatientDataDiv",top.fmain.document).html(res);}});}
function ptPayerModal(callFrom){if(callFrom=='')callFrom='get';switch(callFrom){case'get':$.ajax({url:top.JS_WEB_ROOT_PATH+'/interface/chart_notes/requestHandler.php?elem_formAction=getPtPayer',type:'GET',beforeSend:function(){top.show_loading_image('show');},success:function(response){if(response!=''){$('#patient_payer_modal').find('#patientPayerDiv').html(response);$('.selectpicker').selectpicker('refresh');$('.datePickIn').datepicker({dateFormat:"mm-dd-yy"});}},complete:function(){top.show_loading_image('hide');}});break;case'save':var dat=$("#patientPayerDiv").find('input,select').serialize();$.ajax({url:top.JS_WEB_ROOT_PATH+'/interface/chart_notes/requestHandler.php?elem_formAction=savePtPayer',data:dat,type:'POST',beforeSend:function(){top.show_loading_image('show');},success:function(response){if(response!=''){$('#patient_payer_modal').find('#patientPayerDiv').html(response);$('.selectpicker').selectpicker('refresh');$('.datePickIn').datepicker({dateFormat:"mm-dd-yy"});}},complete:function(){top.show_loading_image('hide');}});break;}}
function showAsHx(flg){if(flg==1){if($("#divAsHx").length<=0){var fid=$("#elem_masterId").val();if(typeof(setProcessImg)=="function")setProcessImg("1","assessplan");$.get("requestHandler.php",{"elem_formAction":"showAsHxNew","fid":fid},function(data){if(typeof(setProcessImg)=="function")setProcessImg("0","assessplan");if(data!=""){$("body").append(data);$("#divAsHx").css({"display":"block"});$("#divAsHx").draggable({handle:".panel-heading"})
$("#divAsHx .panel-body").css({'overflow':'auto','height':$(window).height()-50});$("#divAsHx .panel-heading").css({'cursor':'move'});}});}else{$("#divAsHx").show();}}else{$("#divAsHx").hide();}}
function update_toolbar_icon(){$.get("requestHandler.php",{"elem_formAction":"update_icons"},function(d){if(d){for(var a in d){if(d[a]!=null){$("li#"+a).removeClass("cbred cbgreen cborange").addClass(d[a]);}}}},'json');}
function show_ad_div(op){if(typeof(op)=="undefined"){op=0;}
if(op=="1"){hide_modal("advancedDirectiveModal");}
else if(op=="2"){var adoval=$("#ado_option").val();show_ad_div(1);if(typeof(setProcessImg)=="function")setProcessImg("1");$.post("saveCharts.php",{"elem_saveForm":"save_advance_directive","ado_option":""+adoval},function(d){if(typeof(setProcessImg)=="function")setProcessImg("0");if(typeof(d)!="undefined"&&d!=""){$("#ad_dir").html(d);}});}else{if(typeof(setProcessImg)=="function")setProcessImg("1");$.get("requestHandler.php?elem_formAction=get_adv_directive",function(d){if(typeof(setProcessImg)=="function")setProcessImg("0");if(d&&d!=""){$("body").append(d);$("#advancedDirectiveModal").modal("show");$("#advancedDirectiveModal .menu_advdirective a").bind("click",function(){$("#ado_option").val($(this).data("val"));});}});}}
function show_pop_up_pt_alert(msg){var a="divPtDemographicAlertWV";if(typeof(top.patient_pop_up)=="undefined"){top.patient_pop_up=new Array();}
if(msg!=""&&(jQuery.inArray(a,top.patient_pop_up)=="-1")){top.fAlert('<div style="max-height:450px;overflow-y:scroll;">'+msg+'</div>','Patient Notes');top.patient_pop_up[top.patient_pop_up.length]=a;}}
function hideWVSxDiv(id){var e=event;id=id||'';if(typeof id==='undefined')id='';if(!id)return;var container=$("#"+id);if(!container.is(e.target)&&container.has(e.target).length===0&&container.css('display')!=='none'){container.hide();}}
$(document).mouseup(function(e){hideWVSxDiv('surgeryDiv');});function show_iop_graphs(flg,vision){if(typeof(flg)!="undefined"&&flg==1){if($("#iol_graph_doc").length>0){$("#iol_graph_doc").remove();}else if(top.$("#iol_graph_doc").length>0){top.$("#iol_graph_doc").hide().remove();}return;}
if($("#iol_graph_doc").length<=0){var v=(typeof(vision)!="undefined"&&vision!="")?"&vision="+vision:"";$("body").append("<div id='iol_graph_doc'><iframe id=\"ifrm_iop_graph\" src=\""+zPath+"/chart_notes/view/iop_graphs.php?inc_glbl=1"+v+"\" border=\"0\" height=\"100%\" width=\"100%\" scrolling=\"0\"></iframe></div>");}$("#iol_graph_doc").show();}
function pging_cn_dig(st){if(isNaN(st)&&typeof(st.value)!="undefined"){st=st.value;}else if(isNaN(st)){st=0;}
var url=top.JS_WEB_ROOT_PATH+"/interface/chart_notes/requestHandler.php";$.get(url,{elem_formAction:"PtAtAGlancePopUp",limit_records:"1","st":st},function(resp){resp=$.parseJSON(resp);$('#pgd_showpop',top.fmain.document).html(resp.data)
if(typeof(top.fmain.setHgtGrpDiv)=='function'){top.fmain.setHgtGrpDiv();}
var sh=0;$('#pgd_showpop').find('table:not(:last-child)').each(function(){sh+=$(this).height();});$('#pgd_showpop .modal-body',top.fmain.document).scrollTop(0).scrollTop(sh-50);});stopClickBubble();}
function role_change_options(o,h){if(typeof(h)!="undefined"&&h==1){$("#legendDiv .clickable").popover('hide');return;}
if(typeof($(o).attr("aria-describedby"))=="undefined"){var x=top.$("#li_rc").html();x=x.replace("<h4><label class=\"\">Role as</label>","");x=x.replace(/change_role\(this\)/g,"top.change_role(this,1)");$(o).unbind("click").popover({title:"Role Change<small>Unsaved data will be lost.</small><span class=\"glyphicon glyphicon-remove pull-right\" onclick=\"role_change_options('',1)\"></span>",content:""+x,html:true,placement:"top"});$(o).popover('show');$("#legendDiv input[name=el_usr_role]").each(function(){this.checked=(this.value==logged_user_type)?true:false;});}}
function show_pgd(){var ob=$("#pgd_showpop");if(ob.length>0){var c=ob.css('display');if(c=='none')ob.show();}}
function setHgtGrpDiv(){var len=$("div[id*=div_assess_]").length;for(var i=0;i<len;i++){var oAssess=document.getElementById("div_assess_"+i);var oPlan=document.getElementById("div_plan_"+i);if(oAssess&&oPlan){var len2=oAssess.childNodes.length;for(var j=0;j<len2;j++){var odivAssess=oAssess.childNodes[j];var odivPlan=oPlan.childNodes[j];if(odivAssess||odivPlan){var hgtAssess=(odivAssess&&(typeof odivAssess.offsetHeight!="undefined"))?odivAssess.offsetHeight:15;var hgtPlan=(odivPlan&&(typeof odivPlan.offsetHeight!="undefined"))?odivPlan.offsetHeight:15;var tmp="";if((hgtAssess>hgtPlan)){tmp=hgtAssess;}else{tmp=hgtPlan;}
tmp=parseInt(tmp)+parseInt(15);if(odivAssess){odivAssess.style.height=""+tmp+"px";}
if(odivPlan){odivPlan.style.height=""+tmp+"px";}}}}}}
function show_inpatient_data(){$.ajax({url:top.JS_WEB_ROOT_PATH+'/interface/chart_notes/requestHandler.php',type:'post',data:{elem_formAction:'show_inpatient_data'},beforeSend:function(r){top.show_loading_image('show','','Please wait, loading data...');},complete:function(){top.show_loading_image('hide');},success:function(res){if($("#inpatient_modal",top.fmain.document).length>0){$("#inpatient_modal",top.fmain.document).remove();}
$("body",top.fmain.document).append(res);$("#inpatient_modal",top.fmain.document).find('select').selectpicker();$(".date-pick").datepicker({dateFormat:z_js_dt_frmt});$("#inpatient_modal",top.fmain.document).modal('show');}});}
function show_pt_payer(){var html='';html+='<div id="patient_payer_modal" class="modal fade" role="dialog">';html+='<div class="modal-dialog modal-lg" style="width:80%;">';html+='<!-- Modal content-->';html+='<div class="modal-content">';html+='<div class="modal-header bg-primary">';html+='<button type="button" class="close" data-dismiss="modal"></button>';html+='<h4 class="modal-title">Patient Payer</h4>';html+='</div>';html+='<div class="modal-body">';html+='<div id="selectContainer" style="position:absolute;"></div>';html+='<div class="row">';html+='<div class="col-sm-12" id="patientPayerDiv">';html+='</div>';html+='</div>';html+='</div>';html+='<div id="module_buttons" class="ad_modal_footer modal-footer">';html+='<button type="button" class="btn btn-success" onclick="top.fmain.ptPayerModal(\'save\');">Save Patient Payer</button>';html+='<button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>';html+='</div>';html+='</div>';html+='</div>';html+='</div>';if($("#patient_payer_modal",top.fmain.document).length>0){$("#patient_payer_modal",top.fmain.document).remove();}
$("body",top.fmain.document).append(html);top.fmain.ptPayerModal();$('#patient_payer_modal').modal('show');}
function showSocialForm(){$("#socialBody #socialDataTbl, #socialGHDiv #edit_icon").addClass('hidden');$("#socialBody #socialForm, #socialGHDiv #close_icon, #socialGHDiv #save_icon").removeClass('hidden');if(!$("#social").hasClass('in')){$("#socialGHDiv").find('h4').trigger('click');}
scroll_div();}
function hideSocialForm(){$("#socialBody #socialForm, #socialGHDiv #close_icon, #socialGHDiv #save_icon").addClass('hidden');$("#socialBody #socialDataTbl, #socialGHDiv #edit_icon").removeClass('hidden');if(!$("#social").hasClass('in')){$("#socialGHDiv").find('h4').trigger('click');}}
function scroll_div(){var obj=$("#genHealthDiv_wv").find('.modal-body');obj.animate({scrollTop:obj.scrollTop()+$("#socialGHDiv").offset().top},1000);}
function saveSocialForm(){var frm=$("#socialBody").find("#genHlthSocialForm");var data=frm.serialize();var chk=chkSocialFrmChange();if(chk)
{var url=top.JS_WEB_ROOT_PATH+'/interface/chart_notes/requestHandler.php';$.post(url,data).done(function(r){r=$.parseJSON(r);if(r.success){$("#socialBody #socialDataTbl").html(r.data.html);$("#socialBody #socialForm").html(r.data.form_data);hideSocialForm();$('#genHealthDiv_wv').find('select.selectpicker').selectpicker();$('#genHealthDiv_wv').find("input.datepicker").datepicker({dateFormat:z_js_dt_frmt});}
else{var m='Error occured..Please try again';top.fAlert(m);}});}
else{hideSocialForm();}}
function cancelSocialFrmEditing(){var chk=chkSocialFrmChange();if(chk){var m="There is change in the social information! Would you like to save and continue?"
top.fancyConfirm(m,'','top.fmain.saveSocialForm();','top.fmain.resetSocialForm();');}else{hideSocialForm();}}
function chkSocialFrmChange(){var frm=$("#socialBody").find("#genHlthSocialForm");var inputs=frm.find('input,select,textarea');var chk_change=false;$.each(inputs,function(i,v){var t=v.type;var c_val=$(v).val();var o_val=$(v).data('prev');if(t=='checkbox'){c_val=$(v).is(':checked')?'checked':'';o_val=$(v).data('prev');}
o_val=$.trim(o_val);c_val=$.trim(c_val);if(c_val!==o_val&&v.name!=='elem_formAction'){chk_change=true;}});return chk_change;}
function resetSocialForm(){var frm=$("#socialBody").find("#genHlthSocialForm");var inputs=frm.find('input,select,textarea');$.each(inputs,function(i,v){var t=v.type;var c_val=$(v).val();var o_val=$(v).data('prev');if(t=='checkbox'){c_val=$(v).is(':checked')?'checked':'';o_val=$(v).data('prev');}
c_val=$.trim(c_val);o_val=$.trim(o_val);if(c_val!==o_val){if(t=='checkbox'){var c=(o_val=='checked')?true:false;$(v).prop('checked',c);}
else if(t=='select-multiple'){var d=o_val.split(',');d=d.join(',');$(v).selectpicker('val',d);}
else{$(v).val(o_val);}}});hideSocialForm();}
function save_sur_ocu(o){if(elem_per_vo=="1"){return;}
if(finalize_flag=="1"&&isReviewable!="1"){top.fmain.setSavedBtn("1","Saving Surgical Ocular Hx..");var v=o.checked?1:0;var strsave="elem_saveForm=save_sur_ocu&elem_sur_ocu_hx="+v;$.post("saveCharts.php",strsave,function(d){top.fmain.setSavedBtn("0");});}else{top.$("#save").click();}}
function set_new_carry(flgdone){if(elem_per_vo=="1"||(finalize_flag=="1"&&isReviewable!="1")){return;}
if(typeof(zPath)=="undefined")zPath="";var u=zPath;var qry="";if(typeof flgdone!="undefined"&&flgdone=="1"){var cr_fwd_id=$("#sl_pt_dos_modal :checked[id*=el_nfc_ds]").val();if(typeof cr_fwd_id!="undefined"&&cr_fwd_id!=""){top.show_loading_image('show','','Loading...');qry="&set_cf_form_id="+cr_fwd_id;$.get(u+"/chart_notes/requestHandler.php?elem_formAction=set_crfrwd_id"+qry,function(d){window.location.reload();});}else{top.fAlert("Please select DOS!");}
return;}
qry="&cur_cf_form_id="+$("#cryfwd_form_id").val()+"&cur_form_id="+$("#elem_masterId").val();if($("#sl_pt_dos_modal").length>0){var t=$("#el_filter_pro").val()||"";qry+="&el_filter_pro="+t;t=$("#el_filter_facility").val()||"";qry+="&el_filter_facility="+t;$("#sl_pt_dos_modal").modal('hide');$("#sl_pt_dos_modal, .modal-backdrop").remove();}
top.show_loading_image('show','','Loading...');$.get(u+"/chart_notes/requestHandler.php?elem_formAction=get_dos_prompt"+qry,function(d){$("body").append(d);var hgt=parseInt($(window).height()*70/100);$("#sl_pt_dos_modal .dos_cf").css({"height":hgt+"px","overflow":'auto'});$("#sl_pt_dos_modal").modal("show");$("#sl_pt_dos_modal").draggable();top.show_loading_image('hide');});}
var send_to_ibra=0;function cnct_ibra(flg_snd_dt){if(elem_per_vo=="1"||(finalize_flag=="1"&&isReviewable!="1")){return;}
var a1=$("#el_lasik_trgt_method").val(),a2=$("#el_visLasikTrgtDate").val(),a3=$("#el_lasik_trgt_intervention").val();if(typeof(a1)=="undefined"||a1==""||typeof(a2)=="undefined"||a2==""||typeof(a3)=="undefined"||a3==""){top.fAlert("Please enter Lasik data!");return;}
if(typeof(zPath)=="undefined")zPath="";var u=zPath;if(typeof flg_snd_dt!="undefined"){top.show_loading_image('show');var param="elem_formAction=ibra_case&elem_ibra_action=send_lasik";$.post(u+"/chart_notes/requestHandler.php",param,function(d){top.show_loading_image('hide');if(typeof(d)!="undefined"&&d=='-1'){top.fAlert("Lasik data is sent to IBRA!");}});}else{send_to_ibra=1;top.$("#save").trigger("click");}}
function service_eligibility_check(obj){if($(obj).is(':checked')==true){$(obj).val(1);$(obj).prop('checked',true);}
else{$(obj).val(0);$(obj).prop('checked',false);}}
function dssLoadTiuTitles(){var $select=$('#dssTiuTitle');$.ajax({url:top.JS_WEB_ROOT_PATH+"/interface/core/ajax_handler.php?task=dssLoadTiuTitles",type:'GET',}).done(function(response){$select.append(response);});}
var clMs_mvFrom="";function click2MoveSign(a){if(finalize_flag==1&&isReviewable!=1){return;}
if(clMs_mvFrom==""){clMs_mvFrom=a;$(".divsign .signernm").css("color","green");$("#sign_phy"+a+" .signernm").css("color","red");}else{if(clMs_mvFrom!=a){var arr=["elem_signCoords","hdSignCoordsOriginal","elem_is_user_sign","elem_is_phy_sign","elem_sign_path","elem_physicianIdName","elem_physicianId"];var tmp="";for(var z in arr){tmp="";tmp=$(":input[name="+arr[z]+a+"]").val();$(":input[name="+arr[z]+a+"]").val($(":input[name="+arr[z]+clMs_mvFrom+"]").val());$(":input[name="+arr[z]+clMs_mvFrom+"]").val(tmp);}
tmp=$("#td_signature_applet"+a).parent().html();$("#td_signature_applet"+a).parent().html($("#td_signature_applet"+clMs_mvFrom).parent().html());$("#td_signature_applet"+clMs_mvFrom).parent().html(tmp);if($("#lbl_phy_sig"+a).hasClass("clickable")&&!$("#lbl_phy_sig"+clMs_mvFrom).hasClass("clickable")){$("#lbl_phy_sig"+a).removeClass("clickable").unbind("click");$("#lbl_phy_sig"+a)[0].onclick=function(){};$("#lbl_phy_sig"+clMs_mvFrom).addClass("clickable").bind("click",function(){getPhySign_db(clMs_mvFrom);});}else if(!$("#lbl_phy_sig"+a).hasClass("clickable")&&$("#lbl_phy_sig"+clMs_mvFrom).hasClass("clickable")){$("#lbl_phy_sig"+a).addClass("clickable").bind("click",function(){getPhySign_db(a);});$("#lbl_phy_sig"+clMs_mvFrom).removeClass("clickable").unbind("click");$("#lbl_phy_sig"+clMs_mvFrom)[0].onclick=function(){};}
if($("#sign_phy"+a+" i").length>0||$("#sign_phy"+clMs_mvFrom+" i").length>0){tmp=$("#sign_phy"+a+" i").html();$("#sign_phy"+a+" i").html($("#sign_phy"+clMs_mvFrom+" i").html());$("#sign_phy"+clMs_mvFrom+" i").html(tmp);}}
$(".divsign .signernm").css("color","#663366");clMs_mvFrom="";}}
function show_review_detail(o){var id=$(o).data("lstid"),secName=$(o).data("scnm"),opId=$(o).data("opid"),dateTime=$(o).data("dtm");if(typeof(id)=="undefined"){id="";}
if(typeof(secName)=="undefined"){secName="";}
if(typeof(opId)=="undefined"){opId="";}
if(typeof(dateTime)=="undefined"){dateTimes="";}
var parWidth=document.body.clientWidth;top.popup_win(zPath+'/Medical_history/review_details.php?masterId='+id+'&secName='+secName+'&opId='+opId+'&dateTime='+dateTime,'medHXReviwed','toolbar=0,scrollbars=0,location=0,statusbar=0,menubar=0,resizable=0,width='+parWidth+',height=520');}
var oneEye_issue=oneEye_eye="";function oneEye_isSet(flagPu){var arrRet=null;if(flagPu==2){var oprph=$("#phth_pros");var oeye=$("#is_od_os");if(oprph.length>0&&oprph.val()!=""&&oeye.length>0&&oeye.val()!=""){issue=""+oprph.val();eye=""+oeye.val();arrRet={"issue":issue,"eye":eye};}}else{if(flagPu==1){if(window.opener){var tmp_iss=window.opener.$("#phth_pros").val();var tmp_eye=window.opener.$("#is_od_os").val();}}else{var tmp_iss=$("#phth_pros").val();var tmp_eye=$("#is_od_os").val();}
arrRet={"issue":tmp_iss,"eye":tmp_eye};}
return arrRet;}
function oneEye_disable(i){var elOu=",:input[id*='aneseye_ou'][type='radio'],:input[id*='dileye_ou'][type='radio'],:input[id*='oodeye_ou'][type='radio']";if(i=="OD"){idChk=":input[name*='od_'][type='checkbox'],:input[name*='od_'][type='radio']";idChk+=",:input[name*='Od'][type='radio'],:input[name*='Od'][type='checkbox']";idChk+=",:input[name*='_od'][type='checkbox'],:input[name*='_od'][type='radio'],:input[id*='_od'][type='radio']";idChk+=elOu;idElm=":input[name*='Od'][type!='checkbox'][type!='radio']";idElm+=",:input[name*='_od'][type!='checkbox'][type!='radio']";idElm+=",:input[name*='od_'][type!='checkbox'][type!='radio']";$(idChk).attr("disabled","disabled").removeAttr("checked");$(idElm).attr("disabled","disabled").val("");}else if(i=="OS"){idChk=":input[name*='os_'][type='checkbox'],:input[name*='os_'][type='radio']";idChk+=",:input[name*='_os'][type='checkbox'],:input[name*='_os'][type='radio']";idChk+=",:input[name*='Os'][type='radio'],:input[name*='Os'][type='checkbox'],:input[id*='_os'][type='radio']";idChk+=elOu;idElm=":input[name*='Os'][type!='checkbox'][type!='radio']";idElm+=",:input[name*='os_'][type!='checkbox'][type!='radio']";idElm+=",:input[name*='_os'][type!='checkbox'][type!='radio']";$(idChk).attr("disabled","disabled").removeAttr("checked");$(idElm).attr("disabled","disabled").val("");}}
function oneEye_display(wid,wtxt){wtxt=(typeof wtxt!="undefined")?""+wtxt:"";$("#"+wid).html(""+wtxt);}
function oneEye_setCN(flgTdClr){var oe_issue=$("#phth_pros");var oe_eye=$("#is_od_os");if(!oe_issue.length||!oe_eye.length){return;}
flgTdClr=(typeof flgTdClr=="undefined")?"1":flgTdClr;var strchartsumm_OD=new Array("#pupil_ref","#lidRefOd","#lesionRefOd","#lidPositionRefOd","#lacrimalRefOd","#iop_OD","#iopRefOd","#conjuctOd","#slecorneaOd","#antChamberOd","#sleIrsiOd","#sleLensOd","#vitreous_od","#macula_od","#periphery_od","#vessels_od","#opticNerve_od","#external_od","#cd_od");var strchartsumm_OS=new Array("#pupil_refOs","#lidRefOs","#lesionRefOs","#lidPositionRefOs","#lacrimalRefOs","#iop_OS","#iopRefOs","#conjuctOs","#slecorneaOs","#antChamberOs","#sleIrsiOs","#sleLensOs","#vitreous_os","#macula_os","#periphery_os","#vessels_os","#opticNerve_os","#external_os","#cd_os");var arrSe=new Array("","1","2","3","4","","Iop","1","2","3","4","5","1","2","3","4","6","","6");for(var i=0;i<19;i++){var tmpOd=$(strchartsumm_OD[i]);var tmpOs=$(strchartsumm_OS[i]);var tmpOdi=$(strchartsumm_OD[i]+i);var tmpOsi=$(strchartsumm_OS[i]+i);var tmpOdV=(tmpOdi.length!=0&&tmpOdi.val()!="")?tmpOdi.val():"&nbsp;";var tmpOsV=(tmpOsi.length!=0&&tmpOsi.val()!="")?tmpOsi.val():"&nbsp;";var tmp="";if(oe_issue.val()==""||oe_eye.val()==""){tmpOd.html(tmpOdV);tmpOs.html(tmpOsV);}else{if(oe_eye.val()=="OU"){tmpOd.html(tmpOdV);tmpOs.html(tmpOsV);}else if(oe_eye.val()=="OD"){tmpOd.html(tmpOdV);tmpOs.html(tmpOsV);}else if(oe_eye.val()=="OS"){tmpOd.html(tmpOdV);tmpOs.html(tmpOsV);}}
var flgOd=false;var flgOs=false;if(i==0){var vSe=$("#elem_se_Pupil").val();}else if(i>=1&&i<=4){var vSe=$("#elem_se_La").val();}else if(i==6){var vSe=$("#elem_se_Gonio").val();}else if(i>=7&&i<=11){var vSe=$("#elem_se_Sle").val();}else if(i>=12&&i<=15){var vSe=$("#elem_se_Rv").val();}else if(i==16||i==18){var vSe=$("#elem_se_Optic").val();}else if(i==17){var vSe=$("#elem_se_Ee").val();}
if(i!=5){if(vSe==""||vSe.indexOf(arrSe[i]+"_Od=0")!=-1){flgOd=true;}
if(vSe==""||vSe.indexOf(arrSe[i]+"_Os=0")!=-1){flgOs=true;}}
if(tmpOd.html()==""||tmpOd.html()=="&nbsp;"||flgOd==true){tmpOd.parent().addClass("bgSmoke");}else{tmpOd.parent().removeClass("bgSmoke");}
if(tmpOs.html()==""||tmpOs.html()=="&nbsp;"||flgOs==true){tmpOs.parent().addClass("bgSmoke");}else{tmpOs.parent().removeClass("bgSmoke");}}
var strFRSumm=$("#tr_fr_pupil,#tr_fr_ee,#tr_fr_la,#tr_fr_iop,#tr_fr_sle,#tr_fr_rv");if((oe_issue.val()!="")&&(oe_eye.val()!="")){strFRSumm.each(function(){if(oe_issue.val()=="Poor View"&&this.id!="tr_fr_sle"&&this.id!="tr_fr_rv"){$(this).hide();return;}
$(this).show();var tds=$(this).children();if(oe_eye.val()=="OU"){tds.eq(1).children().html(""+oe_issue.val()).addClass("css_oneEyeDesc");tds.eq(2).children().html(""+oe_issue.val()).addClass("css_oneEyeDesc");if(flgTdClr==1){tds.eq(1).addClass("bgWhite").removeClass("bgSmoke");tds.eq(2).addClass("bgWhite").removeClass("bgSmoke");}}else if(oe_eye.val()=="OD"){tds.eq(1).children().html(""+oe_issue.val()).addClass("css_oneEyeDesc");tds.eq(2).children().html("&nbsp;").removeClass("css_oneEyeDesc");if(flgTdClr==1){tds.eq(2).removeClass("bgWhite").addClass("bgSmoke");tds.eq(1).addClass("bgWhite").removeClass("bgSmoke");}}else if(oe_eye.val()=="OS"){tds.eq(1).children().html("&nbsp;").removeClass("css_oneEyeDesc");tds.eq(2).children().html(""+oe_issue.val()).addClass("css_oneEyeDesc");if(flgTdClr==1){tds.eq(1).removeClass("bgWhite").addClass("bgSmoke");tds.eq(2).addClass("bgWhite").removeClass("bgSmoke");}}});}else{strFRSumm.hide();}
var oVisElemsOd=$("#divVision :input[type!=hidden][name*=Od]");var oVisElemsOs=$("#divVision :input[type!=hidden][name*=Os]");oVisElemsOd.removeAttr("disabled");oVisElemsOs.removeAttr("disabled");var oVisElemsOd=$("#divVision :input[type!=hidden][name*=Od][name*=Txt],#divVision :input[type!=hidden][name*=Od][name*=OverrefV]");var oVisElemsOs=$("#divVision :input[type!=hidden][name*=Os][name*=Txt],#divVision :input[type!=hidden][name*=Os][name*=OverrefV]");oVisElemsOd.val(function(index,value){return(value!="")?this.value:"20/";});oVisElemsOs.val(function(index,value){return(value!="")?this.value:"20/";});}
function oneEye_check(){var oChk=oneEye_isSet(1);if(oChk&&(oChk.issue!="")&&(oChk.issue=="Phthisis"||oChk.issue=="Prosthesis")){wTxt=""+oChk.issue;oneEye_issue=""+oChk.issue;oneEye_eye=""+oChk.eye;oneEye_disable(oChk.eye);}}
function oneEye_isOpAllwd(eye){var ret=true;var iss="";if(typeof(eye)!="undefined"&&eye!=""){var oChk_oe=oneEye_isSet();var ignore_i="";if((oChk_oe!=null)&&(oChk_oe.issue!="")&&(oChk_oe.issue=="Phthisis"||oChk_oe.issue=="Prosthesis")){iss=oChk_oe.issue;ignore_i=oChk_oe.eye;if(ignore_i!=""){if(eye==ignore_i||ignore_i=="OU"){ret=false;}else{if(eye=="OU"){if(ignore_i=="OD"){eye="OS";}
else if(ignore_i=="OS"){eye="OD";}}}}}}
return{alwd:ret,eye:eye,iss:iss};}
function oneEye_checkinexam(){var ret=true;var oChk_oe=oneEye_isSet(1);if((oChk_oe!=null)&&(oChk_oe.issue!="")&&(oChk_oe.issue=="Phthisis"||oChk_oe.issue=="Prosthesis")){ignore_i=oChk_oe.eye;if(ignore_i=="OU"){ret=false;}}
return ret;}
function newET_setGray(ptrn){if(typeof ptrn!="undefined"&&ptrn!=""){$(""+ptrn).addClass("greyAll_v2").bind("click change",function(){var nm=$(this).attr('name');if(nm.indexOf("Od")!=-1){$(""+ptrn+"[name*='Od']").removeClass("greyAll_v2");}else{$(""+ptrn+"[name*='Os']").removeClass("greyAll_v2");}});}}
function newET_setGray_v2(arr,ptrnin){var ptrn="";if(typeof ptrnin!="undefined"){ptrn=""+ptrnin;}else{var len=arr.length;for(var i=0;i<len;i++){if(arr[i]!=""){if(newET_chkB4GrayExe(""+arr[i],"od")){if(ptrn!=""){ptrn+=",";}
ptrn+="#"+arr[i]+" :input[name*='Od_'],"+"#"+arr[i]+" :input[name*='_od'],"+"#"+arr[i]+" :input[name*='Od'],"+"#"+arr[i]+" :input[name*='od_']";}
if(newET_chkB4GrayExe(""+arr[i],"os")){if(ptrn!=""){ptrn+=",";}
ptrn+="#"+arr[i]+" :input[name*='Os_'],"+"#"+arr[i]+" :input[name*='_os'],"+"#"+arr[i]+" :input[name*='Os'],"+"#"+arr[i]+" :input[name*='os_']";}}}}
if(typeof ptrn!="undefined"&&ptrn!=""){var should_not_grey="input[type='button'],:input[name*=sc_elem], button, #elem_noChange, #elem_pharmadilated, #elem_pharmadilated_eye";$(""+ptrn).not(should_not_grey).addClass("greyAll_v2").bind("click change keyup",function(e){if(e&&e.type=="click"&&typeof(e.srcElement)!="undefined"&&e.srcElement.type=="select-one")return;var nm=$(this).attr('name');if(typeof(nm)=="undefined"||nm==""){return;}
if($(this).parents("div.tab-pane").length>0){var idDiv=$(this).parents("div.tab-pane").attr("id");if($("#"+idDiv).parents("div.tab-pane").length>0){idDiv=$("#"+idDiv).parents("div.tab-pane").attr("id");}}else if($(this).parents("div.subExam").length>0){var idDiv=$(this).parents("div.subExam").attr("id");}else{}
var eye="";$(this).removeClass("greyAll_v2");if(nm.toLowerCase().indexOf("od_")!=-1||nm.toLowerCase().indexOf("_od")!=-1){eye="od";}else if(nm.toLowerCase().indexOf("os_")!=-1||nm.toLowerCase().indexOf("_os")!=-1){eye="os";}else if(nm.toLowerCase().indexOf("od")!=-1){eye="od";}else if(nm.toLowerCase().indexOf("os")!=-1){eye="os";}
var is_sc_con_det="";if($(this).parents("#div_sc_con_detail").length>0){is_sc_con_det="#div_sc_con_detail";};if(newET_chkB4GrayExe(idDiv,eye,is_sc_con_det)){newET_setGray_Exe(idDiv,eye,is_sc_con_det);}});}}
function newET_chkB4GrayExe(divId,eye,flgscdet){if(typeof(flgscdet)=="undefined"||flgscdet==""){flgscdet="";}else{flgscdet=flgscdet+" ";}
var ret=true;if(eye=="od"){if($(flgscdet+"#elem_chng_"+divId+"_Od").val()=="1"){ret=false;}}else if(eye=="os"){if($(flgscdet+"#elem_chng_"+divId+"_Os").val()=="1"){ret=false;}}else if(eye=="ou"){if($(flgscdet+"#elem_chng_"+divId+"_Od").val()=="1"&&$(flgscdet+"#elem_chng_"+divId+"_Os").val()=="1"){ret=false;}}
return ret;}
function newET_setGray_Exe(divId,eye,flgscdet){if(typeof(flgscdet)=="undefined"||flgscdet==""){flgscdet="";}else{flgscdet=flgscdet+" ";}
var ptrn_2=flgscdet+"#"+divId+" :input";if(eye.toLowerCase().indexOf("od")!=-1||eye.toLowerCase().indexOf("ou")!=-1){var str=""+ptrn_2+"[name*='Od_'], "+""+ptrn_2+"[name*='_od'], "+""+ptrn_2+"[name*='Od'], "+""+ptrn_2+"[name*='od_'] ";$(""+str).removeClass("greyAll_v2");$(flgscdet+"#elem_chng_"+divId+"_Od").val("1");}
if(eye.toLowerCase().indexOf("os")!=-1||eye.toLowerCase().indexOf("ou")!=-1){var str=""+ptrn_2+"[name*='Os_'], "+""+ptrn_2+"[name*='_os'], "+""+ptrn_2+"[name*='Os'], "+""+ptrn_2+"[name*='os_'] ";$(""+str).removeClass("greyAll_v2");$(flgscdet+"#elem_chng_"+divId+"_Os").val("1");}}
function newET_setIndicators_Exe(divId,eye,val){if(eye.toLowerCase().indexOf("od")!=-1||eye.toLowerCase().indexOf("ou")!=-1){$("#elem_chng_"+divId+"_Od").val(""+val);}
if(eye.toLowerCase().indexOf("os")!=-1||eye.toLowerCase().indexOf("ou")!=-1){$("#elem_chng_"+divId+"_Os").val(""+val);}}
function newET_emptyGray(arr){var str="";var len=arr.length;for(var i=0;i<len;i++){if(str!=""){str+=", ";}
str+="#"+arr[i]+" .greyAll_v2";}
if(str!=""){$(""+str).each(function(){if($(this).is(":checkbox")){if($(this).attr('checked')){$(this).attr('checked',false);}}else{$(this).val('');}});}}
function newET_b4Done(){var obj=docNoChange();if(obj.divNC0.length>0){}}
function newET_bindEvDone(){$(":input[type='submit'][value='Done']").bind("click",function(){newET_b4Done();});}
function newET_drawingChanged(){var oDiv=getWcId("draw");var eye="ou";if(newET_chkB4GrayExe(oDiv.div,eye)){newET_setGray_Exe(oDiv.div,eye);}
if(typeof(examName)!="undefined"&&examName=="Gonio"){$("#divIop3 textarea").triggerHandler("keyup");}}
function newET_setGray_v3(flgfpu){var strPtrnGray="",parentid="",exmid="",srchin="";var ar_parentid=[],ar_exmid=[];if(typeof(examName)=="undefined"){examName="";}
if(typeof(flgfpu)!=""&&flgfpu==1||examName==""){ar_parentid=["#div_sc_con_detail"];var tmp=$(ar_parentid[0]+" div.subExam").attr("id");ar_exmid=[tmp];}else if(examName=="LA"||examName=="SLE"||examName=="Fundus"||examName=="Refractive Surgery"){strPtrnGray=$("#el_strPtrnGray").val();}else if(examName=="Pupil"){ar_parentid=["#divPupil"];ar_exmid=["divPupil"];}else if(examName=="External"){ar_parentid=["#divCon","#divDraw"];ar_exmid=["divCon","divDraw"];}
var ln=ar_parentid.length;for(var i=0;i<ln;i++){parentid=ar_parentid[i];exmid=ar_exmid[i];srchin=(parentid=="#div_sc_con_detail")?parentid+" ":"";var od=$(srchin+"#elem_chng_"+exmid+"_Od").val(),os=$(srchin+"#elem_chng_"+exmid+"_Os").val();if((od==""||od=="0")&&(os==""||os=="0")){strPtrnGray+=parentid+" :input,";}else{if((od==""||od=="0")){strPtrnGray+=parentid+" :input[name*='Od_'],"+parentid+" :input[name*='Od'],";}else if((os==""||os=="0")){strPtrnGray+=parentid+" :input[name*='Os_'],"+parentid+" :input[name*='Os'],";}}}
if(strPtrnGray!=""){strPtrnGray=strPtrnGray.replace(/,\s*$/,'');newET_setGray_v2("",""+strPtrnGray+"");}}
function btn_htm(n,i,f,v,cls,bspn){if(n=="span"){return"<span style=\"padding-left:"+v+"px;\"></span>";}else{btn_class='btn btn-success';switch(v.toLowerCase()){case'cancel':case'no':case'close':case'void':case'delete':case'archive':btn_class='btn btn-danger pull-right';break;}
if(typeof(cls)!="undefined"&&cls!=""){btn_class+=" "+cls;}
bspn='';var noFocs="";if(v=="<< Previous"||v=="Next >>"){noFocs=" onfocus='this.blur();' ";}
return bspn+"<input type=\"button\" class=\""+btn_class+"\" align=\"bottom\""+"name=\""+n+"\" id=\""+i+"\" onClick=\""+f+"\" "+noFocs+"value=\""+v+"\"  />";}}
function btn_show(id,ar){var str="";var n="",v="",fn="",l=0,d="";switch(id){case"DEF":var win_height=screen.height;var win_width=screen.availWidth*0.9
var arr=[["add_np","Add New Patient","top.popup_win('"+JS_WEB_ROOT_PATH+"/interface/scheduler/common/new_patient_info_popup_new.php?source=demographics&search=true&frm_status=show_check_in&popheight="+win_height+"', 'newPatientWindow', 'width="+win_width+",scrollbars=0,resizable=yes,height="+win_height+",top=0,left=10,addressbar=1');"]];l=arr.length;for(var i=0;i<l;i++){n=arr[i][0];v=arr[i][1];fn=arr[i][2];if(priv_vo_pt_info=="1")fn="top.view_only_pt_call(1);";str+=btn_htm(n,n,fn,v);}
break;case"WV":var arr=[["btnPerNext","<< Previous","top.fmain.showPrevCharts('-1');","pull-left"],["save","Save","top.fmain.saveMainPage();"],["btnFinalize","Finalize","top.fmain.FinalizeMainPage();"],["btnUnfinalizeChart","Unfinalize","top.fmain.chartNoteUnfinalize();"],["btnEditChart","Edit","top.fmain.chartNoteEdit();"],["buttonPurge","Purge","top.fmain.getconfirmationPurgeRequest();"],["buttonChrtDel","Delete","top.fmain.deleteChart();"],["buttonPhyView","Phy. View","top.fmain.getPhyViewWV(this.value);"],["btnPerBck","Next >>","top.fmain.showPrevCharts('+1');","pull-right"],["cancel","Cancel","top.fmain.funClose()"],];l=arr.length;for(var i=0;i<l;i++){n=arr[i][0];v=arr[i][1];fn=arr[i][2];cls=arr[i][3];bs=arr[i][4];if(ar["prgdel"]==1&&(v=="Purge"||v=="Delete")){console.log("INSIDE: ");}
else{if(ar["elem_per_vo"]=="1"&&v!="Cancel")continue;if(ar["userTypeCn"]!="1"&&(v=="Edit"||v=="Purge"||v=="Delete"||v=="Finalize"||v=="Unfinalize"))continue;if(ar["userTypeCn"]=="1"&&v=="Phy. View")continue;}
if(v=="Unfinalize"){if((ar["f"]=="1")&&(ar["r"]=="1")&&(ar["e"]==1)&&(ar["prg"]!="1")){}else{continue;}}else if(v=="Save"||v=="Cancel"){if((ar["f"]=="1"&&ar["r"]!="1")||ar["prg"]=="1")continue;}else if(v=="Finalize"){if(ar["f"]=="1"||ar["fz"]=="1")continue;}else if(v=="Edit"){if((ar["f"]=="1")&&(ar["r"]!="1")&&(ar["e"]==1)&&(ar["prg"]!="1")){}else{continue;}}else if(v=="Purge"){if(ar["f"]=="1"&&(ar["cvu"]=="1"||ar["prgdel"]==1)){if(ar["prg"]=="1"){v="Undo Purge";}}else{continue;}}else if(v=="Phy. View"){if((ar["f"]=="1"&&ar["r"]!="1")||ar["prg"]=="1")continue;if(ar["fpv"]=="1"){v="Tech. View";}}else if(v=="Delete"){if(ar["f"]=="1"&&(ar["cvu"]=="1"||ar["prgdel"]==1)&&ar["prg"]=="1"){}else{continue;}}
str+=btn_htm(n,n,fn,v,cls,bs);}
break;case"VF":case"VF-GL":case"LABS":case"CELLCOUNT":case"BSCAN":case"EXTERNAL":case"DISC":case"IVFA":case"ICG":case"NFA":case"OCT":case"OCT-RNFL":case"OTHER":case"PACHY":case"TOPO":case"GDX":case"ASCAN":if(id=="VF"||id=="VF-GL"){var savef="top.fmain.saveVF();";}else if(id=="LABS"||id=="CELLCOUNT"||id=="BSCAN"||id=="PACHY"||id=="TOPO"||id=="OTHER"){var savef="top.fmain.savePachy();";}else if(id=="DISC"||id=="EXTERNAL"){var savef="top.fmain.saveDisc();";}else if(id=="IVFA"){var savef="top.fmain.saveIvfa();";}else if(id=="ICG"){var savef="top.fmain.saveIcg();";}else if(id=="NFA"||id=="OCT"||id=="OCT-RNFL"||id=="GDX"){var savef="top.fmain.saveNfa();";}else if(id=="ASCAN"){var savef="top.fmain.saveAscan();";}
var flg=0;if(ar["elem_per_vo"]=="1")flg=1;if(ar["purged"]!="0"&&ar["purged"]!=""){purge="UndoPurge";flg=1;}else{purge="Purge";}
var rtpath=ar["rtpath"];var arr=[["btnPrev","<< Previous","top.fmain.setPrevValues('-1');","pull-left"],["btn_interpret","Interpreted","top.fmain.test_interpreted();"],["btnReset","Reset","top.fmain.resetTestExam();"],["save","Done",""+savef],["btnEPost","ePost","top.fmain.epostpopTest();"],["btnPrint","Print","top.fmain.printTest();"],["btnPurge",""+purge,"top.fmain.resetTestExam(1);"],["save","Order",""+savef],["Close","Cancel","top.fmain.location.href='"+rtpath+"/tests/index.php';"],["btnNxt","Next >>","top.fmain.setPrevValues('+1');","pull-right"]];l=arr.length;for(var i=0;i<l;i++){n=arr[i][0];v=arr[i][1];fn=arr[i][2];cls=arr[i][3];bs=arr[i][4];if(v=="Interpreted"&&ar["interpreted"]!="1")continue;if(v=='Done'&&ar['interpreted']=='1')continue;if((flg==1)&&(v!="Cancel"&&v!="ePost"&&v!="UndoPurge"))continue;str+=btn_htm(n,n,fn,v,cls,bs);}
break;case"OCU":case"GH":case"HP":case"MED":case"VS":case"ORDRST":case"PL":case"LAB":case"RAD":case"IMM":case"SX":case"ALRG":var arr=[["save_medical_history","Save & Reviewed","top.fmain.save_medical_history();"],["print_medical_history","Print","top.fmain.data_action_function(this.id);"],["export_medical_history","Export","top.fmain.data_action_function(this.id);"],["import_medical_history","Import","top.fmain.data_action_function(this.id,'"+win_height+"');"],["scan_medical_history","Scan/Upload","top.change_main_Selection(top.document.getElementById('Documents_Lab'));"],["save_order_set","Save","top.fmain.save_order_set_data();"],["import_lab_hl7","HL7 Import","top.fmain.export_hl7('Import');"],["new_lab","New Lab Order","top.fmain.new_lab_order();"],["export_imm_hl7","HL7 Export","top.fmain.export_hl7();"],["med_exter_records","External Records","top.fmain.med_exter_records();"],["del_records","Delete","top.fmain.del_records();"],];l=arr.length;for(var i=0;i<l;i++){n=arr[i][0];v=arr[i][1];fn=arr[i][2];if(priv_vo_clinical=="1")fn="top.fmain.view_only_acc_call(0);";if(n=="save_medical_history"&&(id=="ORDRST"||id=="LAB"))continue;if(n!="save_medical_history"&&(id=="OCU"||id=="GH"))continue;if(n=="save_order_set"&&id!="ORDRST")continue;if(n=="scan_medical_history"&&id!="MED"&&id!="LAB"&&id!="RAD")continue;if(n=="export_imm_hl7"&&(id!="IMM"))continue;if(n=="import_lab_hl7"&&(id!="LAB"))continue;if(n=="med_exter_records"&&(id!="MED"))continue;if(n=="new_lab"&&(id!="LAB"))continue;if(n=="import_medical_history"&&id!="MED"&&id!="ALRG"&&id!="PL")continue;if(n=="del_records"&&id!="PL")continue;if(n=="export_medical_history"&&id!="MED"&&id!="SX"&&id!="ALRG"&&id!="IMM"&&id!="VS")continue;if(n=="print_medical_history"&&id!="MED"&&id!="SX"&&id!="ALRG"&&id!="IMM"&&id!="VS"&&id!="HP")continue;if((id=="VS"||id=="PL")&&v=="Save & Reviewed"){v="Save";}
str+=btn_htm(n,n,fn,v);}
break;case"DEMO":case"INS":case"ANP":case"CF":case"CF2":case"CF3":case"SCF":case"POSCF":case"CL1":case"CL2":case"CL3":case"PTD":case"PTINST":case"SCAN_DOCS":case"MULTI_UPLOAD":case"ELIGIBILITY":if(id=='CF'||id=='CF2'||id=='SCF'||id=='POSCF'){var AddApptExe="top.change_main_Selection(top.document.getElementById('sch_icon_li'));"
if(top.doc_pop)
AddApptExe="top.opener.top.change_main_Selection(top.opener.top.document.getElementById('sch_icon_li'));top.opener.top.fmain.focus();";}
if(id=="DEMO"){var arr=[["demographic_save","Save Patient","top.fmain.call_functions('demographic_save');"],["add_appt","Add Appt","top.change_main_Selection(top.document.getElementById('sch_icon_li'));"]];}else if(id=="INS"){var arr=[["insurance_save","Save","top.fmain.call_functions('insurance_save');"],["add_appt","Add Appt","top.change_main_Selection(top.document.getElementById('sch_icon_li'));"]];}else if(id=="ANP"){var arr=[["butId2","Save","top.fmain.save_new_patient();"],["new_patient_saving_canceled","Cancel","top.fmain.location.href='"+WebRoot+"/interface/main/patient_tabs.php';"]];}else if(id=="CF"){var arr=[["consent_save","Save","top.fmain.consent_data.save_form('save_form');"],["consent_save_print","Save and Print","top.fmain.consent_data.save_form('print_form');"],["add_appt","Add Appt",AddApptExe]];}else if(id=="CF2"){var arr=[["consent_save","Save","top.fmain.consent_data.save_form('save_form');"],["consent_save_print","Save and Print","top.fmain.consent_data.save_form('print_form');"],["add_appt","Add Appt",AddApptExe],["consent_hold","On Hold for:","top.fmain.consent_data.hold_dr_sig()"]];}else if(id=="CF3"){var arr=[["consent_send_fax","Send Fax","top.fmain.show_consent_fax_div();"]];}else if(id=="SCF"){var arr=[["surgery_save","Save","top.fmain.consent_data_surgery.save_form('save_form');"],["surgery_save_print","Save and Print","top.fmain.consent_data_surgery.save_form('print_form');"],["add_appt","Add Appt",AddApptExe],["consent_hold","On Hold for:","top.fmain.consent_data_surgery.hold_dr_sig()"]];}else if(id=="POSCF"){var arr=[["savePreOpHealth","Save","top.fmain.consent_data_surgery.savePreOpHealth();"],["preOpHealth_print","Print","top.fmain.consent_data_surgery.print_form_health_quest();"],["add_appt","Add Appt",AddApptExe]];}else if(id=="CL1"){var arr=[["consult_fax_log","Fax Log","top.fmain.show_fax_log();"]];}else if(id=="CL2"){var arr=[["consult_send_fax","Send Fax","top.fmain.show_consult_fax_div();"]];}else if(id=="CL3"){var arr=[["consult_send_fax","Send Fax","top.fmain.show_consult_fax_div();"],["consult_fax_log","Fax Log","top.fmain.show_fax_log();"]];}else if(id=="PTD"){var arr=[["savePtDocs","Save","top.fmain.ifrm_FolderContent.saveTemplateData();"]];}else if(id=="PTINST"){var arr=[["savePtInstructionDocs","Save","top.fmain.ifrm_FolderContent.submit_frm();"]];}else if(id=="SCAN_DOCS"){var arr=[["btSaveAsPDF","Save as PDF","top.fmain.ifrm_FolderContent.save_pdf_jpg('pdf');"],["btSaveAsJPG","Save as JPG","top.fmain.ifrm_FolderContent.save_pdf_jpg('jpg');"],["scnDocmntBtn","Scan Document","top.fmain.ifrm_FolderContent.scan_doc();"],["upldDocmntBtn","Upload Image","top.fmain.ifrm_FolderContent.upload_image();"],["btSaveComment","Save Comment","top.fmain.ifrm_FolderContent.save_comments();"],["btBackFolderCat","Go back to folder categories","top.fmain.ifrm_FolderContent.go_back_folder_cat();"],["btAddNew","Add New Folder","top.fmain.ifrm_FolderContent.add_new_folder_fun();"]];}else if(id=="MULTI_UPLOAD"){var arr=[["scanUploadBtnPdf","Upload","top.fmain.ifrm_FolderContent.scanUploadFun();"],["refreshBtnPdf","Refresh","top.fmain.ifrm_FolderContent.reload_frm();"],["savePdfBtn","Save","top.fmain.ifrm_FolderContent.submit_frm();"],["deletePdfSplitSelected","Delete","top.fmain.ifrm_FolderContent.delPdfSplitFun();"]];}
else if(id=="ELIGIBILITY"){var arr=ar;}
l=arr.length;for(var i=0;i<l;i++){n=arr[i][0];v=arr[i][1];fn=arr[i][2];if(id=="DEMO"){b=arr[i][3];}else{b='';}
if(priv_vo_pt_info=="1"&&n!="consent_print"&&n!="scan_consent_print"&&n!="surgery_print"&&n!="preOpHealth_print"&&n!="add_appt")fn="top.fmain.view_only_call();";str+=btn_htm(n,n,fn,v,b);}
break;case"ELIGIBILITY_REPORT":var arr=ar;l=arr.length;for(var i=0;i<l;i++){n=arr[i][0];v=arr[i][1];fn=arr[i][2];if(priv_vo_pt_info=="1"&&n!="consent_print"&&n!="scan_consent_print"&&n!="surgery_print"&&n!="preOpHealth_print"&&n!="add_appt")fn="top.fmain.view_only_call();";str+=btn_htm(n,n,fn,v);}
break;case"O4A":case"CLRJ":case"BP":case"PPR":case"OPTL":case"ADMN":var arr=ar;l=arr.length;for(var i=0;i<l;i++){n=arr[i][0];v=arr[i][1];fn=arr[i][2];str+=btn_htm(n,n,fn,v);}
break;case"NoPt":n="new_patient_add";v="Add New Patient";fn="top.fmain.location = '"+JS_WEB_ROOT_PATH+"/interface/main/patient_tabs.php?new_patient=1';";str+=btn_htm(n,n,fn,v);break;case"mur_stage1_2015":case"mur_stage2_2015":case"mur_stage1_2014":case"mur_stage2_2014":case"mur_stage2013":n=id;v="Cancel";loc=top.fmain.location.href;fn="top.fmain.location = "+loc;str+=btn_htm(n,n,fn,v);break;case"mur_stage_qrda":var arr=ar;l=arr.length;for(var i=0;i<l;i++){n=arr[i][0];v=arr[i][1];fn=arr[i][2];str+=btn_htm(n,n,fn,v);}
break;case"MURanalyzePrint":var arr=[["btn_pdf","Print ScoreCard","top.fmain.print_mur_scorecard();"]];l=arr.length;for(var i=0;i<l;i++){n=arr[i][0];v=arr[i][1];fn=arr[i][2];str+=btn_htm(n,n,fn,v);}
break;case"ACCOUNT":var arr=ar;l=arr.length;for(var i=0;i<l;i++){n=arr[i][0];v=arr[i][1];fn=arr[i][2];str+=btn_htm(n,n,fn,v);}
break;case'VERIFICATION_SHEET':var arr=ar;l=arr.length;for(var i=0;i<l;i++){n=arr[i][0];v=arr[i][1];fn=arr[i][2];str+=btn_htm(n,n,fn,v);}
break;case'AR_worksheet':var arr=ar;l=arr.length;for(var i=0;i<l;i++){n=arr[i][0];v=arr[i][1];fn=arr[i][2];str+=btn_htm(n,n,fn,v);}
break;default:break;}
var tempContainer=$('<div>').html(str);var leftBtn=$('<div>').addClass('pull-left');var rightBtn=$('<div>').addClass('pull-right');var wrapper=$('<div>').addClass('nowrap').css('overflow','hidden');$(wrapper).append(leftBtn);$(wrapper).append(rightBtn);var buttons=$(tempContainer).children();$(buttons).each(function(count,obj){if($(obj).hasClass('pull-right'))
{$(obj).removeClass('pull-right');if($(obj).val()==='Next >>')
$(obj).appendTo(rightBtn);else
$(obj).prependTo(rightBtn);}
else if($(obj).hasClass('pull-left'))
{$(obj).removeClass('pull-left');if($(obj).val()==='<< Previous')
$(obj).prependTo(leftBtn);else
$(obj).appendTo(leftBtn);}
else
{$(obj).appendTo(wrapper);}});top.$('#page_buttons').html(wrapper);}
function cpoe_printRx(){var parWidth=parent.document.body.clientWidth;var parHeight=parent.document.body.clientHeight;top.popup_win(zPath+'/chart_notes/requestHandler.php?printType=1&elem_formAction=print_patient_rx','printPatientRx','scrollbars=1,resizable=1,width='+parWidth+'height='+parHeight+',top=0,left=0');}
function funInsMed(){var obj_txtarea=document.getElementsByName('elem_plan[]');var val_txtarea='';var med_len=(document.getElementById('hidd_count_med'))?document.getElementById('hidd_count_med').value:0;var obj_sel_split=new Array;var j=obj_len=valobjIndex=val_spntxt=txt=spnMedObj='';for(var i=0;i<med_len;i++){obj_len='';obj_sel=$("#selMed"+i).selectedValuesString();spnMedObj='';if(obj_sel!=""){spnMedObj=document.getElementById('spnOcMed'+i);}
txt='';obj_sel_split=obj_sel.split(',');for(j=0;j<obj_sel_split.length;j++){valobjIndex=obj_sel_split[j];valobjIndex=(parseFloat(valobjIndex)-1);if(obj_txtarea.item(parseFloat(valobjIndex))){val_txtarea=$.trim(""+obj_txtarea.item(parseFloat(valobjIndex)).value);if(spnMedObj){val_spntxt=$.trim(""+spnMedObj.innerText);}
if($.trim(val_txtarea)!=""||j!=0){txt+='\n';}
txt=val_spntxt;if(obj_txtarea.item(parseFloat(valobjIndex)).value!=""){var txtTmpVar=$.trim(obj_txtarea.item(parseFloat(valobjIndex)).value);if(txtTmpVar.indexOf(txt)==-1){obj_txtarea.item(parseFloat(valobjIndex)).value='';obj_txtarea.item(parseFloat(valobjIndex)).value=$.trim(txtTmpVar+'\n'+txt);}}else{obj_txtarea.item(parseFloat(valobjIndex)).value=$.trim(txt);}
obj_txtarea.item(parseFloat(valobjIndex)).onkeyup();}}}}
function isStrExistsInPlan(pln,ndl,flgodr,odrnm){pln=pln.replace(/\&\#3(9|4)\;|\'|\"/g,"");ndl=ndl.replace(/\&\#3(9|4)\;|\'|\"/g,"");pln=$.trim(pln);pln=pln.toLowerCase();pln="\n"+pln+"\n";ndl=ndl.toLowerCase();if(pln.indexOf("\n"+ndl+"\n")!=-1){return 1;}else if(pln.indexOf(""+ndl)!=-1){var arr=pln.split("\n");var ln=arr.length;if(ln>0){ndl=$.trim(ndl);var c=0;for(var a=0;a<ln;a++){var ta=$.trim(arr[a]);if(ta==ndl){return 1;}
if(ta!=""&&ta.length>0){if(ta.charCodeAt(ta.length-1)==173){var ta2=ta.substr(0,ta.length-1);if(ta2==ndl){return 1;}}}
var fndinx=ta.indexOf(""+ndl);if(fndinx!=-1&&fndinx<11){c+=1;}}
if(c==1){return 1;}}}
if($.trim(flgodr)=="ORDER"||$.trim(flgodr)=="2"){odrnm=odrnm.toLowerCase();if(pln.indexOf(""+odrnm)!=-1){return 1;}}
return 0;}
function cpoe_emdeoncheck(){var arrAllOrdrAscId=[],arrAllOrdrDetId=[];var oapa=gebi("elem_apa",1);var lnapa=oapa.length;for(var a=0;a<lnapa;a++){var tmp="";var cmnsep="~cmnsep~";var strAssess=oapa[a].value;var oapp=gebi("elem_app"+a,1);var lnapp=oapp.length;var a_n=parseInt(a)+1;for(var b=0;b<lnapp;b++){var t=$.trim(""+oapp[b].value);if(t!=""){var remflg=1;var oOrdrAscId=$(oapp[b]).attr("data-order_asoc_id");oOrdrDetId=$(oapp[b]).attr("data-order_det_id");if((typeof(oOrdrAscId)!="undefined"&&oOrdrAscId!="")||(typeof(oOrdrDetId)!="undefined"&&oOrdrDetId!="")){}
else{continue;}
var oOrdrAscId=$(oapp[b]).attr("data-order_asoc_id");if(typeof(oOrdrAscId)!="undefined"&&oOrdrAscId!=""){arrAllOrdrAscId[arrAllOrdrAscId.length]=oOrdrAscId;}
if(oapp[b].checked){oOrdrDetId=$(oapp[b]).attr("data-order_det_id");if(typeof(oOrdrDetId)!="undefined"&&oOrdrDetId!=""){arrAllOrdrDetId[arrAllOrdrDetId.length]=oOrdrDetId;}}}}}
if(arrAllOrdrDetId.length>0){var str_or_asc_id=arrAllOrdrAscId.join(",");str_or_asc_id=encodeURI(str_or_asc_id);var str_or_det_id=arrAllOrdrDetId.join(",");str_or_det_id=encodeURI(str_or_det_id);if(typeof(setProcessImg)!='undefined')setProcessImg("1","btnAP_ok","250","530","Please wait! Checking with Emdeon...");var url="requestHandler.php?elem_formAction=GetEmdeonWarnings&str_or_asc_id="+str_or_asc_id+"&str_or_det_id="+str_or_det_id;$.get(url,function(data){if(typeof(setProcessImg)!='undefined')setProcessImg("0","btnAP_ok");if(""+data=="No warning!"){funApPlan(1,'',1);}else{$("body").append("<div id=\"dialog_emd\" title=\"Emdeon Warning!\">"+data+"</div>");$("#dialog_emd").dialog({buttons:{"Save CPOE":function(){$(this).dialog("close");funApPlan(1,'',1);},Cancel:function(){$(this).dialog("close");}}});}});}else{funApPlan(1,'',1);}}
function isPreviousPlanAOrder(data,x,pln,flgdel){pln=$.trim(pln);var oplan=[];var ret=0;var ptrn="\\s*\\d{2}\-\\d{2}\-\\d{4}";var patt=new RegExp(ptrn);var pln_2=""+pln.replace(patt,"");if(data.order&&data.order[x]){for(var xx in data.order[x]){if(data.order[x][xx]&&data.order[x][xx].length>0){var aror=data.order[x][xx];var lnor=aror.length;for(var j=0;j<lnor;j++){if(aror[j]==null||typeof(aror[j][0])=="undefined"){continue;}
if($.trim(aror[j][2])=="ORDER"){var arshw=$.trim(aror[j][0]);var arshid=aror[j][1];var ordersetid=$.trim(aror[j][3]);var ordernm=$.trim(aror[j][4]);var ordersupli=$.trim(aror[j][5]);var arshw_wsitesig=$.trim(aror[j][6]);var ordersig="";var ordersig_s="";var ordersig_s_loc="";}else{var arshw=$.trim(aror[j][0]);var arshid=aror[j][1];var ordersetid=$.trim(aror[j][2]);var ordernm=$.trim(aror[j][3]);var ordersupli=0;var ordersig=$.trim(aror[j][4]);var ordersig_s=$.trim(aror[j][5]);var ordersig_s_loc=$.trim(aror[j][6]);var arshw_wsitesig="";}
if(typeof(ordersetid)=="undefined"||ordersetid==""){ordersetid="0";}
var flg_match=0;if(pln==arshw||pln_2==arshw||flg_match==1){oplan=[arshid,arshw,ordersetid,ordernm,ordersupli,ordersig,ordersig_s,ordersig_s_loc];if($.trim(aror[j][2])=="ORDER"){ret=2;}else{ret=1;}
if(flgdel==1){delete data.order[x][xx][j];}}}}}}
return[ret,oplan,data.order[x]];}
function funApPlan(val,strSC,flgEm){var ptmedRes='';if((typeof(val)=="undefined"||val=="")&&val!="0"){var arAs=[];var arAsIndx=[];var oAs=$("#assessplan textarea[name*=\"elem_assessment[]\"]");var lnAs=oAs.length;for(var i=0;i<lnAs;i++){var as=oAs[i].value;if(as!=""){arAs[arAs.length]=as;arAsIndx[arAs.length]=parseInt(i)+1;}}
var arAsDx=[];var oAsDx=$("#assessplan textarea[name*=elem_assessment_dxcode]");var dxLn=$("#assessplan textarea[name*=elem_assessment_dxcode]").length;for(var i=0;i<dxLn;i++){if(oAs[i].value!="")
arAsDx[arAsDx.length]=oAsDx[i].value;}
var final_flag=document.getElementById('hidd_final_flag').value;var form_id=document.getElementById('hidd_formId').value;var ptmed="";if(typeof(strSC)=="undefined"){strSC="";}
if(arAs.length>0||strSC!=""){$("#divApPlan").remove();var str=arAs.join("~!~");str=encodeURIComponent(str);var strIndx=arAsIndx.join("~!~");strIndx=encodeURIComponent(strIndx);var strDx=arAsDx.join("~!~");strDx=encodeURIComponent(strDx);if(typeof(setProcessImg)!='undefined')setProcessImg(1,"linkPrevPlan");$.get("requestHandler.php?elem_formAction=GetPlansofAsmt&asmt="+str+"&strSC="+strSC+"&final_flag="+final_flag+"&form_id="+form_id+"&lnAs="+lnAs+"&strIndx="+strIndx+"&strDx="+strDx,function(data){if(typeof(setProcessImg)!='undefined')setProcessImg(0,"linkPrevPlan");if(data.assess){var tmp="";var c=0;var k=0;for(var x in data.assess){var as_full=as=x;as=js_htmlentities(as);if(as.length>50){as=""+as.substring(0,50)+"..";}
var arpl=data.assess[x];var lnPl=arpl.length;var bckcolor=(c%2==0)?"#f5f5f5":"white";var ap_num=c+1;if(data.arAsIndx&&data.arAsIndx[x]){ap_num=data.arAsIndx[x];}
var tmp_dup_med_ordr=[];var tmp_dup_med_ordr_htm=[];var type_arr=new Array("Meds","Labs","Imaging/Rad","Procedure/Sx","Info/Inst","Order Sets");var strBtnOrdr="";for(var xz in type_arr){strBtnOrdr+="<button class=\"allbut\" type=\"button\" onclick=\"showOrdersInAP(this, '"+ap_num+"')\" >"+type_arr[xz]+"</button>";}
var tmpConMeds="";var strConMeds="";var clstr=(c%2==0)?"asttd":"asttd1";tmp+="<tr valign=\"top\" class=\""+clstr+"\" >";tmp+="<td id=\"td_appu_"+ap_num+"\"><div><label class=\"as\" >"+ap_num+". "+as+"</label>"+strConMeds+strBtnOrdr+"</div>"+"<input type=\"hidden\" name=\"elem_apa\" value=\""+as_full+"\">";if(lnPl>0){var tmp_pln="",tmp_pln_chk="";for(var j=0;j<lnPl;j++){var tmp_row="";if(arpl[j]==null){continue;}
var arshw=$.trim(arpl[j]);var flgRed=0;if(arpl[j].indexOf("~HI@GH#")!=-1){arpl[j]=$.trim(arpl[j].replace(/~HI@GH#/g,""));arshw="<span class=\"color_red\">"+arpl[j]+"</span>";flgRed=1;}
var flgshowOrder=0;var tmpans=isPreviousPlanAOrder(data,x,arpl[j],flgRed);if(flgRed==1){if(tmpans[0]==1){data.order[x]=tmpans[2];flgshowOrder=1;}else if(tmpans[0]==2){data.order[x]=tmpans[2];flgshowOrder=2;}}else{if(tmpans[0]==1||tmpans[0]==2){continue;}}
tmp_pln_chk="";if(arpl[j]!=""&&typeof($("#elem_plan"+ap_num).val())!="undefined"&&$.trim(""+$("#elem_plan"+ap_num).val())!=""){if(isStrExistsInPlan($("#elem_plan"+ap_num).val(),arpl[j],tmpans[0],tmpans[1][3])){tmp_pln_chk="CHECKED";}}
if(flgshowOrder==2){var tmp_arshid=tmpans[1][0];tmp_row+="<input type=\"checkbox\" id=\"elem_app_pln"+c+k+"\" name=\"elem_app"+c+"\" value=\""+arpl[j]+"\" hspace=\"23\" "+tmp_pln_chk+" onclick=\"delOrderDetail(this)\" data-order_asoc_id=\""+tmp_arshid+"\" ><label for=\"elem_app_pln"+c+k+"\" ondblclick=\"showOrderDetail('"+ap_num+"', '0', '"+tmp_arshid+"')\" >"+arshw+"</label>&nbsp;&nbsp;<label  id=\"elem_app_pln"+c+k+"_lbl_del\"  onclick=\"saveOrderDetail(3, '"+ap_num+"', '"+tmp_arshid+"','del')\" title=\"Delete\" style=\"cursor:pointer; font-weight:bold;color:purple;display:none;\">X</label>";}else if(flgshowOrder==1){var tmp_arshid=tmpans[1][0];var tmp_ordersetid=tmpans[1][2];var tmp_ordernm=tmpans[1][3];var tmp_ordersig=tmpans[1][5];var tmp_ordersig_s=tmpans[1][6];var tmp_ordersig_s_loc=tmpans[1][7];var pntr="";var strEyeOpts="<div class=\"form-inline div_eye_site\"><div class=\"radio\"><input type=\"radio\" name=\"elem_ocu_med_site"+c+k+"\" id=\"elem_ocu_med_site_ou"+c+k+"\" value=\"OU\" checked><label for=\"elem_ocu_med_site_ou"+c+k+"\"><b class=\"ou\">OU</b></label></div>&nbsp;"+"<div class=\"radio\"><input type=\"radio\" name=\"elem_ocu_med_site"+c+k+"\" id=\"elem_ocu_med_site_od"+c+k+"\" value=\"OD\" ><label for=\"elem_ocu_med_site_od"+c+k+"\"><b class=\"od\">OD</b></label></div>&nbsp;"+"<div class=\"radio\"><input type=\"radio\" name=\"elem_ocu_med_site"+c+k+"\" id=\"elem_ocu_med_site_os"+c+k+"\" value=\"OS\" ><label for=\"elem_ocu_med_site_os"+c+k+"\"><b class=\"os\">OS</b></label></div></div>&nbsp;";var strSigOpts="";if(typeof(tmp_ordersig)!="undefined"&&tmp_ordersig!=""){strSigOpts="";var arr_tmp_ordersig=tmp_ordersig.split("\n");for(var cx in arr_tmp_ordersig){if(arr_tmp_ordersig[cx]&&typeof(arr_tmp_ordersig[cx])!="undefined"&&arr_tmp_ordersig[cx]!=""){strSigOpts+="<option value=\""+arr_tmp_ordersig[cx]+"\">"+arr_tmp_ordersig[cx]+"</option>";}}
if(strSigOpts!=""){strSigOpts="<select id=\"elem_ocu_med_sig"+c+k+"\" class=\"form-control\" ><option value=\"\"></option>"+strSigOpts+"</select>";}}
strSigOpts+="&nbsp;&nbsp;<input type=\"text\" id=\"elem_ocu_med_sig_other"+c+k+"\" value=\"\"  placeholder=\"Sig\" class=\"form-control\" >";var tmp_pln002="<input type=\"checkbox\" id=\"elem_app"+c+k+"\" name=\"elem_app"+c+"\" value=\""+arpl[j]+"\" hspace=\"23\" "+tmp_pln_chk+" data-order_det_id=\""+tmp_arshid+"\" data-order_set_id=\""+tmp_ordersetid+"\" data-j=\""+k+"\" data-ordernm=\""+tmp_ordernm+"\" data-sig_s=\""+tmp_ordersig_s+"\" data-sig_s_loc=\""+tmp_ordersig_s_loc+"\"  ><label for=\"elem_app"+c+k+"\" ><b>"+arshw+"</b></label>&nbsp;&nbsp;";if(tmp_dup_med_ordr.indexOf(tmp_ordernm)==-1){tmp_dup_med_ordr[tmp_dup_med_ordr.length]=tmp_ordernm;pntr="<span class=\"pointer ui-icon ui-icon-blank002\" ></span>";if(data.dup_med_order[as_full]&&data.dup_med_order[as_full][tmp_ordernm]&&data.dup_med_order[as_full][tmp_ordernm]>1){pntr="<span class=\"pointer  ui-icon ui-icon-circle-arrow-e\" onmouseover=\"showrelorders('"+tmp_ordernm+"',1, this)\" onmouseout=\"showrelorders('"+tmp_ordernm+"',0)\" ></span>";var tmphtm=tmp_dup_med_ordr_htm[tmp_ordernm]||"";tmphtm=tmphtm+tmp_pln002+"&nbsp;&nbsp;"+strEyeOpts+"&nbsp;&nbsp;"+strSigOpts+"<br/>";tmp_dup_med_ordr_htm[tmp_ordernm]=tmphtm;var tmp_pln003="<input type=\"checkbox\" id=\"elem_app"+c+k+"master\" name=\"elem_app"+c+"master\" value=\""+tmp_ordernm+"\" hspace=\"23\" onclick=\"checkrelorders(this)\" ><label for=\"elem_app"+c+k+"master\" ><b>"+tmp_ordernm+"</b></label>&nbsp;&nbsp;";tmp_pln003+=pntr+"&nbsp;&nbsp;";tmp_row+=tmp_pln003;}else{tmp_pln002+=pntr+"&nbsp;&nbsp;"+strEyeOpts+"&nbsp;&nbsp;"+strSigOpts+"";tmp_row+=tmp_pln002;}}else{var tmphtm=tmp_dup_med_ordr_htm[tmp_ordernm]||"";tmphtm=tmphtm+tmp_pln002+"&nbsp;&nbsp;"+strEyeOpts+"&nbsp;&nbsp;"+strSigOpts+"";tmp_dup_med_ordr_htm[tmp_ordernm]="<div>"+tmphtm+"</div>";}}else{tmp_row+="<input type=\"checkbox\" id=\"elem_app"+c+k+"\" name=\"elem_app"+c+"\" value=\""+arpl[j]+"\" hspace=\"23\" "+tmp_pln_chk+" ><label for=\"elem_app"+c+k+"\">"+arshw+"</label>";}
tmp_pln+="<div class=\"form-inline\">"+tmp_row+"</div>";k++;}
tmp+=(tmp_pln!="")?"<div id=\"divapplan"+ap_num+"\" >"+tmp_pln+"</div>":"";}
var tmp_order=tmp_order_supli="";if(data.order&&data.order[x]){for(var xx in data.order[x]){if(data.order[x][xx]&&data.order[x][xx].length>0){var aror=data.order[x][xx];var lnor=aror.length;for(var j=0;j<lnor;j++){if(aror[j]==null||typeof(aror[j][0])=="undefined"){continue;}
if($.trim(aror[j][2])=="ORDER"){var arshw=$.trim(aror[j][0]);var arshid=aror[j][1];var ordersetid=$.trim(aror[j][3]);var ordernm=$.trim(aror[j][4]);var ordersupli=$.trim(aror[j][5]);var ordersig="";var ordersig_s="";var ordersig_s_loc="";}else{var arshw=$.trim(aror[j][0]);var arshid=aror[j][1];var ordersetid=$.trim(aror[j][2]);var ordernm=$.trim(aror[j][3]);var ordersupli=0;var ordersig=$.trim(aror[j][4]);var ordersig_s=$.trim(aror[j][5]);var ordersig_s_loc=$.trim(aror[j][6]);}
if(typeof(ordersetid)=="undefined"||ordersetid==""){ordersetid="0";}
tmp_pln_chk="";if(arshw!=""&&typeof($("#elem_plan"+ap_num).val())!="undefined"&&$.trim(""+$("#elem_plan"+ap_num).val())!=""){if(isStrExistsInPlan($("#elem_plan"+ap_num).val(),""+arshw,aror[j][2],ordernm)){tmp_pln_chk="CHECKED";}}
if($.trim(aror[j][2])=="ORDER"){if(ordersupli==1){tmp_order_supli+="<div class=\"form-inline\"><input type=\"checkbox\" id=\"elem_app"+c+k+"\" name=\"elem_app"+c+"\" value=\""+arshw+"\" hspace=\"23\" "+tmp_pln_chk+" onclick=\"delOrderDetail(this)\" data-order_asoc_id=\""+arshid+"\" ><label for=\"elem_app"+c+k+"\" ondblclick=\"showOrderDetail('"+ap_num+"', '0', '"+arshid+"')\" >"+arshw+"</label>&nbsp;&nbsp;<label  id=\"elem_app"+c+k+"_lbl_del\"  onclick=\"saveOrderDetail(3, '"+ap_num+"', '"+arshid+"','del')\" title=\"Delete\" style=\"cursor:pointer; font-weight:bold;color:purple;display:none;\">X</label></div>";}else{tmp_order+="<div class=\"form-inline\"><input type=\"checkbox\" id=\"elem_app"+c+k+"\" name=\"elem_app"+c+"\" value=\""+arshw+"\" hspace=\"23\" "+tmp_pln_chk+" onclick=\"delOrderDetail(this)\" data-order_asoc_id=\""+arshid+"\" ><label for=\"elem_app"+c+k+"\" ondblclick=\"showOrderDetail('"+ap_num+"', '0', '"+arshid+"')\" >"+arshw+"</label>&nbsp;&nbsp;<label  id=\"elem_app"+c+k+"_lbl_del\"  onclick=\"saveOrderDetail(3, '"+ap_num+"', '"+arshid+"','del')\" title=\"Delete\" style=\"cursor:pointer; font-weight:bold;color:purple;display:none;\">X</label></div>";}}else{if(arshw!=""&&arshid!=""){var pntr="";var strEyeOpts="<div class=\"form-inline div_eye_site\"><div class=\"radio\"><input type=\"radio\" name=\"elem_ocu_med_site"+c+k+"\" id=\"elem_ocu_med_site_ou"+c+k+"\" value=\"OU\" checked><label for=\"elem_ocu_med_site_ou"+c+k+"\"><b class=\"ou\">OU</b></label></div>&nbsp;"+"<div class=\"radio\"><input type=\"radio\" name=\"elem_ocu_med_site"+c+k+"\" id=\"elem_ocu_med_site_od"+c+k+"\" value=\"OD\" ><label for=\"elem_ocu_med_site_od"+c+k+"\"><b class=\"od\">OD</b></label></div>&nbsp;"+"<div class=\"radio\"><input type=\"radio\" name=\"elem_ocu_med_site"+c+k+"\" id=\"elem_ocu_med_site_os"+c+k+"\" value=\"OS\" ><label for=\"elem_ocu_med_site_os"+c+k+"\"><b class=\"os\">OS</b></label></div></div>&nbsp;";var strSigOpts="";if(typeof(ordersig)!="undefined"&&ordersig!=""){strSigOpts="";var arr_tmp_ordersig=ordersig.split("\n");for(var cx in arr_tmp_ordersig){if(arr_tmp_ordersig[cx]&&typeof(arr_tmp_ordersig[cx])!="undefined"&&arr_tmp_ordersig[cx]!=""){strSigOpts+="<option value=\""+arr_tmp_ordersig[cx]+"\">"+arr_tmp_ordersig[cx]+"</option>";}}
if(strSigOpts!=""){strSigOpts="<select id=\"elem_ocu_med_sig"+c+k+"\" class=\"form-control\" ><option value=\"\"></option>"+strSigOpts+"</select>";}}
strSigOpts+="&nbsp;&nbsp;<input type=\"text\" id=\"elem_ocu_med_sig_other"+c+k+"\" value=\"\" class=\"form-control\"  placeholder=\"Sig\">";var tmp_order002="<input type=\"checkbox\" id=\"elem_app"+c+k+"\" name=\"elem_app"+c+"\" value=\""+arshw+"\" hspace=\"23\" data-order_det_id=\""+arshid+"\" data-order_set_id=\""+ordersetid+"\" data-j=\""+k+"\" data-ordernm=\""+ordernm+"\" data-sig_s=\""+ordersig_s+"\" data-sig_s_loc=\""+ordersig_s_loc+"\"  ><label for=\"elem_app"+c+k+"\" >"+arshw+"</label>";if(tmp_dup_med_ordr.indexOf(ordernm)==-1){tmp_dup_med_ordr[tmp_dup_med_ordr.length]=ordernm;pntr="<span class=\"pointer ui-icon ui-icon-blank002\" ></span>";if(data.dup_med_order[as_full]&&data.dup_med_order[as_full][ordernm]&&data.dup_med_order[as_full][ordernm]>1){pntr="<span class=\"pointer  ui-icon ui-icon-circle-arrow-e\" onmouseover=\"showrelorders('"+ordernm+"',1, this)\" onmouseout=\"showrelorders('"+ordernm+"',0)\" ></span>";var tmphtm=tmp_dup_med_ordr_htm[ordernm]||"";tmphtm=tmphtm+tmp_order002+"&nbsp;&nbsp;"+strEyeOpts+"&nbsp;&nbsp;"+strSigOpts+"<br/>";tmp_dup_med_ordr_htm[ordernm]=tmphtm;var tmp_order003="<input type=\"checkbox\" id=\"elem_app"+c+k+"master\" name=\"elem_app"+c+"master\" value=\""+ordernm+"\" hspace=\"23\"  onclick=\"checkrelorders(this)\"  ><label for=\"elem_app"+c+k+"master\" >"+ordernm+"</label>";tmp_order003+="&nbsp;&nbsp;"+pntr+"&nbsp;&nbsp;";tmp_order+="<div class=\"form-inline\">"+tmp_order003+"</div>";}else{tmp_order002+="&nbsp;&nbsp;"+pntr+"&nbsp;&nbsp;"+strEyeOpts+"&nbsp;&nbsp;"+strSigOpts+"";tmp_order+="<div class=\"form-inline\">"+tmp_order002+"</div>";}}else{var tmphtm=tmp_dup_med_ordr_htm[ordernm]||"";tmphtm=tmphtm+tmp_order002+"&nbsp;&nbsp;"+strEyeOpts+"&nbsp;&nbsp;"+strSigOpts+"";tmp_dup_med_ordr_htm[ordernm]="<div class=\"form-inline\">"+tmphtm+"</div>";}}}
k++;}}}}
var tmp_str="";for(var xordr in tmp_dup_med_ordr_htm){var tmphtm=tmp_dup_med_ordr_htm[xordr];if(typeof(tmphtm)!="undefined"&&tmphtm!=""){var xordr_var=xordr.replace(" ","_");tmp_str+="<div id=\"dv_relorders"+xordr_var+"\" class=\"relorders\" onmouseover=\"showrelorders('"+xordr+"',3)\" onmouseout=\"showrelorders('"+xordr+"',0)\" >"+tmphtm+"</div>";}}
tmp_order+=tmp_str;if(tmp_order_supli!=""||tmp_order!=""){var tmp002="<div id=\"divorder"+ap_num+"\" >";if(tmp_order!=""){tmp002+=tmp_order;}
if(tmp_order_supli!=""){tmp002+="<label class=\"boxhead suppordr\" >Supplemental Orders</label>"+tmp_order_supli;}
tmp002+="</div>";tmp+=tmp002;}else{tmp+="";}
tmp+="</td>";tmp+="</tr>";c++;}
if(tmp!=""){var strdivRxHidden01="";if($("input[name=elem_resiHxReviewd][type=hidden]").length>0){var tmpCheck=($("input[name=elem_resiHxReviewd]").val()==1)?"checked":"";strdivRxHidden01+="<input type=\"checkbox\" id=\"elem_resiHxReviewd_01\"  name=\"elem_resiHxReviewd_01\" value=\"1\"  "+tmpCheck+">"+"<label for=\"elem_resiHxReviewd_01\"  >Resident's hx reviewed, pt interviewed, examined. </label>";}
strdivRxHidden01+="<div class=\"form-group\"><label>Rx HW</label> "+"<select id=\"elem_rxhandwritten_01\" name=\"elem_rxhandwritten_01\" title=\"Rx Handwritten\" class=\"form-control minimal\">"+"<option value=\"\"></option>"+"<option value=\"0\" >0</option>"+"<option value=\"1\" >1</option>"+"<option value=\"2\" >2</option>"+"<option value=\"3\" >3</option>"+"<option value=\"4\" >4</option>"+"<option value=\"5\" >5</option>"+"</select></div>";strdivRxHidden01+="<div class=\"form-group\"><label>LAB HW</label> "+"<select id=\"elem_labhandwritten_01\" name=\"elem_labhandwritten_01\" title=\"LAB Handwritten\" class=\"form-control minimal\">"+"<option value=\"\"></option>"+"<option value=\"0\" >0</option>"+"<option value=\"1\" >1</option>"+"<option value=\"2\" >2</option>"+"<option value=\"3\" >3</option>"+"<option value=\"4\" >4</option>"+"<option value=\"5\" >5</option>"+"</select></div>";strdivRxHidden01+="<div class=\"form-group\"><label>RAD HW</label> "+"<select id=\"elem_radhandwritten_01\" name=\"elem_radhandwritten_01\" title=\"RAD Handwritten\" class=\"form-control minimal\">"+"<option value=\"\"></option>"+"<option value=\"0\" >0</option>"+"<option value=\"1\" >1</option>"+"<option value=\"2\" >2</option>"+"<option value=\"3\" >3</option>"+"<option value=\"4\" >4</option>"+"<option value=\"5\" >5</option>"+"</select></div>";var htm="<div id=\"divApPlan\" class=\"whtbox assignmen\" >"+"<figure onclick=\"funApPlan(0);\"><span class=\"glyphicon glyphicon-remove-sign\" ></span></figure>"+"<div class=\"asshead\" id=\"boxhead\"  >"+"<div class=\"row\">"+"<div class=\"col-sm-3\"><h2>Assessment & Plan</h2></div>"+"<div class=\"col-sm-9 form-inline\">"+
strdivRxHidden01+"</div>"+"</div>"+"<div class=\"clearfix\"></div>"+"</div>"+"<div class=\"table-responsive boxcontent\" >"+"<table class=\"table table-bordered\" width=\"100%\">"+"";htm+=tmp;htm+="</table>";htm+="</div>";var btnRxPrt="";if(z_printbtnRx=="1"){btnRxPrt="<input type=\"button\"  class=\"dff_button btn btn-info\" id=\"prntRxBtnId\" onClick=\"funApPlan(3)\" value=\"Rx Print\" align=\"bottom\" />&nbsp;";}
htm+=""+"<div class=\"dvbtn\" >"+"<input type=\"button\" class=\"dff_button btn btn-success\" id=\"btnAP_ok\" onClick=\"funApPlan(1)\" value=\"Done\"/> "+"<input type=\"button\"  class=\"dff_button btn btn-info\" id=\"prntMedBtnId\" onClick=\"funApPlan(2)\" value=\"Print Meds\" align=\"bottom\" />&nbsp;"+"<input type=\"button\"  class=\"dff_button btn btn-info\" id=\"prntMedsAdmn\" onClick=\"funApPlan(4)\" value=\"Meds Administered\" align=\"bottom\" />&nbsp;"+
btnRxPrt+"<input type=\"button\"  align=\"center\" class=\"dff_button btn btn-danger\" id=\"btnAP_close\" onClick=\"funApPlan(0)\" value=\"Close\"/>"+"</div>"+"";htm+="</div>";$("body").append(""+htm);$("#divApPlan input[type=checkbox], #divApPlan label[for]").addClass("frcb");$("#divApPlan").draggable({handle:".boxhead"});$("#divApPlan").show();$("#divApPlan .boxhead").each(function(){$(this).triggerHandler("mousedown");});var dd_pro=new Array();dd_pro["listHeight"]=300;dd_pro["noneSelected"]="Select All";if($(":input[name=selMed]").length>0){$(":input[name=selMed]").multiSelect(dd_pro);}
var tmp=""+$("input[name=elem_rxhandwritten]").val();if(tmp!=""){$("select[name=elem_rxhandwritten_01]").val(tmp);}
var tmp=""+$("input[name=elem_labhandwritten]").val();if(tmp!=""){$("select[name=elem_labhandwritten_01]").val(tmp);}
var tmp=""+$("input[name=elem_radhandwritten]").val();if(tmp!=""){$("select[name=elem_radhandwritten_01]").val(tmp);}}else{top.fAlert("Please enter an assessment.");}}},'json');}else{top.fAlert("Please enter an assessment.");}}else if(val==0){$(".OrderDetail, .OrderList").remove();$("#divApPlan").remove();}else if(val==1){if((elem_per_vo=="1")||((finalize_flag=="1")&&(isReviewable!="1"))){$("#divApPlan").remove();return;}
if(typeof(flgEm)=="undefined"){cpoe_emdeoncheck();}else{$("#elem_resiHxReviewd").val(0);if($("#elem_resiHxReviewd_01").prop("checked")){$("#elem_resiHxReviewd").val(1);$("#assessplan #spnRxHxRvd").addClass("active");}else{$("#assessplan #spnRxHxRvd").removeClass("active");}
var tmp=""+$("#elem_rxhandwritten_01").val();$("#elem_rxhandwritten").val(tmp);var tmp=""+$("#elem_labhandwritten_01").val();$("#elem_labhandwritten").val(tmp);var tmp=""+$("#elem_radhandwritten_01").val();$("#elem_radhandwritten").val(tmp);var oapa=gebi("elem_apa",1);var lnapa=oapa.length;for(var a=0;a<lnapa;a++){var tmp="";var cmnsep="~cmnsep~";var strAssess=oapa[a].value;var oapp=gebi("elem_app"+a,1);var lnapp=oapp.length;var a_n=parseInt(a)+1;if(oapa[a]&&$(oapa[a]).length>0){if($(oapa[a]).parent().length>0&&typeof($(oapa[a]).parent()[0].id)!="undefined"){a_n=$(oapa[a]).parent()[0].id.replace(/td_appu_/,"");}}
for(var b=0;b<lnapp;b++){var t=$.trim(""+oapp[b].value);if(t!=""){var remflg=1;if(tmp!="")tmp+="\n";var oOdrJ=$(oapp[b]).attr("data-j");var el_oapp_sig=oapp[b].name.replace("elem_app","elem_ocu_med_sig");var val_oapp_sig=$("#"+el_oapp_sig+oOdrJ+"").val();val_oapp_sig=$.trim(val_oapp_sig);if(typeof(val_oapp_sig)=="undefined"){val_oapp_sig="";}
var el_oapp_sig_othr=oapp[b].name.replace("elem_app","elem_ocu_med_sig_other");var val_oapp_sig_othr=$("#"+el_oapp_sig_othr+oOdrJ+"").val();val_oapp_sig_othr=$.trim(val_oapp_sig_othr);if(typeof(val_oapp_sig_othr)=="undefined"){val_oapp_sig_othr="";}
else{if(val_oapp_sig!=""){val_oapp_sig+=", ";}val_oapp_sig+=val_oapp_sig_othr;}
if(val_oapp_sig!=""){val_oapp_sig=val_oapp_sig.replace(/[\r\n]/g,"");var oOdrNm=$(oapp[b]).attr("data-ordernm");if(typeof(oOdrNm)=="undefined"){oOdrNm="";}
if(oOdrNm!=""){var oOdrSigSLoc=$(oapp[b]).attr("data-sig_s_loc");if(typeof(oOdrSigSLoc)!="undefined"&&oOdrSigSLoc!=""){t=""+oOdrSigSLoc.replace("SIGLOCATION",""+val_oapp_sig+"");}else{var oOdrSigS=$(oapp[b]).attr("data-sig_s");if(typeof(oOdrSigS)!="undefined"&&oOdrSigS!=""){t=t.replace(oOdrSigS,"");}
t=t.replace(oOdrNm,oOdrNm+" "+val_oapp_sig+"");}}}
var el_oapp_site=oapp[b].name.replace("elem_app","elem_ocu_med_site");var val_oapp_site=$(":checked[name="+el_oapp_site+oOdrJ+"]").val();if(typeof(val_oapp_site)=="undefined"){val_oapp_site="";}
if(val_oapp_site!=""){var oOdrNm=$(oapp[b]).attr("data-ordernm");if(typeof(oOdrNm)=="undefined"){oOdrNm="";}
if(oOdrNm!=""){t=t.replace(oOdrNm,oOdrNm+" ("+val_oapp_site+")");t=add_dt_to_order(t);}}
if(oapp[b].checked){remflg=0;}
t=t+"\u00AD";if(tmp!=""&&tmp.indexOf(t+cmnsep)!=-1){if(remflg==1){continue;}}else{tmp+=t+cmnsep;}
top.fmain.addAssessOption(strAssess,t,0,"def",remflg,'','',a_n);if(oapp[b].checked){var idOdr="";var oOdr=$(oapp[b]).attr("data-order_det_id");if(oOdr&&""+oOdr.length>0){idOdr=""+oOdr;}
var idOdrset="";var oOdrset=$(oapp[b]).attr("data-order_set_id");if(oOdrset&&""+oOdrset.length>0){idOdrset=""+oOdrset;}
setApPolFU("",strAssess,t,a_n,idOdr,idOdrset,val_oapp_site,val_oapp_sig,1);}}}
var tmp_conmed=0;$("#elem_apConMeds"+a_n+"").val(tmp_conmed);}
funInsMed();$("#divApPlan").remove();}}else if(val==2){printPlanFun(1);}else if(val==3){cpoe_printRx();}else if(val==4){var form_id=document.getElementById('hidd_formId').value;if(typeof(setProcessImg)!='undefined')setProcessImg(1,"divApPlan");$.get("requestHandler.php?elem_formAction=MedAdmnsrd&form_id="+form_id,function(d){if(typeof(setProcessImg)!='undefined')setProcessImg(0,"divApPlan");var htm=d;$("body").append(""+htm);$("#divMedAdmnrd").draggable({handle:".boxhead"});$("#divMedAdmnrd").show();$("#divMedAdmnrd .boxhead").each(function(){$(this).triggerHandler("mousedown");});});}else if(val==51||val==50){var form_id=document.getElementById('hidd_formId').value;if(val==51){var all_ids=[];$("#divMedAdmnrd :checked").each(function(){all_ids[all_ids.length]=this.value;});if(all_ids.length<=0){top.fAlert("Please select any order!");}else{var str_ids=all_ids.join(",");if(typeof(setProcessImg)!='undefined')setProcessImg(1,"divMedAdmnrd");$.get("requestHandler.php?elem_formAction=MedAdmnsrd&form_id="+form_id+"&or_det_id="+str_ids,function(d){if(typeof(setProcessImg)!='undefined')setProcessImg(0,"divMedAdmnrd");if(d==1){top.fAlert("Orders are moved to medical Hx.!");}else{console.log(d);}
$("#divMedAdmnrd").remove();});}}else{$("#divMedAdmnrd").remove();}}}
function set_order_pop_up(num,FrmId){var FrmId;if(FrmId=='')
{top.fAlert('Please Open New Chart Note!');return false;}
var width=screen.width,height=screen.height;var left=0;var top=0;var styleStr='toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=no,resizable=yes,width=1280,height='+height;var asses_val=gebi("elem_assessment"+num).value;asses_val=encodeURIComponent(asses_val);oPUF["order_set"]=window.open('chart_notes_order_set.php?asses_val='+asses_val+'&plan_num='+num,'order_set',styleStr);oPUF["order_set"].moveTo(0,0);oPUF["order_set"].focus();}
function showOrdersInAP(obj,c,o_type,srch){if((elem_per_vo=="1")||((finalize_flag=="1")&&(isReviewable!="1"))){return;}
if(typeof(o_type)!="undefined"&&o_type!=""){var ordr_type=o_type;var srch="&srch="+srch;}else{$(".OrderDetail, .OrderList").remove();var ordr_type=$.trim(obj.innerText);var srch='';}
if(""+ordr_type.toLowerCase()=="info/inst"){ordr_type="Information/Instructions";}
if(ordr_type=="ORDER SETS"||ordr_type=="Order Sets"){var fid=$("#elem_masterId").val();set_order_pop_up(c,fid);}else{var prm="requestHandler.php?elem_formAction=showOrdersInAP&ordertype="+ordr_type+"&assi="+c+srch;$.get(""+prm,function(data){if(typeof(o_type)!="undefined"&&o_type!=""){$(".OrderList .purple_bar").nextAll().remove();$(".OrderList .purple_bar").after(data);}else{var opos_top=$("#divApPlan").css("top");var opos_left=$("#divApPlan").css("left");$("body").append(""+data);$(".OrderList").css({"top":opos_top+""}).draggable({handle:".boxhead"});$(".OrderList .boxhead").css({"cursor":"move"});$("#elem_searchOrders").trigger("focus");}
$(".OrderList :checkbox, .OrderList label[for]").addClass("frcb");});}}
function searchOrders(obj,ordr_type,c){var search=$.trim(obj.value);showOrdersInAP('',c,ordr_type,search);}
var showrelorders_flg;function showrelorders(id,flg,obj){if(flg==3){clearTimeout(showrelorders_flg);showrelorders_flg=null;}else if(flg==2){if(showrelorders_flg){var xordr_var=id.replace(" ","_");$("#dv_relorders"+xordr_var).hide();clearTimeout(showrelorders_flg);showrelorders_flg=null;}}else if(flg==1){var xordr_var=id.replace(" ","_");$(".relorders").not("#dv_relorders"+xordr_var).hide();$("#dv_relorders"+xordr_var).show().position({my:"left top",at:"right bottom",of:obj});}else{if(!showrelorders_flg){showrelorders_flg=setTimeout(function(){showrelorders(id,2,obj);},500);}}}
function checkrelorders(obj){var id=obj.value;var xordr_var=id.replace(" ","_");$("#dv_relorders"+xordr_var+" input[type=checkbox]").each(function(){this.checked=(obj.checked)?true:false;});}
function showOrderDetailStart(c,ordertype){var oid="";$("#divOrderList :checked[id*=elem_inorder]").each(function(indx){if(oid!=""){oid+=",";}
oid+=this.value;});if(oid==""){top.fAlert("Please select an order.");return;}
showOrderDetail(c,oid,0,ordertype);}
function showOrderDetail(c,oid,coid,ordertype){$(".OrderDetail, .OrderList").remove();if(typeof(coid)=="undefined"||coid=="0"){coid="";}
if(typeof(oid)=="undefined"||oid=="0"){oid="";}
if(typeof(flgdel)=="undefined"){flgdel="";}
if(typeof(ordertype)=="undefined"){ordertype="";}
var assi=c;var z_orderId=oid;var chart_ordr_id=coid;var c_otype=ordertype;var form_id='';var str="";if((z_orderId!='')||(chart_ordr_id!='')){if((c_otype!='')&&c_otype=="Meds"&&(z_orderId!='')&&(chart_ordr_id=='')){str=""+"requestHandler.php?elem_formAction=GetOrderDetail&req_ptwo=1&mode=med&id="+z_orderId+"&callFrom=WV&assi="+c;}else{str=""+"requestHandler.php?elem_formAction=GetOrderDetail&req_ptwo=1&id="+z_orderId+"&callFrom=WV&assi="+c+"&form_id="+form_id+"&chart_order_id="+chart_ordr_id;}}else if(c!=''){str=""+"requestHandler.php?elem_formAction=GetOrderDetail&req_ptwo=1&callFrom=WV&assi="+c+"&form_id="+form_id+"&c_otype="+c_otype;}
if(str!=''){str=""+"<div id='divpopupWV' class=\"panel panel-primary\" >"+"<div class='panel-heading purple_bar' id='divHeader' ><span class='glyphicon glyphicon-remove pull-right' onClick=$('#divpopupWV').remove()></span>Orders</div>"+"<div id=\"loadingdiv\" class=\"alert alert-info\">Loading! Please wait. </div>"+"<iframe id='frame_order' src='"+str+"'  frameBorder=0 scrolling='auto' width='100%'></iframe>"+"</div>";$("body").append(""+str);$("#divpopupWV").draggable({handle:"#divHeader"});}}
function add_dt_to_order(str){var dts=$("#elem_masterUpdateDate").data("date-show");if(typeof(dts)!="undefined"&&dts!=""){str+=" "+dts;}
return str;}
function del_order_from_plan(str,strtmp){var ptrn=""+str;ptrn=ptrn.replace(/[-\/\\^$*+?.()|[\]{}]/g,'\\$&');ptrn=""+ptrn+"(\\s*\\d{2}\-\\d{2}\-\\d{4})?"+"";var patt=new RegExp(ptrn);strtmp=strtmp.replace(patt,"");return strtmp;}
function saveOrderDetail(flgsave,c,coid,flgDel,cnfrm){if(flgsave=="3"){if(typeof(cnfrm)=="undefined"){top.fancyConfirm("Are you sure you want to delete this?","","top.fmain.saveOrderDetail('"+flgsave+"', '"+c+"', '"+coid+"', '"+flgDel+"', true);");return;}
if(delOrderDetail_obj!=""){$("#"+delOrderDetail_obj).unbind("click",function(){delOrderDetail(this)});$("label[for="+delOrderDetail_obj+"]").unbind("dblclick");$("#"+delOrderDetail_obj+"_lbl_del").remove();delOrderDetail_obj="";}
if(typeof(flgDel)=="undefined"){flgDel="";}
if(typeof(coid)!="undefined"&&coid!=""){var strOrderDetails={"order_set_associate_details_id":coid,"elem_delete":1};$.post("saveCharts.php?elem_saveForm=SaveOrdersDetails",strOrderDetails,function(data){var strtmp=$("#elem_plan"+c).val();if(data.old_summ&&data.old_summ!=""){data.old_summ=$.trim(data.old_summ);if(strtmp.indexOf(""+data.old_summ)!=-1){strtmp=del_order_from_plan(""+data.old_summ,strtmp);}}
strtmp=$.trim(strtmp);$("#elem_plan"+c).val(strtmp).triggerHandler("keyup");updateOrderDetail(c);},"json");}
return;}
if(flgsave=="1"||flgsave=="2"){var strOrderDetails=$("#frmOrderDetail").serialize();$.post("saveCharts.php?elem_saveForm=SaveOrdersDetails",strOrderDetails,function(data){if(data.order_sum&&data.order_sum!=""){var strtmp=$("#elem_plan"+data.plan_num).val();if(data.old_summ&&data.old_summ!=""){strtmp=strtmp.replace(data.old_summ,"");}
strtmp=$.trim(strtmp);if(data.order_type&&data.order_type=="Meds"){if(strtmp!=""){strtmp="\n"+strtmp;}
strtmp=data.order_sum+strtmp;}else{if(strtmp!=""){strtmp=strtmp+"\n";}
strtmp=strtmp+data.order_sum;}
$("#elem_plan"+data.plan_num).val(strtmp).triggerHandler("keyup");updateOrderDetail(data.plan_num);}},"json");}
if(flgsave=="2"){if(top.$("#tl_erx .icon24_eRx").length>0){if(typeof top.fmain.open_erx!="undefined")top.fmain.open_erx();}}
$('.OrderDetail').remove();}
function saveOrderDetail_new(form,flgsave,c,coid,flgDel){if(flgsave=="1"||flgsave=="2"){var ofrm=(top.fmain.frame_order.contentWindow)?top.fmain.frame_order.contentWindow:top.fmain.frame_order;var tmpCKE=top.fmain.frame_order.CKEDITOR;if(top.fmain.frame_order.CKEDITOR==null||typeof(top.fmain.frame_order.CKEDITOR)=="undefined"){tmpCKE=(top.fmain.frame_order.contentWindow&&top.fmain.frame_order.contentWindow.CKEDITOR)?top.fmain.frame_order.contentWindow.CKEDITOR:null;}
template_content=(tmpCKE)?tmpCKE.instances['FCKeditor1'].getData():"";frm_data=$(form).serialize();frm_data+="&FCKeditor1="+escape(template_content);if(typeof(ofrm.disProcessing)!='undefined')ofrm.disProcessing(1);$.post("saveCharts.php?elem_saveForm=SaveOrdersDetails",frm_data,function(data1){if(typeof(ofrm.disProcessing)!='undefined')ofrm.disProcessing(0);if(data1&&data1.cpoe_error&&data1.cpoe_error!=""){var s=ofrm.$("#div_cpoe_error");if(s){s.html("<div class=\"alert alert-warning\">Emdeon Warning !</div>"+data1.cpoe_error);ofrm.set_frame_height();ofrm.set_emdeon_off();}}else if(data1&&data1.cpoe_site_care&&data1.cpoe_site_care!=""){var s=ofrm.$("#div_cpoe_error");if(s){s.html(data1.cpoe_site_care);ofrm.set_frame_height();ofrm.set_emdeon_off();}}else{if(data1&&data1.length>0){var flg_plan_num=0;for(var xx in data1){var data=data1[xx];if(data.order_sum&&data.order_sum!=""){var strtmp=$("#elem_plan"+data.plan_num).val();if(data.old_summ&&data.old_summ!=""){strtmp=del_order_from_plan(""+data.old_summ,strtmp);}
strtmp=$.trim(strtmp);if(data.order_type&&data.order_type=="Meds"&&1==2){if(strtmp!=""){strtmp="\n"+strtmp;}
strtmp=data.order_sum+strtmp;}else{if(strtmp!=""){strtmp=strtmp+"\n";}
var t=add_dt_to_order(data.order_sum);strtmp=strtmp+t;}
$("#elem_plan"+data.plan_num).val(strtmp).triggerHandler("keyup");if(flg_plan_num==0){flg_plan_num=data.plan_num;}}}
updateOrderDetail(flg_plan_num);}
$('.OrderDetail').remove();$('#divpopupWV').remove();$(".OrderDetail, .OrderList").remove();}},"json");}else{top.show_loading_image('hide');}}
function updateOrderDetail(c){var asmt=$("#assessplan textarea[id=elem_assessment"+c+"]").val();var strDx=$("#assessplan textarea[id=elem_assessment_dxcode"+c+"]").val();var form_id=document.getElementById('hidd_formId').value;var prm="requestHandler.php?elem_formAction=updateOrderDetail&assi="+c+"&form_id="+form_id+"&asmt="+encodeURI(asmt)+"&strDx="+encodeURI(strDx);var ar_uchked=[];$("#td_appu_"+c+" #divorder"+c+"  input[type=checkbox][id*=elem_app]").each(function(){if(this.checked==false){ar_uchked[ar_uchked.length]=this.value;}});$.get(""+prm,function(data){var k=$("#td_appu_"+c+"  input[type=checkbox]").length||0;if(k>0){var tk=0,k=0;$("#td_appu_"+c+"  input[type=checkbox][id*=elem_app]").each(function(){if(this.id&&this.name){tk=this.id.replace(this.name,'');if(typeof(tk)!="undefined"&&tk!=""){tk=parseInt(tk);if(k<tk){k=tk;}}}});if(k>0){k+=1;}}
ap_num=c;var str=str_supli="";if(data){for(var z in data){if(data[z]&&data[z].length){var aror=data[z];var lnor=aror.length;var tmp_dup_med_ordr=[];var tmp_dup_med_ordr_htm=[];for(var j=0;j<lnor;j++){if(aror[j]==null||typeof(aror[j][0])=="undefined"){continue;}
if($.trim(aror[j][2])=="ORDER"){var arshw=$.trim(aror[j][0]);var arshid=aror[j][1];var ordersetid=$.trim(aror[j][3]);var ordernm=$.trim(aror[j][4]);var ordersupli=$.trim(aror[j][5]);var ordersig="";var ordersig_s="";var ordersig_s_loc="";}else{var arshw=$.trim(aror[j][0]);var arshid=aror[j][1];var ordersetid=$.trim(aror[j][2]);var ordernm=$.trim(aror[j][3]);var ordersupli=0;var ordersig=$.trim(aror[j][4]);var ordersig_s=$.trim(aror[j][5]);var ordersig_s_loc=$.trim(aror[j][6]);}
if(typeof(ordersetid)=="undefined"||ordersetid==""){ordersetid="0";}
tmp_pln_chk="";if(arshw!=""&&typeof($("#elem_plan"+ap_num).val())!="undefined"&&$.trim(""+$("#elem_plan"+ap_num).val())!=""){if(isStrExistsInPlan($("#elem_plan"+ap_num).val(),""+arshw,aror[j][2],ordernm)){if(ar_uchked.length>0&&ar_uchked.indexOf(ordernm)!=-1){}
else{tmp_pln_chk="CHECKED";}}}
var xc=parseInt(c)-1;xc=""+xc+"00";var flgNoshow=0;$("#divapplan"+ap_num+" span.color_red").each(function(){var tmpchk=$.trim(""+this.innerText);if(tmpchk==arshw){if($.trim(aror[j][2])=="ORDER"){if(ordersupli==1){var olbl=$(this).parent();var chkid=olbl.attr("for");$("#"+chkid).prop("checked",true).bind("click",function(){delOrderDetail(this)});olbl.bind("dblclick",function(){showOrderDetail(ap_num,'0',arshid)});$("&nbsp;&nbsp;<label  id=\""+chkid+"_lbl_del\"  onclick=\"saveOrderDetail(3, '"+ap_num+"', '"+arshid+"','del')\" title=\"Delete\" style=\"cursor:pointer; font-weight:bold;color:purple;display:none;\">X</label>").insertAfter(olbl);}}
flgNoshow=1;}});if(flgNoshow==1){continue;}
if($.trim(aror[j][2])=="ORDER"){if(ordersupli==1){str_supli+="<div class=\"form-inline\"><input type=\"checkbox\" id=\"elem_app"+xc+k+"\" name=\"elem_app"+xc+"\" value=\""+arshw+"\" hspace=\"23\" "+tmp_pln_chk+" onclick=\"delOrderDetail(this)\" ><label for=\"elem_app"+xc+k+"\" ondblclick=\"showOrderDetail('"+ap_num+"', '0', '"+arshid+"')\" >"+arshw+"</label>&nbsp;&nbsp;<label  id=\"elem_app"+xc+k+"_lbl_del\"  onclick=\"saveOrderDetail(3, '"+ap_num+"', '"+arshid+"','del')\" title=\"Delete\" style=\"cursor:pointer; font-weight:bold;color:purple;display:none;\">X</label></div>";}else{str+="<div class=\"form-inline\"><input type=\"checkbox\" id=\"elem_app"+xc+k+"\" name=\"elem_app"+xc+"\" value=\""+arshw+"\" hspace=\"23\" "+tmp_pln_chk+" onclick=\"delOrderDetail(this)\" ><label for=\"elem_app"+xc+k+"\" ondblclick=\"showOrderDetail('"+ap_num+"', '0', '"+arshid+"')\" >"+arshw+"</label>&nbsp;&nbsp;<label  id=\"elem_app"+xc+k+"_lbl_del\"  onclick=\"saveOrderDetail(3, '"+ap_num+"', '"+arshid+"','del')\" title=\"Delete\" style=\"cursor:pointer; font-weight:bold;color:purple;display:none;\">X</label></div>";}}else{if(arshw!=""&&arshid!=""){var strEyeOpts="<div class=\"form-inline div_eye_site\"><div class=\"radio\"><input type=\"radio\" name=\"elem_ocu_med_site"+xc+k+"\" id=\"elem_ocu_med_site_ou"+xc+k+"\" value=\"OU\" checked><label for=\"elem_ocu_med_site_ou"+xc+k+"\"><b class=\"ou\">OU</b></label></div>&nbsp;"+"<div class=\"radio\"><input type=\"radio\" name=\"elem_ocu_med_site"+xc+k+"\" id=\"elem_ocu_med_site_od"+xc+k+"\" value=\"OD\" ><label for=\"elem_ocu_med_site_ou"+xc+k+"\"><b class=\"od\">OD</b></label></div>&nbsp;"+"<div class=\"radio\"><input type=\"radio\" name=\"elem_ocu_med_site"+xc+k+"\" id=\"elem_ocu_med_site_os"+xc+k+"\" value=\"OS\" ><label for=\"elem_ocu_med_site_ou"+xc+k+"\"><b class=\"os\">OS</b></label></div></div>&nbsp;";var strSigOpts="";if(typeof(ordersig)!="undefined"&&ordersig!=""){strSigOpts="";var arr_tmp_ordersig=ordersig.split("\n");for(var cx in arr_tmp_ordersig){if(arr_tmp_ordersig[cx]&&typeof(arr_tmp_ordersig[cx])!="undefined"&&arr_tmp_ordersig[cx]!=""){strSigOpts+="<option value=\""+arr_tmp_ordersig[cx]+"\">"+arr_tmp_ordersig[cx]+"</option>";}}
if(strSigOpts!=""){strSigOpts="<select id=\"elem_ocu_med_sig"+xc+k+"\" class=\"form-control\" ><option value=\"\"></option>"+strSigOpts+"</select>";}}
strSigOpts+="&nbsp;&nbsp;<input type=\"text\" id=\"elem_ocu_med_sig_other"+xc+k+"\" value=\"\"  placeholder=\"Sig\" class=\"form-control\" >";var tmp_pln002="<input type=\"checkbox\" id=\"elem_app"+xc+k+"\" name=\"elem_app"+xc+"\" value=\""+arshw+"\" hspace=\"23\" data-order_det_id=\""+arshid+"\" data-order_set_id=\""+ordersetid+"\" data-j=\""+k+"\" data-ordernm=\""+ordernm+"\" data-sig_s=\""+ordersig_s+"\" data-sig_s_loc=\""+ordersig_s_loc+"\"  ><label for=\"elem_app"+xc+k+"\" >"+arshw+"</label>";if(tmp_dup_med_ordr.indexOf(ordernm)==-1){tmp_dup_med_ordr[tmp_dup_med_ordr.length]=ordernm;pntr="<span class=\"pointer ui-icon ui-icon-blank002\" ></span>";if(data.dup_med_order&&data.dup_med_order[ordernm]&&data.dup_med_order[ordernm]>1){pntr="<span class=\"pointer  ui-icon ui-icon-circle-arrow-e\" onmouseover=\"showrelorders('"+ordernm+"',1, this)\" onmouseout=\"showrelorders('"+ordernm+"',0)\" ></span>";var tmphtm=tmp_dup_med_ordr_htm[ordernm]||"";tmphtm=tmphtm+tmp_pln002+"&nbsp;&nbsp;"+strEyeOpts+"&nbsp;&nbsp;"+strSigOpts+"";tmp_dup_med_ordr_htm[ordernm]="<div class=\"form-inline\">"+tmphtm+"</div>";var tmp_pln003="<input type=\"checkbox\" id=\"elem_app"+xc+k+"master\" name=\"elem_app"+xc+"master\" value=\""+ordernm+"\" hspace=\"23\"   onclick=\"checkrelorders(this)\" ><label for=\"elem_app"+xc+k+"master\" >"+ordernm+"</label>";tmp_pln003+=pntr+"&nbsp;&nbsp;";str+="<div class=\"form-inline\">"+tmp_pln003+"</div>";}else{tmp_pln002+=pntr+"&nbsp;&nbsp;"+strEyeOpts+"&nbsp;&nbsp;"+strSigOpts+"";str+="<div class=\"form-inline\">"+tmp_pln002+"</div>";}}else{var tmphtm=tmp_dup_med_ordr_htm[ordernm]||"";tmphtm=tmphtm+tmp_pln002+"&nbsp;&nbsp;"+strEyeOpts+"&nbsp;&nbsp;"+strSigOpts+"";tmp_dup_med_ordr_htm[ordernm]="<div class=\"form-inline\">"+tmphtm+"</div>";}}}
k++;}}}}
var tmp_str="";for(var xordr in tmp_dup_med_ordr_htm){var tmphtm=tmp_dup_med_ordr_htm[xordr];if(typeof(tmphtm)!="undefined"&&tmphtm!=""){var xordr_var=xordr.replace(" ","_");tmp_str+="<div id=\"dv_relorders"+xordr_var+"\" class=\"relorders\" onmouseover=\"showrelorders('"+xordr+"',3)\" onmouseout=\"showrelorders('"+xordr+"',0)\" >"+tmphtm+"</div>";}}
str+=tmp_str;if(str_supli!=""){str=str+"<label class=\"boxhead suppordr\" >Supplemental Orders</label>"+str_supli;}
if($("#divorder"+c).length>0){$("#divorder"+c).html(""+str);}else{var str="<div id=\"divorder"+c+"\" >"+str+"</div>";$("#td_appu_"+c).append(str);}
$("#divorder"+c+" :checkbox, #divorder"+c+" label[for]").addClass("frcb");},"json");}
var delOrderDetail_obj="";function delOrderDetail(obj){var nm=obj.id;if(obj.checked==false){delOrderDetail_obj="";if($(obj).parents("div[id*=divorder]").length<=0){delOrderDetail_obj=nm;}
$("#"+nm+"_lbl_del").click();}}
function attachOrder2Chart(indx,ordrids){if(typeof(ordrids)=="undefined")ordrids="";if(typeof(indx)=="undefined"){indx="";}
if($.trim(ordrids)==""){return;}
var url="requestHandler.php";var p={"elem_formAction":"attachOrder2Chart","strIdOdr":""+ordrids,"a_n":indx};if(typeof(setProcessImg)!='undefined')setProcessImg("1","follow_up");$.post(url,p,function(data){if(typeof(setProcessImg)!='undefined')setProcessImg("0","follow_up");if(data!="0"){}},"text");}
var _epostX=350;var _epostY=100;function epostpopTest(){var i=parseInt(gebi('epost_insertID').value);gebi('epost_insertID').value=i+1;addEPost(i);var oReq=gebi('evaluationEPostDiv'+i);if(oReq){oReq.style.display='block';var posX=_epostX;var posY=_epostY;$('#evaluationEPostDiv'+i).css({"top":posY,"left":posX});_epostX+=10;_epostY+=10;}}
function saveEpost(i,examName){var getTexts=$("#eposting"+i).val();var epos=$("#evaluationEPostDiv"+i).position();var edb=eval("("+$("#evaluationEPostDiv"+i).attr("data-epost")+")");if(typeof(edb)!="undefined"&&typeof(edb.dbId)!="undefined"){var edbId=edb.dbId;}else{edbId="";}
var strPrePhrase="";$("#evaluationEPostDiv"+i+" :checked").each(function(){strPrePhrase+=$(this).val()+"*|*";});if((getTexts!=''||strPrePhrase!="")&&epos.left!=''&&epos.top!=''){examName=(typeof examName=="undefined")?"":examName;var url1=zPath+"/chart_notes/saveCharts.php";$.get(url1,{q:getTexts,name:"evaluationEPostDiv"+i,left_div:epos.left+"px",top_div:epos.top+"px",prephrase:strPrePhrase,examName:examName,elem_dbId:edbId,elem_saveForm:"EPOST",op:"add"},function(data){$("#evaluationEPostDiv"+i).attr("data-epost","{'dbId':"+data+"}");});}}
function addEPost(i){if(isNaN(i)){return;}
if(typeof(authUserNM)=="undefined")authUserNM="";if(typeof(epost_crDt)=="undefined")epost_crDt="";var left="350px";var ttop="100px";var disEpost="none";var attrDis="0";var examNm=epost_examNm;var ePostData="";var str="";str+=""+"<div class=\"epost panel panel-success\" style=\"left:"+left+"; top:"+ttop+"; display:"+disEpost+";\" id=\"evaluationEPostDiv"+i+"\" "+"attrDis=\""+attrDis+"\"  >"+"<div class=\"panel-heading\" onMouseUp=\"saveEpost("+i+",'"+examNm+"');\">"+"ePostIt : "+""+authUserNM+" ("+epost_crDt+")"+"<span class=\"glyphicon glyphicon-remove pull-right cur_hnd\" onClick=\"deleteEPost('"+i+"','"+examNm+"');\"></span>"+"</div><div class=\"panel-body\">";for(var x in arrEpost){str+=""+"<input type=\"checkbox\" name=\"pre_phrase"+i+"\" id=\"pre_phrase"+i+"_"+x+"\"  value=\""+arrEpost[x]+"\" class=\"frcb\" "+"onClick=\" saveEpost("+i+",'"+examNm+"');\"  ><label for=\"pre_phrase"+i+"_"+x+"\" class=\"frcb\">"+arrEpost[x]+"</label><br/>"+"";}
str+=""+""+"<textarea name=\"eposting\" id=\"eposting"+i+"\" "+"onBlur=\"saveEpost("+i+",'"+examNm+"');\" class=\"form-control\" onkeyup=\"epost_setTaPlanHgt(this);\">"+ePostData+"</textarea>"+""+""+"</div><div class=\"panel-footer\"></div>"+"</div>";$("body").append(str);$("#evaluationEPostDiv"+i).draggable();if(typeof(epost_addTypeAhead)!="undefined"){epost_addTypeAhead();}}
function epost_setTaPlanHgt(o){var num=o.id;var x=$("#"+num)[0].scrollHeight;var y=(typeof(x)!="undefined"&&x>40)?x:40;$("#"+num).attr("style","height: "+y+"px !important");}
function deleteEPost(i,examName){var edb=eval("("+$("#evaluationEPostDiv"+i).attr("data-epost")+")");if(typeof(edb)!="undefined"&&typeof(edb.dbId)!="undefined"){var edbId=edb.dbId;}else{edbId="";}
$("#evaluationEPostDiv"+i).remove();if(edbId!=""){examName=(typeof examName=="undefined")?"":examName;var url2=zPath+"/chart_notes/saveCharts.php";$.get(url2,{del:"evaluationEPostDiv"+i,examName:examName,elem_dbId:edbId,elem_saveForm:"EPOST",op:"delete"});}}
$(document).ready(function(){top.$('#spanMoreCoMangPhy, #spanMoreRefPhy, #spanMorePCP').unbind("click");top.$('#spanMoreCoMangPhy, #spanMoreRefPhy, #spanMorePCP').click(function(){var refPhyId="";var multi="";var spanID=$(this).attr('id');var patId=sess_pt;if(spanID=='spanMoreCoMangPhy'){multi="2";}
else if(spanID=='spanMoreRefPhy'){multi="1";}
else if(spanID=='spanMorePCP'){multi="3,4";}
top.$('#spanMoreCoMangPhy, #spanMoreRefPhy, #spanMorePCP').popover("destroy");$.ajax({url:zPath+"/patient_info/ajax/insurance/ajax.php?action=refPhyDetails&refPhyId="+refPhyId+"&multi="+multi+"&id="+patId,dataType:'json',success:function(data){var r="";if(data&&data.data){r=""+data.data;}
if(r==''){top.$("#"+spanID).popover("destroy");}else{var title_r="",content_r="";var ar=r.split("~||~");if(typeof(ar[0])!="undefined"){title_r=ar[0];}
if(typeof(ar[1])!="undefined"){content_r=ar[1];content_r=content_r.replace(/\n/g,'<br/>');}
top.$("#"+spanID).popover({title:''+title_r,content:''+content_r,html:true,placement:"bottom"});top.$("#"+spanID).popover("show");}}});});});function loadPhysicians(){}
function hideDetail(){}
var refPhyName=new Array();var refPhyNameID=new Array();function showMultiPhy(op,phyType){hideDetail();op=op||0;phyType=phyType||0;if($("#divMultiRefPhy").length<=0){var htm=""+"<div id=\"divMultiRefPhy\" class=\"section mt10 m5 dvMultiRefPhy\"  ></div>"+"<div id=\"divMultiPCPDemo\" class=\"section mt10 m5 dvMultiRefPhy\" ></div>"+"<div id=\"divMultiCoPhy\" class=\"section mt10 m5 dvMultiRefPhy\" ></div>"+"";$("body").append(htm);$("#divMultiRefPhy, #divMultiPCPDemo, #divMultiCoPhy").draggable({handle:".modal-title"});}
if(op==1){var arrRefPhy=new Array();var arrRefPhyHid=new Array();var arrCoPhy=new Array();var arrCoPhyHid=new Array();var arrPCPDemoPhy=new Array();var arrPCPDemoHid=new Array();var strRefPhy="";var strCoPhy="";var strPCPDemoPhy="";var strRefPhyHid="";var strCoPhyHid="";var strPCPDemoHid="";top.show_loading_image("show");var tmp_txt="",tmp_hidden="";if(phyType==1||phyType==12){tmp_txt="txtRefPhyArr[]";tmp_hidden="hidRefPhyArr-";}else if(phyType==2){tmp_txt="txtCoPhyArr[]";tmp_hidden="hidCoPhyArr-";}else if(phyType==4){tmp_txt="txtPCPDemoArr[]";tmp_hidden="hidPCPDemoArr-";}
if(tmp_txt!=""&&tmp_hidden!=""){if(document.getElementsByName(""+tmp_txt)){var objRefPhyArr=document.getElementsByName(""+tmp_txt);for(var i=0;i<objRefPhyArr.length;i++){var objRefPhyArrID=objRefPhyArr[i].id;var arrRefPhyArrID=objRefPhyArrID.split("-");var hidRefPhyArrID=""+tmp_hidden+arrRefPhyArrID[1];if((document.getElementById(objRefPhyArrID))&&(document.getElementById(hidRefPhyArrID))){arrRefPhy[i]=document.getElementById(objRefPhyArrID).value;arrRefPhyHid[i]=document.getElementById(hidRefPhyArrID).value;}}
if(arrRefPhy.length>0){strRefPhy=arrRefPhy.join("!~#~!");strRefPhyHid=arrRefPhyHid.join("!~#~!");}}}
$.ajax({url:zPath+"/patient_info/common/muti_phy.php?mode=get&phyType="+phyType+"&strRefPhy="+strRefPhy+"&strRefPhyHid="+strRefPhyHid+"&strCoPhy="+strCoPhy+"&strCoPhyHid="+strCoPhyHid+"&strPCPDemoPhy="+strPCPDemoPhy+"&strPCPDemoHid="+strPCPDemoHid+"&callFrom=WV",success:function(respRes){var tmp_txt_arr="",tmp_hid_arr="",tmp_span_id="",tmp_multi_cur="",tmp_multi_ref="divMultiRefPhy",tmp_multi_co="divMultiCoPhy",tmp_multi_pcp="divMultiPCPDemo";if(phyType==1||phyType==12){tmp_multi_cur="divMultiRefPhy";tmp_span_id="spanDetailRefPhy";}else if(phyType==2){tmp_multi_cur="divMultiCoPhy";tmp_span_id="spanDetailCoMangPhy";}else if(phyType==4){tmp_multi_cur="divMultiPCPDemo";tmp_span_id="spanDetailPCP";}
if(tmp_multi_cur!=""){var arrResp=respRes.split("!~-1-~!");var arrTemp=arrResp[1].split("~-~");for(var a=0;a<=arrTemp.length;a++){refPhyName[a]=arrTemp[a];}
var arrTemp=arrResp[2].split("~-~");for(var a=0;a<=arrTemp.length;a++){refPhyNameID[a]=arrTemp[a];}
document.getElementById(""+tmp_multi_ref).style.zIndex=1;document.getElementById(""+tmp_multi_co).style.zIndex=1;document.getElementById(""+tmp_multi_pcp).style.zIndex=1;document.getElementById(""+tmp_multi_cur).innerHTML=arrResp[0];document.getElementById(""+tmp_multi_cur).style.zIndex=1000;var selectedEffect="blind";var offset=top.$("#"+tmp_span_id).offset();var x=offset.left-250;var y=$(window).scrollTop()+20;$("#"+tmp_multi_cur).css({'left':""+x+"px",'top':""+y+"px","z-index":"1000"});$("#"+tmp_multi_cur).show(selectedEffect,"",500);multiphy_typeahead(phyType);}
top.show_loading_image("hide");}});}
else if(op==0){var selectedEffect="blind";if(phyType==1||phyType==12){$("#divMultiRefPhy").hide(selectedEffect,"",500);}
else if(phyType==2){$("#divMultiCoPhy").hide(selectedEffect,"",500);}
else if(phyType==4){$("#divMultiPCPDemo").hide(selectedEffect,"",500);}}
else if(op==2){top.show_loading_image("show");var selectedEffect="blind";var tmp_txt_arr="",tmp_hid_arr="",tmp_span_id="",tmp_multi_cur="",tmp_hid_arr_id="",tmp_del_hid="",tmp_multi_ref="divMultiRefPhy",tmp_multi_co="divMultiCoPhy",tmp_multi_pcp="divMultiPCPDemo";if(phyType==1||phyType==12){tmp_txt_arr="txtRefPhyArr[]";tmp_hid_arr="hidRefPhyArr-";tmp_hid_arr_id="hidRefPhyId";tmp_del_hid="hidDeleteRefPhy";tmp_multi_cur="divMultiRefPhy";strTxtUsrArr="strTxtRefPhyArr";strHidUsrIdID="strHidRefPhyIdID";strHidUsrArrID="strHidRefPhyArrID";hidDeleteUsrVal="hidDeleteRefPhyVal";}else if(phyType==2){tmp_txt_arr="txtCoPhyArr[]";tmp_hid_arr="hidCoPhyArr-";tmp_hid_arr_id="hidCoPhyId";tmp_del_hid="hidDeleteCoPhy";tmp_multi_cur="divMultiCoPhy";strTxtUsrArr="strTxtCoPhyArr";strHidUsrIdID="strHidCoPhyIdID";strHidUsrArrID="strHidCoPhyArrID";hidDeleteUsrVal="hidDeleteCoPhyVal";}else if(phyType==4){tmp_txt_arr="txtPCPDemoArr[]";tmp_hid_arr="hidPCPDemoArr-";tmp_hid_arr_id="hidPCPDemoId";tmp_del_hid="hidDeletePCPDemo";tmp_multi_cur="divMultiPCPDemo";strTxtUsrArr="strTxtPCPDemoArr";strHidUsrIdID="strHidPCPDemoIdID";strHidUsrArrID="strHidPCPDemoArrID";hidDeleteUsrVal="hidDeletePCPDemoVal";}
if(tmp_multi_cur!=""){var strTxtRefPhyArr="";var strHidRefPhyArrID="";var strHidRefPhyIdID="";if(document.getElementsByName(""+tmp_txt_arr)){var objRefPhyArr=document.getElementsByName(""+tmp_txt_arr);for(var i=0;i<objRefPhyArr.length;i++){var objRefPhyArrID=objRefPhyArr[i].id;var arrRefPhyArrID=objRefPhyArrID.split("-");var hidRefPhyArrID=""+tmp_hid_arr+arrRefPhyArrID[1];var hidRefPhyIdID=""+tmp_hid_arr_id+arrRefPhyArrID[1];if((document.getElementById(objRefPhyArrID))&&(document.getElementById(hidRefPhyArrID))){strTxtRefPhyArr+=document.getElementById(objRefPhyArrID).value+"!$@$!";strHidRefPhyArrID+=document.getElementById(hidRefPhyArrID).value+"!$@$!";if(document.getElementById(hidRefPhyIdID)){strHidRefPhyIdID+=document.getElementById(hidRefPhyIdID).value+"!$@$!";}}}}
var hidDeleteRefPhyVal=document.getElementById(""+tmp_del_hid).value;$.ajax({url:zPath+"/patient_info/common/muti_phy.php?mode=save&phyType="+phyType+"&"+strTxtUsrArr+"="+strTxtRefPhyArr+"&"+strHidUsrIdID+"="+strHidRefPhyIdID+"&"+strHidUsrArrID+"="+strHidRefPhyArrID+"&"+hidDeleteUsrVal+"="+hidDeleteRefPhyVal,success:function(respRes){var arrRespRes=respRes.split("-!-");if(arrRespRes[0]=="DONE"){$("#"+tmp_multi_cur).hide(selectedEffect,"",500);}
top.show_loading_image("hide");set_refer_phy_tbar(1);}});}}}
function add_phy_row(add_image_id,del_image_id,intCounter,phyType){var objDelImg=$("#"+del_image_id);var objAddImg=$("#"+add_image_id);if(objAddImg){objAddImg.addClass('hidden')}
if(objDelImg){objDelImg.removeClass('hidden');}
var intCounterTemp=parseInt(intCounter)+1;var divTrTag=document.createElement("div");divTrTag.id="divTR"+"-"+phyType+"-"+intCounterTemp
divTrTag.className="col-xs-12";divTrTag.style.marginBottom="5px";var divTDTag1=document.createElement("div");divTDTag1.className="col-xs-2 text-center";divTDTag1.innerHTML=intCounterTemp;divTrTag.appendChild(divTDTag1);var divTDTag2=document.createElement("div");divTDTag2.className="col-xs-9";if(phyType==1||phyType==12){var txtId="txtRefPhyArr-"+intCounterTemp;}
else if(phyType==2){var txtId="txtCoPhyArr-"+intCounterTemp;}
else if(phyType==4){var txtId="txtPCPDemoArr-"+intCounterTemp;}
var txtBox=document.createElement("input");txtBox.type="text";if(phyType==1||phyType==12){txtBox.name="txtRefPhyArr[]";}
else if(phyType==2){txtBox.name="txtCoPhyArr[]";}
else if(phyType==4){txtBox.name="txtPCPDemoArr[]";}
txtBox.id=txtId;txtBox.value="";txtBox.className="form-control";divTDTag2.appendChild(txtBox);if(phyType==1||phyType==12){var hidId="hidRefPhyArr-"+intCounterTemp;}
else if(phyType==2){var hidId="hidCoPhyArr-"+intCounterTemp;}
else if(phyType==4){var hidId="hidPCPDemoArr-"+intCounterTemp;}
var hidBox=document.createElement("input");hidBox.type="hidden";if(phyType==1||phyType==12){hidBox.name="hidRefPhyArr[]";}
else if(phyType==2){hidBox.name="hidCoPhyArr[]";}
else if(phyType==4){hidBox.name="hidPCPDemoArr[]";}
hidBox.id=hidId;hidBox.value="";divTDTag2.appendChild(hidBox);divTrTag.appendChild(divTDTag2);var divTDTag3=document.createElement("div");divTDTag3.className="col-xs-1";var imgDelId="imgDel"+"-"+phyType+"-"+intCounterTemp;var imgAddId="imgAdd"+"-"+phyType+"-"+intCounterTemp;var strImgHTML="<span id=\""+imgDelId+"\" name=\""+imgDelId+"\" class=\"pointer hidden\" onClick=\"del_phy_row('"+imgDelId+"','"+intCounterTemp+"', '','"+phyType+"');\" ><i class=\"glyphicon glyphicon-remove\"></i></span>";strImgHTML+="<span id=\""+imgAddId+"\" name=\""+imgAddId+"\" onClick=\"add_phy_row('"+imgAddId+"','"+imgDelId+"', '"+intCounterTemp+"', '"+phyType+"');\" class=\"pointer\" ><i class=\"glyphicon glyphicon-plus\"></i></span>";divTDTag3.innerHTML=strImgHTML;divTrTag.appendChild(divTDTag3);if(phyType==1||phyType==12){document.getElementById("divMultiPhyInner1").appendChild(divTrTag);}
else if(phyType==2){document.getElementById("divMultiPhyInner2").appendChild(divTrTag);}
else if(phyType==4){document.getElementById("divMultiPhyInner4").appendChild(divTrTag);}
multiphy_typeahead(phyType);document.getElementById(txtId).focus();}
function del_phy_row(del_image_id,intCounter,intPhyIdDB,phyType){var objDelImg=$("#"+del_image_id);intPhyIdDB=intPhyIdDB||0;var divTrTag="divTR"+"-"+phyType+"-"+intCounter;if((intPhyIdDB>0)&&(phyType==1||phyType==12)){document.getElementById("hidDeleteRefPhy").value+=intPhyIdDB+'-';}
else if((intPhyIdDB>0)&&phyType==2){document.getElementById("hidDeleteCoPhy").value+=intPhyIdDB+'-';}
else if((intPhyIdDB>0)&&phyType==4){document.getElementById("hidDeletePCPDemo").value+=intPhyIdDB+'-';}
if(document.getElementById(divTrTag)){var divType="divMultiPhyInner"+phyType;var objMainDiv=document.getElementById(divType);objMainDiv.removeChild(document.getElementById(divTrTag));}}
function reff_multi_add_popup(){}
function justify2DecimalCL(objElem,global_sign,nosign){if(objElem.name.indexOf("Cyl")!=-1||objElem.name.indexOf("sphere")!=-1||objElem.name.indexOf("Sphere")!=-1){var valElem=$.trim(objElem.value);if(valElem!=""&&!isNaN(valElem)&&nosign!=1){var tmp=global_sign;if(typeof(tmp)=="undefined"||tmp==""){tmp="+"}
var ptrn="^[\+|\-]";var reg=new RegExp(ptrn,'g');var sign=valElem.match(reg);var unJustNumber=(sign==null)?valElem:valElem.substr(1);var justNumber=(unJustNumber=="")?"":parseFloat(unJustNumber).toFixed(2);if(justNumber==0.00)tmp=sign="";if(objElem.name.indexOf("sphere")!=-1||objElem.name.indexOf("Sphere")!=-1){tmp="";}
objElem.value=(sign==null)?tmp+justNumber:sign+justNumber;}else{objElem.value=valElem;}}}
function check2BlurCL(obj,wh,wh2,container,decPoint){var e=window.event;var kCode=e.keyCode
if(!decPoint){decPoint=2;}
if(((kCode>=48)&&(kCode<=57))||((kCode>=65)&&(kCode<=90))||((kCode>=96)&&(kCode<=111))||((kCode>=186)&&(kCode<=191))||((kCode>=219)&&(kCode<=222))){var val=(typeof obj.value=="undefined")?"":obj.value;if(((wh=="I")||(wh=="A"))&&(val.length>=3)){ths=$(obj).attr('id');var nextFd=0;$('input[type=text]',$('#'+container)).each(function()
{if(nextFd==1){$(this).focus();nextFd=0;return 0;}
if(ths==$(this).attr('id')){nextFd=1;}else{nextFd=0;}});}else{var dInx=val.indexOf(".");if((dInx!=-1)){var sbStr=val.substr(dInx+1);if(sbStr.length>=decPoint){ths=$(obj).attr('id');var nextFd=0;$('input[type=text]',$('#'+container)).each(function()
{if(nextFd==1){$(this).focus();nextFd=0;return 0;}
if(ths==$(this).attr('id')){nextFd=1;}else{nextFd=0;}});}}}}}
function copyValuesODToOS(odName,osName){if(dgi(odName)&&dgi(osName)){if(dgi(osName).value==''){if(dgi(odName).value!=''){$("#"+osName).val(dgi(odName).value).trigger("click");}
if(dgi(odName+'ID')&&dgi(osName+'ID')){dgi(osName+'ID').value=dgi(odName+'ID').value;}}}}
function showAppletsDiv(eye,sno,idoc_drawing_id,od_desc,os_desc){parentCtrlId='idoc_drawing_id_'+eye;parentImgId='DrawingPngImg_'+eye;var clWidth=document.body.clientWidth;var clHeight=window.screen.availHeight;if(clHeight==null){clHeight=675;}
w=clWidth;h=parseInt(clHeight)-125;window.open('onload_wv.php?elem_action=Drawingpane&cl_draw=1&sno='+sno+'&eye='+eye+'&idoc_drawing_id='+idoc_drawing_id+'&parentCtrlId='+parentCtrlId+'&parentImgId='+parentImgId+'&od_desc='+od_desc+'&os_desc='+os_desc,'clDrawing'+sno,'height='+h+'px, width='+w+'px, left=0px, top=0px, resizable=yes');}
function hideAppletsDiv(divId){if(dgi(divId)){dgi(divId).style.display='none';}}
function getCLImages_SCL(eye,num,callFrom,sdata,simg,desc){if(eye=='od'){var v1='corneaSCL_od_desc'+num;var v5="elem_SCLOdDrawingPath"+num;if(typeof(setProcessImg)!='undefined')setProcessImg(1,""+v1);$.post('cl_drawing.php',{'elem_formAction':'GetSign','sData':sdata,'sImg':simg},function(data){if(typeof(setProcessImg)!='undefined')setProcessImg(0,""+v1);if(data==''||data=='0')data='';$('input[name='+v5+']').val(data);if(data==''){if(dgi("scl_odDrawingPngImg"+num)){dgi("scl_odDrawingPngImg"+num).src="images/odDrawing.png";}}else{if(dgi("scl_odDrawingPngImg"+num)){dgi("scl_odDrawingPngImg"+num).src="images/odHasDrawing.png";}}});if(callFrom=='wv'){$('#corneaSCL_od_desc'+num).val(desc);}}
if(eye=='os'){var v1='corneaSCL_os_desc'+num;var v5="elem_SCLOsDrawingPath"+num;if(typeof(setProcessImg)!='undefined')setProcessImg(1,""+v1);$.post('cl_drawing.php',{'elem_formAction':'GetSign','sData':sdata,'sImg':simg},function(data){if(typeof(setProcessImg)!='undefined')setProcessImg(0,""+v1);if(data==''||data=='0')data='';$('input[name='+v5+']').val(data);if(data==''){if(dgi("scl_osDrawingPngImg"+num)){dgi("scl_osDrawingPngImg"+num).src="images/odDrawing.png";}}else{if(dgi("scl_osDrawingPngImg"+num)){dgi("scl_osDrawingPngImg"+num).src="images/odHasDrawing.png";}}});if(callFrom=='wv'){$('#corneaSCL_os_desc'+num).val(desc);}}}
function getCoords_SCL(eye,num,callFrom,flgGetImg)
{if(eye=='od'){if(typeof(isHTML5OK)!="undefined"&&isHTML5OK==1){if(flgGetImg==1){var objData=gebi("sig_dataapp_scl_od_drawing"+num);var objImg=gebi("sig_imgapp_scl_od_drawing"+num);window.opener.getCLImages_SCL(eye,num,callFrom,objData.value,objImg.value,dgi('corneaSCL_od_desc'+num).value);window.close();}}else{var coords;var objElemConjunctivaOdDrawing=dgi("elem_SCLOdDrawing"+num);coords=getCoords('app_scl_od_drawing'+num);objElemConjunctivaOdDrawing.value=refineCoords(coords);var objConjunctivaOdDrawingOriginal=dgi("hdSCLOdDrawingOriginal"+num);var checkDrawingConjunctivaOd=checkAppletDrawing(objElemConjunctivaOdDrawing.value);if((checkDrawingConjunctivaOd)&&(objConjunctivaOdDrawingOriginal.value==""))
{objElemConjunctivaOdDrawing.onchange();objConjunctivaOdDrawingOriginal.value=objElemConjunctivaOdDrawing.value;if(dgi("scl_odDrawingPngImg"+num)){dgi("scl_odDrawingPngImg"+num).src="images/odHasDrawing.png";}}
else if((objElemConjunctivaOdDrawing.value!=objConjunctivaOdDrawingOriginal.value)&&(objConjunctivaOdDrawingOriginal.value!=""))
{if(dgi("scl_odDrawingPngImg"+num)){dgi("scl_odDrawingPngImg"+num).src="images/odHasDrawing.png";}
objElemConjunctivaOdDrawing.onchange();objConjunctivaOdDrawingOriginal.value=objElemConjunctivaOdDrawing.value;}
if(callFrom=='wv'){window.opener.$('#elem_SCLOdDrawing'+num).val(objElemConjunctivaOdDrawing.value);window.opener.$('#hdSCLOdDrawingOriginal'+num).val(objConjunctivaOdDrawingOriginal.value);window.opener.$('#corneaSCL_od_desc'+num).val(dgi('corneaSCL_od_desc'+num).value);}}}
if(eye=='os'){if(typeof(isHTML5OK)!="undefined"&&isHTML5OK==1){if(flgGetImg==1){var objData=gebi("sig_dataapp_scl_os_drawing"+num);var objImg=gebi("sig_imgapp_scl_os_drawing"+num);window.opener.getCLImages_SCL(eye,num,callFrom,objData.value,objImg.value,dgi('corneaSCL_os_desc'+num).value);window.close();}}else{var objElemConjunctivaOsDrawing=dgi("elem_SCLOsDrawing"+num);coords=getCoords('app_scl_os_drawing'+num);objElemConjunctivaOsDrawing.value=refineCoords(coords);var objConjunctivaOsDrawingOriginal=dgi("hdSCLOsDrawingOriginal"+num);var checkDrawingConjunctivaOs=checkAppletDrawing(objElemConjunctivaOsDrawing.value);if((checkDrawingConjunctivaOs)&&(objConjunctivaOsDrawingOriginal.value==""))
{objElemConjunctivaOsDrawing.onchange();objConjunctivaOsDrawingOriginal.value=objElemConjunctivaOsDrawing.value;if(dgi("scl_oSDrawingPngImg"+num)){dgi("scl_oSDrawingPngImg"+num).src="images/odHasDrawing.png";}}
else if((objElemConjunctivaOsDrawing.value!=objConjunctivaOsDrawingOriginal.value)&&(objConjunctivaOsDrawingOriginal.value!=""))
{objElemConjunctivaOsDrawing.onchange();objConjunctivaOsDrawingOriginal.value=objElemConjunctivaOsDrawing.value;if(dgi("scl_oSDrawingPngImg"+num)){dgi("scl_oSDrawingPngImg"+num).src="images/odHasDrawing.png";}}
if(callFrom=='wv'){window.opener.$('#elem_SCLOsDrawing'+num).val(objElemConjunctivaOsDrawing.value);window.opener.$('#hdSCLOsDrawingOriginal'+num).val(objConjunctivaOsDrawingOriginal.value);window.opener.$('#corneaSCL_os_desc'+num).val(dgi('corneaSCL_os_desc'+num).value);}}}}
function getCLImages_RGP(eye,num,callFrom,sdata,simg,desc){if(eye=='od'){var v1='cornea_od_desc'+num;var v5="elem_conjunctivaOdDrawingPath"+num;if(typeof(setProcessImg)!='undefined')setProcessImg(1,""+v1);$.post('cl_drawing.php',{'elem_formAction':'GetSign','sData':sdata,'sImg':simg},function(data){if(typeof(setProcessImg)!='undefined')setProcessImg(0,""+v1);if(data==''||data=='0')data='';$('input[name='+v5+']').val(data);if(data==''){if(dgi("rgp_odDrawingPngImg"+num)){dgi("rgp_odDrawingPngImg"+num).src="images/odDrawing.png";}}else{if(dgi("rgp_odDrawingPngImg"+num)){dgi("rgp_odDrawingPngImg"+num).src="images/odHasDrawing.png";}}});if(callFrom=='wv'){$('#cornea_od_desc'+num).val(desc);}}
if(eye=='os'){var v1='cornea_os_desc'+num;var v5="elem_conjunctivaOsDrawingPath"+num;if(typeof(setProcessImg)!='undefined')setProcessImg(1,""+v1);$.post('cl_drawing.php',{'elem_formAction':'GetSign','sData':sdata,'sImg':simg},function(data){if(typeof(setProcessImg)!='undefined')setProcessImg(0,""+v1);if(data==''||data=='0')data='';$('input[name='+v5+']').val(data);if(data==''){if(dgi("rgp_osDrawingPngImg"+num)){dgi("rgp_osDrawingPngImg"+num).src="images/odDrawing.png";}}else{if(dgi("rgp_osDrawingPngImg"+num)){dgi("rgp_osDrawingPngImg"+num).src="images/odHasDrawing.png";}}});if(callFrom=='wv'){$('#cornea_os_desc'+num).val(desc);}}}
function getCoords_RGP(eye,num,callFrom,flgGetImg){if(eye=='od'){if(typeof(isHTML5OK)!="undefined"&&isHTML5OK==1){if(flgGetImg==1){var objData=gebi("sig_dataapp_rgp_od_drawing"+num);var objImg=gebi("sig_imgapp_rgp_od_drawing"+num);window.opener.getCLImages_RGP(eye,num,callFrom,objData.value,objImg.value,dgi('cornea_od_desc'+num).value);window.close();}}else{var coords;var objElemConjunctivaOdDrawing=dgi("elem_conjunctivaOdDrawing"+num);coords=getCoords('app_rgp_od_drawing'+num);objElemConjunctivaOdDrawing.value=refineCoords(coords);var objConjunctivaOdDrawingOriginal=dgi("hdConjunctivaOdDrawingOriginal"+num);var checkDrawingConjunctivaOd=checkAppletDrawing(objElemConjunctivaOdDrawing.value);if((checkDrawingConjunctivaOd)&&(objConjunctivaOdDrawingOriginal.value==""))
{objElemConjunctivaOdDrawing.onchange();objConjunctivaOdDrawingOriginal.value=objElemConjunctivaOdDrawing.value;if(dgi("rgp_odDrawingPngImg"+num)){dgi("rgp_odDrawingPngImg"+num).src="images/odHasDrawing.png";}}
else if((objElemConjunctivaOdDrawing.value!=objConjunctivaOdDrawingOriginal.value)&&(objConjunctivaOdDrawingOriginal.value!=""))
{if(dgi("rgp_odDrawingPngImg"+num)){dgi("rgp_odDrawingPngImg"+num).src="images/odHasDrawing.png";}
objElemConjunctivaOdDrawing.onchange();objConjunctivaOdDrawingOriginal.value=objElemConjunctivaOdDrawing.value;}
if(callFrom=='wv'){window.opener.$('#elem_conjunctivaOdDrawing'+num).val(objElemConjunctivaOdDrawing.value);window.opener.$('#hdConjunctivaOdDrawingOriginal'+num).val(objConjunctivaOdDrawingOriginal.value);window.opener.$('#cornea_od_desc'+num).val(dgi('cornea_od_desc'+num).value);}}}
if(eye=='os'){if(typeof(isHTML5OK)!="undefined"&&isHTML5OK==1){if(flgGetImg==1){var objData=gebi("sig_dataapp_rgp_os_drawing"+num);var objImg=gebi("sig_imgapp_rgp_os_drawing"+num);window.opener.getCLImages_RGP(eye,num,callFrom,objData.value,objImg.value,dgi('cornea_os_desc'+num).value);window.close();}}else{var objElemConjunctivaOsDrawing=dgi("elem_conjunctivaOsDrawing"+num);coords=getCoords('app_rgp_os_drawing'+num);objElemConjunctivaOsDrawing.value=refineCoords(coords);var objConjunctivaOsDrawingOriginal=dgi("hdConjunctivaOsDrawingOriginal"+num);var checkDrawingConjunctivaOs=checkAppletDrawing(objElemConjunctivaOsDrawing.value);if((checkDrawingConjunctivaOs)&&(objConjunctivaOsDrawingOriginal.value==""))
{objElemConjunctivaOsDrawing.onchange();objConjunctivaOsDrawingOriginal.value=objElemConjunctivaOsDrawing.value;if(dgi("rgp_oSDrawingPngImg"+num)){dgi("rgp_oSDrawingPngImg"+num).src="images/osHasDrawing.png";}}
else if((objElemConjunctivaOsDrawing.value!=objConjunctivaOsDrawingOriginal.value)&&(objConjunctivaOsDrawingOriginal.value!=""))
{objElemConjunctivaOsDrawing.onchange();objConjunctivaOsDrawingOriginal.value=objElemConjunctivaOsDrawing.value;if(dgi("rgp_oSDrawingPngImg"+num)){dgi("rgp_oSDrawingPngImg"+num).src="images/osHasDrawing.png";}}
if(callFrom=='wv'){window.opener.$('#elem_conjunctivaOsDrawing'+num).val(objElemConjunctivaOsDrawing.value);window.opener.$('#elem_conjunctivaOsDrawing'+num).val(objConjunctivaOsDrawingOriginal.value);window.opener.$('#cornea_os_desc'+num).val(dgi('cornea_os_desc'+num).value);}}}}
function getclear(appletId)
{if(typeof(isHTML5OK)!="undefined"&&isHTML5OK==1){if(oSimpDrw&&oSimpDrw[appletId]){oSimpDrw[appletId].clearCanvas();}}else{with(document.applets[appletId])
{clearIt();onmouseout();}}}
function changeRow(clType,odos,rowName,totRows,rowNum,arrManufac,arrManufacId,arrManufacInfo)
{var showTitle=0;var typeName='';if(odos=='od'){typeName='clTypeOD';}else if(odos=='os'){typeName='clTypeOS';}else if(odos=='ou'){typeName='clTypeOU';}
if(rowNum==1){showTitle=1;}
if(rowNum>1){if(dgi(typeName+(rowNum-1))){var prevClType=dgi(typeName+(rowNum-1)).value;if(clType!=prevClType){showTitle=1;}}}
top.show_loading_image('show');$.ajax({url:"add_contactLens_row.php?mode=change&addType="+clType+"&showTitle="+showTitle+"&rowName="+rowName+"&odos="+odos+"&totRows="+totRows+"&rowNum="+rowNum+"&referer=wv",success:function(newRow){top.show_loading_image('hide');$("#"+rowName+rowNum).replaceWith(newRow);if(clType=='prosthesis'||clType=='no-cl'){$("#"+rowName+rowNum+' input[type="text"]').attr("disabled",true);}
applyTypeAhead();var typeAheadWidth="";if(clType=="scl"){typeAheadWidth="300px";}else if(clType=="rgp"){typeAheadWidth="250px";}else if(clType=="cust_rgp"){typeAheadWidth="250px";}
$('ul.typeahead').css('width',typeAheadWidth);$('ul.typeahead').css('max-width',typeAheadWidth);$('ul.typeahead').css('overflow','scroll');$("ul.typeahead li").each(function(){$(this).css("width",typeAheadWidth);$(this).css("max-width",typeAheadWidth);});}});var sclExist='';var rgpExist='';if($('[id^="clTypeOD"')){var ODLen=$('#txtTotOD').val();if(ODLen>0){for(i=1;i<=ODLen;i++)
{if(dgi('clTypeOD'+i).value=='scl'){sclExist=1;}
if(dgi('clTypeOD'+i).value=='rgp'||dgi('clTypeOD'+i).value=='cust_rgp'){rgpExist=1;}}}}
if($('[id^="clTypeOS"')){var ODLen=$('#txtTotOS').val();if(ODLen>0){for(i=1;i<=ODLen;i++)
{if(dgi('clTypeOS'+i).value=='scl'){sclExist=1;}
if(dgi('clTypeOS'+i).value=='rgp'||dgi('clTypeOS'+i).value=='cust_rgp'){rgpExist=1;}}}}
if($('[id^="clTypeOU"')){var OULen=$('#txtTotOU').val();if(OULen>0){for(i=1;i<=OULen;i++)
{if(dgi('clTypeOU'+i).value=='scl'){sclExist=1;}
if(dgi('clTypeOU'+i).value=='rgp'||dgi('clTypeOU'+i).value=='cust_rgp'){rgpExist=1;}}}}}
function setTitleRows(clType){if(clType=='scl'){var titleRow='<tr>';titleRow+='<td class="txt_10b valignBottom">&nbsp;</td>';titleRow+='<td class="txt_10b valignBottom">B. Curve</td>';titleRow+='<td class="txt_11b alignLeft">Diameter</td>';titleRow+='<td class="txt_11b alignLeft" >Sphere</td>';titleRow+='<td class="txt_11b nowrap alignLeft">Cylinder</td>';titleRow+='<td class="txt_11b alignLeft" >Axis</td>';titleRow+='<td class="txt_11b alignLeft" >ADD</td>';titleRow+='<td class="txt_11b alignLeft nowrap">DVA</td>';titleRow+='<td class="txt_11b alignLeft nowrap">NVA</td>';titleRow+='<td class="txt_11b alignLeft nowrap">Type</td>';titleRow+='</tr>';}
if(clType=='rgp')
{var titleRow='<tr>';titleRow+='<td>&nbsp;</td>';titleRow+='<td class="txt_11b nowrap">BC</td>';titleRow+='<td class="txt_11b">Diameter</td>';titleRow+='<td class="txt_11b">Power</td>';titleRow+='<td class="txt_11b">OZ</td>';titleRow+='<td class="txt_11b">CT</td>';titleRow+='<td class="txt_11b">Color</td>';titleRow+='<td class="txt_11b">Latitude</td>';titleRow+='<td class="txt_11b">Add</td>';titleRow+='<td class="txt_11b">DVA</td>';titleRow+='<td class="txt_11b">NVA</td>';titleRow+='<td class="txt_11b">Type</td>';titleRow+='<td class="txt_11b">Warranty</td>';titleRow+='</tr>';}
if(clType=='cust_rgp')
{var titleRow='<tr class="txt_11b" >';titleRow+='<td>&nbsp;</td>';titleRow+='<td>BC</td>';titleRow+='<td>Diameter</td>';titleRow+='<td>Power</td>';titleRow+='<td>2&#176;/W</td>';titleRow+='<td>3&#176;/W</td>';titleRow+='<td>PC/W</td>';titleRow+='<td>OZ</td>';titleRow+='<td>CT</td>';titleRow+='<td>Color</td>';titleRow+='<td>Blend</td>';titleRow+='<td>Edge</td>';titleRow+='<td>Latitude</td>';titleRow+='<td>Add</td>';titleRow+='<td>DVA</td>';titleRow+='<td>NVA</td>';titleRow+='<td>Type</td>';titleRow+='<td>Warranty</td>';titleRow+='</tr>';}
return titleRow;}
function removeTableRow(rowId)
{$("#"+rowId).remove();}
function addNewRow(addType,odos,oldRow,imgId,rowNum,rowCols,referer,arrManufac,arrManufacId,arrManufacInfo)
{var newNum=parseInt(rowNum)+1;var newTrId=oldRow+newNum;var newImgId=imgId+newNum;$("#"+imgId+rowNum).removeClass('glyphicon-plus');$("#"+imgId+rowNum).addClass('glyphicon-remove');$("#"+imgId+rowNum).css('cursor','pointer');$("#"+imgId+rowNum).attr('title','Delete row');$("#"+imgId+rowNum).attr('data-original-title','Delete Row');$("#"+imgId+rowNum).attr('onclick',"removeTableRow('"+oldRow+rowNum+"')");$.ajax({url:"add_contactLens_row.php?addType="+addType+"&rowName="+oldRow+"&odos="+odos+"&rowNum="+rowNum+"&rowCols="+rowCols+"&referer="+referer,success:function(newRow){$("#"+oldRow+rowNum).after(newRow);if(odos=='od'){$('#txtTotOD').val(newNum);}else if(odos=='os'){$('#txtTotOS').val(newNum);}
applyTypeAhead();fillValues(addType,odos,rowNum);var typeAheadWidth="";if(addType=="scl"){typeAheadWidth="300px";}else if(addType=="rgp"){typeAheadWidth="250px";}else if(addType=="cust_rgp"){typeAheadWidth="250px";}
$('ul.typeahead').css('width',typeAheadWidth);$('ul.typeahead').css('max-width',typeAheadWidth);$('ul.typeahead').css('overflow','scroll');$("ul.typeahead li").each(function(){$(this).css("width",typeAheadWidth);$(this).css("max-width",typeAheadWidth);});}});}
function set_properties(id,arrManufacInfo,addType){if(document.getElementById(id+'ID')){var odos=(id.indexOf('OD')=='-1')?'OS':'OD';arrN=id.split(odos);n=arrN[1];if(n){makeId=$('#'+id+'ID').val();if(makeId>0){if(typeof arrManufacInfo[makeId]!="undefined"){arrVals=arrManufacInfo[makeId].split('~');if(addType=='scl'){if(arrVals[0]){$('#SclBcurve'+odos+n).val(arrVals[0]);}
if(arrVals[1]){$('#SclDiameter'+odos+n).val(arrVals[1]);}}else if(addType=='rgp'){if(arrVals[0]){$('#RgpBC'+odos+n).val(arrVals[0]);}
if(arrVals[1]){$('#RgpDiameter'+odos+n).val(arrVals[1]);}}else if(addType=='cust_rgp'){if(arrVals[0]){$('#RgpCustomBC'+odos+n).val(arrVals[0]);}
if(arrVals[1]){$('#RgpCustomDiameter'+odos+n).val(arrVals[1]);}}}}
if(odos=='OD'){osId=id.replace('OD','OS');if($('#'+osId)){$('#'+osId).val($('#'+id).val());}
if($('#'+osId+'ID')){$('#'+osId+'ID').val($('#'+id+'ID').val());}
if(addType=='scl'){if($('#SclBcurveOS'+n)){$('#SclBcurveOS'+n).val($('#SclBcurveOD'+n).val());}
if($('#SclDiameterOS'+n)){$('#SclDiameterOS'+n).val($('#SclDiameterOD'+n).val());}}else if(addType=='rgp'){if($('#SclBcurveOS'+n)){$('#RgpBCOS'+n).val($('#RgpBCOD'+n).val());}
if($('#SclDiameterOS'+n)){$('#RgpDiameterOS'+n).val($('#RgpDiameterOD'+n).val());}}else if(addType=='cust_rgp'){if($('#SclBcurveOS'+n)){$('#RgpCustomBCOS'+n).val($('#RgpCustomBCOD'+n).val());}
if($('#SclDiameterOS'+n)){$('#RgpCustomDiameterOS'+n).val($('#RgpCustomDiameterOD'+n).val());}}}}}}
function fillValues(addType,odos,rowNum)
{var newNum=parseInt(rowNum)+1;if(addType=='scl'){var ar={scl_elemMake:'SclType',scl_elemBc:'SclBcurve',scl_elemDiameter:'SclDiameter',scl_elemSphere:'Sclsphere',scl_elemCylinder:'SclCylinder',scl_elemAxis:'Sclaxis',scl_elemColor:'SclColor',scl_elemAdd:'SclAdd',scl_elemDva:'SclDva',scl_elemNva:'SclNva',};}
if(addType=='rgp'){var ar={rgp_elemMake:'RgpType',rgp_elemBc:'RgpBC',rgp_elemCylinder:'RgpCylinder',rgp_elemDiameter:'RgpDiameter',rgp_elemSphere:'RgpPower',rgp_elemAxis:'RgpAxis',rgp_elemColor:'RgpColor',rgp_elemOZ:'RgpOZ',rgp_elemCT:'RgpCT',rgp_elemAdd:'RgpAdd',rgp_elemDva:'RgpDva',rgp_elemNva:'RgpNva'};}
if(addType=='cust_rgp'){var ar={cust_rgp_elemMake:'RgpCustomType',cust_rgp_elemBc:'RgpCustomBC',cust_rgp_elemDiameter:'RgpCustomDiameter',cust_rgp_elemPower:'RgpCustomPower',cust_rgp_elemCylinder:'RgpCustomCylinder',cust_rgp_elemAxis:'RgpCustomAxis',cust_rgp_elemTwoDegree:'RgpCustom2degree',cust_rgp_elemThreeDegree:'RgpCustom3degree',cust_rgp_elemPCW:'RgpCustomPCW',cust_rgp_elemOZ:'RgpCustomOZ',cust_rgp_elemCT:'RgpCustomCT',cust_rgp_elemColor:'RgpCustomColor',cust_rgp_elemBlend:'RgpCustomBlend',cust_rgp_elemEdge:'RgpCustomEdge',cust_rgp_elemAdd:'RgpCustomAdd',cust_rgp_elemDva:'RgpCustomDva',cust_rgp_elemNva:'RgpCustomNva'};}
for(var a in ar){var site=odos.toUpperCase();var newf=ar[a]+site+newNum;var oldf=ar[a]+site+rowNum;$("#"+newf).val($("#"+oldf).val()).trigger("click");if(ar[a]=="SclType"||ar[a]=="RgpType"||ar[a]=="RgpCustomType"){var newf=newf+"ID";var oldf=oldf+"ID";$("#"+newf).val($("#"+oldf).val()).trigger("click");}}}
function checkwnls(){}
function print_CL_Mr()
{var givenMrValue=dgi('mrVals').value;var pr=flg_printMr=0;var parWidth=parent.document.body.clientWidth;var parHeight=parent.document.body.clientHeight;winPrintMr=window.open('../main/print_patient_mr.php?printType=1&givenMr='+givenMrValue,'printPatientMr','scrollbars=1,resizable=1,width='+parWidth+'height='+parHeight+',top=0,left=0');}
function generate_ajax_menus(eye_class){$('.'+eye_class).menu({content:$('.'+eye_class).next().html(),crumbDefaultText:' '});$.get('simpleMenuContent.php',function(data){$('.'+eye_class).each(function(){var elemID=$(this).attr('id');$('#'+elemID).keydown(function(){$('#'+elemID+'ID').val('');});$(this).menu({content:data,hierarchy:true});});});}
function printRx(method,workSheetId){var parWidth=parent.document.body.clientWidth/2;var parHeight=parent.document.body.clientHeight/2;top.popup_win('print_patient_contact_lenses.php?printType=2&method='+method+'&workSheetId='+workSheetId,'printPatientContact','scrollbars=1,resizable=1,width='+parWidth+'height='+parHeight+',top=0,left=0');}
function enbDisTrialNo(ctrlId,ctrlVal){if(ctrlVal=='Current Trial'){document.getElementById('clws_trial_number').disabled=false;}else{document.getElementById('clws_trial_number').disabled=true;}}
function checkTrialNo(ctrlId){}
function checkDOS(txtBox){}
function copyAllCLValues(addType,fromEye,rowNum)
{var newNum=parseInt(rowNum)+1;if(addType=='scl'){if(fromEye=='OD'){if(dgi('SclsphereOS'+rowNum)){dgi('SclsphereOS'+rowNum).value=dgi('SclsphereOD'+rowNum).value;dgi('SclCylinderOS'+rowNum).value=dgi('SclCylinderOD'+rowNum).value;dgi('SclaxisOS'+rowNum).value=dgi('SclaxisOD'+rowNum).value;dgi('SclBcurveOS'+rowNum).value=dgi('SclBcurveOD'+rowNum).value;dgi('SclDiameterOS'+rowNum).value=dgi('SclDiameterOD'+rowNum).value;dgi('SclAddOS'+rowNum).value=dgi('SclAddOD'+rowNum).value;dgi('SclDvaOS'+rowNum).value=dgi('SclDvaOD'+rowNum).value;dgi('SclNvaOS'+rowNum).value=dgi('SclNvaOD'+rowNum).value;dgi('SclTypeOS'+rowNum).value=dgi('SclTypeOD'+rowNum).value;dgi('SclTypeOS'+rowNum+"ID").value=dgi('SclTypeOD'+rowNum+"ID").value;dgi('SclCylinderOS'+rowNum).value=dgi('SclCylinderOD'+rowNum).value;}else{alert('No corresponding row exists.');}}}
if(addType=='rgp'){if(fromEye=='OD'){if(dgi('RgpPowerOS'+rowNum)){dgi('RgpPowerOS'+rowNum).value=dgi('RgpPowerOD'+rowNum).value;dgi('RgpBCOS'+rowNum).value=dgi('RgpBCOD'+rowNum).value;dgi('RgpDiameterOS'+rowNum).value=dgi('RgpDiameterOD'+rowNum).value;dgi('RgpOZOS'+rowNum).value=dgi('RgpOZOD'+rowNum).value;dgi('RgpCTOS'+rowNum).value=dgi('RgpCTOD'+rowNum).value;dgi('RgpColorOS'+rowNum).value=dgi('RgpColorOD'+rowNum).value;dgi('RgpLatitudeOS'+rowNum).value=dgi('RgpLatitudeOD'+rowNum).value;dgi('RgpAddOS'+rowNum).value=dgi('RgpAddOD'+rowNum).value;dgi('RgpDvaOS'+rowNum).value=dgi('RgpDvaOD'+rowNum).value;dgi('RgpNvaOS'+rowNum).value=dgi('RgpNvaOD'+rowNum).value;dgi('RgpTypeOS'+rowNum).value=dgi('RgpTypeOD'+rowNum).value;dgi('RgpTypeOS'+rowNum+"ID").value=dgi('RgpTypeOD'+rowNum+"ID").value;dgi('RgpWarrantyOS'+rowNum).value=dgi('RgpWarrantyOD'+rowNum).value;}else{alert('No Corresponding row exists.');}}}
if(addType=='cust_rgp'){if(fromEye=='OD'){if(dgi('RgpCustomPowerOS'+rowNum)){dgi('RgpCustomPowerOS'+rowNum).value=dgi('RgpCustomPowerOD'+rowNum).value;dgi('RgpCustomBCOS'+rowNum).value=dgi('RgpCustomBCOD'+rowNum).value;dgi('RgpCustom2degreeOS'+rowNum).value=dgi('RgpCustom2degreeOD'+rowNum).value;dgi('RgpCustom3degreeOS'+rowNum).value=dgi('RgpCustom3degreeOD'+rowNum).value;dgi('RgpCustomPCWOS'+rowNum).value=dgi('RgpCustomPCWOD'+rowNum).value;dgi('RgpCustomDiameterOS'+rowNum).value=dgi('RgpCustomDiameterOD'+rowNum).value;dgi('RgpCustomOZOS'+rowNum).value=dgi('RgpCustomOZOD'+rowNum).value;dgi('RgpCustomCTOS'+rowNum).value=dgi('RgpCustomCTOD'+rowNum).value;dgi('RgpCustomColorOS'+rowNum).value=dgi('RgpCustomColorOD'+rowNum).value;dgi('RgpCustomBlendOS'+rowNum).value=dgi('RgpCustomBlendOD'+rowNum).value;dgi('RgpCustomEdgeOS'+rowNum).value=dgi('RgpCustomEdgeOD'+rowNum).value;dgi('RgpCustomLatitudeOS'+rowNum).value=dgi('RgpCustomLatitudeOD'+rowNum).value;dgi('RgpCustomAddOS'+rowNum).value=dgi('RgpCustomAddOD'+rowNum).value;dgi('RgpCustomDvaOS'+rowNum).value=dgi('RgpCustomDvaOD'+rowNum).value;dgi('RgpCustomNvaOS'+rowNum).value=dgi('RgpCustomNvaOD'+rowNum).value;dgi('RgpCustomTypeOS'+rowNum).value=dgi('RgpCustomTypeOD'+rowNum).value;dgi('RgpCustomTypeOS'+rowNum+"ID").value=dgi('RgpCustomTypeOD'+rowNum+"ID").value;dgi('RgpCustomWarrantyOS'+rowNum).value=dgi('RgpCustomWarrantyOD'+rowNum).value;}else{alert('No Corresponding row exists.');}}}}
function showHideCopyImgs(clGrp){var totRows=parseInt(dgi('txtTotOD').value)+parseInt(dgi('txtTotOS').value);if(clGrp=='ou'){$('[id="copyValsDiv"]').show();}else{$('[id="copyValsDiv"]').hide();}}
var jq_curMnuOb=null;function jq_showMenu(ob){var o=$(ob).offset();var mtop=(parseInt(o.top))+"px";$("#menu_manuf").css({"left":o.left,"top":mtop,"display":"block"});jq_curMnuOb=ob;}
var jq_hm_f=0;function jq_hideMenu(){if(jq_hm_f==0){jq_curMnuOb=null;$("#menu_manuf").css({"display":"none"});}}
function jq_hideMenu_can(v){jq_hm_f=v;}
function jq_menuclick(ob){txtBoxID=jq_curMnuOb.id+"ID";$(jq_curMnuOb).val(ob.innerText);jq_aftermenuclick(ob,txtBoxID);jq_hm_f=0;jq_hideMenu();}
function jq_aftermenuclick(item,txtBoxID){if($('#'+txtBoxID)){var mkID=$(item).attr('name');$('#'+txtBoxID).val(mkID);}
if($('#'+txtBoxID).attr('funVars')){var funVals=$('#'+txtBoxID).attr('funVars');var fVals=funVals.split("~");if(dgi('ctrlListVals')){var ctrlListVals=$('#ctrlListVals').val();var txtBoxBC=fVals[3];var txtBoxDiam=fVals[4];if(ctrlListVals!=''&&dgi(txtBoxBC)&&dgi(txtBoxDiam)){var parts='';var tempArr=ctrlListVals.split(',');var fBCArr=new Array();var fDiamArr=new Array();for(t=0;t<tempArr.length;t++){parts=tempArr[t].split('$');fBCArr[parts[0]]=parts[1];fDiamArr[parts[0]]=parts[2];}
$('#'+txtBoxBC).val(fBCArr[mkID]);$('#'+txtBoxDiam).val(fDiamArr[mkID]);var txtBoxBC_OS=txtBoxBC.replace("OD","OS");var txtBoxDiam_OS=txtBoxDiam.replace("OD","OS");if($('#'+txtBoxBC_OS)){$('#'+txtBoxBC_OS).val(fBCArr[mkID]);}
if($('#'+txtBoxDiam_OS)){$('#'+txtBoxDiam_OS).val(fDiamArr[mkID]);}}}
if(fVals[0]=='printOrder'){setPrice(fVals[1],fVals[2],$('#'+txtBoxID).val());}
if(fVals[0]=='worksheet'){if($('#'+fVals[2])){copyValuesODToOS(fVals[1],fVals[2]);}}}}
function showSave(command){dgi('buttonSavediv').style.display='inline-table';if(command=="close"){dgi('buttonSavediv').style.display='none';}}
function Contactlensformsubmit(){var lengthArray=document.getElementsByName('clws_type').length;var iCounter=0;var cTrial='no';var SubMitForm=false;for(iCounter=0;iCounter<lengthArray;iCounter++){if(document.getElementsByName('clws_type')[iCounter].checked==true){SubMitForm=true;if(document.getElementsByName('clws_type')[iCounter].value=='Current Trial'){cTrial='yes';}}}
if(document.getElementById('otherSave').value!=''){SubMitForm=true;}
if(cTrial=='yes'&&document.getElementById('clws_trial_number').value==''){SubmitForm=false;alert('Please fill trial no value.');}
if(SubMitForm==false){alert("Please select Evaluation/Trial option.");return false;}else{var selClwsVals=$('#clws_types').val();document.getElementById('CLName').innerHTML=selClwsVals;top.$(':input[name=save][type=button]').trigger('click');showSave('close')}}
function checkSingle(elemId,elemPrice,grpName,callFor)
{var selTypes='';var charges_id='';var checked=0;var noOfChkd=totPrice=0;if(callFor=='sheet'){var obgrp=document.getElementsByName(grpName);var objele=dgi(elemId);var len=obgrp.length;if(dgi('cpt_evaluation_fit_refit').value<=0||dgi('cpt_evaluation_fit_refit').value==''){dgi('cpt_evaluation_fit_refit').value=0;}
if(objele.checked==true)
{dgi('cpt_evaluation_fit_refit').value=(parseInt(dgi('cpt_evaluation_fit_refit').value)+parseInt(elemPrice))+'.00';}else if(objele.checked==false){dgi('cpt_evaluation_fit_refit').value=parseInt(dgi('cpt_evaluation_fit_refit').value)-parseInt(elemPrice)+'.00';}
for(var i=1;i<=4;i++)
{if(document.getElementById('chargesChk'+i).checked)
{noOfChkd+=1;totPrice+=parseInt($('#chargesChk'+i).attr('clPrice'));}}
if(noOfChkd>1){$('#cpt_evaluation_fit_refit').val(totPrice+'.00');$('#cpt_evaluation_fit_refit').attr('readonly',true);}else{$('#cpt_evaluation_fit_refit').attr('readonly',false);}}
if(callFor=='popup'){var obgrp=$('#buttonSavediv input:checkbox[name^="'+grpName+'"]');var objDiv=$('#buttonSavediv #'+elemId);var len=obgrp.length;var obgrp1=document.getElementsByName(grpName);for(var i=0;i<len;i++)
{if(obgrp[i].checked==true)
{selTypes+=obgrp[i].value+',';checked=1;}}
separator='';dgi('clws_types').value=selTypes.substr(0,(selTypes.length)-1);if(checked==1){separator=',';}
if(dgi('otherSave').value!=''){dgi('clws_types').value+=separator+dgi('otherSave').value;}}}
function loadCopyFromWorkSheet(strcopysheetId){if(strcopysheetId>0){var prvdos=dgi('prvdos').value;$.ajax({url:"cl_block.php?copySheetId="+strcopysheetId,success:function(resp){if(resp){$('#ContactLens').html(resp);utElem_setBgColor();}}});}}
function enbDisTrialNo1(ctrlId){if(dgi(ctrlId).checked==true){document.getElementById('clws_trial_number').disabled=false;}else{document.getElementById('clws_trial_number').disabled=true;}}
var arrManufac=[];var arrManufacId=[];var arrManufacInfo=[];function showSave(command){dgi('buttonSavediv').style.display='inline-table';if(command=="close"){dgi('buttonSavediv').style.display='none';}}
function Contactlensformsubmit(){var lengthArray=document.getElementsByName('clws_type').length;var iCounter=0;var SubMitForm=false;for(iCounter=0;iCounter<lengthArray;iCounter++){if(document.getElementsByName('clws_type')[iCounter].checked==true){SubMitForm=true;}}
if(document.getElementById('otherSave').value!=''){SubMitForm=true;}
if(SubMitForm==false){alert("Please select Evaluation/Trial option.");return false;}else{var selClwsVals=$('#clws_types').val();if($("#CLName").innerHTML!=null&&$("#CLName").innerHTML!=undefined){document.getElementById('CLName').innerHTML=selClwsVals;}
cl_save_wv();showSave('close');}}
function checkSingle(elemId,elemPrice,grpName,callFor)
{var selTypes='';var charges_id='';var checked=0;var noOfChkd=totPrice=0;if(callFor=='sheet'){var obgrp=document.getElementsByName(grpName);var objele=dgi(elemId);var len=obgrp.length;if(dgi('cpt_evaluation_fit_refit').value<=0||dgi('cpt_evaluation_fit_refit').value==''){dgi('cpt_evaluation_fit_refit').value=0;}
if(objele.checked==true)
{dgi('cpt_evaluation_fit_refit').value=(parseInt(dgi('cpt_evaluation_fit_refit').value)+parseInt(elemPrice))+'.00';}else if(objele.checked==false){dgi('cpt_evaluation_fit_refit').value=parseInt(dgi('cpt_evaluation_fit_refit').value)-parseInt(elemPrice)+'.00';}
for(var i=1;i<=4;i++)
{if(document.getElementById('chargesChk'+i).checked)
{noOfChkd+=1;totPrice+=parseInt($('#chargesChk'+i).attr('clPrice'));}}
if(noOfChkd>1){$('#cpt_evaluation_fit_refit').val(totPrice+'.00');$('#cpt_evaluation_fit_refit').attr('readonly',true);}else{$('#cpt_evaluation_fit_refit').attr('readonly',false);}}
if(callFor=='popup'){var obgrp=$('#buttonSavediv input:checkbox[name^="'+grpName+'"]');var objDiv=$('#buttonSavediv #'+elemId);var len=obgrp.length;var obgrp1=document.getElementsByName(grpName);for(var i=0;i<len;i++)
{if(obgrp[i].checked==true)
{selTypes+=obgrp[i].value+',';checked=1;}}
separator='';dgi('clws_types').value=selTypes.substr(0,(selTypes.length)-1);if(checked==1){separator=',';}
if(dgi('otherSave').value!=''){dgi('clws_types').value+=separator+dgi('otherSave').value;}}}
function loadCopyFromWorkSheet(strcopysheetId,elemChanged,copied_to_clws_id,callFrom){if(typeof(callFrom)=="undefined"){callFrom="";}
if(strcopysheetId>0||callFrom=='popup'){var url_str='';var prvdos=dgi('prvdos').value;if(typeof copied_to_clws_id!='string'){copied_to_clws_id='';}
if(callFrom=='popup'){url_str='cl_block.php';}else{url_str='cl_block.php?copySheetId='+strcopysheetId+'&copied_to_clws_id='+copied_to_clws_id;}
$.ajax({url:url_str,success:function(resp){if(resp){$('#ContactLens').html(resp);applyTypeAhead();utElem_setBgColor();curVals=document.getElementById('elem_utElems_cur').value;arrElems=curVals.split(',');for(x in arrElems){elem=arrElems[x];if(elem!=""){set_vis_el_active(document.getElementById(elem));utElem_capture(document.getElementById(elem));}}
for(x in elemChanged){elem=x;if(elem!=""){set_vis_el_active(document.getElementById(elem));utElem_capture(document.getElementById(elem));}}
if(callFrom==''){$('div[id^="CLRowOD"] input').each(function(){$(this).trigger('click');});$('div[id^="CLRowOS"] input').each(function(){$(this).trigger('click');});}}}});}else{$("#clws_id").val("0");}}
function enbDisTrialNo1(ctrlId){if(dgi(ctrlId).checked==true){document.getElementById('clws_trial_number').disabled=false;}else{document.getElementById('clws_trial_number').disabled=true;}}
var cl_ajax_type_ahd_obj=function(o){$(o).autocomplete({source:"cl_block.php?elem_formAction=TypeAhead",minLength:1,autoFocus:true,focus:function(event,ui){return false;},select:function(event,ui){if(ui.item.value!=""){this.value=""+ui.item.value;id=$(this).attr('id');addType='';if(id.indexOf('Scl')!='-1')addType='scl';else if(id.indexOf('RgpType')!='-1')addType='rgp';else if(id.indexOf('RgpCustom')!='-1')addType='cust_rgp';if(ui.item.id&&typeof(ui.item.id)!="undefined"){$('#'+id+'ID').val(""+ui.item.id);if(ui.item.info&&typeof(ui.item.info)!="undefined"){if(document.getElementById(id+'ID')){var odos=(id.indexOf('OD')=='-1')?'OS':'OD';arrN=id.split(odos);n=arrN[1];if(n){makeId=$('#'+id+'ID').val();if(makeId>0){var tmp=""+ui.item.info;arrVals=tmp.split('~');if(addType=='scl'){if(arrVals[0]){$('#SclBcurve'+odos+n).val(arrVals[0]).trigger("click");}
if(arrVals[1]){$('#SclDiameter'+odos+n).val(arrVals[1]).trigger("click");}}else if(addType=='rgp'){if(arrVals[0]){$('#RgpBC'+odos+n).val(arrVals[0]).trigger("click");}
if(arrVals[1]){$('#RgpDiameter'+odos+n).val(arrVals[1]).trigger("click");}}else if(addType=='cust_rgp'){if(arrVals[0]){$('#RgpCustomBC'+odos+n).val(arrVals[0]).trigger("click");}
if(arrVals[1]){$('#RgpCustomDiameter'+odos+n).val(arrVals[1]).trigger("click");}}}
if(odos=='OD'){osId=id.replace('OD','OS');if($('#'+osId)){$('#'+osId).val($('#'+id).val()).trigger("click");}
if($('#'+osId+'ID')){$('#'+osId+'ID').val($('#'+id+'ID').val());}
if(addType=='scl'){if($('#SclBcurveOS'+n)){$('#SclBcurveOS'+n).val($('#SclBcurveOD'+n).val()).trigger("click");}
if($('#SclDiameterOS'+n)){$('#SclDiameterOS'+n).val($('#SclDiameterOD'+n).val()).trigger("click");}}else if(addType=='rgp'){if($('#SclBcurveOS'+n)){$('#RgpBCOS'+n).val($('#RgpBCOD'+n).val()).trigger("click");}
if($('#SclDiameterOS'+n)){$('#RgpDiameterOS'+n).val($('#RgpDiameterOD'+n).val()).trigger("click");}}else if(addType=='cust_rgp'){if($('#SclBcurveOS'+n)){$('#RgpCustomBCOS'+n).val($('#RgpCustomBCOD'+n).val()).trigger("click");}
if($('#SclDiameterOS'+n)){$('#RgpCustomDiameterOS'+n).val($('#RgpCustomDiameterOD'+n).val()).trigger("click");}}}}}}}}}});};function cl_ajax_type_ahd_all(){$('.typeAhead').bind("focus",function(){if(!$(this).hasClass("ui-autocomplete-input")){cl_ajax_type_ahd_obj(this);};});}
function cl_save_wv(){top.fmain.zSaveWithoutPopupSave=1;top.$(':input[name=save][type=button]').trigger('click');}
function applyTypeAhead(){$(".typeAhead").each(function(i,obj){var odOrOS="";var tmpId=$(this).attr('id');var rowCount=parseInt(tmpId.match(/\d+/)[0],10);var autocomplete=$("#"+tmpId).typeahead({items:arrManufac.length});autocomplete.data('typeahead').source=arrManufac;autocomplete.data('typeahead').updater=function(item)
{for(var j=0;j<arrManufac.length;j++)
{if(item==arrManufac[j])
{if(tmpId.indexOf("OD")!==-1){odOrOS="OD";}else if(tmpId.indexOf("OS")!==-1){odOrOS="OS";}
var lensMakeId=arrManufacId[j];$("#SclType"+odOrOS+rowCount+"ID").val(lensMakeId);$("#clDetId"+odOrOS+rowCount).val(lensMakeId);var curve=arrManufacInfo[arrManufacId[j]].split('~')[0];var diameter=arrManufacInfo[arrManufacId[j]].split('~')[1];if($("#clType"+odOrOS+rowCount).val()=="scl"||$("#clType"+odOrOS+rowCount).val()=="prosthesis"||$("#clType"+odOrOS+rowCount).val()=="no-cl"){$("#SclBcurve"+odOrOS+rowCount).val(curve);$("#SclDiameter"+odOrOS+rowCount).val(diameter);}
if($("#clType"+odOrOS+rowCount).val()=="rgp"){$("#RgpType"+odOrOS+rowCount+"ID").val(lensMakeId);$("#RgpBC"+odOrOS+rowCount).val(curve);$("#RgpDiameter"+odOrOS+rowCount).val(diameter);}
if($("#clType"+odOrOS+rowCount).val()=="cust_rgp"){$("#RgpCustomType"+odOrOS+rowCount+"ID").val(lensMakeId);$("#RgpCustomBC"+odOrOS+rowCount).val(curve);$("#RgpCustomDiameter"+odOrOS+rowCount).val(diameter);}
if(odOrOS=="OD"){if($("#clType"+odOrOS+rowCount).val()=="scl"||$("#clType"+odOrOS+rowCount).val()=="prosthesis"||$("#clType"+odOrOS+rowCount).val()=="no-cl"){$("#SclBcurveOS"+rowCount).val(curve);$("#SclDiameterOS"+rowCount).val(diameter);$("#SclTypeOS"+rowCount+"ID").val(lensMakeId);$("#clDetIdOS"+rowCount).val(lensMakeId);$("#SclTypeOS"+rowCount).val(item);}
if($("#clType"+odOrOS+rowCount).val()=="rgp"){$("#RgpBCOS"+rowCount).val(curve);$("#RgpDiameterOS"+rowCount).val(diameter);$("#RgpTypeOS"+rowCount+"ID").val(lensMakeId);$("#RgpTypeOS"+rowCount).val(item);}
if($("#clType"+odOrOS+rowCount).val()=="cust_rgp"){$("#RgpCustomBCOS"+rowCount).val(curve);$("#RgpCustomDiameterOS"+rowCount).val(diameter);$("#RgpCustomTypeOS"+rowCount+"ID").val(lensMakeId);$("#RgpCustomTypeOS"+rowCount).val(item);}}
return item;}}}});}
function unpin_icon(pin_unpin,authUserID){$("#pin_unpin_div").css({"display":"none"});icon_ajax(pin_unpin,'unpin',authUserID);}
function pin_icon(pin_unpin,authUserID){$("#"+pin_unpin+" ").append('<a id="pin_'+pin_unpin+'" style="position: absolute;left: 0;width: auto;top: 0;"><img src="'+top.JS_WEB_ROOT_PATH+'/library/images/pin.png"></a>').css({"position":"relative","cursor":"pointer"}).on("click",function(){var remove_obj=$(this).attr("id");$("#pin_"+remove_obj).remove();$('.okayNav__nav--visible').append($("#"+remove_obj));icon_ajax(pin_unpin,'pin',authUserID);});}
function icon_ajax(obj_val,status,authUserID){if(typeof(top.JS_WEB_ROOT_PATH)=="undefined"){return;}
$.ajax({url:top.JS_WEB_ROOT_PATH+"/interface/chart_notes/view/ajax_work_view_icon.php?objval="+obj_val+"&status="+status+"&authUserID="+authUserID,success:function(data){if($.trim(data)){var cnt=data.split(",");for(var i=0;i<cnt.length;i++){pin_unpin=cnt[i];if(pin_unpin){$('.okayNav__nav--invisible').append($("#"+pin_unpin));pin_icon(pin_unpin,authUserID);}}}}});}
function check_refusal(id){$("#refusal_row").val(id);$('#refusal_reason').val($("#refusal_reason"+id).val());$('#m_refusal_snomed').val($("#refusal_snomed"+id).val());}
function check_refusal_values(){var ID=$("#refusal_row").val();var refusal_reason=$('#refusal_reason').val();var refusal_snomed=$('#m_refusal_snomed').val();if(!ID){return false;}
$("#refusal"+ID).val(1);$("#refusal_reason"+ID).val(refusal_reason);$("#refusal_snomed"+ID).val(refusal_snomed);$("#myModal").modal('hide');}
var okay_nav_obj={};$(document).ready(function(){var navigation=$('#nav-main').okayNav();setTimeout(function(){if(!top.$("#first_toolbar").hasClass("Work_View")&&!top.$("#first_toolbar").hasClass("user_fst_landing")){top.$("#first_toolbar").removeClass();top.$("#first_toolbar").addClass("usersection Work_View");top.$("#Work_View").triggerHandler("click");return;}
if(typeof(authUserID)=="undefined"){authUserID=0;}
$('[data-toggle="tooltip"]').tooltip();$('#ContactLens ul.typeahead').css({'max-width':'350px','width':'350px'});$("#ContactLens ul.typeahead li").each(function(){$(this).css({'max-width':'350px','width':'350px'});});$('#pgd_showpop').tooltip({selector:'[data-toggle="tooltip"]',container:'#pgd_showpop'});$('#ContactLens .dropdown-menu li a').click(function(){$(this).parentsUntil('div').parent().siblings('input').val($(this).html());});var pin_unpin=chk_pin="";$('#nav-main .okayNav__nav--visible li').each(function(id,elem){$(elem).on('contextmenu',function(){var str=$(elem).parent().attr("class");if(str.indexOf("invisible")!=-1){return false;}
var left_pos=($(this).position().left);var top_pos=($(this).position().top);$("#pin_unpin_div").css({"display":"block",top:top_pos,left:left_pos});setTimeout(function(){$("#pin_unpin_div").css({"display":"none"});},5000);pin_unpin=$(this).attr("id");return false;});});$("#pin_unpin_div img").click(function(){unpin_icon(pin_unpin,authUserID);});icon_ajax("","",authUserID);$("body").on('change','.checkbox',function(){if(this.checked){var row_id=this.id;$("#hc_modal").modal('show');$("#myModal").modal('show');$("#rowID").val(row_id);}});if(typeof(isDssEnable)!="undefined"&&isDssEnable==1){dssLoadTiuTitles();}},180);top.$(".elchart, #div_pt_name").css("display","block");$("#dvloading").remove();});/*VERSION NO. 0*/