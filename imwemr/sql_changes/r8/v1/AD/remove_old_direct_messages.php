<?php 
$ignoreAuth = true;
include("../../../../config/globals.php");
$cleanDB = array();

// Direct messages MID to remove
$midArrOld=array(280694,279280,279270,279263,278137,276838,274226,280969,285711,380152,377573,377572,377568,377567,377566,377560,375511,375510,375506,375504,375494,375493,374443,374442,374439,374413,374016,371460,362147,380166,380264,380265,380267,380265,380264,380237,380232,380190,380188,380177,425004,431069,431040,430971,771096,771096,782629,782627,782625,782623,781202,781186,768719,768670,767969,767952,751715,751711,751030,751027,751026,751001,745153,745053,742583,742577,737670,737661,737643,737642,737632,737617,733703,733100,733096,731880,811970,812100,812103,812103,840919,811970,1275747,1275746,1275740,1275737,1275734,1269600,1269598,1269594,1269591,1269585,1269581,1235492,1208225,1175782,1175158,1175098,1154882,1154881,1154878,1154840,1154832,1154693,1150755,1150745,1142449,1125861,1096355,1094671,1091574,1048805,663494,663494,639067,663497,663497,663502,663502,663505,663505,663510,663510,677572,677572,674025,673091,673003,672960,663510,663505,663502,663497,663494,677603,677603,677761,677762,677759,677603,677572,674025,673091,673003,672960,2715860,2707718,2680832,2666184,2666178,2666149,2645677,2645256,2633563,2605737,2600532,2584201,2584198,2583810,2549188,2532171,2532051,2514416,2514412,2514410,2514408,2501980,2501788,2499042,2495377,2495376,2495374,2495360,2495358,2495357,2716022,2790360,2784145,2478619,2478577,2449813,2790625,2911881,3989833,3982097,3978362,3978327,3978311,3978273,3978181,3973250,3966075,3966043,3965800,3965777,3965762,3965738,3965737,3965736,3965734,3965732,3965731,3965725,3965724,3965723,3965720,3965714,3965713,3965709,3958991,3958399,3958278,3958277,4000376,4000857,4000914,4000995,4001023,4079025,4079026,4079027,4079027,4079026,4079025,4078972,4078899,4078840,4078696,4078562,4078459,4078251,4077994,4077630,4077480,4077293,4076995,4074693,4072033,4062462,4042312,4036717,4015076,4002158,4002076,4001023,4000995,4000914,4000857,4000573,4000376,3991766,4123262,4122735,4122733,4122715,4122714,4122713,4118826,4117606,4117444,4117430,4117417,4115291,4115132,4115076,4115054,4115039,4115018,4115004,4114983,4091877,4090148,4090130,4089645,4089158,4089057,4088643,4088546,4085600,4081808,4081346,4123301,775433,775438,775459,775465,775468,775469,775460,775471,775472,775466,775482,775483,775486,775487,775513,775514,775519,775525,775526,775532,775533,775534,775535,775559,775560,776224,776225,776527);

$midArr = array(
	array(1,280694,279768,364),
	array(2,279280,278355,364),
	array(3,279270,278345,364),
	array(4,279263,278338,364),
	array(5,278137,277212,364),
	array(6,276838,275914,364),
	array(7,274226,273302,364),
	array(8,280969,0,0),
	array(9,285711,0,0),
	array(10,380152,378686,1209),
	array(11,377573,376134,1209),
	array(12,377572,376133,1209),
	array(13,377568,376129,1209),
	array(14,377567,376128,1209),
	array(15,377566,376127,1209),
	array(16,377560,376121,1209),
	array(17,375511,374074,1209),
	array(18,375510,374073,1209),
	array(19,375506,374069,1209),
	array(20,375504,374067,1209),
	array(21,375494,374057,1209),
	array(22,375493,374056,1209),
	array(23,374443,373011,1209),
	array(24,374442,373010,1209),
	array(25,374439,373007,1209),
	array(26,374413,372981,5794),
	array(27,374016,372583,6886),
	array(28,371460,370048,6886),
	array(29,362147,360784,5794),
	array(30,380166,0,0),
	array(31,380264,0,0),
	array(32,380265,0,0),
	array(33,380267,378801,5794),
	array(34,380265,378799,5794),
	array(35,380264,378798,5794),
	array(36,380237,378771,1209),
	array(37,380232,378766,1209),
	array(38,380190,378724,1209),
	array(39,380188,378722,1209),
	array(40,380177,378711,1209),
	array(41,425004,0,0),
	array(42,431069,429823,5794),
	array(43,431040,429790,8038),
	array(44,430971,429720,5794),
	array(45,771096,0,0),
	array(46,771096,772499,8029),
	array(47,782629,784162,5794),
	array(48,782627,784160,5794),
	array(49,782625,784158,5794),
	array(50,782623,784156,5794),
	array(51,781202,782723,5794),
	array(52,781186,782705,5794),
	array(53,768719,770086,14805),
	array(54,768670,770037,5794),
	array(55,767969,769332,5794),
	array(56,767952,769315,5794),
	array(57,751715,752921,14430),
	array(58,751711,752917,14429),
	array(59,751030,752218,5794),
	array(60,751027,752215,5794),
	array(61,751026,752214,5794),
	array(62,751001,752186,1265),
	array(63,745153,746277,1265),
	array(64,745053,746174,1265),
	array(65,742583,743662,5794),
	array(66,742577,743656,5794),
	array(67,737670,738712,1265),
	array(68,737661,738703,1265),
	array(69,737643,738685,1265),
	array(70,737642,738684,1265),
	array(71,737632,738674,1265),
	array(72,737617,738659,1265),
	array(73,733703,734689,5794),
	array(74,733100,734079,5794),
	array(75,733096,734075,5794),
	array(76,731880,732834,1265),
	array(77,811970,0,0),
	array(78,812100,813770,8029),
	array(79,812103,0,0),
	array(80,812103,813772,8029),
	array(81,840919,0,0),
	array(82,811970,813640,8029),
	array(83,1275747,1291301,26328),
	array(84,1275746,1291300,26329),
	array(85,1275740,1291294,26330),
	array(86,1275737,1291290,26331),
	array(87,1275734,1291287,26332),
	array(88,1269600,1285097,26283),
	array(89,1269598,1285095,26269),
	array(90,1269594,1285091,26267),
	array(91,1269591,1285088,26266),
	array(92,1269585,1285082,26265),
	array(93,1269581,1285078,26264),
	array(94,1235492,1250622,5794),
	array(95,1208225,1223133,5794),
	array(96,1175782,1182312,5794),
	array(97,1175158,1181683,5794),
	array(98,1175098,1181621,5794),
	array(99,1154882,1161298,5794),
	array(100,1154881,1161297,5794),
	array(101,1154878,1161294,5794),
	array(102,1154840,1161255,1265),
	array(103,1154832,1161247,1265),
	array(104,1154693,1161107,1265),
	array(105,1150755,1157146,5794),
	array(106,1150745,1157136,5794),
	array(107,1142449,1148776,5794),
	array(108,1125861,1132072,1265),
	array(109,1096355,1102485,10690),
	array(110,1094671,1100784,10690),
	array(111,1091574,1097661,5794),
	array(112,1048805,1054537,5794),
	array(113,663494,0,0),
	array(114,663494,662270,364),
	array(115,639067,637834,1551),
	array(116,663497,0,0),
	array(117,663497,662273,364),
	array(118,663502,0,0),
	array(119,663502,662278,364),
	array(120,663505,0,0),
	array(121,663505,662281,364),
	array(122,663510,0,0),
	array(123,663510,662286,364),
	array(124,677572,0,0),
	array(125,677572,676340,364),
	array(126,674025,672799,1551),
	array(127,673091,671868,1551),
	array(128,673003,671780,1551),
	array(129,672960,671737,1551),
	array(130,663510,662286,364),
	array(131,663505,662281,364),
	array(132,663502,662278,364),
	array(133,663497,662273,364),
	array(134,663494,662270,364),
	array(135,677603,0,0),
	array(136,677603,676371,364),
	array(137,677761,676529,1551),
	array(138,677762,676530,1551),
	array(139,677759,676527,1551),
	array(140,677603,676371,364),
	array(141,677572,676340,364),
	array(142,674025,672799,1551),
	array(143,673091,671868,1551),
	array(144,673003,671780,1551),
	array(145,672960,671737,1551),
	array(146,2715860,2739379,36325),
	array(147,2707718,2731147,5794),
	array(148,2680832,2705013,5794),
	array(149,2666184,2690108,50482),
	array(150,2666178,2690106,50482),
	array(151,2666149,2690075,5794),
	array(152,2645677,2669306,5794),
	array(153,2645256,2668886,5794),
	array(154,2633563,2656886,5794),
	array(155,2605737,2628770,5794),
	array(156,2600532,2623467,5794),
	array(157,2584201,2607018,36325),
	array(158,2584198,2607015,5794),
	array(159,2583810,2606605,36325),
	array(160,2549188,2571338,5794),
	array(161,2532171,2554161,1265),
	array(162,2532051,2554041,5794),
	array(163,2514416,2536303,5794),
	array(164,2514412,2536299,5794),
	array(165,2514410,2536297,5794),
	array(166,2514408,2536295,5794),
	array(167,2501980,2523804,5794),
	array(168,2501788,2523610,5794),
	array(169,2499042,2520845,5794),
	array(170,2495377,2517135,5794),
	array(171,2495376,2517134,5794),
	array(172,2495374,2517132,5794),
	array(173,2495360,2517118,5794),
	array(174,2495358,2517116,5794),
	array(175,2495357,2517115,5794),
	array(176,2716022,0,0),
	array(177,2790360,2814828,5794),
	array(178,2784145,2808600,5794),
	array(179,2478619,2500274,43609),
	array(180,2478577,2500232,43609),
	array(181,2449813,2470877,5794),
	array(182,2790625,0,0),
	array(183,2911881,0,0),
	array(184,3989833,4154303,5794),
	array(185,3982097,4142734,16952),
	array(186,3978362,4137168,16952),
	array(187,3978327,4137133,16952),
	array(188,3978311,4137117,16952),
	array(189,3978273,4137079,5794),
	array(190,3978181,4136962,5794),
	array(191,3973250,4130427,5794),
	array(192,3966075,4120915,5794),
	array(193,3966043,4120865,5794),
	array(194,3965800,4120549,1265),
	array(195,3965777,4120526,1265),
	array(196,3965762,4120511,5794),
	array(197,3965738,4120486,5794),
	array(198,3965737,4120485,5794),
	array(199,3965736,4120484,5794),
	array(200,3965734,4120482,5794),
	array(201,3965732,4120479,5794),
	array(202,3965731,4120478,5794),
	array(203,3965725,4120472,5794),
	array(204,3965724,4120471,5794),
	array(205,3965723,4120470,5794),
	array(206,3965720,4120467,5794),
	array(207,3965714,4120460,5794),
	array(208,3965713,4120459,5794),
	array(209,3965709,4120455,5794),
	array(210,3958991,4111819,44730),
	array(211,3958399,4110669,5794),
	array(212,3958278,4110507,5794),
	array(213,3958277,4110506,5794),
	array(214,4000376,0,0),
	array(215,4000857,0,0),
	array(216,4000914,0,0),
	array(217,4000995,0,0),
	array(218,4001023,0,0),
	array(219,4079025,0,0),
	array(220,4079026,0,0),
	array(221,4079027,0,0),
	array(222,4079027,4273978,5794),
	array(223,4079026,4273977,5794),
	array(224,4079025,4273976,5794),
	array(225,4078972,4273914,71500),
	array(226,4078899,4273823,71500),
	array(227,4078840,4273762,71500),
	array(228,4078696,4273598,71500),
	array(229,4078562,4273349,71500),
	array(230,4078459,4273175,71500),
	array(231,4078251,4272588,71500),
	array(232,4077994,4272323,71500),
	array(233,4077630,4271942,71500),
	array(234,4077480,4271759,71500),
	array(235,4077293,4271516,71500),
	array(236,4076995,4271218,71500),
	array(237,4074693,4268475,32367),
	array(238,4072033,4265147,5794),
	array(239,4062462,4253068,7883),
	array(240,4042312,4225826,67337),
	array(241,4036717,4218113,67336),
	array(242,4015076,4188371,5794),
	array(243,4002158,4169578,5794),
	array(244,4002076,4169430,5794),
	array(245,4001023,4168068,5794),
	array(246,4000995,4168036,5794),
	array(247,4000914,4167955,5794),
	array(248,4000857,4167890,5794),
	array(249,4000573,4167485,5794),
	array(250,4000376,4167288,5794),
	array(251,3991766,4157192,5794),
	array(252,4123262,4330555,5794),
	array(253,4122735,4329412,5794),
	array(254,4122733,4329410,5794),
	array(255,4122715,4329392,5794),
	array(256,4122714,4329391,5794),
	array(257,4122713,4329390,5794),
	array(258,4118826,4324817,72142),
	array(259,4117606,4323395,72122),
	array(260,4117444,4323206,72118),
	array(261,4117430,4323191,72117),
	array(262,4117417,4323180,72116),
	array(263,4115291,4319898,72086),
	array(264,4115132,4319748,72006),
	array(265,4115076,4319684,72005),
	array(266,4115054,4319662,72004),
	array(267,4115039,4319652,72002),
	array(268,4115018,4319626,72001),
	array(269,4115004,4319610,72000),
	array(270,4114983,4319593,71999),
	array(271,4091877,4290099,5794),
	array(272,4090148,4287596,36422),
	array(273,4090130,4287570,36422),
	array(274,4089645,4286995,36422),
	array(275,4089158,4286472,71500),
	array(276,4089057,4286375,71500),
	array(277,4088643,4285861,71500),
	array(278,4088546,4285760,71500),
	array(279,4085600,4282309,5794),
	array(280,4081808,4277468,71500),
	array(281,4081346,4276932,71500),
	array(282,4123301,0,0),
	array(283,775433,0,0),
	array(284,775438,0,0),
	array(285,775459,0,0),
	array(286,775465,0,0),
	array(287,775468,0,0),
	array(288,775469,0,0),
	array(289,775460,0,0),
	array(290,775471,0,0),
	array(291,775472,0,0),
	array(292,775466,0,0),
	array(293,775482,0,0),
	array(294,775483,0,0),
	array(295,775486,0,0),
	array(296,775487,0,0),
	array(297,775513,0,0),
	array(298,775514,0,0),
	array(299,775519,0,0),
	array(300,775525,0,0),
	array(301,775526,0,0),
	array(302,775532,0,0),
	array(303,775533,0,0),
	array(304,775534,0,0),
	array(305,775535,0,0),
	array(306,775559,0,0),
	array(307,775560,0,0),
	array(308,776224,0,0),
	array(309,776225,0,0),
	array(310,776527,0,0),
	array(311,5530335,5956583,86394),
	array(312,5530330,5956579,5794),
	array(313,5523596,5948834,86394),
	array(314,5434451,5845768,5794),
	array(315,5430751,5841211,87797),
	array(316,5414061,5822202,5794),
	array(317,5413778,5821875,5794),
	array(318,5413586,5821547,5794),
	array(319,5409180,5816400,5794),
	array(320,5409176,5816396,5794),
	array(321,5409084,5816287,5794),
	array(322,5409004,5816203,5794),
	array(323,5408998,5816192,5794),
	array(324,5408704,5815841,5794),
	array(325,5288997,5678525,5794),
	array(326,5288935,5678463,5794),
	array(327,5193494,5570614,5794),
	array(328,5105859,5469073,5794),
	array(329,5105855,5469069,5794),
	array(330,5105853,5469067,5794),
	array(331,5090915,5451441,5794),
	array(332,5089318,5449689,5794),
	array(333,5078154,5436618,5794),
	array(334,5074444,5432464,5794),
	array(335,5023054,5373291,65600),
	array(336,4923917,5259202,5794),
	array(337,4923801,5259052,5794),
	array(338,4921681,5256540,5794),
	array(339,4921652,5256503,5794),
	array(340,4893414,5224012,5794)
); 

//Removing the above msg id's from the table
foreach ($midArr as $values) {
	$msgId = $values[0];
	$MID = $values[1];
	$MSID = $values[2];
	$FromUID = $values[3];
	$chkMsg = imw_query(' SELECT id FROM direct_messages WHERE id = '.$msgId.' AND MID = '.$MID.' AND MSID = '.$MSID.' AND FromUID = '.$FromUID.' ');
	if($chkMsg && imw_num_rows($chkMsg) > 0){
		$rowFetch = imw_fetch_assoc($chkMsg);
		imw_query(' DELETE FROM direct_messages WHERE id = '.$rowFetch['id'].' ');	
	}
}
// 
// 
// $delSql = imw_query(' SELECT id FROM direct_messages WHERE MID in ('.implode(",", $midArr).')  ');
// if($delSql && imw_num_rows($delSql) > 0){
// 	echo 'Deleting Records From Direct Messages';
// 	while($rowFetch = imw_fetch_assoc($delSql)){
// 		//pre($rowFetch);
// 		$delQry = imw_query(' DELETE FROM `direct_messages` WHERE id = '.$rowFetch['id'].' ');
// 		//if($delQry) imw_query(' DELETE FROM `direct_messages_patient_attachment` WHERE `direct_message_id` = '.$rowFetch['id'].' ');
// 	}
// 	$cleanDB[] = "direct_messages";
// 	echo 'Direct Messages Deleted';
// }

$ptMsgArr=array(
	array(225,69070,2,224),
	array(224,0,69070,222),
	array(223,23507,2,220),
	array(222,69070,2,221),
	array(221,0,69070,0),
	array(220,2,23507,0),
	array(219,6,2,218),
	array(218,1,6,0),
	array(216,2,6,0),
	array(217,6,2,216),
	array(215,69070,4,212),
	array(214,69070,2,212),
	array(212,0,69070,0),
	array(213,69070,2,211),
	array(211,0,69070,0),
	array(209,0,68897,0),
	array(210,68897,2,209),
	array(207,0,68897,0),
	array(208,68897,2,207),
	array(206,2,68897,0),
	array(202,0,7572,0),
	array(203,7572,2,202),
	array(204,7572,18,202),
	array(205,7572,18,202),
	array(201,68483,2,199),
	array(199,0,68483,0),
	array(200,68483,2,199),
	array(198,2,10776,0),
	array(197,2,2,196),
	array(196,2,2,0),
	array(195,37812,2,193),
	array(193,2,37812,0),
	array(194,0,68017,0),
	array(192,0,13897,191),
	array(191,13897,4,190),
	array(190,2,13897,0),
	array(189,67658,1,188),
	array(185,67657,1,183),
	array(186,0,67568,0),
	array(187,0,67568,0),
	array(188,61,67658,0),
	array(182,5,67657,0),
	array(183,0,67657,0),
	array(184,67657,1,182),
	array(181,67656,1,180),
	array(180,5,67656,0),
	array(178,0,38555,177),
	array(179,86,38555,0),
	array(176,2,7572,0),
	array(177,38555,1,0),
	array(170,67595,1,0),
	array(171,0,67616,0),
	array(172,0,67595,0),
	array(173,67595,1,172),
	array(174,0,67568,0),
	array(175,67568,1,174),
	array(168,0,67595,0),
	array(169,67595,1,168),
	array(167,67595,1,166),
	array(165,67568,1,164),
	array(166,1,67595,0),
	array(162,67568,1,0),
	array(163,58846,1,0),
	array(164,0,67568,0),
	array(161,67568,1,160),
	array(157,58846,1,0),
	array(158,0,67568,0),
	array(159,0,67568,0),
	array(160,2,67568,0),
	array(156,58846,1,155),
	array(155,0,58846,137),
	array(151,0,67568,0),
	array(152,0,0,0),
	array(153,0,0,0),
	array(154,0,67568,0),
	array(141,67568,1,0),
	array(142,67568,1,0),
	array(143,0,67568,0),
	array(144,0,67568,0),
	array(145,0,67568,0),
	array(146,0,67568,0),
	array(147,0,67568,0),
	array(148,0,67568,0),
	array(149,0,67568,0),
	array(150,0,67568,0),
	array(138,0,37363,0),
	array(139,0,67568,0),
	array(140,67568,1,0),
	array(137,58846,1,0),
	array(136,58846,1,134),
	array(135,0,58846,0),
	array(134,2,58846,0),
	array(133,67568,1,105),
	array(132,0,67568,0),
	array(131,0,67568,130),
	array(130,67568,1,105),
	array(129,67568,1,105),
	array(128,0,36647,127),
	array(127,36647,1,102),
	array(126,1,1,103),
	array(125,36647,1,102),
	array(122,36647,1,102),
	array(123,0,36647,0),
	array(124,34,36647,0),
	array(120,0,36647,0),
	array(121,36647,1,102),
	array(110,2,67568,0),
	array(111,0,67568,0),
	array(112,0,6,0),
	array(113,6,1,0),
	array(114,6,1,0),
	array(115,5,67568,0),
	array(116,0,67568,0),
	array(117,67568,1,0),
	array(118,0,36647,0),
	array(119,36647,1,102),
	array(106,67568,1,105),
	array(107,0,67568,0),
	array(108,86,59473,0),
	array(109,34,36647,0),
	array(105,2,67568,0),
	array(104,34,36647,0),
	array(103,36647,1,102),
	array(101,36647,1,0),
	array(102,2,36647,0),
	array(226,0,69070,0),
	array(227,69070,2,226),
	array(228,0,69638,0),
	array(229,36647,1,0),
	array(230,0,36647,229),
	array(231,34,69644,0),
	array(232,34,69644,0)
);

//Removing the above msg id's from the table
foreach ($ptMsgArr as $values) {
	$ptMsgId = $values[0];
	$receiverId = $values[1];
	$senderId = $values[2];
	$repliedId = $values[3];
	//echo ' SELECT pt_msg_id FROM patient_messages WHERE pt_msg_id = '.$ptMsgId.' AND receiver_id = '.$receiverId.' AND sender_id = '.$senderId.' AND replied_id = '.$repliedId.' ';die;
	$chkMsg = imw_query(' SELECT pt_msg_id FROM patient_messages WHERE pt_msg_id = '.$ptMsgId.' AND receiver_id = '.$receiverId.' AND sender_id = '.$senderId.' AND replied_id = '.$repliedId.' ');
	if($chkMsg && imw_num_rows($chkMsg) > 0){
		$rowFetch = imw_fetch_assoc($chkMsg);
		imw_query(' DELETE FROM patient_messages WHERE pt_msg_id = '.$rowFetch['pt_msg_id'].' ');	
	}
}

die('Tables are cleaned');
